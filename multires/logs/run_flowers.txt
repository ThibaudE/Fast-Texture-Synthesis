############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0015_1_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0015_1_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0015_1_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0015_1_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0015_1_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0015_1_256.jpg_256_256_avg_SAME_n.pkl
Net loaded and Gram computation (if needed) done after  0.49803972244262695  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 2.92e+09, loss_total = 2.92e+09
Step 1 : gram_loss = 2.01e+09, loss_total = 2.01e+09
Step 2 : gram_loss = 1.90e+09, loss_total = 1.90e+09
Step 3 : gram_loss = 1.37e+09, loss_total = 1.37e+09
Step 4 : gram_loss = 6.87e+08, loss_total = 6.87e+08
Step 5 : gram_loss = 3.47e+08, loss_total = 3.47e+08
Step 6 : gram_loss = 2.38e+08, loss_total = 2.38e+08
Step 7 : gram_loss = 1.82e+08, loss_total = 1.82e+08
Step 8 : gram_loss = 1.56e+08, loss_total = 1.56e+08
Step 9 : gram_loss = 1.32e+08, loss_total = 1.32e+08
Step 10 : gram_loss = 1.06e+08, loss_total = 1.06e+08
Step 11 : gram_loss = 7.57e+07, loss_total = 7.57e+07
Step 12 : gram_loss = 5.21e+07, loss_total = 5.21e+07
Step 13 : gram_loss = 4.31e+07, loss_total = 4.31e+07
Step 14 : gram_loss = 3.30e+07, loss_total = 3.30e+07
Step 15 : gram_loss = 2.97e+07, loss_total = 2.97e+07
Step 16 : gram_loss = 2.66e+07, loss_total = 2.66e+07
Step 17 : gram_loss = 2.51e+07, loss_total = 2.51e+07
Step 18 : gram_loss = 2.34e+07, loss_total = 2.34e+07
Step 19 : gram_loss = 2.18e+07, loss_total = 2.18e+07
Step 20 : gram_loss = 1.90e+07, loss_total = 1.90e+07
Step 21 : gram_loss = 1.60e+07, loss_total = 1.60e+07
Step 22 : gram_loss = 1.39e+07, loss_total = 1.39e+07
Step 23 : gram_loss = 1.24e+07, loss_total = 1.24e+07
Step 24 : gram_loss = 1.18e+07, loss_total = 1.18e+07
Step 25 : gram_loss = 1.15e+07, loss_total = 1.15e+07
Step 26 : gram_loss = 1.09e+07, loss_total = 1.09e+07
Step 27 : gram_loss = 1.06e+07, loss_total = 1.06e+07
Step 28 : gram_loss = 9.79e+06, loss_total = 9.79e+06
Step 29 : gram_loss = 8.94e+06, loss_total = 8.94e+06
Step 30 : gram_loss = 8.30e+06, loss_total = 8.30e+06
Step 31 : gram_loss = 8.07e+06, loss_total = 8.07e+06
Step 32 : gram_loss = 7.86e+06, loss_total = 7.86e+06
Step 33 : gram_loss = 7.59e+06, loss_total = 7.59e+06
Step 34 : gram_loss = 7.06e+06, loss_total = 7.06e+06
Step 35 : gram_loss = 6.83e+06, loss_total = 6.83e+06
Step 36 : gram_loss = 6.59e+06, loss_total = 6.59e+06
Step 37 : gram_loss = 6.44e+06, loss_total = 6.44e+06
Step 38 : gram_loss = 6.25e+06, loss_total = 6.25e+06
Step 39 : gram_loss = 5.97e+06, loss_total = 5.97e+06
Step 40 : gram_loss = 5.65e+06, loss_total = 5.65e+06
Step 41 : gram_loss = 5.47e+06, loss_total = 5.47e+06
Step 42 : gram_loss = 5.27e+06, loss_total = 5.27e+06
Step 43 : gram_loss = 5.12e+06, loss_total = 5.12e+06
Step 44 : gram_loss = 4.93e+06, loss_total = 4.93e+06
Step 45 : gram_loss = 4.75e+06, loss_total = 4.75e+06
Step 46 : gram_loss = 4.64e+06, loss_total = 4.64e+06
Step 47 : gram_loss = 4.53e+06, loss_total = 4.53e+06
Step 48 : gram_loss = 4.42e+06, loss_total = 4.42e+06
Step 49 : gram_loss = 4.24e+06, loss_total = 4.24e+06
Step 50 : gram_loss = 3.98e+06, loss_total = 3.98e+06
Step 51 : gram_loss = 3.72e+06, loss_total = 3.72e+06
Step 52 : gram_loss = 3.57e+06, loss_total = 3.57e+06
Step 53 : gram_loss = 3.49e+06, loss_total = 3.49e+06
Step 54 : gram_loss = 3.40e+06, loss_total = 3.40e+06
Step 55 : gram_loss = 3.32e+06, loss_total = 3.32e+06
Step 56 : gram_loss = 3.16e+06, loss_total = 3.16e+06
Step 57 : gram_loss = 3.09e+06, loss_total = 3.09e+06
Step 58 : gram_loss = 2.97e+06, loss_total = 2.97e+06
Step 59 : gram_loss = 2.76e+06, loss_total = 2.76e+06
Step 60 : gram_loss = 2.59e+06, loss_total = 2.59e+06
Step 61 : gram_loss = 2.48e+06, loss_total = 2.48e+06
Step 62 : gram_loss = 2.40e+06, loss_total = 2.40e+06
Step 63 : gram_loss = 2.33e+06, loss_total = 2.33e+06
Step 64 : gram_loss = 2.27e+06, loss_total = 2.27e+06
Step 65 : gram_loss = 2.20e+06, loss_total = 2.20e+06
Step 66 : gram_loss = 2.08e+06, loss_total = 2.08e+06
Step 67 : gram_loss = 1.98e+06, loss_total = 1.98e+06
Step 68 : gram_loss = 1.88e+06, loss_total = 1.88e+06
Step 69 : gram_loss = 1.84e+06, loss_total = 1.84e+06
Step 70 : gram_loss = 1.79e+06, loss_total = 1.79e+06
Step 71 : gram_loss = 1.68e+06, loss_total = 1.68e+06
Step 72 : gram_loss = 1.60e+06, loss_total = 1.60e+06
Step 73 : gram_loss = 1.55e+06, loss_total = 1.55e+06
Step 74 : gram_loss = 1.50e+06, loss_total = 1.50e+06
Step 75 : gram_loss = 1.46e+06, loss_total = 1.46e+06
Step 76 : gram_loss = 1.39e+06, loss_total = 1.39e+06
Step 77 : gram_loss = 1.30e+06, loss_total = 1.30e+06
Step 78 : gram_loss = 1.28e+06, loss_total = 1.28e+06
Step 79 : gram_loss = 1.25e+06, loss_total = 1.25e+06
Step 80 : gram_loss = 1.22e+06, loss_total = 1.22e+06
Step 81 : gram_loss = 1.15e+06, loss_total = 1.15e+06
Step 82 : gram_loss = 1.11e+06, loss_total = 1.11e+06
Step 83 : gram_loss = 1.06e+06, loss_total = 1.06e+06
Step 84 : gram_loss = 1.04e+06, loss_total = 1.04e+06
Step 85 : gram_loss = 1.02e+06, loss_total = 1.02e+06
Step 86 : gram_loss = 9.74e+05, loss_total = 9.74e+05
Step 87 : gram_loss = 9.40e+05, loss_total = 9.40e+05
Step 88 : gram_loss = 9.13e+05, loss_total = 9.13e+05
Step 89 : gram_loss = 8.93e+05, loss_total = 8.93e+05
Step 90 : gram_loss = 8.69e+05, loss_total = 8.69e+05
Step 91 : gram_loss = 8.53e+05, loss_total = 8.53e+05
Step 92 : gram_loss = 8.24e+05, loss_total = 8.24e+05
Step 93 : gram_loss = 8.11e+05, loss_total = 8.11e+05
Step 94 : gram_loss = 8.00e+05, loss_total = 8.00e+05
Step 95 : gram_loss = 7.87e+05, loss_total = 7.87e+05
Step 96 : gram_loss = 7.73e+05, loss_total = 7.73e+05
Step 97 : gram_loss = 7.60e+05, loss_total = 7.60e+05
Step 98 : gram_loss = 7.38e+05, loss_total = 7.38e+05
Step 99 : gram_loss = 7.12e+05, loss_total = 7.12e+05
Step 100 : gram_loss = 6.94e+05, loss_total = 6.94e+05
Step 101 : gram_loss = 6.79e+05, loss_total = 6.79e+05
Step 102 : gram_loss = 6.62e+05, loss_total = 6.62e+05
Step 103 : gram_loss = 6.37e+05, loss_total = 6.37e+05
Step 104 : gram_loss = 6.24e+05, loss_total = 6.24e+05
Step 105 : gram_loss = 6.16e+05, loss_total = 6.16e+05
Step 106 : gram_loss = 6.07e+05, loss_total = 6.07e+05
Step 107 : gram_loss = 5.94e+05, loss_total = 5.94e+05
Step 108 : gram_loss = 5.85e+05, loss_total = 5.85e+05
Step 109 : gram_loss = 5.68e+05, loss_total = 5.68e+05
Step 110 : gram_loss = 5.61e+05, loss_total = 5.61e+05
Step 111 : gram_loss = 5.51e+05, loss_total = 5.51e+05
Step 112 : gram_loss = 5.46e+05, loss_total = 5.46e+05
Step 113 : gram_loss = 5.39e+05, loss_total = 5.39e+05
Step 114 : gram_loss = 5.26e+05, loss_total = 5.26e+05
Step 115 : gram_loss = 5.14e+05, loss_total = 5.14e+05
Step 116 : gram_loss = 5.07e+05, loss_total = 5.07e+05
Step 117 : gram_loss = 4.98e+05, loss_total = 4.98e+05
Step 118 : gram_loss = 4.84e+05, loss_total = 4.84e+05
Step 119 : gram_loss = 4.78e+05, loss_total = 4.78e+05
Step 120 : gram_loss = 4.68e+05, loss_total = 4.68e+05
Step 121 : gram_loss = 4.65e+05, loss_total = 4.65e+05
Step 122 : gram_loss = 4.59e+05, loss_total = 4.59e+05
Step 123 : gram_loss = 4.51e+05, loss_total = 4.51e+05
Step 124 : gram_loss = 4.40e+05, loss_total = 4.40e+05
Step 125 : gram_loss = 4.37e+05, loss_total = 4.37e+05
Step 126 : gram_loss = 4.29e+05, loss_total = 4.29e+05
Step 127 : gram_loss = 4.26e+05, loss_total = 4.26e+05
Step 128 : gram_loss = 4.21e+05, loss_total = 4.21e+05
Step 129 : gram_loss = 4.13e+05, loss_total = 4.13e+05
Step 130 : gram_loss = 4.06e+05, loss_total = 4.06e+05
Step 131 : gram_loss = 4.00e+05, loss_total = 4.00e+05
Step 132 : gram_loss = 3.90e+05, loss_total = 3.90e+05
Step 133 : gram_loss = 3.86e+05, loss_total = 3.86e+05
Step 134 : gram_loss = 3.80e+05, loss_total = 3.80e+05
Step 135 : gram_loss = 3.76e+05, loss_total = 3.76e+05
Step 136 : gram_loss = 3.72e+05, loss_total = 3.72e+05
Step 137 : gram_loss = 3.70e+05, loss_total = 3.70e+05
Step 138 : gram_loss = 3.67e+05, loss_total = 3.67e+05
Step 139 : gram_loss = 3.59e+05, loss_total = 3.59e+05
Step 140 : gram_loss = 3.52e+05, loss_total = 3.52e+05
Step 141 : gram_loss = 3.47e+05, loss_total = 3.47e+05
Step 142 : gram_loss = 3.43e+05, loss_total = 3.43e+05
Step 143 : gram_loss = 3.39e+05, loss_total = 3.39e+05
Step 144 : gram_loss = 3.36e+05, loss_total = 3.36e+05
Step 145 : gram_loss = 3.29e+05, loss_total = 3.29e+05
Step 146 : gram_loss = 3.26e+05, loss_total = 3.26e+05
Step 147 : gram_loss = 3.23e+05, loss_total = 3.23e+05
Step 148 : gram_loss = 3.21e+05, loss_total = 3.21e+05
Step 149 : gram_loss = 3.17e+05, loss_total = 3.17e+05
Step 150 : gram_loss = 3.13e+05, loss_total = 3.13e+05
Step 151 : gram_loss = 3.09e+05, loss_total = 3.09e+05
Step 152 : gram_loss = 3.05e+05, loss_total = 3.05e+05
Step 153 : gram_loss = 3.02e+05, loss_total = 3.02e+05
Step 154 : gram_loss = 2.98e+05, loss_total = 2.98e+05
Step 155 : gram_loss = 2.94e+05, loss_total = 2.94e+05
Step 156 : gram_loss = 2.92e+05, loss_total = 2.92e+05
Step 157 : gram_loss = 2.90e+05, loss_total = 2.90e+05
Step 158 : gram_loss = 2.87e+05, loss_total = 2.87e+05
Step 159 : gram_loss = 2.83e+05, loss_total = 2.83e+05
Step 160 : gram_loss = 2.79e+05, loss_total = 2.79e+05
Step 161 : gram_loss = 2.74e+05, loss_total = 2.74e+05
Step 162 : gram_loss = 2.71e+05, loss_total = 2.71e+05
Step 163 : gram_loss = 2.69e+05, loss_total = 2.69e+05
Step 164 : gram_loss = 2.67e+05, loss_total = 2.67e+05
Step 165 : gram_loss = 2.65e+05, loss_total = 2.65e+05
Step 166 : gram_loss = 2.62e+05, loss_total = 2.62e+05
Step 167 : gram_loss = 2.59e+05, loss_total = 2.59e+05
Step 168 : gram_loss = 2.56e+05, loss_total = 2.56e+05
Step 169 : gram_loss = 2.53e+05, loss_total = 2.53e+05
Step 170 : gram_loss = 2.50e+05, loss_total = 2.50e+05
Step 171 : gram_loss = 2.47e+05, loss_total = 2.47e+05
Step 172 : gram_loss = 2.45e+05, loss_total = 2.45e+05
Step 173 : gram_loss = 2.44e+05, loss_total = 2.44e+05
Step 174 : gram_loss = 2.42e+05, loss_total = 2.42e+05
Step 175 : gram_loss = 2.41e+05, loss_total = 2.41e+05
Step 176 : gram_loss = 2.40e+05, loss_total = 2.40e+05
Step 177 : gram_loss = 2.37e+05, loss_total = 2.37e+05
Step 178 : gram_loss = 2.35e+05, loss_total = 2.35e+05
Step 179 : gram_loss = 2.32e+05, loss_total = 2.32e+05
Step 180 : gram_loss = 2.30e+05, loss_total = 2.30e+05
Step 181 : gram_loss = 2.29e+05, loss_total = 2.29e+05
Step 182 : gram_loss = 2.27e+05, loss_total = 2.27e+05
Step 183 : gram_loss = 2.24e+05, loss_total = 2.24e+05
Step 184 : gram_loss = 2.23e+05, loss_total = 2.23e+05
Step 185 : gram_loss = 2.22e+05, loss_total = 2.22e+05
Step 186 : gram_loss = 2.20e+05, loss_total = 2.20e+05
Step 187 : gram_loss = 2.19e+05, loss_total = 2.19e+05
Step 188 : gram_loss = 2.17e+05, loss_total = 2.17e+05
Step 189 : gram_loss = 2.16e+05, loss_total = 2.16e+05
Step 190 : gram_loss = 2.14e+05, loss_total = 2.14e+05
Step 191 : gram_loss = 2.12e+05, loss_total = 2.12e+05
Step 192 : gram_loss = 2.11e+05, loss_total = 2.11e+05
Step 193 : gram_loss = 2.09e+05, loss_total = 2.09e+05
Step 194 : gram_loss = 2.08e+05, loss_total = 2.08e+05
Step 195 : gram_loss = 2.07e+05, loss_total = 2.07e+05
Step 196 : gram_loss = 2.05e+05, loss_total = 2.05e+05
Step 197 : gram_loss = 2.03e+05, loss_total = 2.03e+05
Step 198 : gram_loss = 2.01e+05, loss_total = 2.01e+05
Step 199 : gram_loss = 1.99e+05, loss_total = 1.99e+05
Step 200 : gram_loss = 1.98e+05, loss_total = 1.98e+05
Close Sess - End of the global optimization.
Computation total for  103.06096029281616  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0028_1_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0028_1_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0028_1_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0028_1_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0028_1_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0028_1_256.jpg_256_256_avg_SAME_n.pkl
Net loaded and Gram computation (if needed) done after  0.46724963188171387  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 2.40e+09, loss_total = 2.40e+09
Step 1 : gram_loss = 2.01e+09, loss_total = 2.01e+09
Step 2 : gram_loss = 1.76e+09, loss_total = 1.76e+09
Step 3 : gram_loss = 1.16e+09, loss_total = 1.16e+09
Step 4 : gram_loss = 4.19e+08, loss_total = 4.19e+08
Step 5 : gram_loss = 2.55e+08, loss_total = 2.55e+08
Step 6 : gram_loss = 1.86e+08, loss_total = 1.86e+08
Step 7 : gram_loss = 1.34e+08, loss_total = 1.34e+08
Step 8 : gram_loss = 1.15e+08, loss_total = 1.15e+08
Step 9 : gram_loss = 8.56e+07, loss_total = 8.56e+07
Step 10 : gram_loss = 6.57e+07, loss_total = 6.57e+07
Step 11 : gram_loss = 4.47e+07, loss_total = 4.47e+07
Step 12 : gram_loss = 2.99e+07, loss_total = 2.99e+07
Step 13 : gram_loss = 2.40e+07, loss_total = 2.40e+07
Step 14 : gram_loss = 2.07e+07, loss_total = 2.07e+07
Step 15 : gram_loss = 1.90e+07, loss_total = 1.90e+07
Step 16 : gram_loss = 1.74e+07, loss_total = 1.74e+07
Step 17 : gram_loss = 1.52e+07, loss_total = 1.52e+07
Step 18 : gram_loss = 1.26e+07, loss_total = 1.26e+07
Step 19 : gram_loss = 1.19e+07, loss_total = 1.19e+07
Step 20 : gram_loss = 1.01e+07, loss_total = 1.01e+07
Step 21 : gram_loss = 9.40e+06, loss_total = 9.40e+06
Step 22 : gram_loss = 8.85e+06, loss_total = 8.85e+06
Step 23 : gram_loss = 8.02e+06, loss_total = 8.02e+06
Step 24 : gram_loss = 7.28e+06, loss_total = 7.28e+06
Step 25 : gram_loss = 6.59e+06, loss_total = 6.59e+06
Step 26 : gram_loss = 5.88e+06, loss_total = 5.88e+06
Step 27 : gram_loss = 5.53e+06, loss_total = 5.53e+06
Step 28 : gram_loss = 5.37e+06, loss_total = 5.37e+06
Step 29 : gram_loss = 5.18e+06, loss_total = 5.18e+06
Step 30 : gram_loss = 4.96e+06, loss_total = 4.96e+06
Step 31 : gram_loss = 4.72e+06, loss_total = 4.72e+06
Step 32 : gram_loss = 4.24e+06, loss_total = 4.24e+06
Step 33 : gram_loss = 3.88e+06, loss_total = 3.88e+06
Step 34 : gram_loss = 3.69e+06, loss_total = 3.69e+06
Step 35 : gram_loss = 3.47e+06, loss_total = 3.47e+06
Step 36 : gram_loss = 3.30e+06, loss_total = 3.30e+06
Step 37 : gram_loss = 3.11e+06, loss_total = 3.11e+06
Step 38 : gram_loss = 2.96e+06, loss_total = 2.96e+06
Step 39 : gram_loss = 2.84e+06, loss_total = 2.84e+06
Step 40 : gram_loss = 2.77e+06, loss_total = 2.77e+06
Step 41 : gram_loss = 2.60e+06, loss_total = 2.60e+06
Step 42 : gram_loss = 2.49e+06, loss_total = 2.49e+06
Step 43 : gram_loss = 2.37e+06, loss_total = 2.37e+06
Step 44 : gram_loss = 2.19e+06, loss_total = 2.19e+06
Step 45 : gram_loss = 2.11e+06, loss_total = 2.11e+06
Step 46 : gram_loss = 2.06e+06, loss_total = 2.06e+06
Step 47 : gram_loss = 2.02e+06, loss_total = 2.02e+06
Step 48 : gram_loss = 1.97e+06, loss_total = 1.97e+06
Step 49 : gram_loss = 1.90e+06, loss_total = 1.90e+06
Step 50 : gram_loss = 1.83e+06, loss_total = 1.83e+06
Step 51 : gram_loss = 1.77e+06, loss_total = 1.77e+06
Step 52 : gram_loss = 1.71e+06, loss_total = 1.71e+06
Step 53 : gram_loss = 1.67e+06, loss_total = 1.67e+06
Step 54 : gram_loss = 1.58e+06, loss_total = 1.58e+06
Step 55 : gram_loss = 1.53e+06, loss_total = 1.53e+06
Step 56 : gram_loss = 1.49e+06, loss_total = 1.49e+06
Step 57 : gram_loss = 1.44e+06, loss_total = 1.44e+06
Step 58 : gram_loss = 1.40e+06, loss_total = 1.40e+06
Step 59 : gram_loss = 1.33e+06, loss_total = 1.33e+06
Step 60 : gram_loss = 1.28e+06, loss_total = 1.28e+06
Step 61 : gram_loss = 1.24e+06, loss_total = 1.24e+06
Step 62 : gram_loss = 1.19e+06, loss_total = 1.19e+06
Step 63 : gram_loss = 1.18e+06, loss_total = 1.18e+06
Step 64 : gram_loss = 1.15e+06, loss_total = 1.15e+06
Step 65 : gram_loss = 1.12e+06, loss_total = 1.12e+06
Step 66 : gram_loss = 1.09e+06, loss_total = 1.09e+06
Step 67 : gram_loss = 1.04e+06, loss_total = 1.04e+06
Step 68 : gram_loss = 1.01e+06, loss_total = 1.01e+06
Step 69 : gram_loss = 9.93e+05, loss_total = 9.93e+05
Step 70 : gram_loss = 9.78e+05, loss_total = 9.78e+05
Step 71 : gram_loss = 9.63e+05, loss_total = 9.63e+05
Step 72 : gram_loss = 9.30e+05, loss_total = 9.30e+05
Step 73 : gram_loss = 9.16e+05, loss_total = 9.16e+05
Step 74 : gram_loss = 8.68e+05, loss_total = 8.68e+05
Step 75 : gram_loss = 8.48e+05, loss_total = 8.48e+05
Step 76 : gram_loss = 8.36e+05, loss_total = 8.36e+05
Step 77 : gram_loss = 8.10e+05, loss_total = 8.10e+05
Step 78 : gram_loss = 7.73e+05, loss_total = 7.73e+05
Step 79 : gram_loss = 7.56e+05, loss_total = 7.56e+05
Step 80 : gram_loss = 7.30e+05, loss_total = 7.30e+05
Step 81 : gram_loss = 7.16e+05, loss_total = 7.16e+05
Step 82 : gram_loss = 7.00e+05, loss_total = 7.00e+05
Step 83 : gram_loss = 6.81e+05, loss_total = 6.81e+05
Step 84 : gram_loss = 6.58e+05, loss_total = 6.58e+05
Step 85 : gram_loss = 6.46e+05, loss_total = 6.46e+05
Step 86 : gram_loss = 6.32e+05, loss_total = 6.32e+05
Step 87 : gram_loss = 6.15e+05, loss_total = 6.15e+05
Step 88 : gram_loss = 5.99e+05, loss_total = 5.99e+05
Step 89 : gram_loss = 5.84e+05, loss_total = 5.84e+05
Step 90 : gram_loss = 5.68e+05, loss_total = 5.68e+05
Step 91 : gram_loss = 5.58e+05, loss_total = 5.58e+05
Step 92 : gram_loss = 5.51e+05, loss_total = 5.51e+05
Step 93 : gram_loss = 5.46e+05, loss_total = 5.46e+05
Step 94 : gram_loss = 5.39e+05, loss_total = 5.39e+05
Step 95 : gram_loss = 5.33e+05, loss_total = 5.33e+05
Step 96 : gram_loss = 5.17e+05, loss_total = 5.17e+05
Step 97 : gram_loss = 5.02e+05, loss_total = 5.02e+05
Step 98 : gram_loss = 4.90e+05, loss_total = 4.90e+05
Step 99 : gram_loss = 4.83e+05, loss_total = 4.83e+05
Step 100 : gram_loss = 4.77e+05, loss_total = 4.77e+05
Step 101 : gram_loss = 4.72e+05, loss_total = 4.72e+05
Step 102 : gram_loss = 4.58e+05, loss_total = 4.58e+05
Step 103 : gram_loss = 4.49e+05, loss_total = 4.49e+05
Step 104 : gram_loss = 4.44e+05, loss_total = 4.44e+05
Step 105 : gram_loss = 4.35e+05, loss_total = 4.35e+05
Step 106 : gram_loss = 4.29e+05, loss_total = 4.29e+05
Step 107 : gram_loss = 4.19e+05, loss_total = 4.19e+05
Step 108 : gram_loss = 4.10e+05, loss_total = 4.10e+05
Step 109 : gram_loss = 4.05e+05, loss_total = 4.05e+05
Step 110 : gram_loss = 3.95e+05, loss_total = 3.95e+05
Step 111 : gram_loss = 3.90e+05, loss_total = 3.90e+05
Step 112 : gram_loss = 3.84e+05, loss_total = 3.84e+05
Step 113 : gram_loss = 3.77e+05, loss_total = 3.77e+05
Step 114 : gram_loss = 3.75e+05, loss_total = 3.75e+05
Step 115 : gram_loss = 3.71e+05, loss_total = 3.71e+05
Step 116 : gram_loss = 3.67e+05, loss_total = 3.67e+05
Step 117 : gram_loss = 3.64e+05, loss_total = 3.64e+05
Step 118 : gram_loss = 3.58e+05, loss_total = 3.58e+05
Step 119 : gram_loss = 3.49e+05, loss_total = 3.49e+05
Step 120 : gram_loss = 3.41e+05, loss_total = 3.41e+05
Step 121 : gram_loss = 3.34e+05, loss_total = 3.34e+05
Step 122 : gram_loss = 3.29e+05, loss_total = 3.29e+05
Step 123 : gram_loss = 3.26e+05, loss_total = 3.26e+05
Step 124 : gram_loss = 3.23e+05, loss_total = 3.23e+05
Step 125 : gram_loss = 3.20e+05, loss_total = 3.20e+05
Step 126 : gram_loss = 3.17e+05, loss_total = 3.17e+05
Step 127 : gram_loss = 3.14e+05, loss_total = 3.14e+05
Step 128 : gram_loss = 3.08e+05, loss_total = 3.08e+05
Step 129 : gram_loss = 3.03e+05, loss_total = 3.03e+05
Step 130 : gram_loss = 3.01e+05, loss_total = 3.01e+05
Step 131 : gram_loss = 2.96e+05, loss_total = 2.96e+05
Step 132 : gram_loss = 2.92e+05, loss_total = 2.92e+05
Step 133 : gram_loss = 2.87e+05, loss_total = 2.87e+05
Step 134 : gram_loss = 2.84e+05, loss_total = 2.84e+05
Step 135 : gram_loss = 2.79e+05, loss_total = 2.79e+05
Step 136 : gram_loss = 2.78e+05, loss_total = 2.78e+05
Step 137 : gram_loss = 2.74e+05, loss_total = 2.74e+05
Step 138 : gram_loss = 2.72e+05, loss_total = 2.72e+05
Step 139 : gram_loss = 2.70e+05, loss_total = 2.70e+05
Step 140 : gram_loss = 2.66e+05, loss_total = 2.66e+05
Step 141 : gram_loss = 2.59e+05, loss_total = 2.59e+05
Step 142 : gram_loss = 2.56e+05, loss_total = 2.56e+05
Step 143 : gram_loss = 2.54e+05, loss_total = 2.54e+05
Step 144 : gram_loss = 2.52e+05, loss_total = 2.52e+05
Step 145 : gram_loss = 2.50e+05, loss_total = 2.50e+05
Step 146 : gram_loss = 2.46e+05, loss_total = 2.46e+05
Step 147 : gram_loss = 2.43e+05, loss_total = 2.43e+05
Step 148 : gram_loss = 2.40e+05, loss_total = 2.40e+05
Step 149 : gram_loss = 2.37e+05, loss_total = 2.37e+05
Step 150 : gram_loss = 2.34e+05, loss_total = 2.34e+05
Step 151 : gram_loss = 2.32e+05, loss_total = 2.32e+05
Step 152 : gram_loss = 2.29e+05, loss_total = 2.29e+05
Step 153 : gram_loss = 2.27e+05, loss_total = 2.27e+05
Step 154 : gram_loss = 2.26e+05, loss_total = 2.26e+05
Step 155 : gram_loss = 2.25e+05, loss_total = 2.25e+05
Step 156 : gram_loss = 2.23e+05, loss_total = 2.23e+05
Step 157 : gram_loss = 2.22e+05, loss_total = 2.22e+05
Step 158 : gram_loss = 2.19e+05, loss_total = 2.19e+05
Step 159 : gram_loss = 2.18e+05, loss_total = 2.18e+05
Step 160 : gram_loss = 2.16e+05, loss_total = 2.16e+05
Step 161 : gram_loss = 2.14e+05, loss_total = 2.14e+05
Step 162 : gram_loss = 2.12e+05, loss_total = 2.12e+05
Step 163 : gram_loss = 2.10e+05, loss_total = 2.10e+05
Step 164 : gram_loss = 2.07e+05, loss_total = 2.07e+05
Step 165 : gram_loss = 2.05e+05, loss_total = 2.05e+05
Step 166 : gram_loss = 2.04e+05, loss_total = 2.04e+05
Step 167 : gram_loss = 2.01e+05, loss_total = 2.01e+05
Step 168 : gram_loss = 2.00e+05, loss_total = 2.00e+05
Step 169 : gram_loss = 1.98e+05, loss_total = 1.98e+05
Step 170 : gram_loss = 1.97e+05, loss_total = 1.97e+05
Step 171 : gram_loss = 1.96e+05, loss_total = 1.96e+05
Step 172 : gram_loss = 1.94e+05, loss_total = 1.94e+05
Step 173 : gram_loss = 1.91e+05, loss_total = 1.91e+05
Step 174 : gram_loss = 1.89e+05, loss_total = 1.89e+05
Step 175 : gram_loss = 1.87e+05, loss_total = 1.87e+05
Step 176 : gram_loss = 1.86e+05, loss_total = 1.86e+05
Step 177 : gram_loss = 1.85e+05, loss_total = 1.85e+05
Step 178 : gram_loss = 1.83e+05, loss_total = 1.83e+05
Step 179 : gram_loss = 1.81e+05, loss_total = 1.81e+05
Step 180 : gram_loss = 1.81e+05, loss_total = 1.81e+05
Step 181 : gram_loss = 1.80e+05, loss_total = 1.80e+05
Step 182 : gram_loss = 1.79e+05, loss_total = 1.79e+05
Step 183 : gram_loss = 1.78e+05, loss_total = 1.78e+05
Step 184 : gram_loss = 1.77e+05, loss_total = 1.77e+05
Step 185 : gram_loss = 1.75e+05, loss_total = 1.75e+05
Step 186 : gram_loss = 1.74e+05, loss_total = 1.74e+05
Step 187 : gram_loss = 1.72e+05, loss_total = 1.72e+05
Step 188 : gram_loss = 1.71e+05, loss_total = 1.71e+05
Step 189 : gram_loss = 1.70e+05, loss_total = 1.70e+05
Step 190 : gram_loss = 1.69e+05, loss_total = 1.69e+05
Step 191 : gram_loss = 1.68e+05, loss_total = 1.68e+05
Step 192 : gram_loss = 1.66e+05, loss_total = 1.66e+05
Step 193 : gram_loss = 1.65e+05, loss_total = 1.65e+05
Step 194 : gram_loss = 1.64e+05, loss_total = 1.64e+05
Step 195 : gram_loss = 1.63e+05, loss_total = 1.63e+05
Step 196 : gram_loss = 1.62e+05, loss_total = 1.62e+05
Step 197 : gram_loss = 1.60e+05, loss_total = 1.60e+05
Step 198 : gram_loss = 1.59e+05, loss_total = 1.59e+05
Step 199 : gram_loss = 1.58e+05, loss_total = 1.58e+05
Step 200 : gram_loss = 1.57e+05, loss_total = 1.57e+05
Close Sess - End of the global optimization.
Computation total for  102.96479558944702  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0023_1_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0023_1_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0023_1_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0023_1_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0023_1_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0023_1_256.jpg_256_256_avg_SAME_n.pkl
Net loaded and Gram computation (if needed) done after  0.4624807834625244  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 3.70e+09, loss_total = 3.70e+09
Step 1 : gram_loss = 3.23e+09, loss_total = 3.23e+09
Step 2 : gram_loss = 2.84e+09, loss_total = 2.84e+09
Step 3 : gram_loss = 1.92e+09, loss_total = 1.92e+09
Step 4 : gram_loss = 6.96e+08, loss_total = 6.96e+08
Step 5 : gram_loss = 2.94e+08, loss_total = 2.94e+08
Step 6 : gram_loss = 2.40e+08, loss_total = 2.40e+08
Step 7 : gram_loss = 1.43e+08, loss_total = 1.43e+08
Step 8 : gram_loss = 1.02e+08, loss_total = 1.02e+08
Step 9 : gram_loss = 7.53e+07, loss_total = 7.53e+07
Step 10 : gram_loss = 6.48e+07, loss_total = 6.48e+07
Step 11 : gram_loss = 4.84e+07, loss_total = 4.84e+07
Step 12 : gram_loss = 3.43e+07, loss_total = 3.43e+07
Step 13 : gram_loss = 2.74e+07, loss_total = 2.74e+07
Step 14 : gram_loss = 2.38e+07, loss_total = 2.38e+07
Step 15 : gram_loss = 2.00e+07, loss_total = 2.00e+07
Step 16 : gram_loss = 1.82e+07, loss_total = 1.82e+07
Step 17 : gram_loss = 1.55e+07, loss_total = 1.55e+07
Step 18 : gram_loss = 1.33e+07, loss_total = 1.33e+07
Step 19 : gram_loss = 1.11e+07, loss_total = 1.11e+07
Step 20 : gram_loss = 1.04e+07, loss_total = 1.04e+07
Step 21 : gram_loss = 9.55e+06, loss_total = 9.55e+06
Step 22 : gram_loss = 8.86e+06, loss_total = 8.86e+06
Step 23 : gram_loss = 8.08e+06, loss_total = 8.08e+06
Step 24 : gram_loss = 7.78e+06, loss_total = 7.78e+06
Step 25 : gram_loss = 7.39e+06, loss_total = 7.39e+06
Step 26 : gram_loss = 7.04e+06, loss_total = 7.04e+06
Step 27 : gram_loss = 6.96e+06, loss_total = 6.96e+06
Step 28 : gram_loss = 6.28e+06, loss_total = 6.28e+06
Step 29 : gram_loss = 6.12e+06, loss_total = 6.12e+06
Step 30 : gram_loss = 5.90e+06, loss_total = 5.90e+06
Step 31 : gram_loss = 5.58e+06, loss_total = 5.58e+06
Step 32 : gram_loss = 5.14e+06, loss_total = 5.14e+06
Step 33 : gram_loss = 4.74e+06, loss_total = 4.74e+06
Step 34 : gram_loss = 4.28e+06, loss_total = 4.28e+06
Step 35 : gram_loss = 4.04e+06, loss_total = 4.04e+06
Step 36 : gram_loss = 3.80e+06, loss_total = 3.80e+06
Step 37 : gram_loss = 3.67e+06, loss_total = 3.67e+06
Step 38 : gram_loss = 3.57e+06, loss_total = 3.57e+06
Step 39 : gram_loss = 3.28e+06, loss_total = 3.28e+06
Step 40 : gram_loss = 3.11e+06, loss_total = 3.11e+06
Step 41 : gram_loss = 2.92e+06, loss_total = 2.92e+06
Step 42 : gram_loss = 2.69e+06, loss_total = 2.69e+06
Step 43 : gram_loss = 2.50e+06, loss_total = 2.50e+06
Step 44 : gram_loss = 2.41e+06, loss_total = 2.41e+06
Step 45 : gram_loss = 2.30e+06, loss_total = 2.30e+06
Step 46 : gram_loss = 2.25e+06, loss_total = 2.25e+06
Step 47 : gram_loss = 2.18e+06, loss_total = 2.18e+06
Step 48 : gram_loss = 2.09e+06, loss_total = 2.09e+06
Step 49 : gram_loss = 2.04e+06, loss_total = 2.04e+06
Step 50 : gram_loss = 1.99e+06, loss_total = 1.99e+06
Step 51 : gram_loss = 1.93e+06, loss_total = 1.93e+06
Step 52 : gram_loss = 1.89e+06, loss_total = 1.89e+06
Step 53 : gram_loss = 1.80e+06, loss_total = 1.80e+06
Step 54 : gram_loss = 1.71e+06, loss_total = 1.71e+06
Step 55 : gram_loss = 1.65e+06, loss_total = 1.65e+06
Step 56 : gram_loss = 1.60e+06, loss_total = 1.60e+06
Step 57 : gram_loss = 1.56e+06, loss_total = 1.56e+06
Step 58 : gram_loss = 1.51e+06, loss_total = 1.51e+06
Step 59 : gram_loss = 1.43e+06, loss_total = 1.43e+06
Step 60 : gram_loss = 1.36e+06, loss_total = 1.36e+06
Step 61 : gram_loss = 1.30e+06, loss_total = 1.30e+06
Step 62 : gram_loss = 1.23e+06, loss_total = 1.23e+06
Step 63 : gram_loss = 1.21e+06, loss_total = 1.21e+06
Step 64 : gram_loss = 1.16e+06, loss_total = 1.16e+06
Step 65 : gram_loss = 1.15e+06, loss_total = 1.15e+06
Step 66 : gram_loss = 1.11e+06, loss_total = 1.11e+06
Step 67 : gram_loss = 1.08e+06, loss_total = 1.08e+06
Step 68 : gram_loss = 1.01e+06, loss_total = 1.01e+06
Step 69 : gram_loss = 9.92e+05, loss_total = 9.92e+05
Step 70 : gram_loss = 9.56e+05, loss_total = 9.56e+05
Step 71 : gram_loss = 9.43e+05, loss_total = 9.43e+05
Step 72 : gram_loss = 9.19e+05, loss_total = 9.19e+05
Step 73 : gram_loss = 9.12e+05, loss_total = 9.12e+05
Step 74 : gram_loss = 8.76e+05, loss_total = 8.76e+05
Step 75 : gram_loss = 8.67e+05, loss_total = 8.67e+05
Step 76 : gram_loss = 8.54e+05, loss_total = 8.54e+05
Step 77 : gram_loss = 8.32e+05, loss_total = 8.32e+05
Step 78 : gram_loss = 7.98e+05, loss_total = 7.98e+05
Step 79 : gram_loss = 7.86e+05, loss_total = 7.86e+05
Step 80 : gram_loss = 7.68e+05, loss_total = 7.68e+05
Step 81 : gram_loss = 7.52e+05, loss_total = 7.52e+05
Step 82 : gram_loss = 7.41e+05, loss_total = 7.41e+05
Step 83 : gram_loss = 7.16e+05, loss_total = 7.16e+05
Step 84 : gram_loss = 6.90e+05, loss_total = 6.90e+05
Step 85 : gram_loss = 6.77e+05, loss_total = 6.77e+05
Step 86 : gram_loss = 6.56e+05, loss_total = 6.56e+05
Step 87 : gram_loss = 6.47e+05, loss_total = 6.47e+05
Step 88 : gram_loss = 6.32e+05, loss_total = 6.32e+05
Step 89 : gram_loss = 6.09e+05, loss_total = 6.09e+05
Step 90 : gram_loss = 5.93e+05, loss_total = 5.93e+05
Step 91 : gram_loss = 5.84e+05, loss_total = 5.84e+05
Step 92 : gram_loss = 5.66e+05, loss_total = 5.66e+05
Step 93 : gram_loss = 5.57e+05, loss_total = 5.57e+05
Step 94 : gram_loss = 5.42e+05, loss_total = 5.42e+05
Step 95 : gram_loss = 5.36e+05, loss_total = 5.36e+05
Step 96 : gram_loss = 5.29e+05, loss_total = 5.29e+05
Step 97 : gram_loss = 5.25e+05, loss_total = 5.25e+05
Step 98 : gram_loss = 5.17e+05, loss_total = 5.17e+05
Step 99 : gram_loss = 5.09e+05, loss_total = 5.09e+05
Step 100 : gram_loss = 4.99e+05, loss_total = 4.99e+05
Step 101 : gram_loss = 4.90e+05, loss_total = 4.90e+05
Step 102 : gram_loss = 4.84e+05, loss_total = 4.84e+05
Step 103 : gram_loss = 4.75e+05, loss_total = 4.75e+05
Step 104 : gram_loss = 4.66e+05, loss_total = 4.66e+05
Step 105 : gram_loss = 4.51e+05, loss_total = 4.51e+05
Step 106 : gram_loss = 4.47e+05, loss_total = 4.47e+05
Step 107 : gram_loss = 4.34e+05, loss_total = 4.34e+05
Step 108 : gram_loss = 4.29e+05, loss_total = 4.29e+05
Step 109 : gram_loss = 4.24e+05, loss_total = 4.24e+05
Step 110 : gram_loss = 4.18e+05, loss_total = 4.18e+05
Step 111 : gram_loss = 4.07e+05, loss_total = 4.07e+05
Step 112 : gram_loss = 4.00e+05, loss_total = 4.00e+05
Step 113 : gram_loss = 3.93e+05, loss_total = 3.93e+05
Step 114 : gram_loss = 3.85e+05, loss_total = 3.85e+05
Step 115 : gram_loss = 3.77e+05, loss_total = 3.77e+05
Step 116 : gram_loss = 3.70e+05, loss_total = 3.70e+05
Step 117 : gram_loss = 3.65e+05, loss_total = 3.65e+05
Step 118 : gram_loss = 3.61e+05, loss_total = 3.61e+05
Step 119 : gram_loss = 3.59e+05, loss_total = 3.59e+05
Step 120 : gram_loss = 3.55e+05, loss_total = 3.55e+05
Step 121 : gram_loss = 3.52e+05, loss_total = 3.52e+05
Step 122 : gram_loss = 3.49e+05, loss_total = 3.49e+05
Step 123 : gram_loss = 3.47e+05, loss_total = 3.47e+05
Step 124 : gram_loss = 3.46e+05, loss_total = 3.46e+05
Step 125 : gram_loss = 3.44e+05, loss_total = 3.44e+05
Step 126 : gram_loss = 3.40e+05, loss_total = 3.40e+05
Step 127 : gram_loss = 3.32e+05, loss_total = 3.32e+05
Step 128 : gram_loss = 3.26e+05, loss_total = 3.26e+05
Step 129 : gram_loss = 3.20e+05, loss_total = 3.20e+05
Step 130 : gram_loss = 3.16e+05, loss_total = 3.16e+05
Step 131 : gram_loss = 3.12e+05, loss_total = 3.12e+05
Step 132 : gram_loss = 3.09e+05, loss_total = 3.09e+05
Step 133 : gram_loss = 3.07e+05, loss_total = 3.07e+05
Step 134 : gram_loss = 3.04e+05, loss_total = 3.04e+05
Step 135 : gram_loss = 3.01e+05, loss_total = 3.01e+05
Step 136 : gram_loss = 2.93e+05, loss_total = 2.93e+05
Step 137 : gram_loss = 2.89e+05, loss_total = 2.89e+05
Step 138 : gram_loss = 2.86e+05, loss_total = 2.86e+05
Step 139 : gram_loss = 2.82e+05, loss_total = 2.82e+05
Step 140 : gram_loss = 2.79e+05, loss_total = 2.79e+05
Step 141 : gram_loss = 2.74e+05, loss_total = 2.74e+05
Step 142 : gram_loss = 2.71e+05, loss_total = 2.71e+05
Step 143 : gram_loss = 2.70e+05, loss_total = 2.70e+05
Step 144 : gram_loss = 2.69e+05, loss_total = 2.69e+05
Step 145 : gram_loss = 2.67e+05, loss_total = 2.67e+05
Step 146 : gram_loss = 2.65e+05, loss_total = 2.65e+05
Step 147 : gram_loss = 2.62e+05, loss_total = 2.62e+05
Step 148 : gram_loss = 2.58e+05, loss_total = 2.58e+05
Step 149 : gram_loss = 2.55e+05, loss_total = 2.55e+05
Step 150 : gram_loss = 2.52e+05, loss_total = 2.52e+05
Step 151 : gram_loss = 2.50e+05, loss_total = 2.50e+05
Step 152 : gram_loss = 2.47e+05, loss_total = 2.47e+05
Step 153 : gram_loss = 2.45e+05, loss_total = 2.45e+05
Step 154 : gram_loss = 2.43e+05, loss_total = 2.43e+05
Step 155 : gram_loss = 2.41e+05, loss_total = 2.41e+05
Step 156 : gram_loss = 2.39e+05, loss_total = 2.39e+05
Step 157 : gram_loss = 2.36e+05, loss_total = 2.36e+05
Step 158 : gram_loss = 2.33e+05, loss_total = 2.33e+05
Step 159 : gram_loss = 2.29e+05, loss_total = 2.29e+05
Step 160 : gram_loss = 2.28e+05, loss_total = 2.28e+05
Step 161 : gram_loss = 2.27e+05, loss_total = 2.27e+05
Step 162 : gram_loss = 2.26e+05, loss_total = 2.26e+05
Step 163 : gram_loss = 2.25e+05, loss_total = 2.25e+05
Step 164 : gram_loss = 2.23e+05, loss_total = 2.23e+05
Step 165 : gram_loss = 2.22e+05, loss_total = 2.22e+05
Step 166 : gram_loss = 2.20e+05, loss_total = 2.20e+05
Step 167 : gram_loss = 2.18e+05, loss_total = 2.18e+05
Step 168 : gram_loss = 2.16e+05, loss_total = 2.16e+05
Step 169 : gram_loss = 2.15e+05, loss_total = 2.15e+05
Step 170 : gram_loss = 2.13e+05, loss_total = 2.13e+05
Step 171 : gram_loss = 2.12e+05, loss_total = 2.12e+05
Step 172 : gram_loss = 2.11e+05, loss_total = 2.11e+05
Step 173 : gram_loss = 2.09e+05, loss_total = 2.09e+05
Step 174 : gram_loss = 2.07e+05, loss_total = 2.07e+05
Step 175 : gram_loss = 2.05e+05, loss_total = 2.05e+05
Step 176 : gram_loss = 2.03e+05, loss_total = 2.03e+05
Step 177 : gram_loss = 2.01e+05, loss_total = 2.01e+05
Step 178 : gram_loss = 2.00e+05, loss_total = 2.00e+05
Step 179 : gram_loss = 1.99e+05, loss_total = 1.99e+05
Step 180 : gram_loss = 1.98e+05, loss_total = 1.98e+05
Step 181 : gram_loss = 1.97e+05, loss_total = 1.97e+05
Step 182 : gram_loss = 1.95e+05, loss_total = 1.95e+05
Step 183 : gram_loss = 1.94e+05, loss_total = 1.94e+05
Step 184 : gram_loss = 1.92e+05, loss_total = 1.92e+05
Step 185 : gram_loss = 1.90e+05, loss_total = 1.90e+05
Step 186 : gram_loss = 1.89e+05, loss_total = 1.89e+05
Step 187 : gram_loss = 1.88e+05, loss_total = 1.88e+05
Step 188 : gram_loss = 1.88e+05, loss_total = 1.88e+05
Step 189 : gram_loss = 1.86e+05, loss_total = 1.86e+05
Step 190 : gram_loss = 1.86e+05, loss_total = 1.86e+05
Step 191 : gram_loss = 1.85e+05, loss_total = 1.85e+05
Step 192 : gram_loss = 1.84e+05, loss_total = 1.84e+05
Step 193 : gram_loss = 1.83e+05, loss_total = 1.83e+05
Step 194 : gram_loss = 1.81e+05, loss_total = 1.81e+05
Step 195 : gram_loss = 1.80e+05, loss_total = 1.80e+05
Step 196 : gram_loss = 1.80e+05, loss_total = 1.80e+05
Step 197 : gram_loss = 1.78e+05, loss_total = 1.78e+05
Step 198 : gram_loss = 1.77e+05, loss_total = 1.77e+05
Step 199 : gram_loss = 1.76e+05, loss_total = 1.76e+05
Step 200 : gram_loss = 1.76e+05, loss_total = 1.76e+05
Close Sess - End of the global optimization.
Computation total for  103.55793952941895  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0007_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0007_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0007_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0007_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0007_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0007_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.5714428424835205  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 2.65e+09, loss_total = 2.65e+09
Step 1 : gram_loss = 1.81e+09, loss_total = 1.81e+09
Step 2 : gram_loss = 1.44e+09, loss_total = 1.44e+09
Step 3 : gram_loss = 1.09e+09, loss_total = 1.09e+09
Step 4 : gram_loss = 7.32e+08, loss_total = 7.32e+08
Step 5 : gram_loss = 5.24e+08, loss_total = 5.24e+08
Step 6 : gram_loss = 3.53e+08, loss_total = 3.53e+08
Step 7 : gram_loss = 2.78e+08, loss_total = 2.78e+08
Step 8 : gram_loss = 2.23e+08, loss_total = 2.23e+08
Step 9 : gram_loss = 2.00e+08, loss_total = 2.00e+08
Step 10 : gram_loss = 1.59e+08, loss_total = 1.59e+08
Step 11 : gram_loss = 1.24e+08, loss_total = 1.24e+08
Step 12 : gram_loss = 9.51e+07, loss_total = 9.51e+07
Step 13 : gram_loss = 8.01e+07, loss_total = 8.01e+07
Step 14 : gram_loss = 7.20e+07, loss_total = 7.20e+07
Step 15 : gram_loss = 6.18e+07, loss_total = 6.18e+07
Step 16 : gram_loss = 5.52e+07, loss_total = 5.52e+07
Step 17 : gram_loss = 4.38e+07, loss_total = 4.38e+07
Step 18 : gram_loss = 3.65e+07, loss_total = 3.65e+07
Step 19 : gram_loss = 3.14e+07, loss_total = 3.14e+07
Step 20 : gram_loss = 2.74e+07, loss_total = 2.74e+07
Step 21 : gram_loss = 2.50e+07, loss_total = 2.50e+07
Step 22 : gram_loss = 2.34e+07, loss_total = 2.34e+07
Step 23 : gram_loss = 2.01e+07, loss_total = 2.01e+07
Step 24 : gram_loss = 1.87e+07, loss_total = 1.87e+07
Step 25 : gram_loss = 1.67e+07, loss_total = 1.67e+07
Step 26 : gram_loss = 1.62e+07, loss_total = 1.62e+07
Step 27 : gram_loss = 1.54e+07, loss_total = 1.54e+07
Step 28 : gram_loss = 1.48e+07, loss_total = 1.48e+07
Step 29 : gram_loss = 1.41e+07, loss_total = 1.41e+07
Step 30 : gram_loss = 1.31e+07, loss_total = 1.31e+07
Step 31 : gram_loss = 1.24e+07, loss_total = 1.24e+07
Step 32 : gram_loss = 1.17e+07, loss_total = 1.17e+07
Step 33 : gram_loss = 1.13e+07, loss_total = 1.13e+07
Step 34 : gram_loss = 1.10e+07, loss_total = 1.10e+07
Step 35 : gram_loss = 1.04e+07, loss_total = 1.04e+07
Step 36 : gram_loss = 9.96e+06, loss_total = 9.96e+06
Step 37 : gram_loss = 9.48e+06, loss_total = 9.48e+06
Step 38 : gram_loss = 8.96e+06, loss_total = 8.96e+06
Step 39 : gram_loss = 8.55e+06, loss_total = 8.55e+06
Step 40 : gram_loss = 8.30e+06, loss_total = 8.30e+06
Step 41 : gram_loss = 8.01e+06, loss_total = 8.01e+06
Step 42 : gram_loss = 7.80e+06, loss_total = 7.80e+06
Step 43 : gram_loss = 7.64e+06, loss_total = 7.64e+06
Step 44 : gram_loss = 7.37e+06, loss_total = 7.37e+06
Step 45 : gram_loss = 6.94e+06, loss_total = 6.94e+06
Step 46 : gram_loss = 6.73e+06, loss_total = 6.73e+06
Step 47 : gram_loss = 6.49e+06, loss_total = 6.49e+06
Step 48 : gram_loss = 6.31e+06, loss_total = 6.31e+06
Step 49 : gram_loss = 6.20e+06, loss_total = 6.20e+06
Step 50 : gram_loss = 6.09e+06, loss_total = 6.09e+06
Step 51 : gram_loss = 5.91e+06, loss_total = 5.91e+06
Step 52 : gram_loss = 5.63e+06, loss_total = 5.63e+06
Step 53 : gram_loss = 5.49e+06, loss_total = 5.49e+06
Step 54 : gram_loss = 5.35e+06, loss_total = 5.35e+06
Step 55 : gram_loss = 5.32e+06, loss_total = 5.32e+06
Step 56 : gram_loss = 5.20e+06, loss_total = 5.20e+06
Step 57 : gram_loss = 5.07e+06, loss_total = 5.07e+06
Step 58 : gram_loss = 4.91e+06, loss_total = 4.91e+06
Step 59 : gram_loss = 4.73e+06, loss_total = 4.73e+06
Step 60 : gram_loss = 4.67e+06, loss_total = 4.67e+06
Step 61 : gram_loss = 4.58e+06, loss_total = 4.58e+06
Step 62 : gram_loss = 4.48e+06, loss_total = 4.48e+06
Step 63 : gram_loss = 4.40e+06, loss_total = 4.40e+06
Step 64 : gram_loss = 4.27e+06, loss_total = 4.27e+06
Step 65 : gram_loss = 4.15e+06, loss_total = 4.15e+06
Step 66 : gram_loss = 4.06e+06, loss_total = 4.06e+06
Step 67 : gram_loss = 3.98e+06, loss_total = 3.98e+06
Step 68 : gram_loss = 3.91e+06, loss_total = 3.91e+06
Step 69 : gram_loss = 3.76e+06, loss_total = 3.76e+06
Step 70 : gram_loss = 3.64e+06, loss_total = 3.64e+06
Step 71 : gram_loss = 3.57e+06, loss_total = 3.57e+06
Step 72 : gram_loss = 3.50e+06, loss_total = 3.50e+06
Step 73 : gram_loss = 3.46e+06, loss_total = 3.46e+06
Step 74 : gram_loss = 3.34e+06, loss_total = 3.34e+06
Step 75 : gram_loss = 3.27e+06, loss_total = 3.27e+06
Step 76 : gram_loss = 3.18e+06, loss_total = 3.18e+06
Step 77 : gram_loss = 3.15e+06, loss_total = 3.15e+06
Step 78 : gram_loss = 3.10e+06, loss_total = 3.10e+06
Step 79 : gram_loss = 3.03e+06, loss_total = 3.03e+06
Step 80 : gram_loss = 2.92e+06, loss_total = 2.92e+06
Step 81 : gram_loss = 2.83e+06, loss_total = 2.83e+06
Step 82 : gram_loss = 2.77e+06, loss_total = 2.77e+06
Step 83 : gram_loss = 2.72e+06, loss_total = 2.72e+06
Step 84 : gram_loss = 2.66e+06, loss_total = 2.66e+06
Step 85 : gram_loss = 2.61e+06, loss_total = 2.61e+06
Step 86 : gram_loss = 2.57e+06, loss_total = 2.57e+06
Step 87 : gram_loss = 2.53e+06, loss_total = 2.53e+06
Step 88 : gram_loss = 2.47e+06, loss_total = 2.47e+06
Step 89 : gram_loss = 2.43e+06, loss_total = 2.43e+06
Step 90 : gram_loss = 2.40e+06, loss_total = 2.40e+06
Step 91 : gram_loss = 2.36e+06, loss_total = 2.36e+06
Step 92 : gram_loss = 2.30e+06, loss_total = 2.30e+06
Step 93 : gram_loss = 2.24e+06, loss_total = 2.24e+06
Step 94 : gram_loss = 2.20e+06, loss_total = 2.20e+06
Step 95 : gram_loss = 2.17e+06, loss_total = 2.17e+06
Step 96 : gram_loss = 2.11e+06, loss_total = 2.11e+06
Step 97 : gram_loss = 2.09e+06, loss_total = 2.09e+06
Step 98 : gram_loss = 2.06e+06, loss_total = 2.06e+06
Step 99 : gram_loss = 2.00e+06, loss_total = 2.00e+06
Step 100 : gram_loss = 1.94e+06, loss_total = 1.94e+06
Step 101 : gram_loss = 1.89e+06, loss_total = 1.89e+06
Step 102 : gram_loss = 1.86e+06, loss_total = 1.86e+06
Step 103 : gram_loss = 1.82e+06, loss_total = 1.82e+06
Step 104 : gram_loss = 1.80e+06, loss_total = 1.80e+06
Step 105 : gram_loss = 1.78e+06, loss_total = 1.78e+06
Step 106 : gram_loss = 1.73e+06, loss_total = 1.73e+06
Step 107 : gram_loss = 1.71e+06, loss_total = 1.71e+06
Step 108 : gram_loss = 1.69e+06, loss_total = 1.69e+06
Step 109 : gram_loss = 1.67e+06, loss_total = 1.67e+06
Step 110 : gram_loss = 1.66e+06, loss_total = 1.66e+06
Step 111 : gram_loss = 1.63e+06, loss_total = 1.63e+06
Step 112 : gram_loss = 1.61e+06, loss_total = 1.61e+06
Step 113 : gram_loss = 1.58e+06, loss_total = 1.58e+06
Step 114 : gram_loss = 1.54e+06, loss_total = 1.54e+06
Step 115 : gram_loss = 1.52e+06, loss_total = 1.52e+06
Step 116 : gram_loss = 1.49e+06, loss_total = 1.49e+06
Step 117 : gram_loss = 1.46e+06, loss_total = 1.46e+06
Step 118 : gram_loss = 1.44e+06, loss_total = 1.44e+06
Step 119 : gram_loss = 1.41e+06, loss_total = 1.41e+06
Step 120 : gram_loss = 1.39e+06, loss_total = 1.39e+06
Step 121 : gram_loss = 1.37e+06, loss_total = 1.37e+06
Step 122 : gram_loss = 1.35e+06, loss_total = 1.35e+06
Step 123 : gram_loss = 1.33e+06, loss_total = 1.33e+06
Step 124 : gram_loss = 1.31e+06, loss_total = 1.31e+06
Step 125 : gram_loss = 1.29e+06, loss_total = 1.29e+06
Step 126 : gram_loss = 1.28e+06, loss_total = 1.28e+06
Step 127 : gram_loss = 1.26e+06, loss_total = 1.26e+06
Step 128 : gram_loss = 1.25e+06, loss_total = 1.25e+06
Step 129 : gram_loss = 1.23e+06, loss_total = 1.23e+06
Step 130 : gram_loss = 1.22e+06, loss_total = 1.22e+06
Step 131 : gram_loss = 1.20e+06, loss_total = 1.20e+06
Step 132 : gram_loss = 1.20e+06, loss_total = 1.20e+06
Step 133 : gram_loss = 1.19e+06, loss_total = 1.19e+06
Step 134 : gram_loss = 1.18e+06, loss_total = 1.18e+06
Step 135 : gram_loss = 1.17e+06, loss_total = 1.17e+06
Step 136 : gram_loss = 1.15e+06, loss_total = 1.15e+06
Step 137 : gram_loss = 1.13e+06, loss_total = 1.13e+06
Step 138 : gram_loss = 1.12e+06, loss_total = 1.12e+06
Step 139 : gram_loss = 1.11e+06, loss_total = 1.11e+06
Step 140 : gram_loss = 1.09e+06, loss_total = 1.09e+06
Step 141 : gram_loss = 1.08e+06, loss_total = 1.08e+06
Step 142 : gram_loss = 1.07e+06, loss_total = 1.07e+06
Step 143 : gram_loss = 1.05e+06, loss_total = 1.05e+06
Step 144 : gram_loss = 1.04e+06, loss_total = 1.04e+06
Step 145 : gram_loss = 1.03e+06, loss_total = 1.03e+06
Step 146 : gram_loss = 1.03e+06, loss_total = 1.03e+06
Step 147 : gram_loss = 1.02e+06, loss_total = 1.02e+06
Step 148 : gram_loss = 1.01e+06, loss_total = 1.01e+06
Step 149 : gram_loss = 9.95e+05, loss_total = 9.95e+05
Step 150 : gram_loss = 9.84e+05, loss_total = 9.84e+05
Step 151 : gram_loss = 9.77e+05, loss_total = 9.77e+05
Step 152 : gram_loss = 9.68e+05, loss_total = 9.68e+05
Step 153 : gram_loss = 9.56e+05, loss_total = 9.56e+05
Step 154 : gram_loss = 9.46e+05, loss_total = 9.46e+05
Step 155 : gram_loss = 9.41e+05, loss_total = 9.41e+05
Step 156 : gram_loss = 9.34e+05, loss_total = 9.34e+05
Step 157 : gram_loss = 9.26e+05, loss_total = 9.26e+05
Step 158 : gram_loss = 9.19e+05, loss_total = 9.19e+05
Step 159 : gram_loss = 9.15e+05, loss_total = 9.15e+05
Step 160 : gram_loss = 9.09e+05, loss_total = 9.09e+05
Step 161 : gram_loss = 9.00e+05, loss_total = 9.00e+05
Step 162 : gram_loss = 8.92e+05, loss_total = 8.92e+05
Step 163 : gram_loss = 8.83e+05, loss_total = 8.83e+05
Step 164 : gram_loss = 8.76e+05, loss_total = 8.76e+05
Step 165 : gram_loss = 8.71e+05, loss_total = 8.71e+05
Step 166 : gram_loss = 8.65e+05, loss_total = 8.65e+05
Step 167 : gram_loss = 8.61e+05, loss_total = 8.61e+05
Step 168 : gram_loss = 8.54e+05, loss_total = 8.54e+05
Step 169 : gram_loss = 8.47e+05, loss_total = 8.47e+05
Step 170 : gram_loss = 8.43e+05, loss_total = 8.43e+05
Step 171 : gram_loss = 8.38e+05, loss_total = 8.38e+05
Step 172 : gram_loss = 8.29e+05, loss_total = 8.29e+05
Step 173 : gram_loss = 8.20e+05, loss_total = 8.20e+05
Step 174 : gram_loss = 8.15e+05, loss_total = 8.15e+05
Step 175 : gram_loss = 8.11e+05, loss_total = 8.11e+05
Step 176 : gram_loss = 8.07e+05, loss_total = 8.07e+05
Step 177 : gram_loss = 8.03e+05, loss_total = 8.03e+05
Step 178 : gram_loss = 7.95e+05, loss_total = 7.95e+05
Step 179 : gram_loss = 7.90e+05, loss_total = 7.90e+05
Step 180 : gram_loss = 7.86e+05, loss_total = 7.86e+05
Step 181 : gram_loss = 7.84e+05, loss_total = 7.84e+05
Step 182 : gram_loss = 7.82e+05, loss_total = 7.82e+05
Step 183 : gram_loss = 7.80e+05, loss_total = 7.80e+05
Step 184 : gram_loss = 7.75e+05, loss_total = 7.75e+05
Step 185 : gram_loss = 7.68e+05, loss_total = 7.68e+05
Step 186 : gram_loss = 7.62e+05, loss_total = 7.62e+05
Step 187 : gram_loss = 7.59e+05, loss_total = 7.59e+05
Step 188 : gram_loss = 7.56e+05, loss_total = 7.56e+05
Step 189 : gram_loss = 7.52e+05, loss_total = 7.52e+05
Step 190 : gram_loss = 7.48e+05, loss_total = 7.48e+05
Step 191 : gram_loss = 7.41e+05, loss_total = 7.41e+05
Step 192 : gram_loss = 7.36e+05, loss_total = 7.36e+05
Step 193 : gram_loss = 7.31e+05, loss_total = 7.31e+05
Step 194 : gram_loss = 7.27e+05, loss_total = 7.27e+05
Step 195 : gram_loss = 7.23e+05, loss_total = 7.23e+05
Step 196 : gram_loss = 7.19e+05, loss_total = 7.19e+05
Step 197 : gram_loss = 7.16e+05, loss_total = 7.16e+05
Step 198 : gram_loss = 7.12e+05, loss_total = 7.12e+05
Step 199 : gram_loss = 7.09e+05, loss_total = 7.09e+05
Step 200 : gram_loss = 7.06e+05, loss_total = 7.06e+05
Close Sess - End of the global optimization.
Computation total for  110.46114134788513  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0022_1_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0022_1_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0022_1_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0022_1_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0022_1_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0022_1_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.2303407192230225  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 3.72e+09, loss_total = 3.72e+09
Step 1 : gram_loss = 2.89e+09, loss_total = 2.89e+09
Step 2 : gram_loss = 2.75e+09, loss_total = 2.75e+09
Step 3 : gram_loss = 2.13e+09, loss_total = 2.13e+09
Step 4 : gram_loss = 1.10e+09, loss_total = 1.10e+09
Step 5 : gram_loss = 4.26e+08, loss_total = 4.26e+08
Step 6 : gram_loss = 2.83e+08, loss_total = 2.83e+08
Step 7 : gram_loss = 2.04e+08, loss_total = 2.04e+08
Step 8 : gram_loss = 1.51e+08, loss_total = 1.51e+08
Step 9 : gram_loss = 1.20e+08, loss_total = 1.20e+08
Step 10 : gram_loss = 9.98e+07, loss_total = 9.98e+07
Step 11 : gram_loss = 7.92e+07, loss_total = 7.92e+07
Step 12 : gram_loss = 5.77e+07, loss_total = 5.77e+07
Step 13 : gram_loss = 4.24e+07, loss_total = 4.24e+07
Step 14 : gram_loss = 3.66e+07, loss_total = 3.66e+07
Step 15 : gram_loss = 3.46e+07, loss_total = 3.46e+07
Step 16 : gram_loss = 3.02e+07, loss_total = 3.02e+07
Step 17 : gram_loss = 2.64e+07, loss_total = 2.64e+07
Step 18 : gram_loss = 2.05e+07, loss_total = 2.05e+07
Step 19 : gram_loss = 1.91e+07, loss_total = 1.91e+07
Step 20 : gram_loss = 1.68e+07, loss_total = 1.68e+07
Step 21 : gram_loss = 1.56e+07, loss_total = 1.56e+07
Step 22 : gram_loss = 1.43e+07, loss_total = 1.43e+07
Step 23 : gram_loss = 1.29e+07, loss_total = 1.29e+07
Step 24 : gram_loss = 1.15e+07, loss_total = 1.15e+07
Step 25 : gram_loss = 1.02e+07, loss_total = 1.02e+07
Step 26 : gram_loss = 9.81e+06, loss_total = 9.81e+06
Step 27 : gram_loss = 9.18e+06, loss_total = 9.18e+06
Step 28 : gram_loss = 8.64e+06, loss_total = 8.64e+06
Step 29 : gram_loss = 7.71e+06, loss_total = 7.71e+06
Step 30 : gram_loss = 6.98e+06, loss_total = 6.98e+06
Step 31 : gram_loss = 6.44e+06, loss_total = 6.44e+06
Step 32 : gram_loss = 5.93e+06, loss_total = 5.93e+06
Step 33 : gram_loss = 5.72e+06, loss_total = 5.72e+06
Step 34 : gram_loss = 5.42e+06, loss_total = 5.42e+06
Step 35 : gram_loss = 5.12e+06, loss_total = 5.12e+06
Step 36 : gram_loss = 4.71e+06, loss_total = 4.71e+06
Step 37 : gram_loss = 4.50e+06, loss_total = 4.50e+06
Step 38 : gram_loss = 4.34e+06, loss_total = 4.34e+06
Step 39 : gram_loss = 4.16e+06, loss_total = 4.16e+06
Step 40 : gram_loss = 3.90e+06, loss_total = 3.90e+06
Step 41 : gram_loss = 3.63e+06, loss_total = 3.63e+06
Step 42 : gram_loss = 3.36e+06, loss_total = 3.36e+06
Step 43 : gram_loss = 3.21e+06, loss_total = 3.21e+06
Step 44 : gram_loss = 3.01e+06, loss_total = 3.01e+06
Step 45 : gram_loss = 2.91e+06, loss_total = 2.91e+06
Step 46 : gram_loss = 2.72e+06, loss_total = 2.72e+06
Step 47 : gram_loss = 2.57e+06, loss_total = 2.57e+06
Step 48 : gram_loss = 2.42e+06, loss_total = 2.42e+06
Step 49 : gram_loss = 2.37e+06, loss_total = 2.37e+06
Step 50 : gram_loss = 2.31e+06, loss_total = 2.31e+06
Step 51 : gram_loss = 2.24e+06, loss_total = 2.24e+06
Step 52 : gram_loss = 2.11e+06, loss_total = 2.11e+06
Step 53 : gram_loss = 2.06e+06, loss_total = 2.06e+06
Step 54 : gram_loss = 1.94e+06, loss_total = 1.94e+06
Step 55 : gram_loss = 1.84e+06, loss_total = 1.84e+06
Step 56 : gram_loss = 1.76e+06, loss_total = 1.76e+06
Step 57 : gram_loss = 1.64e+06, loss_total = 1.64e+06
Step 58 : gram_loss = 1.57e+06, loss_total = 1.57e+06
Step 59 : gram_loss = 1.51e+06, loss_total = 1.51e+06
Step 60 : gram_loss = 1.48e+06, loss_total = 1.48e+06
Step 61 : gram_loss = 1.44e+06, loss_total = 1.44e+06
Step 62 : gram_loss = 1.36e+06, loss_total = 1.36e+06
Step 63 : gram_loss = 1.30e+06, loss_total = 1.30e+06
Step 64 : gram_loss = 1.26e+06, loss_total = 1.26e+06
Step 65 : gram_loss = 1.20e+06, loss_total = 1.20e+06
Step 66 : gram_loss = 1.14e+06, loss_total = 1.14e+06
Step 67 : gram_loss = 1.11e+06, loss_total = 1.11e+06
Step 68 : gram_loss = 1.06e+06, loss_total = 1.06e+06
Step 69 : gram_loss = 1.03e+06, loss_total = 1.03e+06
Step 70 : gram_loss = 9.83e+05, loss_total = 9.83e+05
Step 71 : gram_loss = 9.47e+05, loss_total = 9.47e+05
Step 72 : gram_loss = 9.10e+05, loss_total = 9.10e+05
Step 73 : gram_loss = 8.87e+05, loss_total = 8.87e+05
Step 74 : gram_loss = 8.64e+05, loss_total = 8.64e+05
Step 75 : gram_loss = 8.25e+05, loss_total = 8.25e+05
Step 76 : gram_loss = 7.83e+05, loss_total = 7.83e+05
Step 77 : gram_loss = 7.62e+05, loss_total = 7.62e+05
Step 78 : gram_loss = 7.45e+05, loss_total = 7.45e+05
Step 79 : gram_loss = 7.25e+05, loss_total = 7.25e+05
Step 80 : gram_loss = 6.88e+05, loss_total = 6.88e+05
Step 81 : gram_loss = 6.55e+05, loss_total = 6.55e+05
Step 82 : gram_loss = 6.39e+05, loss_total = 6.39e+05
Step 83 : gram_loss = 6.23e+05, loss_total = 6.23e+05
Step 84 : gram_loss = 6.15e+05, loss_total = 6.15e+05
Step 85 : gram_loss = 6.04e+05, loss_total = 6.04e+05
Step 86 : gram_loss = 5.88e+05, loss_total = 5.88e+05
Step 87 : gram_loss = 5.75e+05, loss_total = 5.75e+05
Step 88 : gram_loss = 5.51e+05, loss_total = 5.51e+05
Step 89 : gram_loss = 5.34e+05, loss_total = 5.34e+05
Step 90 : gram_loss = 5.15e+05, loss_total = 5.15e+05
Step 91 : gram_loss = 5.00e+05, loss_total = 5.00e+05
Step 92 : gram_loss = 4.93e+05, loss_total = 4.93e+05
Step 93 : gram_loss = 4.82e+05, loss_total = 4.82e+05
Step 94 : gram_loss = 4.72e+05, loss_total = 4.72e+05
Step 95 : gram_loss = 4.61e+05, loss_total = 4.61e+05
Step 96 : gram_loss = 4.51e+05, loss_total = 4.51e+05
Step 97 : gram_loss = 4.38e+05, loss_total = 4.38e+05
Step 98 : gram_loss = 4.16e+05, loss_total = 4.16e+05
Step 99 : gram_loss = 4.04e+05, loss_total = 4.04e+05
Step 100 : gram_loss = 3.88e+05, loss_total = 3.88e+05
Step 101 : gram_loss = 3.85e+05, loss_total = 3.85e+05
Step 102 : gram_loss = 3.77e+05, loss_total = 3.77e+05
Step 103 : gram_loss = 3.72e+05, loss_total = 3.72e+05
Step 104 : gram_loss = 3.63e+05, loss_total = 3.63e+05
Step 105 : gram_loss = 3.54e+05, loss_total = 3.54e+05
Step 106 : gram_loss = 3.43e+05, loss_total = 3.43e+05
Step 107 : gram_loss = 3.38e+05, loss_total = 3.38e+05
Step 108 : gram_loss = 3.30e+05, loss_total = 3.30e+05
Step 109 : gram_loss = 3.26e+05, loss_total = 3.26e+05
Step 110 : gram_loss = 3.21e+05, loss_total = 3.21e+05
Step 111 : gram_loss = 3.11e+05, loss_total = 3.11e+05
Step 112 : gram_loss = 3.03e+05, loss_total = 3.03e+05
Step 113 : gram_loss = 2.97e+05, loss_total = 2.97e+05
Step 114 : gram_loss = 2.93e+05, loss_total = 2.93e+05
Step 115 : gram_loss = 2.88e+05, loss_total = 2.88e+05
Step 116 : gram_loss = 2.82e+05, loss_total = 2.82e+05
Step 117 : gram_loss = 2.79e+05, loss_total = 2.79e+05
Step 118 : gram_loss = 2.73e+05, loss_total = 2.73e+05
Step 119 : gram_loss = 2.71e+05, loss_total = 2.71e+05
Step 120 : gram_loss = 2.67e+05, loss_total = 2.67e+05
Step 121 : gram_loss = 2.64e+05, loss_total = 2.64e+05
Step 122 : gram_loss = 2.57e+05, loss_total = 2.57e+05
Step 123 : gram_loss = 2.54e+05, loss_total = 2.54e+05
Step 124 : gram_loss = 2.50e+05, loss_total = 2.50e+05
Step 125 : gram_loss = 2.45e+05, loss_total = 2.45e+05
Step 126 : gram_loss = 2.38e+05, loss_total = 2.38e+05
Step 127 : gram_loss = 2.34e+05, loss_total = 2.34e+05
Step 128 : gram_loss = 2.29e+05, loss_total = 2.29e+05
Step 129 : gram_loss = 2.26e+05, loss_total = 2.26e+05
Step 130 : gram_loss = 2.24e+05, loss_total = 2.24e+05
Step 131 : gram_loss = 2.21e+05, loss_total = 2.21e+05
Step 132 : gram_loss = 2.18e+05, loss_total = 2.18e+05
Step 133 : gram_loss = 2.16e+05, loss_total = 2.16e+05
Step 134 : gram_loss = 2.13e+05, loss_total = 2.13e+05
Step 135 : gram_loss = 2.09e+05, loss_total = 2.09e+05
Step 136 : gram_loss = 2.07e+05, loss_total = 2.07e+05
Step 137 : gram_loss = 2.04e+05, loss_total = 2.04e+05
Step 138 : gram_loss = 2.01e+05, loss_total = 2.01e+05
Step 139 : gram_loss = 1.96e+05, loss_total = 1.96e+05
Step 140 : gram_loss = 1.94e+05, loss_total = 1.94e+05
Step 141 : gram_loss = 1.92e+05, loss_total = 1.92e+05
Step 142 : gram_loss = 1.90e+05, loss_total = 1.90e+05
Step 143 : gram_loss = 1.88e+05, loss_total = 1.88e+05
Step 144 : gram_loss = 1.85e+05, loss_total = 1.85e+05
Step 145 : gram_loss = 1.83e+05, loss_total = 1.83e+05
Step 146 : gram_loss = 1.81e+05, loss_total = 1.81e+05
Step 147 : gram_loss = 1.78e+05, loss_total = 1.78e+05
Step 148 : gram_loss = 1.75e+05, loss_total = 1.75e+05
Step 149 : gram_loss = 1.72e+05, loss_total = 1.72e+05
Step 150 : gram_loss = 1.70e+05, loss_total = 1.70e+05
Step 151 : gram_loss = 1.68e+05, loss_total = 1.68e+05
Step 152 : gram_loss = 1.66e+05, loss_total = 1.66e+05
Step 153 : gram_loss = 1.63e+05, loss_total = 1.63e+05
Step 154 : gram_loss = 1.61e+05, loss_total = 1.61e+05
Step 155 : gram_loss = 1.60e+05, loss_total = 1.60e+05
Step 156 : gram_loss = 1.59e+05, loss_total = 1.59e+05
Step 157 : gram_loss = 1.57e+05, loss_total = 1.57e+05
Step 158 : gram_loss = 1.55e+05, loss_total = 1.55e+05
Step 159 : gram_loss = 1.54e+05, loss_total = 1.54e+05
Step 160 : gram_loss = 1.51e+05, loss_total = 1.51e+05
Step 161 : gram_loss = 1.48e+05, loss_total = 1.48e+05
Step 162 : gram_loss = 1.46e+05, loss_total = 1.46e+05
Step 163 : gram_loss = 1.44e+05, loss_total = 1.44e+05
Step 164 : gram_loss = 1.43e+05, loss_total = 1.43e+05
Step 165 : gram_loss = 1.42e+05, loss_total = 1.42e+05
Step 166 : gram_loss = 1.40e+05, loss_total = 1.40e+05
Step 167 : gram_loss = 1.39e+05, loss_total = 1.39e+05
Step 168 : gram_loss = 1.38e+05, loss_total = 1.38e+05
Step 169 : gram_loss = 1.37e+05, loss_total = 1.37e+05
Step 170 : gram_loss = 1.36e+05, loss_total = 1.36e+05
Step 171 : gram_loss = 1.34e+05, loss_total = 1.34e+05
Step 172 : gram_loss = 1.33e+05, loss_total = 1.33e+05
Step 173 : gram_loss = 1.31e+05, loss_total = 1.31e+05
Step 174 : gram_loss = 1.30e+05, loss_total = 1.30e+05
Step 175 : gram_loss = 1.30e+05, loss_total = 1.30e+05
Step 176 : gram_loss = 1.28e+05, loss_total = 1.28e+05
Step 177 : gram_loss = 1.28e+05, loss_total = 1.28e+05
Step 178 : gram_loss = 1.27e+05, loss_total = 1.27e+05
Step 179 : gram_loss = 1.26e+05, loss_total = 1.26e+05
Step 180 : gram_loss = 1.25e+05, loss_total = 1.25e+05
Step 181 : gram_loss = 1.24e+05, loss_total = 1.24e+05
Step 182 : gram_loss = 1.23e+05, loss_total = 1.23e+05
Step 183 : gram_loss = 1.21e+05, loss_total = 1.21e+05
Step 184 : gram_loss = 1.21e+05, loss_total = 1.21e+05
Step 185 : gram_loss = 1.19e+05, loss_total = 1.19e+05
Step 186 : gram_loss = 1.19e+05, loss_total = 1.19e+05
Step 187 : gram_loss = 1.18e+05, loss_total = 1.18e+05
Step 188 : gram_loss = 1.17e+05, loss_total = 1.17e+05
Step 189 : gram_loss = 1.16e+05, loss_total = 1.16e+05
Step 190 : gram_loss = 1.15e+05, loss_total = 1.15e+05
Step 191 : gram_loss = 1.15e+05, loss_total = 1.15e+05
Step 192 : gram_loss = 1.14e+05, loss_total = 1.14e+05
Step 193 : gram_loss = 1.13e+05, loss_total = 1.13e+05
Step 194 : gram_loss = 1.13e+05, loss_total = 1.13e+05
Step 195 : gram_loss = 1.12e+05, loss_total = 1.12e+05
Step 196 : gram_loss = 1.11e+05, loss_total = 1.11e+05
Step 197 : gram_loss = 1.10e+05, loss_total = 1.10e+05
Step 198 : gram_loss = 1.09e+05, loss_total = 1.09e+05
Step 199 : gram_loss = 1.08e+05, loss_total = 1.08e+05
Step 200 : gram_loss = 1.08e+05, loss_total = 1.08e+05
Close Sess - End of the global optimization.
Computation total for  108.79326152801514  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0043_1_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0043_1_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0043_1_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0043_1_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0043_1_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0043_1_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.240734100341797  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 8.59e+08, loss_total = 8.59e+08
Step 1 : gram_loss = 3.76e+08, loss_total = 3.76e+08
Step 2 : gram_loss = 3.53e+08, loss_total = 3.53e+08
Step 3 : gram_loss = 2.36e+08, loss_total = 2.36e+08
Step 4 : gram_loss = 1.39e+08, loss_total = 1.39e+08
Step 5 : gram_loss = 1.16e+08, loss_total = 1.16e+08
Step 6 : gram_loss = 1.07e+08, loss_total = 1.07e+08
Step 7 : gram_loss = 8.22e+07, loss_total = 8.22e+07
Step 8 : gram_loss = 6.95e+07, loss_total = 6.95e+07
Step 9 : gram_loss = 5.59e+07, loss_total = 5.59e+07
Step 10 : gram_loss = 4.57e+07, loss_total = 4.57e+07
Step 11 : gram_loss = 3.90e+07, loss_total = 3.90e+07
Step 12 : gram_loss = 3.49e+07, loss_total = 3.49e+07
Step 13 : gram_loss = 2.86e+07, loss_total = 2.86e+07
Step 14 : gram_loss = 2.48e+07, loss_total = 2.48e+07
Step 15 : gram_loss = 2.09e+07, loss_total = 2.09e+07
Step 16 : gram_loss = 1.87e+07, loss_total = 1.87e+07
Step 17 : gram_loss = 1.65e+07, loss_total = 1.65e+07
Step 18 : gram_loss = 1.45e+07, loss_total = 1.45e+07
Step 19 : gram_loss = 1.33e+07, loss_total = 1.33e+07
Step 20 : gram_loss = 1.23e+07, loss_total = 1.23e+07
Step 21 : gram_loss = 1.17e+07, loss_total = 1.17e+07
Step 22 : gram_loss = 1.08e+07, loss_total = 1.08e+07
Step 23 : gram_loss = 9.70e+06, loss_total = 9.70e+06
Step 24 : gram_loss = 8.92e+06, loss_total = 8.92e+06
Step 25 : gram_loss = 8.49e+06, loss_total = 8.49e+06
Step 26 : gram_loss = 8.18e+06, loss_total = 8.18e+06
Step 27 : gram_loss = 7.43e+06, loss_total = 7.43e+06
Step 28 : gram_loss = 7.19e+06, loss_total = 7.19e+06
Step 29 : gram_loss = 6.66e+06, loss_total = 6.66e+06
Step 30 : gram_loss = 6.44e+06, loss_total = 6.44e+06
Step 31 : gram_loss = 6.22e+06, loss_total = 6.22e+06
Step 32 : gram_loss = 5.92e+06, loss_total = 5.92e+06
Step 33 : gram_loss = 5.69e+06, loss_total = 5.69e+06
Step 34 : gram_loss = 5.48e+06, loss_total = 5.48e+06
Step 35 : gram_loss = 5.06e+06, loss_total = 5.06e+06
Step 36 : gram_loss = 4.88e+06, loss_total = 4.88e+06
Step 37 : gram_loss = 4.61e+06, loss_total = 4.61e+06
Step 38 : gram_loss = 4.50e+06, loss_total = 4.50e+06
Step 39 : gram_loss = 4.37e+06, loss_total = 4.37e+06
Step 40 : gram_loss = 4.08e+06, loss_total = 4.08e+06
Step 41 : gram_loss = 3.85e+06, loss_total = 3.85e+06
Step 42 : gram_loss = 3.75e+06, loss_total = 3.75e+06
Step 43 : gram_loss = 3.70e+06, loss_total = 3.70e+06
Step 44 : gram_loss = 3.59e+06, loss_total = 3.59e+06
Step 45 : gram_loss = 3.44e+06, loss_total = 3.44e+06
Step 46 : gram_loss = 3.34e+06, loss_total = 3.34e+06
Step 47 : gram_loss = 3.17e+06, loss_total = 3.17e+06
Step 48 : gram_loss = 3.12e+06, loss_total = 3.12e+06
Step 49 : gram_loss = 2.83e+06, loss_total = 2.83e+06
Step 50 : gram_loss = 2.75e+06, loss_total = 2.75e+06
Step 51 : gram_loss = 2.69e+06, loss_total = 2.69e+06
Step 52 : gram_loss = 2.64e+06, loss_total = 2.64e+06
Step 53 : gram_loss = 2.57e+06, loss_total = 2.57e+06
Step 54 : gram_loss = 2.45e+06, loss_total = 2.45e+06
Step 55 : gram_loss = 2.39e+06, loss_total = 2.39e+06
Step 56 : gram_loss = 2.21e+06, loss_total = 2.21e+06
Step 57 : gram_loss = 2.17e+06, loss_total = 2.17e+06
Step 58 : gram_loss = 2.12e+06, loss_total = 2.12e+06
Step 59 : gram_loss = 2.10e+06, loss_total = 2.10e+06
Step 60 : gram_loss = 2.06e+06, loss_total = 2.06e+06
Step 61 : gram_loss = 2.02e+06, loss_total = 2.02e+06
Step 62 : gram_loss = 1.93e+06, loss_total = 1.93e+06
Step 63 : gram_loss = 1.90e+06, loss_total = 1.90e+06
Step 64 : gram_loss = 1.85e+06, loss_total = 1.85e+06
Step 65 : gram_loss = 1.78e+06, loss_total = 1.78e+06
Step 66 : gram_loss = 1.70e+06, loss_total = 1.70e+06
Step 67 : gram_loss = 1.66e+06, loss_total = 1.66e+06
Step 68 : gram_loss = 1.64e+06, loss_total = 1.64e+06
Step 69 : gram_loss = 1.58e+06, loss_total = 1.58e+06
Step 70 : gram_loss = 1.48e+06, loss_total = 1.48e+06
Step 71 : gram_loss = 1.46e+06, loss_total = 1.46e+06
Step 72 : gram_loss = 1.43e+06, loss_total = 1.43e+06
Step 73 : gram_loss = 1.42e+06, loss_total = 1.42e+06
Step 74 : gram_loss = 1.35e+06, loss_total = 1.35e+06
Step 75 : gram_loss = 1.30e+06, loss_total = 1.30e+06
Step 76 : gram_loss = 1.29e+06, loss_total = 1.29e+06
Step 77 : gram_loss = 1.25e+06, loss_total = 1.25e+06
Step 78 : gram_loss = 1.23e+06, loss_total = 1.23e+06
Step 79 : gram_loss = 1.19e+06, loss_total = 1.19e+06
Step 80 : gram_loss = 1.15e+06, loss_total = 1.15e+06
Step 81 : gram_loss = 1.14e+06, loss_total = 1.14e+06
Step 82 : gram_loss = 1.11e+06, loss_total = 1.11e+06
Step 83 : gram_loss = 1.10e+06, loss_total = 1.10e+06
Step 84 : gram_loss = 1.09e+06, loss_total = 1.09e+06
Step 85 : gram_loss = 1.06e+06, loss_total = 1.06e+06
Step 86 : gram_loss = 1.01e+06, loss_total = 1.01e+06
Step 87 : gram_loss = 9.97e+05, loss_total = 9.97e+05
Step 88 : gram_loss = 9.79e+05, loss_total = 9.79e+05
Step 89 : gram_loss = 9.60e+05, loss_total = 9.60e+05
Step 90 : gram_loss = 9.50e+05, loss_total = 9.50e+05
Step 91 : gram_loss = 9.34e+05, loss_total = 9.34e+05
Step 92 : gram_loss = 9.11e+05, loss_total = 9.11e+05
Step 93 : gram_loss = 8.91e+05, loss_total = 8.91e+05
Step 94 : gram_loss = 8.80e+05, loss_total = 8.80e+05
Step 95 : gram_loss = 8.72e+05, loss_total = 8.72e+05
Step 96 : gram_loss = 8.63e+05, loss_total = 8.63e+05
Step 97 : gram_loss = 8.30e+05, loss_total = 8.30e+05
Step 98 : gram_loss = 8.05e+05, loss_total = 8.05e+05
Step 99 : gram_loss = 7.84e+05, loss_total = 7.84e+05
Step 100 : gram_loss = 7.76e+05, loss_total = 7.76e+05
Step 101 : gram_loss = 7.64e+05, loss_total = 7.64e+05
Step 102 : gram_loss = 7.61e+05, loss_total = 7.61e+05
Step 103 : gram_loss = 7.57e+05, loss_total = 7.57e+05
Step 104 : gram_loss = 7.45e+05, loss_total = 7.45e+05
Step 105 : gram_loss = 7.31e+05, loss_total = 7.31e+05
Step 106 : gram_loss = 7.11e+05, loss_total = 7.11e+05
Step 107 : gram_loss = 7.03e+05, loss_total = 7.03e+05
Step 108 : gram_loss = 6.88e+05, loss_total = 6.88e+05
Step 109 : gram_loss = 6.81e+05, loss_total = 6.81e+05
Step 110 : gram_loss = 6.72e+05, loss_total = 6.72e+05
Step 111 : gram_loss = 6.65e+05, loss_total = 6.65e+05
Step 112 : gram_loss = 6.51e+05, loss_total = 6.51e+05
Step 113 : gram_loss = 6.30e+05, loss_total = 6.30e+05
Step 114 : gram_loss = 6.21e+05, loss_total = 6.21e+05
Step 115 : gram_loss = 6.10e+05, loss_total = 6.10e+05
Step 116 : gram_loss = 6.07e+05, loss_total = 6.07e+05
Step 117 : gram_loss = 6.01e+05, loss_total = 6.01e+05
Step 118 : gram_loss = 5.93e+05, loss_total = 5.93e+05
Step 119 : gram_loss = 5.82e+05, loss_total = 5.82e+05
Step 120 : gram_loss = 5.71e+05, loss_total = 5.71e+05
Step 121 : gram_loss = 5.65e+05, loss_total = 5.65e+05
Step 122 : gram_loss = 5.62e+05, loss_total = 5.62e+05
Step 123 : gram_loss = 5.58e+05, loss_total = 5.58e+05
Step 124 : gram_loss = 5.52e+05, loss_total = 5.52e+05
Step 125 : gram_loss = 5.42e+05, loss_total = 5.42e+05
Step 126 : gram_loss = 5.32e+05, loss_total = 5.32e+05
Step 127 : gram_loss = 5.27e+05, loss_total = 5.27e+05
Step 128 : gram_loss = 5.24e+05, loss_total = 5.24e+05
Step 129 : gram_loss = 5.19e+05, loss_total = 5.19e+05
Step 130 : gram_loss = 5.15e+05, loss_total = 5.15e+05
Step 131 : gram_loss = 5.14e+05, loss_total = 5.14e+05
Step 132 : gram_loss = 5.02e+05, loss_total = 5.02e+05
Step 133 : gram_loss = 4.92e+05, loss_total = 4.92e+05
Step 134 : gram_loss = 4.85e+05, loss_total = 4.85e+05
Step 135 : gram_loss = 4.80e+05, loss_total = 4.80e+05
Step 136 : gram_loss = 4.76e+05, loss_total = 4.76e+05
Step 137 : gram_loss = 4.67e+05, loss_total = 4.67e+05
Step 138 : gram_loss = 4.60e+05, loss_total = 4.60e+05
Step 139 : gram_loss = 4.53e+05, loss_total = 4.53e+05
Step 140 : gram_loss = 4.48e+05, loss_total = 4.48e+05
Step 141 : gram_loss = 4.44e+05, loss_total = 4.44e+05
Step 142 : gram_loss = 4.39e+05, loss_total = 4.39e+05
Step 143 : gram_loss = 4.30e+05, loss_total = 4.30e+05
Step 144 : gram_loss = 4.25e+05, loss_total = 4.25e+05
Step 145 : gram_loss = 4.22e+05, loss_total = 4.22e+05
Step 146 : gram_loss = 4.19e+05, loss_total = 4.19e+05
Step 147 : gram_loss = 4.16e+05, loss_total = 4.16e+05
Step 148 : gram_loss = 4.14e+05, loss_total = 4.14e+05
Step 149 : gram_loss = 4.12e+05, loss_total = 4.12e+05
Step 150 : gram_loss = 4.07e+05, loss_total = 4.07e+05
Step 151 : gram_loss = 4.02e+05, loss_total = 4.02e+05
Step 152 : gram_loss = 4.00e+05, loss_total = 4.00e+05
Step 153 : gram_loss = 3.97e+05, loss_total = 3.97e+05
Step 154 : gram_loss = 3.91e+05, loss_total = 3.91e+05
Step 155 : gram_loss = 3.86e+05, loss_total = 3.86e+05
Step 156 : gram_loss = 3.84e+05, loss_total = 3.84e+05
Step 157 : gram_loss = 3.82e+05, loss_total = 3.82e+05
Step 158 : gram_loss = 3.78e+05, loss_total = 3.78e+05
Step 159 : gram_loss = 3.72e+05, loss_total = 3.72e+05
Step 160 : gram_loss = 3.70e+05, loss_total = 3.70e+05
Step 161 : gram_loss = 3.64e+05, loss_total = 3.64e+05
Step 162 : gram_loss = 3.61e+05, loss_total = 3.61e+05
Step 163 : gram_loss = 3.58e+05, loss_total = 3.58e+05
Step 164 : gram_loss = 3.57e+05, loss_total = 3.57e+05
Step 165 : gram_loss = 3.55e+05, loss_total = 3.55e+05
Step 166 : gram_loss = 3.52e+05, loss_total = 3.52e+05
Step 167 : gram_loss = 3.49e+05, loss_total = 3.49e+05
Step 168 : gram_loss = 3.44e+05, loss_total = 3.44e+05
Step 169 : gram_loss = 3.41e+05, loss_total = 3.41e+05
Step 170 : gram_loss = 3.40e+05, loss_total = 3.40e+05
Step 171 : gram_loss = 3.37e+05, loss_total = 3.37e+05
Step 172 : gram_loss = 3.33e+05, loss_total = 3.33e+05
Step 173 : gram_loss = 3.28e+05, loss_total = 3.28e+05
Step 174 : gram_loss = 3.24e+05, loss_total = 3.24e+05
Step 175 : gram_loss = 3.23e+05, loss_total = 3.23e+05
Step 176 : gram_loss = 3.21e+05, loss_total = 3.21e+05
Step 177 : gram_loss = 3.20e+05, loss_total = 3.20e+05
Step 178 : gram_loss = 3.19e+05, loss_total = 3.19e+05
Step 179 : gram_loss = 3.17e+05, loss_total = 3.17e+05
Step 180 : gram_loss = 3.14e+05, loss_total = 3.14e+05
Step 181 : gram_loss = 3.11e+05, loss_total = 3.11e+05
Step 182 : gram_loss = 3.08e+05, loss_total = 3.08e+05
Step 183 : gram_loss = 3.05e+05, loss_total = 3.05e+05
Step 184 : gram_loss = 3.03e+05, loss_total = 3.03e+05
Step 185 : gram_loss = 3.02e+05, loss_total = 3.02e+05
Step 186 : gram_loss = 3.01e+05, loss_total = 3.01e+05
Step 187 : gram_loss = 2.97e+05, loss_total = 2.97e+05
Step 188 : gram_loss = 2.95e+05, loss_total = 2.95e+05
Step 189 : gram_loss = 2.94e+05, loss_total = 2.94e+05
Step 190 : gram_loss = 2.93e+05, loss_total = 2.93e+05
Step 191 : gram_loss = 2.93e+05, loss_total = 2.93e+05
Step 192 : gram_loss = 2.89e+05, loss_total = 2.89e+05
Step 193 : gram_loss = 2.87e+05, loss_total = 2.87e+05
Step 194 : gram_loss = 2.85e+05, loss_total = 2.85e+05
Step 195 : gram_loss = 2.84e+05, loss_total = 2.84e+05
Step 196 : gram_loss = 2.81e+05, loss_total = 2.81e+05
Step 197 : gram_loss = 2.79e+05, loss_total = 2.79e+05
Step 198 : gram_loss = 2.79e+05, loss_total = 2.79e+05
Step 199 : gram_loss = 2.76e+05, loss_total = 2.76e+05
Step 200 : gram_loss = 2.75e+05, loss_total = 2.75e+05
Close Sess - End of the global optimization.
Computation total for  110.07739400863647  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0027_1_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0027_1_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0027_1_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0027_1_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0027_1_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0027_1_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.257997274398804  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 4.44e+09, loss_total = 4.44e+09
Step 1 : gram_loss = 3.45e+09, loss_total = 3.45e+09
Step 2 : gram_loss = 3.25e+09, loss_total = 3.25e+09
Step 3 : gram_loss = 2.67e+09, loss_total = 2.67e+09
Step 4 : gram_loss = 8.39e+08, loss_total = 8.39e+08
Step 5 : gram_loss = 1.72e+08, loss_total = 1.72e+08
Step 6 : gram_loss = 1.06e+08, loss_total = 1.06e+08
Step 7 : gram_loss = 8.59e+07, loss_total = 8.59e+07
Step 8 : gram_loss = 5.49e+07, loss_total = 5.49e+07
Step 9 : gram_loss = 3.82e+07, loss_total = 3.82e+07
Step 10 : gram_loss = 3.40e+07, loss_total = 3.40e+07
Step 11 : gram_loss = 2.90e+07, loss_total = 2.90e+07
Step 12 : gram_loss = 2.45e+07, loss_total = 2.45e+07
Step 13 : gram_loss = 1.73e+07, loss_total = 1.73e+07
Step 14 : gram_loss = 1.30e+07, loss_total = 1.30e+07
Step 15 : gram_loss = 1.19e+07, loss_total = 1.19e+07
Step 16 : gram_loss = 1.04e+07, loss_total = 1.04e+07
Step 17 : gram_loss = 8.54e+06, loss_total = 8.54e+06
Step 18 : gram_loss = 7.33e+06, loss_total = 7.33e+06
Step 19 : gram_loss = 6.48e+06, loss_total = 6.48e+06
Step 20 : gram_loss = 5.05e+06, loss_total = 5.05e+06
Step 21 : gram_loss = 4.41e+06, loss_total = 4.41e+06
Step 22 : gram_loss = 3.63e+06, loss_total = 3.63e+06
Step 23 : gram_loss = 3.41e+06, loss_total = 3.41e+06
Step 24 : gram_loss = 3.26e+06, loss_total = 3.26e+06
Step 25 : gram_loss = 2.95e+06, loss_total = 2.95e+06
Step 26 : gram_loss = 2.61e+06, loss_total = 2.61e+06
Step 27 : gram_loss = 2.24e+06, loss_total = 2.24e+06
Step 28 : gram_loss = 2.16e+06, loss_total = 2.16e+06
Step 29 : gram_loss = 1.91e+06, loss_total = 1.91e+06
Step 30 : gram_loss = 1.83e+06, loss_total = 1.83e+06
Step 31 : gram_loss = 1.76e+06, loss_total = 1.76e+06
Step 32 : gram_loss = 1.63e+06, loss_total = 1.63e+06
Step 33 : gram_loss = 1.54e+06, loss_total = 1.54e+06
Step 34 : gram_loss = 1.42e+06, loss_total = 1.42e+06
Step 35 : gram_loss = 1.34e+06, loss_total = 1.34e+06
Step 36 : gram_loss = 1.27e+06, loss_total = 1.27e+06
Step 37 : gram_loss = 1.19e+06, loss_total = 1.19e+06
Step 38 : gram_loss = 1.06e+06, loss_total = 1.06e+06
Step 39 : gram_loss = 9.82e+05, loss_total = 9.82e+05
Step 40 : gram_loss = 9.30e+05, loss_total = 9.30e+05
Step 41 : gram_loss = 8.16e+05, loss_total = 8.16e+05
Step 42 : gram_loss = 7.74e+05, loss_total = 7.74e+05
Step 43 : gram_loss = 7.18e+05, loss_total = 7.18e+05
Step 44 : gram_loss = 6.91e+05, loss_total = 6.91e+05
Step 45 : gram_loss = 6.68e+05, loss_total = 6.68e+05
Step 46 : gram_loss = 6.44e+05, loss_total = 6.44e+05
Step 47 : gram_loss = 5.99e+05, loss_total = 5.99e+05
Step 48 : gram_loss = 5.77e+05, loss_total = 5.77e+05
Step 49 : gram_loss = 5.49e+05, loss_total = 5.49e+05
Step 50 : gram_loss = 5.17e+05, loss_total = 5.17e+05
Step 51 : gram_loss = 4.92e+05, loss_total = 4.92e+05
Step 52 : gram_loss = 4.70e+05, loss_total = 4.70e+05
Step 53 : gram_loss = 4.54e+05, loss_total = 4.54e+05
Step 54 : gram_loss = 4.46e+05, loss_total = 4.46e+05
Step 55 : gram_loss = 4.34e+05, loss_total = 4.34e+05
Step 56 : gram_loss = 4.17e+05, loss_total = 4.17e+05
Step 57 : gram_loss = 4.09e+05, loss_total = 4.09e+05
Step 58 : gram_loss = 4.04e+05, loss_total = 4.04e+05
Step 59 : gram_loss = 3.97e+05, loss_total = 3.97e+05
Step 60 : gram_loss = 3.79e+05, loss_total = 3.79e+05
Step 61 : gram_loss = 3.65e+05, loss_total = 3.65e+05
Step 62 : gram_loss = 3.46e+05, loss_total = 3.46e+05
Step 63 : gram_loss = 3.25e+05, loss_total = 3.25e+05
Step 64 : gram_loss = 3.20e+05, loss_total = 3.20e+05
Step 65 : gram_loss = 3.13e+05, loss_total = 3.13e+05
Step 66 : gram_loss = 3.09e+05, loss_total = 3.09e+05
Step 67 : gram_loss = 3.01e+05, loss_total = 3.01e+05
Step 68 : gram_loss = 2.85e+05, loss_total = 2.85e+05
Step 69 : gram_loss = 2.83e+05, loss_total = 2.83e+05
Step 70 : gram_loss = 2.67e+05, loss_total = 2.67e+05
Step 71 : gram_loss = 2.62e+05, loss_total = 2.62e+05
Step 72 : gram_loss = 2.55e+05, loss_total = 2.55e+05
Step 73 : gram_loss = 2.48e+05, loss_total = 2.48e+05
Step 74 : gram_loss = 2.42e+05, loss_total = 2.42e+05
Step 75 : gram_loss = 2.34e+05, loss_total = 2.34e+05
Step 76 : gram_loss = 2.29e+05, loss_total = 2.29e+05
Step 77 : gram_loss = 2.24e+05, loss_total = 2.24e+05
Step 78 : gram_loss = 2.19e+05, loss_total = 2.19e+05
Step 79 : gram_loss = 2.15e+05, loss_total = 2.15e+05
Step 80 : gram_loss = 2.13e+05, loss_total = 2.13e+05
Step 81 : gram_loss = 2.10e+05, loss_total = 2.10e+05
Step 82 : gram_loss = 2.05e+05, loss_total = 2.05e+05
Step 83 : gram_loss = 1.99e+05, loss_total = 1.99e+05
Step 84 : gram_loss = 1.94e+05, loss_total = 1.94e+05
Step 85 : gram_loss = 1.88e+05, loss_total = 1.88e+05
Step 86 : gram_loss = 1.82e+05, loss_total = 1.82e+05
Step 87 : gram_loss = 1.78e+05, loss_total = 1.78e+05
Step 88 : gram_loss = 1.74e+05, loss_total = 1.74e+05
Step 89 : gram_loss = 1.72e+05, loss_total = 1.72e+05
Step 90 : gram_loss = 1.68e+05, loss_total = 1.68e+05
Step 91 : gram_loss = 1.62e+05, loss_total = 1.62e+05
Step 92 : gram_loss = 1.58e+05, loss_total = 1.58e+05
Step 93 : gram_loss = 1.56e+05, loss_total = 1.56e+05
Step 94 : gram_loss = 1.52e+05, loss_total = 1.52e+05
Step 95 : gram_loss = 1.48e+05, loss_total = 1.48e+05
Step 96 : gram_loss = 1.44e+05, loss_total = 1.44e+05
Step 97 : gram_loss = 1.41e+05, loss_total = 1.41e+05
Step 98 : gram_loss = 1.40e+05, loss_total = 1.40e+05
Step 99 : gram_loss = 1.38e+05, loss_total = 1.38e+05
Step 100 : gram_loss = 1.36e+05, loss_total = 1.36e+05
Step 101 : gram_loss = 1.34e+05, loss_total = 1.34e+05
Step 102 : gram_loss = 1.32e+05, loss_total = 1.32e+05
Step 103 : gram_loss = 1.31e+05, loss_total = 1.31e+05
Step 104 : gram_loss = 1.29e+05, loss_total = 1.29e+05
Step 105 : gram_loss = 1.28e+05, loss_total = 1.28e+05
Step 106 : gram_loss = 1.25e+05, loss_total = 1.25e+05
Step 107 : gram_loss = 1.23e+05, loss_total = 1.23e+05
Step 108 : gram_loss = 1.20e+05, loss_total = 1.20e+05
Step 109 : gram_loss = 1.18e+05, loss_total = 1.18e+05
Step 110 : gram_loss = 1.16e+05, loss_total = 1.16e+05
Step 111 : gram_loss = 1.15e+05, loss_total = 1.15e+05
Step 112 : gram_loss = 1.14e+05, loss_total = 1.14e+05
Step 113 : gram_loss = 1.13e+05, loss_total = 1.13e+05
Step 114 : gram_loss = 1.11e+05, loss_total = 1.11e+05
Step 115 : gram_loss = 1.10e+05, loss_total = 1.10e+05
Step 116 : gram_loss = 1.09e+05, loss_total = 1.09e+05
Step 117 : gram_loss = 1.06e+05, loss_total = 1.06e+05
Step 118 : gram_loss = 1.05e+05, loss_total = 1.05e+05
Step 119 : gram_loss = 1.03e+05, loss_total = 1.03e+05
Step 120 : gram_loss = 1.01e+05, loss_total = 1.01e+05
Step 121 : gram_loss = 9.92e+04, loss_total = 9.92e+04
Step 122 : gram_loss = 9.79e+04, loss_total = 9.79e+04
Step 123 : gram_loss = 9.72e+04, loss_total = 9.72e+04
Step 124 : gram_loss = 9.65e+04, loss_total = 9.65e+04
Step 125 : gram_loss = 9.59e+04, loss_total = 9.59e+04
Step 126 : gram_loss = 9.47e+04, loss_total = 9.47e+04
Step 127 : gram_loss = 9.40e+04, loss_total = 9.40e+04
Step 128 : gram_loss = 9.34e+04, loss_total = 9.34e+04
Step 129 : gram_loss = 9.23e+04, loss_total = 9.23e+04
Step 130 : gram_loss = 9.03e+04, loss_total = 9.03e+04
Step 131 : gram_loss = 8.89e+04, loss_total = 8.89e+04
Step 132 : gram_loss = 8.81e+04, loss_total = 8.81e+04
Step 133 : gram_loss = 8.75e+04, loss_total = 8.75e+04
Step 134 : gram_loss = 8.70e+04, loss_total = 8.70e+04
Step 135 : gram_loss = 8.61e+04, loss_total = 8.61e+04
Step 136 : gram_loss = 8.49e+04, loss_total = 8.49e+04
Step 137 : gram_loss = 8.30e+04, loss_total = 8.30e+04
Step 138 : gram_loss = 8.22e+04, loss_total = 8.22e+04
Step 139 : gram_loss = 8.10e+04, loss_total = 8.10e+04
Step 140 : gram_loss = 8.01e+04, loss_total = 8.01e+04
Step 141 : gram_loss = 7.91e+04, loss_total = 7.91e+04
Step 142 : gram_loss = 7.80e+04, loss_total = 7.80e+04
Step 143 : gram_loss = 7.73e+04, loss_total = 7.73e+04
Step 144 : gram_loss = 7.69e+04, loss_total = 7.69e+04
Step 145 : gram_loss = 7.64e+04, loss_total = 7.64e+04
Step 146 : gram_loss = 7.62e+04, loss_total = 7.62e+04
Step 147 : gram_loss = 7.54e+04, loss_total = 7.54e+04
Step 148 : gram_loss = 7.51e+04, loss_total = 7.51e+04
Step 149 : gram_loss = 7.46e+04, loss_total = 7.46e+04
Step 150 : gram_loss = 7.40e+04, loss_total = 7.40e+04
Step 151 : gram_loss = 7.34e+04, loss_total = 7.34e+04
Step 152 : gram_loss = 7.23e+04, loss_total = 7.23e+04
Step 153 : gram_loss = 7.10e+04, loss_total = 7.10e+04
Step 154 : gram_loss = 7.03e+04, loss_total = 7.03e+04
Step 155 : gram_loss = 6.97e+04, loss_total = 6.97e+04
Step 156 : gram_loss = 6.92e+04, loss_total = 6.92e+04
Step 157 : gram_loss = 6.89e+04, loss_total = 6.89e+04
Step 158 : gram_loss = 6.86e+04, loss_total = 6.86e+04
Step 159 : gram_loss = 6.78e+04, loss_total = 6.78e+04
Step 160 : gram_loss = 6.74e+04, loss_total = 6.74e+04
Step 161 : gram_loss = 6.64e+04, loss_total = 6.64e+04
Step 162 : gram_loss = 6.60e+04, loss_total = 6.60e+04
Step 163 : gram_loss = 6.54e+04, loss_total = 6.54e+04
Step 164 : gram_loss = 6.49e+04, loss_total = 6.49e+04
Step 165 : gram_loss = 6.45e+04, loss_total = 6.45e+04
Step 166 : gram_loss = 6.36e+04, loss_total = 6.36e+04
Step 167 : gram_loss = 6.32e+04, loss_total = 6.32e+04
Step 168 : gram_loss = 6.28e+04, loss_total = 6.28e+04
Step 169 : gram_loss = 6.25e+04, loss_total = 6.25e+04
Step 170 : gram_loss = 6.24e+04, loss_total = 6.24e+04
Step 171 : gram_loss = 6.16e+04, loss_total = 6.16e+04
Step 172 : gram_loss = 6.12e+04, loss_total = 6.12e+04
Step 173 : gram_loss = 6.10e+04, loss_total = 6.10e+04
Step 174 : gram_loss = 6.07e+04, loss_total = 6.07e+04
Step 175 : gram_loss = 6.02e+04, loss_total = 6.02e+04
Step 176 : gram_loss = 5.98e+04, loss_total = 5.98e+04
Step 177 : gram_loss = 5.94e+04, loss_total = 5.94e+04
Step 178 : gram_loss = 5.91e+04, loss_total = 5.91e+04
Step 179 : gram_loss = 5.89e+04, loss_total = 5.89e+04
Step 180 : gram_loss = 5.82e+04, loss_total = 5.82e+04
Step 181 : gram_loss = 5.76e+04, loss_total = 5.76e+04
Step 182 : gram_loss = 5.72e+04, loss_total = 5.72e+04
Step 183 : gram_loss = 5.66e+04, loss_total = 5.66e+04
Step 184 : gram_loss = 5.62e+04, loss_total = 5.62e+04
Step 185 : gram_loss = 5.58e+04, loss_total = 5.58e+04
Step 186 : gram_loss = 5.54e+04, loss_total = 5.54e+04
Step 187 : gram_loss = 5.52e+04, loss_total = 5.52e+04
Step 188 : gram_loss = 5.47e+04, loss_total = 5.47e+04
Step 189 : gram_loss = 5.45e+04, loss_total = 5.45e+04
Step 190 : gram_loss = 5.41e+04, loss_total = 5.41e+04
Step 191 : gram_loss = 5.37e+04, loss_total = 5.37e+04
Step 192 : gram_loss = 5.33e+04, loss_total = 5.33e+04
Step 193 : gram_loss = 5.30e+04, loss_total = 5.30e+04
Step 194 : gram_loss = 5.29e+04, loss_total = 5.29e+04
Step 195 : gram_loss = 5.27e+04, loss_total = 5.27e+04
Step 196 : gram_loss = 5.25e+04, loss_total = 5.25e+04
Step 197 : gram_loss = 5.20e+04, loss_total = 5.20e+04
Step 198 : gram_loss = 5.17e+04, loss_total = 5.17e+04
Step 199 : gram_loss = 5.13e+04, loss_total = 5.13e+04
Step 200 : gram_loss = 5.07e+04, loss_total = 5.07e+04
Close Sess - End of the global optimization.
Computation total for  109.70562171936035  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0008_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0008_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0008_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0008_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0008_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0008_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.344587564468384  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 5.62e+09, loss_total = 5.62e+09
Step 1 : gram_loss = 2.76e+09, loss_total = 2.76e+09
Step 2 : gram_loss = 2.64e+09, loss_total = 2.64e+09
Step 3 : gram_loss = 2.50e+09, loss_total = 2.50e+09
Step 4 : gram_loss = 2.32e+09, loss_total = 2.32e+09
Step 5 : gram_loss = 1.90e+09, loss_total = 1.90e+09
Step 6 : gram_loss = 1.43e+09, loss_total = 1.43e+09
Step 7 : gram_loss = 1.23e+09, loss_total = 1.23e+09
Step 8 : gram_loss = 1.14e+09, loss_total = 1.14e+09
Step 9 : gram_loss = 9.53e+08, loss_total = 9.53e+08
Step 10 : gram_loss = 8.15e+08, loss_total = 8.15e+08
Step 11 : gram_loss = 7.24e+08, loss_total = 7.24e+08
Step 12 : gram_loss = 6.35e+08, loss_total = 6.35e+08
Step 13 : gram_loss = 5.37e+08, loss_total = 5.37e+08
Step 14 : gram_loss = 4.45e+08, loss_total = 4.45e+08
Step 15 : gram_loss = 3.43e+08, loss_total = 3.43e+08
Step 16 : gram_loss = 2.73e+08, loss_total = 2.73e+08
Step 17 : gram_loss = 2.43e+08, loss_total = 2.43e+08
Step 18 : gram_loss = 2.22e+08, loss_total = 2.22e+08
Step 19 : gram_loss = 2.03e+08, loss_total = 2.03e+08
Step 20 : gram_loss = 1.67e+08, loss_total = 1.67e+08
Step 21 : gram_loss = 1.20e+08, loss_total = 1.20e+08
Step 22 : gram_loss = 9.25e+07, loss_total = 9.25e+07
Step 23 : gram_loss = 7.05e+07, loss_total = 7.05e+07
Step 24 : gram_loss = 6.01e+07, loss_total = 6.01e+07
Step 25 : gram_loss = 5.16e+07, loss_total = 5.16e+07
Step 26 : gram_loss = 4.09e+07, loss_total = 4.09e+07
Step 27 : gram_loss = 3.31e+07, loss_total = 3.31e+07
Step 28 : gram_loss = 2.66e+07, loss_total = 2.66e+07
Step 29 : gram_loss = 2.35e+07, loss_total = 2.35e+07
Step 30 : gram_loss = 2.11e+07, loss_total = 2.11e+07
Step 31 : gram_loss = 1.98e+07, loss_total = 1.98e+07
Step 32 : gram_loss = 1.88e+07, loss_total = 1.88e+07
Step 33 : gram_loss = 1.71e+07, loss_total = 1.71e+07
Step 34 : gram_loss = 1.52e+07, loss_total = 1.52e+07
Step 35 : gram_loss = 1.42e+07, loss_total = 1.42e+07
Step 36 : gram_loss = 1.34e+07, loss_total = 1.34e+07
Step 37 : gram_loss = 1.24e+07, loss_total = 1.24e+07
Step 38 : gram_loss = 1.19e+07, loss_total = 1.19e+07
Step 39 : gram_loss = 1.14e+07, loss_total = 1.14e+07
Step 40 : gram_loss = 1.09e+07, loss_total = 1.09e+07
Step 41 : gram_loss = 9.82e+06, loss_total = 9.82e+06
Step 42 : gram_loss = 9.34e+06, loss_total = 9.34e+06
Step 43 : gram_loss = 8.75e+06, loss_total = 8.75e+06
Step 44 : gram_loss = 8.51e+06, loss_total = 8.51e+06
Step 45 : gram_loss = 8.05e+06, loss_total = 8.05e+06
Step 46 : gram_loss = 7.72e+06, loss_total = 7.72e+06
Step 47 : gram_loss = 7.21e+06, loss_total = 7.21e+06
Step 48 : gram_loss = 6.84e+06, loss_total = 6.84e+06
Step 49 : gram_loss = 6.54e+06, loss_total = 6.54e+06
Step 50 : gram_loss = 6.26e+06, loss_total = 6.26e+06
Step 51 : gram_loss = 5.98e+06, loss_total = 5.98e+06
Step 52 : gram_loss = 5.81e+06, loss_total = 5.81e+06
Step 53 : gram_loss = 5.64e+06, loss_total = 5.64e+06
Step 54 : gram_loss = 5.50e+06, loss_total = 5.50e+06
Step 55 : gram_loss = 5.28e+06, loss_total = 5.28e+06
Step 56 : gram_loss = 5.06e+06, loss_total = 5.06e+06
Step 57 : gram_loss = 4.86e+06, loss_total = 4.86e+06
Step 58 : gram_loss = 4.77e+06, loss_total = 4.77e+06
Step 59 : gram_loss = 4.64e+06, loss_total = 4.64e+06
Step 60 : gram_loss = 4.53e+06, loss_total = 4.53e+06
Step 61 : gram_loss = 4.43e+06, loss_total = 4.43e+06
Step 62 : gram_loss = 4.33e+06, loss_total = 4.33e+06
Step 63 : gram_loss = 4.18e+06, loss_total = 4.18e+06
Step 64 : gram_loss = 4.08e+06, loss_total = 4.08e+06
Step 65 : gram_loss = 4.03e+06, loss_total = 4.03e+06
Step 66 : gram_loss = 3.98e+06, loss_total = 3.98e+06
Step 67 : gram_loss = 3.87e+06, loss_total = 3.87e+06
Step 68 : gram_loss = 3.75e+06, loss_total = 3.75e+06
Step 69 : gram_loss = 3.62e+06, loss_total = 3.62e+06
Step 70 : gram_loss = 3.55e+06, loss_total = 3.55e+06
Step 71 : gram_loss = 3.48e+06, loss_total = 3.48e+06
Step 72 : gram_loss = 3.41e+06, loss_total = 3.41e+06
Step 73 : gram_loss = 3.33e+06, loss_total = 3.33e+06
Step 74 : gram_loss = 3.26e+06, loss_total = 3.26e+06
Step 75 : gram_loss = 3.16e+06, loss_total = 3.16e+06
Step 76 : gram_loss = 3.07e+06, loss_total = 3.07e+06
Step 77 : gram_loss = 3.02e+06, loss_total = 3.02e+06
Step 78 : gram_loss = 2.96e+06, loss_total = 2.96e+06
Step 79 : gram_loss = 2.90e+06, loss_total = 2.90e+06
Step 80 : gram_loss = 2.85e+06, loss_total = 2.85e+06
Step 81 : gram_loss = 2.77e+06, loss_total = 2.77e+06
Step 82 : gram_loss = 2.74e+06, loss_total = 2.74e+06
Step 83 : gram_loss = 2.71e+06, loss_total = 2.71e+06
Step 84 : gram_loss = 2.64e+06, loss_total = 2.64e+06
Step 85 : gram_loss = 2.56e+06, loss_total = 2.56e+06
Step 86 : gram_loss = 2.51e+06, loss_total = 2.51e+06
Step 87 : gram_loss = 2.48e+06, loss_total = 2.48e+06
Step 88 : gram_loss = 2.45e+06, loss_total = 2.45e+06
Step 89 : gram_loss = 2.41e+06, loss_total = 2.41e+06
Step 90 : gram_loss = 2.36e+06, loss_total = 2.36e+06
Step 91 : gram_loss = 2.30e+06, loss_total = 2.30e+06
Step 92 : gram_loss = 2.25e+06, loss_total = 2.25e+06
Step 93 : gram_loss = 2.20e+06, loss_total = 2.20e+06
Step 94 : gram_loss = 2.17e+06, loss_total = 2.17e+06
Step 95 : gram_loss = 2.13e+06, loss_total = 2.13e+06
Step 96 : gram_loss = 2.10e+06, loss_total = 2.10e+06
Step 97 : gram_loss = 2.07e+06, loss_total = 2.07e+06
Step 98 : gram_loss = 2.01e+06, loss_total = 2.01e+06
Step 99 : gram_loss = 1.98e+06, loss_total = 1.98e+06
Step 100 : gram_loss = 1.95e+06, loss_total = 1.95e+06
Step 101 : gram_loss = 1.92e+06, loss_total = 1.92e+06
Step 102 : gram_loss = 1.89e+06, loss_total = 1.89e+06
Step 103 : gram_loss = 1.87e+06, loss_total = 1.87e+06
Step 104 : gram_loss = 1.85e+06, loss_total = 1.85e+06
Step 105 : gram_loss = 1.83e+06, loss_total = 1.83e+06
Step 106 : gram_loss = 1.81e+06, loss_total = 1.81e+06
Step 107 : gram_loss = 1.78e+06, loss_total = 1.78e+06
Step 108 : gram_loss = 1.76e+06, loss_total = 1.76e+06
Step 109 : gram_loss = 1.73e+06, loss_total = 1.73e+06
Step 110 : gram_loss = 1.71e+06, loss_total = 1.71e+06
Step 111 : gram_loss = 1.69e+06, loss_total = 1.69e+06
Step 112 : gram_loss = 1.67e+06, loss_total = 1.67e+06
Step 113 : gram_loss = 1.65e+06, loss_total = 1.65e+06
Step 114 : gram_loss = 1.62e+06, loss_total = 1.62e+06
Step 115 : gram_loss = 1.59e+06, loss_total = 1.59e+06
Step 116 : gram_loss = 1.57e+06, loss_total = 1.57e+06
Step 117 : gram_loss = 1.55e+06, loss_total = 1.55e+06
Step 118 : gram_loss = 1.54e+06, loss_total = 1.54e+06
Step 119 : gram_loss = 1.52e+06, loss_total = 1.52e+06
Step 120 : gram_loss = 1.50e+06, loss_total = 1.50e+06
Step 121 : gram_loss = 1.48e+06, loss_total = 1.48e+06
Step 122 : gram_loss = 1.47e+06, loss_total = 1.47e+06
Step 123 : gram_loss = 1.45e+06, loss_total = 1.45e+06
Step 124 : gram_loss = 1.44e+06, loss_total = 1.44e+06
Step 125 : gram_loss = 1.43e+06, loss_total = 1.43e+06
Step 126 : gram_loss = 1.42e+06, loss_total = 1.42e+06
Step 127 : gram_loss = 1.41e+06, loss_total = 1.41e+06
Step 128 : gram_loss = 1.40e+06, loss_total = 1.40e+06
Step 129 : gram_loss = 1.39e+06, loss_total = 1.39e+06
Step 130 : gram_loss = 1.37e+06, loss_total = 1.37e+06
Step 131 : gram_loss = 1.35e+06, loss_total = 1.35e+06
Step 132 : gram_loss = 1.33e+06, loss_total = 1.33e+06
Step 133 : gram_loss = 1.32e+06, loss_total = 1.32e+06
Step 134 : gram_loss = 1.30e+06, loss_total = 1.30e+06
Step 135 : gram_loss = 1.30e+06, loss_total = 1.30e+06
Step 136 : gram_loss = 1.29e+06, loss_total = 1.29e+06
Step 137 : gram_loss = 1.28e+06, loss_total = 1.28e+06
Step 138 : gram_loss = 1.26e+06, loss_total = 1.26e+06
Step 139 : gram_loss = 1.25e+06, loss_total = 1.25e+06
Step 140 : gram_loss = 1.23e+06, loss_total = 1.23e+06
Step 141 : gram_loss = 1.22e+06, loss_total = 1.22e+06
Step 142 : gram_loss = 1.21e+06, loss_total = 1.21e+06
Step 143 : gram_loss = 1.20e+06, loss_total = 1.20e+06
Step 144 : gram_loss = 1.19e+06, loss_total = 1.19e+06
Step 145 : gram_loss = 1.18e+06, loss_total = 1.18e+06
Step 146 : gram_loss = 1.17e+06, loss_total = 1.17e+06
Step 147 : gram_loss = 1.16e+06, loss_total = 1.16e+06
Step 148 : gram_loss = 1.15e+06, loss_total = 1.15e+06
Step 149 : gram_loss = 1.15e+06, loss_total = 1.15e+06
Step 150 : gram_loss = 1.14e+06, loss_total = 1.14e+06
Step 151 : gram_loss = 1.13e+06, loss_total = 1.13e+06
Step 152 : gram_loss = 1.12e+06, loss_total = 1.12e+06
Step 153 : gram_loss = 1.11e+06, loss_total = 1.11e+06
Step 154 : gram_loss = 1.10e+06, loss_total = 1.10e+06
Step 155 : gram_loss = 1.09e+06, loss_total = 1.09e+06
Step 156 : gram_loss = 1.08e+06, loss_total = 1.08e+06
Step 157 : gram_loss = 1.07e+06, loss_total = 1.07e+06
Step 158 : gram_loss = 1.07e+06, loss_total = 1.07e+06
Step 159 : gram_loss = 1.06e+06, loss_total = 1.06e+06
Step 160 : gram_loss = 1.05e+06, loss_total = 1.05e+06
Step 161 : gram_loss = 1.04e+06, loss_total = 1.04e+06
Step 162 : gram_loss = 1.03e+06, loss_total = 1.03e+06
Step 163 : gram_loss = 1.03e+06, loss_total = 1.03e+06
Step 164 : gram_loss = 1.02e+06, loss_total = 1.02e+06
Step 165 : gram_loss = 1.01e+06, loss_total = 1.01e+06
Step 166 : gram_loss = 1.00e+06, loss_total = 1.00e+06
Step 167 : gram_loss = 9.98e+05, loss_total = 9.98e+05
Step 168 : gram_loss = 9.91e+05, loss_total = 9.91e+05
Step 169 : gram_loss = 9.87e+05, loss_total = 9.87e+05
Step 170 : gram_loss = 9.81e+05, loss_total = 9.81e+05
Step 171 : gram_loss = 9.78e+05, loss_total = 9.78e+05
Step 172 : gram_loss = 9.72e+05, loss_total = 9.72e+05
Step 173 : gram_loss = 9.68e+05, loss_total = 9.68e+05
Step 174 : gram_loss = 9.62e+05, loss_total = 9.62e+05
Step 175 : gram_loss = 9.54e+05, loss_total = 9.54e+05
Step 176 : gram_loss = 9.47e+05, loss_total = 9.47e+05
Step 177 : gram_loss = 9.42e+05, loss_total = 9.42e+05
Step 178 : gram_loss = 9.37e+05, loss_total = 9.37e+05
Step 179 : gram_loss = 9.33e+05, loss_total = 9.33e+05
Step 180 : gram_loss = 9.29e+05, loss_total = 9.29e+05
Step 181 : gram_loss = 9.25e+05, loss_total = 9.25e+05
Step 182 : gram_loss = 9.21e+05, loss_total = 9.21e+05
Step 183 : gram_loss = 9.15e+05, loss_total = 9.15e+05
Step 184 : gram_loss = 9.10e+05, loss_total = 9.10e+05
Step 185 : gram_loss = 9.03e+05, loss_total = 9.03e+05
Step 186 : gram_loss = 8.96e+05, loss_total = 8.96e+05
Step 187 : gram_loss = 8.93e+05, loss_total = 8.93e+05
Step 188 : gram_loss = 8.89e+05, loss_total = 8.89e+05
Step 189 : gram_loss = 8.85e+05, loss_total = 8.85e+05
Step 190 : gram_loss = 8.80e+05, loss_total = 8.80e+05
Step 191 : gram_loss = 8.75e+05, loss_total = 8.75e+05
Step 192 : gram_loss = 8.72e+05, loss_total = 8.72e+05
Step 193 : gram_loss = 8.70e+05, loss_total = 8.70e+05
Step 194 : gram_loss = 8.67e+05, loss_total = 8.67e+05
Step 195 : gram_loss = 8.64e+05, loss_total = 8.64e+05
Step 196 : gram_loss = 8.61e+05, loss_total = 8.61e+05
Step 197 : gram_loss = 8.58e+05, loss_total = 8.58e+05
Step 198 : gram_loss = 8.54e+05, loss_total = 8.54e+05
Step 199 : gram_loss = 8.52e+05, loss_total = 8.52e+05
Step 200 : gram_loss = 8.46e+05, loss_total = 8.46e+05
Close Sess - End of the global optimization.
Computation total for  108.49806642532349  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0034_1_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0034_1_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0034_1_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0034_1_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0034_1_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0034_1_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.305358648300171  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 1.80e+09, loss_total = 1.80e+09
Step 1 : gram_loss = 8.59e+08, loss_total = 8.59e+08
Step 2 : gram_loss = 8.25e+08, loss_total = 8.25e+08
Step 3 : gram_loss = 6.08e+08, loss_total = 6.08e+08
Step 4 : gram_loss = 2.61e+08, loss_total = 2.61e+08
Step 5 : gram_loss = 1.44e+08, loss_total = 1.44e+08
Step 6 : gram_loss = 1.24e+08, loss_total = 1.24e+08
Step 7 : gram_loss = 1.12e+08, loss_total = 1.12e+08
Step 8 : gram_loss = 9.17e+07, loss_total = 9.17e+07
Step 9 : gram_loss = 8.00e+07, loss_total = 8.00e+07
Step 10 : gram_loss = 5.95e+07, loss_total = 5.95e+07
Step 11 : gram_loss = 4.35e+07, loss_total = 4.35e+07
Step 12 : gram_loss = 2.91e+07, loss_total = 2.91e+07
Step 13 : gram_loss = 2.21e+07, loss_total = 2.21e+07
Step 14 : gram_loss = 2.05e+07, loss_total = 2.05e+07
Step 15 : gram_loss = 1.73e+07, loss_total = 1.73e+07
Step 16 : gram_loss = 1.47e+07, loss_total = 1.47e+07
Step 17 : gram_loss = 1.17e+07, loss_total = 1.17e+07
Step 18 : gram_loss = 9.98e+06, loss_total = 9.98e+06
Step 19 : gram_loss = 9.30e+06, loss_total = 9.30e+06
Step 20 : gram_loss = 8.78e+06, loss_total = 8.78e+06
Step 21 : gram_loss = 8.05e+06, loss_total = 8.05e+06
Step 22 : gram_loss = 7.00e+06, loss_total = 7.00e+06
Step 23 : gram_loss = 6.58e+06, loss_total = 6.58e+06
Step 24 : gram_loss = 5.85e+06, loss_total = 5.85e+06
Step 25 : gram_loss = 5.63e+06, loss_total = 5.63e+06
Step 26 : gram_loss = 5.42e+06, loss_total = 5.42e+06
Step 27 : gram_loss = 5.00e+06, loss_total = 5.00e+06
Step 28 : gram_loss = 4.65e+06, loss_total = 4.65e+06
Step 29 : gram_loss = 4.34e+06, loss_total = 4.34e+06
Step 30 : gram_loss = 4.05e+06, loss_total = 4.05e+06
Step 31 : gram_loss = 3.90e+06, loss_total = 3.90e+06
Step 32 : gram_loss = 3.73e+06, loss_total = 3.73e+06
Step 33 : gram_loss = 3.55e+06, loss_total = 3.55e+06
Step 34 : gram_loss = 3.36e+06, loss_total = 3.36e+06
Step 35 : gram_loss = 3.22e+06, loss_total = 3.22e+06
Step 36 : gram_loss = 3.10e+06, loss_total = 3.10e+06
Step 37 : gram_loss = 3.01e+06, loss_total = 3.01e+06
Step 38 : gram_loss = 2.88e+06, loss_total = 2.88e+06
Step 39 : gram_loss = 2.75e+06, loss_total = 2.75e+06
Step 40 : gram_loss = 2.57e+06, loss_total = 2.57e+06
Step 41 : gram_loss = 2.46e+06, loss_total = 2.46e+06
Step 42 : gram_loss = 2.38e+06, loss_total = 2.38e+06
Step 43 : gram_loss = 2.30e+06, loss_total = 2.30e+06
Step 44 : gram_loss = 2.25e+06, loss_total = 2.25e+06
Step 45 : gram_loss = 2.18e+06, loss_total = 2.18e+06
Step 46 : gram_loss = 2.05e+06, loss_total = 2.05e+06
Step 47 : gram_loss = 1.97e+06, loss_total = 1.97e+06
Step 48 : gram_loss = 1.94e+06, loss_total = 1.94e+06
Step 49 : gram_loss = 1.82e+06, loss_total = 1.82e+06
Step 50 : gram_loss = 1.78e+06, loss_total = 1.78e+06
Step 51 : gram_loss = 1.74e+06, loss_total = 1.74e+06
Step 52 : gram_loss = 1.66e+06, loss_total = 1.66e+06
Step 53 : gram_loss = 1.56e+06, loss_total = 1.56e+06
Step 54 : gram_loss = 1.49e+06, loss_total = 1.49e+06
Step 55 : gram_loss = 1.43e+06, loss_total = 1.43e+06
Step 56 : gram_loss = 1.41e+06, loss_total = 1.41e+06
Step 57 : gram_loss = 1.38e+06, loss_total = 1.38e+06
Step 58 : gram_loss = 1.32e+06, loss_total = 1.32e+06
Step 59 : gram_loss = 1.28e+06, loss_total = 1.28e+06
Step 60 : gram_loss = 1.23e+06, loss_total = 1.23e+06
Step 61 : gram_loss = 1.19e+06, loss_total = 1.19e+06
Step 62 : gram_loss = 1.13e+06, loss_total = 1.13e+06
Step 63 : gram_loss = 1.06e+06, loss_total = 1.06e+06
Step 64 : gram_loss = 1.01e+06, loss_total = 1.01e+06
Step 65 : gram_loss = 9.91e+05, loss_total = 9.91e+05
Step 66 : gram_loss = 9.57e+05, loss_total = 9.57e+05
Step 67 : gram_loss = 9.16e+05, loss_total = 9.16e+05
Step 68 : gram_loss = 8.46e+05, loss_total = 8.46e+05
Step 69 : gram_loss = 8.19e+05, loss_total = 8.19e+05
Step 70 : gram_loss = 7.90e+05, loss_total = 7.90e+05
Step 71 : gram_loss = 7.64e+05, loss_total = 7.64e+05
Step 72 : gram_loss = 7.34e+05, loss_total = 7.34e+05
Step 73 : gram_loss = 7.17e+05, loss_total = 7.17e+05
Step 74 : gram_loss = 6.83e+05, loss_total = 6.83e+05
Step 75 : gram_loss = 6.64e+05, loss_total = 6.64e+05
Step 76 : gram_loss = 6.26e+05, loss_total = 6.26e+05
Step 77 : gram_loss = 5.83e+05, loss_total = 5.83e+05
Step 78 : gram_loss = 5.45e+05, loss_total = 5.45e+05
Step 79 : gram_loss = 5.30e+05, loss_total = 5.30e+05
Step 80 : gram_loss = 4.98e+05, loss_total = 4.98e+05
Step 81 : gram_loss = 4.86e+05, loss_total = 4.86e+05
Step 82 : gram_loss = 4.73e+05, loss_total = 4.73e+05
Step 83 : gram_loss = 4.53e+05, loss_total = 4.53e+05
Step 84 : gram_loss = 4.38e+05, loss_total = 4.38e+05
Step 85 : gram_loss = 4.13e+05, loss_total = 4.13e+05
Step 86 : gram_loss = 3.96e+05, loss_total = 3.96e+05
Step 87 : gram_loss = 3.86e+05, loss_total = 3.86e+05
Step 88 : gram_loss = 3.72e+05, loss_total = 3.72e+05
Step 89 : gram_loss = 3.59e+05, loss_total = 3.59e+05
Step 90 : gram_loss = 3.41e+05, loss_total = 3.41e+05
Step 91 : gram_loss = 3.30e+05, loss_total = 3.30e+05
Step 92 : gram_loss = 3.22e+05, loss_total = 3.22e+05
Step 93 : gram_loss = 3.12e+05, loss_total = 3.12e+05
Step 94 : gram_loss = 2.99e+05, loss_total = 2.99e+05
Step 95 : gram_loss = 2.89e+05, loss_total = 2.89e+05
Step 96 : gram_loss = 2.78e+05, loss_total = 2.78e+05
Step 97 : gram_loss = 2.73e+05, loss_total = 2.73e+05
Step 98 : gram_loss = 2.63e+05, loss_total = 2.63e+05
Step 99 : gram_loss = 2.58e+05, loss_total = 2.58e+05
Step 100 : gram_loss = 2.50e+05, loss_total = 2.50e+05
Step 101 : gram_loss = 2.46e+05, loss_total = 2.46e+05
Step 102 : gram_loss = 2.41e+05, loss_total = 2.41e+05
Step 103 : gram_loss = 2.36e+05, loss_total = 2.36e+05
Step 104 : gram_loss = 2.31e+05, loss_total = 2.31e+05
Step 105 : gram_loss = 2.24e+05, loss_total = 2.24e+05
Step 106 : gram_loss = 2.21e+05, loss_total = 2.21e+05
Step 107 : gram_loss = 2.16e+05, loss_total = 2.16e+05
Step 108 : gram_loss = 2.12e+05, loss_total = 2.12e+05
Step 109 : gram_loss = 2.08e+05, loss_total = 2.08e+05
Step 110 : gram_loss = 2.00e+05, loss_total = 2.00e+05
Step 111 : gram_loss = 1.99e+05, loss_total = 1.99e+05
Step 112 : gram_loss = 1.92e+05, loss_total = 1.92e+05
Step 113 : gram_loss = 1.91e+05, loss_total = 1.91e+05
Step 114 : gram_loss = 1.89e+05, loss_total = 1.89e+05
Step 115 : gram_loss = 1.84e+05, loss_total = 1.84e+05
Step 116 : gram_loss = 1.79e+05, loss_total = 1.79e+05
Step 117 : gram_loss = 1.75e+05, loss_total = 1.75e+05
Step 118 : gram_loss = 1.72e+05, loss_total = 1.72e+05
Step 119 : gram_loss = 1.70e+05, loss_total = 1.70e+05
Step 120 : gram_loss = 1.67e+05, loss_total = 1.67e+05
Step 121 : gram_loss = 1.64e+05, loss_total = 1.64e+05
Step 122 : gram_loss = 1.60e+05, loss_total = 1.60e+05
Step 123 : gram_loss = 1.57e+05, loss_total = 1.57e+05
Step 124 : gram_loss = 1.54e+05, loss_total = 1.54e+05
Step 125 : gram_loss = 1.52e+05, loss_total = 1.52e+05
Step 126 : gram_loss = 1.51e+05, loss_total = 1.51e+05
Step 127 : gram_loss = 1.48e+05, loss_total = 1.48e+05
Step 128 : gram_loss = 1.47e+05, loss_total = 1.47e+05
Step 129 : gram_loss = 1.45e+05, loss_total = 1.45e+05
Step 130 : gram_loss = 1.44e+05, loss_total = 1.44e+05
Step 131 : gram_loss = 1.42e+05, loss_total = 1.42e+05
Step 132 : gram_loss = 1.40e+05, loss_total = 1.40e+05
Step 133 : gram_loss = 1.38e+05, loss_total = 1.38e+05
Step 134 : gram_loss = 1.36e+05, loss_total = 1.36e+05
Step 135 : gram_loss = 1.34e+05, loss_total = 1.34e+05
Step 136 : gram_loss = 1.32e+05, loss_total = 1.32e+05
Step 137 : gram_loss = 1.31e+05, loss_total = 1.31e+05
Step 138 : gram_loss = 1.29e+05, loss_total = 1.29e+05
Step 139 : gram_loss = 1.28e+05, loss_total = 1.28e+05
Step 140 : gram_loss = 1.26e+05, loss_total = 1.26e+05
Step 141 : gram_loss = 1.26e+05, loss_total = 1.26e+05
Step 142 : gram_loss = 1.24e+05, loss_total = 1.24e+05
Step 143 : gram_loss = 1.22e+05, loss_total = 1.22e+05
Step 144 : gram_loss = 1.21e+05, loss_total = 1.21e+05
Step 145 : gram_loss = 1.20e+05, loss_total = 1.20e+05
Step 146 : gram_loss = 1.19e+05, loss_total = 1.19e+05
Step 147 : gram_loss = 1.17e+05, loss_total = 1.17e+05
Step 148 : gram_loss = 1.15e+05, loss_total = 1.15e+05
Step 149 : gram_loss = 1.14e+05, loss_total = 1.14e+05
Step 150 : gram_loss = 1.13e+05, loss_total = 1.13e+05
Step 151 : gram_loss = 1.12e+05, loss_total = 1.12e+05
Step 152 : gram_loss = 1.11e+05, loss_total = 1.11e+05
Step 153 : gram_loss = 1.10e+05, loss_total = 1.10e+05
Step 154 : gram_loss = 1.09e+05, loss_total = 1.09e+05
Step 155 : gram_loss = 1.08e+05, loss_total = 1.08e+05
Step 156 : gram_loss = 1.07e+05, loss_total = 1.07e+05
Step 157 : gram_loss = 1.06e+05, loss_total = 1.06e+05
Step 158 : gram_loss = 1.06e+05, loss_total = 1.06e+05
Step 159 : gram_loss = 1.05e+05, loss_total = 1.05e+05
Step 160 : gram_loss = 1.03e+05, loss_total = 1.03e+05
Step 161 : gram_loss = 1.03e+05, loss_total = 1.03e+05
Step 162 : gram_loss = 1.02e+05, loss_total = 1.02e+05
Step 163 : gram_loss = 1.01e+05, loss_total = 1.01e+05
Step 164 : gram_loss = 1.00e+05, loss_total = 1.00e+05
Step 165 : gram_loss = 9.97e+04, loss_total = 9.97e+04
Step 166 : gram_loss = 9.85e+04, loss_total = 9.85e+04
Step 167 : gram_loss = 9.79e+04, loss_total = 9.79e+04
Step 168 : gram_loss = 9.72e+04, loss_total = 9.72e+04
Step 169 : gram_loss = 9.60e+04, loss_total = 9.60e+04
Step 170 : gram_loss = 9.52e+04, loss_total = 9.52e+04
Step 171 : gram_loss = 9.46e+04, loss_total = 9.46e+04
Step 172 : gram_loss = 9.40e+04, loss_total = 9.40e+04
Step 173 : gram_loss = 9.31e+04, loss_total = 9.31e+04
Step 174 : gram_loss = 9.21e+04, loss_total = 9.21e+04
Step 175 : gram_loss = 9.16e+04, loss_total = 9.16e+04
Step 176 : gram_loss = 9.10e+04, loss_total = 9.10e+04
Step 177 : gram_loss = 9.04e+04, loss_total = 9.04e+04
Step 178 : gram_loss = 9.00e+04, loss_total = 9.00e+04
Step 179 : gram_loss = 8.95e+04, loss_total = 8.95e+04
Step 180 : gram_loss = 8.86e+04, loss_total = 8.86e+04
Step 181 : gram_loss = 8.77e+04, loss_total = 8.77e+04
Step 182 : gram_loss = 8.69e+04, loss_total = 8.69e+04
Step 183 : gram_loss = 8.66e+04, loss_total = 8.66e+04
Step 184 : gram_loss = 8.56e+04, loss_total = 8.56e+04
Step 185 : gram_loss = 8.52e+04, loss_total = 8.52e+04
Step 186 : gram_loss = 8.48e+04, loss_total = 8.48e+04
Step 187 : gram_loss = 8.43e+04, loss_total = 8.43e+04
Step 188 : gram_loss = 8.40e+04, loss_total = 8.40e+04
Step 189 : gram_loss = 8.34e+04, loss_total = 8.34e+04
Step 190 : gram_loss = 8.29e+04, loss_total = 8.29e+04
Step 191 : gram_loss = 8.22e+04, loss_total = 8.22e+04
Step 192 : gram_loss = 8.19e+04, loss_total = 8.19e+04
Step 193 : gram_loss = 8.15e+04, loss_total = 8.15e+04
Step 194 : gram_loss = 8.11e+04, loss_total = 8.11e+04
Step 195 : gram_loss = 8.05e+04, loss_total = 8.05e+04
Step 196 : gram_loss = 7.99e+04, loss_total = 7.99e+04
Step 197 : gram_loss = 7.96e+04, loss_total = 7.96e+04
Step 198 : gram_loss = 7.90e+04, loss_total = 7.90e+04
Step 199 : gram_loss = 7.88e+04, loss_total = 7.88e+04
Step 200 : gram_loss = 7.83e+04, loss_total = 7.83e+04
Close Sess - End of the global optimization.
Computation total for  109.46624040603638  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0004_1_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0004_1_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0004_1_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0004_1_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0004_1_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0004_1_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.200798273086548  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 4.41e+09, loss_total = 4.41e+09
Step 1 : gram_loss = 3.21e+09, loss_total = 3.21e+09
Step 2 : gram_loss = 2.93e+09, loss_total = 2.93e+09
Step 3 : gram_loss = 2.34e+09, loss_total = 2.34e+09
Step 4 : gram_loss = 1.35e+09, loss_total = 1.35e+09
Step 5 : gram_loss = 6.44e+08, loss_total = 6.44e+08
Step 6 : gram_loss = 4.19e+08, loss_total = 4.19e+08
Step 7 : gram_loss = 3.27e+08, loss_total = 3.27e+08
Step 8 : gram_loss = 2.01e+08, loss_total = 2.01e+08
Step 9 : gram_loss = 1.49e+08, loss_total = 1.49e+08
Step 10 : gram_loss = 1.18e+08, loss_total = 1.18e+08
Step 11 : gram_loss = 9.33e+07, loss_total = 9.33e+07
Step 12 : gram_loss = 6.28e+07, loss_total = 6.28e+07
Step 13 : gram_loss = 4.90e+07, loss_total = 4.90e+07
Step 14 : gram_loss = 4.31e+07, loss_total = 4.31e+07
Step 15 : gram_loss = 3.44e+07, loss_total = 3.44e+07
Step 16 : gram_loss = 2.90e+07, loss_total = 2.90e+07
Step 17 : gram_loss = 2.42e+07, loss_total = 2.42e+07
Step 18 : gram_loss = 2.22e+07, loss_total = 2.22e+07
Step 19 : gram_loss = 2.04e+07, loss_total = 2.04e+07
Step 20 : gram_loss = 1.86e+07, loss_total = 1.86e+07
Step 21 : gram_loss = 1.57e+07, loss_total = 1.57e+07
Step 22 : gram_loss = 1.39e+07, loss_total = 1.39e+07
Step 23 : gram_loss = 1.25e+07, loss_total = 1.25e+07
Step 24 : gram_loss = 1.16e+07, loss_total = 1.16e+07
Step 25 : gram_loss = 1.03e+07, loss_total = 1.03e+07
Step 26 : gram_loss = 8.83e+06, loss_total = 8.83e+06
Step 27 : gram_loss = 8.06e+06, loss_total = 8.06e+06
Step 28 : gram_loss = 7.59e+06, loss_total = 7.59e+06
Step 29 : gram_loss = 6.99e+06, loss_total = 6.99e+06
Step 30 : gram_loss = 6.74e+06, loss_total = 6.74e+06
Step 31 : gram_loss = 6.43e+06, loss_total = 6.43e+06
Step 32 : gram_loss = 6.17e+06, loss_total = 6.17e+06
Step 33 : gram_loss = 5.56e+06, loss_total = 5.56e+06
Step 34 : gram_loss = 5.48e+06, loss_total = 5.48e+06
Step 35 : gram_loss = 4.92e+06, loss_total = 4.92e+06
Step 36 : gram_loss = 4.80e+06, loss_total = 4.80e+06
Step 37 : gram_loss = 4.61e+06, loss_total = 4.61e+06
Step 38 : gram_loss = 4.31e+06, loss_total = 4.31e+06
Step 39 : gram_loss = 4.14e+06, loss_total = 4.14e+06
Step 40 : gram_loss = 3.90e+06, loss_total = 3.90e+06
Step 41 : gram_loss = 3.74e+06, loss_total = 3.74e+06
Step 42 : gram_loss = 3.61e+06, loss_total = 3.61e+06
Step 43 : gram_loss = 3.22e+06, loss_total = 3.22e+06
Step 44 : gram_loss = 3.08e+06, loss_total = 3.08e+06
Step 45 : gram_loss = 2.99e+06, loss_total = 2.99e+06
Step 46 : gram_loss = 2.80e+06, loss_total = 2.80e+06
Step 47 : gram_loss = 2.75e+06, loss_total = 2.75e+06
Step 48 : gram_loss = 2.66e+06, loss_total = 2.66e+06
Step 49 : gram_loss = 2.48e+06, loss_total = 2.48e+06
Step 50 : gram_loss = 2.30e+06, loss_total = 2.30e+06
Step 51 : gram_loss = 2.16e+06, loss_total = 2.16e+06
Step 52 : gram_loss = 2.09e+06, loss_total = 2.09e+06
Step 53 : gram_loss = 2.00e+06, loss_total = 2.00e+06
Step 54 : gram_loss = 1.93e+06, loss_total = 1.93e+06
Step 55 : gram_loss = 1.79e+06, loss_total = 1.79e+06
Step 56 : gram_loss = 1.74e+06, loss_total = 1.74e+06
Step 57 : gram_loss = 1.62e+06, loss_total = 1.62e+06
Step 58 : gram_loss = 1.58e+06, loss_total = 1.58e+06
Step 59 : gram_loss = 1.53e+06, loss_total = 1.53e+06
Step 60 : gram_loss = 1.49e+06, loss_total = 1.49e+06
Step 61 : gram_loss = 1.36e+06, loss_total = 1.36e+06
Step 62 : gram_loss = 1.28e+06, loss_total = 1.28e+06
Step 63 : gram_loss = 1.20e+06, loss_total = 1.20e+06
Step 64 : gram_loss = 1.16e+06, loss_total = 1.16e+06
Step 65 : gram_loss = 1.11e+06, loss_total = 1.11e+06
Step 66 : gram_loss = 1.06e+06, loss_total = 1.06e+06
Step 67 : gram_loss = 1.00e+06, loss_total = 1.00e+06
Step 68 : gram_loss = 9.78e+05, loss_total = 9.78e+05
Step 69 : gram_loss = 9.26e+05, loss_total = 9.26e+05
Step 70 : gram_loss = 8.92e+05, loss_total = 8.92e+05
Step 71 : gram_loss = 8.61e+05, loss_total = 8.61e+05
Step 72 : gram_loss = 8.27e+05, loss_total = 8.27e+05
Step 73 : gram_loss = 8.01e+05, loss_total = 8.01e+05
Step 74 : gram_loss = 7.49e+05, loss_total = 7.49e+05
Step 75 : gram_loss = 7.08e+05, loss_total = 7.08e+05
Step 76 : gram_loss = 6.84e+05, loss_total = 6.84e+05
Step 77 : gram_loss = 6.69e+05, loss_total = 6.69e+05
Step 78 : gram_loss = 6.56e+05, loss_total = 6.56e+05
Step 79 : gram_loss = 6.14e+05, loss_total = 6.14e+05
Step 80 : gram_loss = 5.98e+05, loss_total = 5.98e+05
Step 81 : gram_loss = 5.67e+05, loss_total = 5.67e+05
Step 82 : gram_loss = 5.55e+05, loss_total = 5.55e+05
Step 83 : gram_loss = 5.41e+05, loss_total = 5.41e+05
Step 84 : gram_loss = 5.13e+05, loss_total = 5.13e+05
Step 85 : gram_loss = 4.88e+05, loss_total = 4.88e+05
Step 86 : gram_loss = 4.61e+05, loss_total = 4.61e+05
Step 87 : gram_loss = 4.45e+05, loss_total = 4.45e+05
Step 88 : gram_loss = 4.33e+05, loss_total = 4.33e+05
Step 89 : gram_loss = 4.18e+05, loss_total = 4.18e+05
Step 90 : gram_loss = 4.10e+05, loss_total = 4.10e+05
Step 91 : gram_loss = 3.98e+05, loss_total = 3.98e+05
Step 92 : gram_loss = 3.89e+05, loss_total = 3.89e+05
Step 93 : gram_loss = 3.77e+05, loss_total = 3.77e+05
Step 94 : gram_loss = 3.68e+05, loss_total = 3.68e+05
Step 95 : gram_loss = 3.58e+05, loss_total = 3.58e+05
Step 96 : gram_loss = 3.48e+05, loss_total = 3.48e+05
Step 97 : gram_loss = 3.39e+05, loss_total = 3.39e+05
Step 98 : gram_loss = 3.32e+05, loss_total = 3.32e+05
Step 99 : gram_loss = 3.26e+05, loss_total = 3.26e+05
Step 100 : gram_loss = 3.18e+05, loss_total = 3.18e+05
Step 101 : gram_loss = 3.08e+05, loss_total = 3.08e+05
Step 102 : gram_loss = 3.00e+05, loss_total = 3.00e+05
Step 103 : gram_loss = 2.92e+05, loss_total = 2.92e+05
Step 104 : gram_loss = 2.86e+05, loss_total = 2.86e+05
Step 105 : gram_loss = 2.81e+05, loss_total = 2.81e+05
Step 106 : gram_loss = 2.77e+05, loss_total = 2.77e+05
Step 107 : gram_loss = 2.68e+05, loss_total = 2.68e+05
Step 108 : gram_loss = 2.59e+05, loss_total = 2.59e+05
Step 109 : gram_loss = 2.54e+05, loss_total = 2.54e+05
Step 110 : gram_loss = 2.48e+05, loss_total = 2.48e+05
Step 111 : gram_loss = 2.43e+05, loss_total = 2.43e+05
Step 112 : gram_loss = 2.39e+05, loss_total = 2.39e+05
Step 113 : gram_loss = 2.35e+05, loss_total = 2.35e+05
Step 114 : gram_loss = 2.32e+05, loss_total = 2.32e+05
Step 115 : gram_loss = 2.29e+05, loss_total = 2.29e+05
Step 116 : gram_loss = 2.24e+05, loss_total = 2.24e+05
Step 117 : gram_loss = 2.23e+05, loss_total = 2.23e+05
Step 118 : gram_loss = 2.21e+05, loss_total = 2.21e+05
Step 119 : gram_loss = 2.17e+05, loss_total = 2.17e+05
Step 120 : gram_loss = 2.11e+05, loss_total = 2.11e+05
Step 121 : gram_loss = 2.08e+05, loss_total = 2.08e+05
Step 122 : gram_loss = 2.06e+05, loss_total = 2.06e+05
Step 123 : gram_loss = 2.04e+05, loss_total = 2.04e+05
Step 124 : gram_loss = 2.02e+05, loss_total = 2.02e+05
Step 125 : gram_loss = 1.97e+05, loss_total = 1.97e+05
Step 126 : gram_loss = 1.95e+05, loss_total = 1.95e+05
Step 127 : gram_loss = 1.91e+05, loss_total = 1.91e+05
Step 128 : gram_loss = 1.89e+05, loss_total = 1.89e+05
Step 129 : gram_loss = 1.86e+05, loss_total = 1.86e+05
Step 130 : gram_loss = 1.84e+05, loss_total = 1.84e+05
Step 131 : gram_loss = 1.83e+05, loss_total = 1.83e+05
Step 132 : gram_loss = 1.81e+05, loss_total = 1.81e+05
Step 133 : gram_loss = 1.79e+05, loss_total = 1.79e+05
Step 134 : gram_loss = 1.76e+05, loss_total = 1.76e+05
Step 135 : gram_loss = 1.74e+05, loss_total = 1.74e+05
Step 136 : gram_loss = 1.72e+05, loss_total = 1.72e+05
Step 137 : gram_loss = 1.71e+05, loss_total = 1.71e+05
Step 138 : gram_loss = 1.69e+05, loss_total = 1.69e+05
Step 139 : gram_loss = 1.68e+05, loss_total = 1.68e+05
Step 140 : gram_loss = 1.67e+05, loss_total = 1.67e+05
Step 141 : gram_loss = 1.65e+05, loss_total = 1.65e+05
Step 142 : gram_loss = 1.63e+05, loss_total = 1.63e+05
Step 143 : gram_loss = 1.61e+05, loss_total = 1.61e+05
Step 144 : gram_loss = 1.60e+05, loss_total = 1.60e+05
Step 145 : gram_loss = 1.59e+05, loss_total = 1.59e+05
Step 146 : gram_loss = 1.56e+05, loss_total = 1.56e+05
Step 147 : gram_loss = 1.55e+05, loss_total = 1.55e+05
Step 148 : gram_loss = 1.53e+05, loss_total = 1.53e+05
Step 149 : gram_loss = 1.52e+05, loss_total = 1.52e+05
Step 150 : gram_loss = 1.50e+05, loss_total = 1.50e+05
Step 151 : gram_loss = 1.48e+05, loss_total = 1.48e+05
Step 152 : gram_loss = 1.47e+05, loss_total = 1.47e+05
Step 153 : gram_loss = 1.46e+05, loss_total = 1.46e+05
Step 154 : gram_loss = 1.45e+05, loss_total = 1.45e+05
Step 155 : gram_loss = 1.45e+05, loss_total = 1.45e+05
Step 156 : gram_loss = 1.43e+05, loss_total = 1.43e+05
Step 157 : gram_loss = 1.43e+05, loss_total = 1.43e+05
Step 158 : gram_loss = 1.41e+05, loss_total = 1.41e+05
Step 159 : gram_loss = 1.40e+05, loss_total = 1.40e+05
Step 160 : gram_loss = 1.39e+05, loss_total = 1.39e+05
Step 161 : gram_loss = 1.38e+05, loss_total = 1.38e+05
Step 162 : gram_loss = 1.37e+05, loss_total = 1.37e+05
Step 163 : gram_loss = 1.36e+05, loss_total = 1.36e+05
Step 164 : gram_loss = 1.36e+05, loss_total = 1.36e+05
Step 165 : gram_loss = 1.35e+05, loss_total = 1.35e+05
Step 166 : gram_loss = 1.34e+05, loss_total = 1.34e+05
Step 167 : gram_loss = 1.33e+05, loss_total = 1.33e+05
Step 168 : gram_loss = 1.33e+05, loss_total = 1.33e+05
Step 169 : gram_loss = 1.32e+05, loss_total = 1.32e+05
Step 170 : gram_loss = 1.30e+05, loss_total = 1.30e+05
Step 171 : gram_loss = 1.30e+05, loss_total = 1.30e+05
Step 172 : gram_loss = 1.29e+05, loss_total = 1.29e+05
Step 173 : gram_loss = 1.28e+05, loss_total = 1.28e+05
Step 174 : gram_loss = 1.27e+05, loss_total = 1.27e+05
Step 175 : gram_loss = 1.26e+05, loss_total = 1.26e+05
Step 176 : gram_loss = 1.25e+05, loss_total = 1.25e+05
Step 177 : gram_loss = 1.24e+05, loss_total = 1.24e+05
Step 178 : gram_loss = 1.23e+05, loss_total = 1.23e+05
Step 179 : gram_loss = 1.23e+05, loss_total = 1.23e+05
Step 180 : gram_loss = 1.22e+05, loss_total = 1.22e+05
Step 181 : gram_loss = 1.21e+05, loss_total = 1.21e+05
Step 182 : gram_loss = 1.21e+05, loss_total = 1.21e+05
Step 183 : gram_loss = 1.20e+05, loss_total = 1.20e+05
Step 184 : gram_loss = 1.20e+05, loss_total = 1.20e+05
Step 185 : gram_loss = 1.19e+05, loss_total = 1.19e+05
Step 186 : gram_loss = 1.18e+05, loss_total = 1.18e+05
Step 187 : gram_loss = 1.17e+05, loss_total = 1.17e+05
Step 188 : gram_loss = 1.17e+05, loss_total = 1.17e+05
Step 189 : gram_loss = 1.16e+05, loss_total = 1.16e+05
Step 190 : gram_loss = 1.15e+05, loss_total = 1.15e+05
Step 191 : gram_loss = 1.15e+05, loss_total = 1.15e+05
Step 192 : gram_loss = 1.14e+05, loss_total = 1.14e+05
Step 193 : gram_loss = 1.14e+05, loss_total = 1.14e+05
Step 194 : gram_loss = 1.13e+05, loss_total = 1.13e+05
Step 195 : gram_loss = 1.13e+05, loss_total = 1.13e+05
Step 196 : gram_loss = 1.12e+05, loss_total = 1.12e+05
Step 197 : gram_loss = 1.11e+05, loss_total = 1.11e+05
Step 198 : gram_loss = 1.11e+05, loss_total = 1.11e+05
Step 199 : gram_loss = 1.10e+05, loss_total = 1.10e+05
Step 200 : gram_loss = 1.09e+05, loss_total = 1.09e+05
Close Sess - End of the global optimization.
Computation total for  107.41698908805847  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0040_1_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0040_1_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0040_1_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0040_1_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0040_1_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0040_1_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.28089165687561  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 5.06e+09, loss_total = 5.06e+09
Step 1 : gram_loss = 3.56e+09, loss_total = 3.56e+09
Step 2 : gram_loss = 3.44e+09, loss_total = 3.44e+09
Step 3 : gram_loss = 2.82e+09, loss_total = 2.82e+09
Step 4 : gram_loss = 2.23e+09, loss_total = 2.23e+09
Step 5 : gram_loss = 1.29e+09, loss_total = 1.29e+09
Step 6 : gram_loss = 9.48e+08, loss_total = 9.48e+08
Step 7 : gram_loss = 7.31e+08, loss_total = 7.31e+08
Step 8 : gram_loss = 6.24e+08, loss_total = 6.24e+08
Step 9 : gram_loss = 4.85e+08, loss_total = 4.85e+08
Step 10 : gram_loss = 4.25e+08, loss_total = 4.25e+08
Step 11 : gram_loss = 2.93e+08, loss_total = 2.93e+08
Step 12 : gram_loss = 1.74e+08, loss_total = 1.74e+08
Step 13 : gram_loss = 1.15e+08, loss_total = 1.15e+08
Step 14 : gram_loss = 9.11e+07, loss_total = 9.11e+07
Step 15 : gram_loss = 7.58e+07, loss_total = 7.58e+07
Step 16 : gram_loss = 5.87e+07, loss_total = 5.87e+07
Step 17 : gram_loss = 3.54e+07, loss_total = 3.54e+07
Step 18 : gram_loss = 2.67e+07, loss_total = 2.67e+07
Step 19 : gram_loss = 2.02e+07, loss_total = 2.02e+07
Step 20 : gram_loss = 1.79e+07, loss_total = 1.79e+07
Step 21 : gram_loss = 1.63e+07, loss_total = 1.63e+07
Step 22 : gram_loss = 1.36e+07, loss_total = 1.36e+07
Step 23 : gram_loss = 9.63e+06, loss_total = 9.63e+06
Step 24 : gram_loss = 7.59e+06, loss_total = 7.59e+06
Step 25 : gram_loss = 6.30e+06, loss_total = 6.30e+06
Step 26 : gram_loss = 6.07e+06, loss_total = 6.07e+06
Step 27 : gram_loss = 5.42e+06, loss_total = 5.42e+06
Step 28 : gram_loss = 5.00e+06, loss_total = 5.00e+06
Step 29 : gram_loss = 4.60e+06, loss_total = 4.60e+06
Step 30 : gram_loss = 3.84e+06, loss_total = 3.84e+06
Step 31 : gram_loss = 3.35e+06, loss_total = 3.35e+06
Step 32 : gram_loss = 2.67e+06, loss_total = 2.67e+06
Step 33 : gram_loss = 2.53e+06, loss_total = 2.53e+06
Step 34 : gram_loss = 2.36e+06, loss_total = 2.36e+06
Step 35 : gram_loss = 2.20e+06, loss_total = 2.20e+06
Step 36 : gram_loss = 1.96e+06, loss_total = 1.96e+06
Step 37 : gram_loss = 1.74e+06, loss_total = 1.74e+06
Step 38 : gram_loss = 1.58e+06, loss_total = 1.58e+06
Step 39 : gram_loss = 1.50e+06, loss_total = 1.50e+06
Step 40 : gram_loss = 1.38e+06, loss_total = 1.38e+06
Step 41 : gram_loss = 1.32e+06, loss_total = 1.32e+06
Step 42 : gram_loss = 1.24e+06, loss_total = 1.24e+06
Step 43 : gram_loss = 1.19e+06, loss_total = 1.19e+06
Step 44 : gram_loss = 1.14e+06, loss_total = 1.14e+06
Step 45 : gram_loss = 1.06e+06, loss_total = 1.06e+06
Step 46 : gram_loss = 9.51e+05, loss_total = 9.51e+05
Step 47 : gram_loss = 9.02e+05, loss_total = 9.02e+05
Step 48 : gram_loss = 8.59e+05, loss_total = 8.59e+05
Step 49 : gram_loss = 8.36e+05, loss_total = 8.36e+05
Step 50 : gram_loss = 7.85e+05, loss_total = 7.85e+05
Step 51 : gram_loss = 7.36e+05, loss_total = 7.36e+05
Step 52 : gram_loss = 6.90e+05, loss_total = 6.90e+05
Step 53 : gram_loss = 6.53e+05, loss_total = 6.53e+05
Step 54 : gram_loss = 6.26e+05, loss_total = 6.26e+05
Step 55 : gram_loss = 6.01e+05, loss_total = 6.01e+05
Step 56 : gram_loss = 5.84e+05, loss_total = 5.84e+05
Step 57 : gram_loss = 5.71e+05, loss_total = 5.71e+05
Step 58 : gram_loss = 5.51e+05, loss_total = 5.51e+05
Step 59 : gram_loss = 5.21e+05, loss_total = 5.21e+05
Step 60 : gram_loss = 5.02e+05, loss_total = 5.02e+05
Step 61 : gram_loss = 4.81e+05, loss_total = 4.81e+05
Step 62 : gram_loss = 4.69e+05, loss_total = 4.69e+05
Step 63 : gram_loss = 4.52e+05, loss_total = 4.52e+05
Step 64 : gram_loss = 4.42e+05, loss_total = 4.42e+05
Step 65 : gram_loss = 4.33e+05, loss_total = 4.33e+05
Step 66 : gram_loss = 4.24e+05, loss_total = 4.24e+05
Step 67 : gram_loss = 4.05e+05, loss_total = 4.05e+05
Step 68 : gram_loss = 3.91e+05, loss_total = 3.91e+05
Step 69 : gram_loss = 3.82e+05, loss_total = 3.82e+05
Step 70 : gram_loss = 3.75e+05, loss_total = 3.75e+05
Step 71 : gram_loss = 3.63e+05, loss_total = 3.63e+05
Step 72 : gram_loss = 3.50e+05, loss_total = 3.50e+05
Step 73 : gram_loss = 3.44e+05, loss_total = 3.44e+05
Step 74 : gram_loss = 3.34e+05, loss_total = 3.34e+05
Step 75 : gram_loss = 3.31e+05, loss_total = 3.31e+05
Step 76 : gram_loss = 3.24e+05, loss_total = 3.24e+05
Step 77 : gram_loss = 3.21e+05, loss_total = 3.21e+05
Step 78 : gram_loss = 3.17e+05, loss_total = 3.17e+05
Step 79 : gram_loss = 3.08e+05, loss_total = 3.08e+05
Step 80 : gram_loss = 3.02e+05, loss_total = 3.02e+05
Step 81 : gram_loss = 2.92e+05, loss_total = 2.92e+05
Step 82 : gram_loss = 2.86e+05, loss_total = 2.86e+05
Step 83 : gram_loss = 2.79e+05, loss_total = 2.79e+05
Step 84 : gram_loss = 2.75e+05, loss_total = 2.75e+05
Step 85 : gram_loss = 2.71e+05, loss_total = 2.71e+05
Step 86 : gram_loss = 2.68e+05, loss_total = 2.68e+05
Step 87 : gram_loss = 2.64e+05, loss_total = 2.64e+05
Step 88 : gram_loss = 2.61e+05, loss_total = 2.61e+05
Step 89 : gram_loss = 2.56e+05, loss_total = 2.56e+05
Step 90 : gram_loss = 2.50e+05, loss_total = 2.50e+05
Step 91 : gram_loss = 2.43e+05, loss_total = 2.43e+05
Step 92 : gram_loss = 2.37e+05, loss_total = 2.37e+05
Step 93 : gram_loss = 2.34e+05, loss_total = 2.34e+05
Step 94 : gram_loss = 2.31e+05, loss_total = 2.31e+05
Step 95 : gram_loss = 2.29e+05, loss_total = 2.29e+05
Step 96 : gram_loss = 2.26e+05, loss_total = 2.26e+05
Step 97 : gram_loss = 2.24e+05, loss_total = 2.24e+05
Step 98 : gram_loss = 2.22e+05, loss_total = 2.22e+05
Step 99 : gram_loss = 2.17e+05, loss_total = 2.17e+05
Step 100 : gram_loss = 2.13e+05, loss_total = 2.13e+05
Step 101 : gram_loss = 2.09e+05, loss_total = 2.09e+05
Step 102 : gram_loss = 2.06e+05, loss_total = 2.06e+05
Step 103 : gram_loss = 2.04e+05, loss_total = 2.04e+05
Step 104 : gram_loss = 2.01e+05, loss_total = 2.01e+05
Step 105 : gram_loss = 1.98e+05, loss_total = 1.98e+05
Step 106 : gram_loss = 1.96e+05, loss_total = 1.96e+05
Step 107 : gram_loss = 1.94e+05, loss_total = 1.94e+05
Step 108 : gram_loss = 1.91e+05, loss_total = 1.91e+05
Step 109 : gram_loss = 1.89e+05, loss_total = 1.89e+05
Step 110 : gram_loss = 1.86e+05, loss_total = 1.86e+05
Step 111 : gram_loss = 1.84e+05, loss_total = 1.84e+05
Step 112 : gram_loss = 1.84e+05, loss_total = 1.84e+05
Step 113 : gram_loss = 1.82e+05, loss_total = 1.82e+05
Step 114 : gram_loss = 1.81e+05, loss_total = 1.81e+05
Step 115 : gram_loss = 1.78e+05, loss_total = 1.78e+05
Step 116 : gram_loss = 1.76e+05, loss_total = 1.76e+05
Step 117 : gram_loss = 1.74e+05, loss_total = 1.74e+05
Step 118 : gram_loss = 1.72e+05, loss_total = 1.72e+05
Step 119 : gram_loss = 1.71e+05, loss_total = 1.71e+05
Step 120 : gram_loss = 1.69e+05, loss_total = 1.69e+05
Step 121 : gram_loss = 1.68e+05, loss_total = 1.68e+05
Step 122 : gram_loss = 1.67e+05, loss_total = 1.67e+05
Step 123 : gram_loss = 1.65e+05, loss_total = 1.65e+05
Step 124 : gram_loss = 1.62e+05, loss_total = 1.62e+05
Step 125 : gram_loss = 1.60e+05, loss_total = 1.60e+05
Step 126 : gram_loss = 1.59e+05, loss_total = 1.59e+05
Step 127 : gram_loss = 1.57e+05, loss_total = 1.57e+05
Step 128 : gram_loss = 1.56e+05, loss_total = 1.56e+05
Step 129 : gram_loss = 1.54e+05, loss_total = 1.54e+05
Step 130 : gram_loss = 1.53e+05, loss_total = 1.53e+05
Step 131 : gram_loss = 1.53e+05, loss_total = 1.53e+05
Step 132 : gram_loss = 1.51e+05, loss_total = 1.51e+05
Step 133 : gram_loss = 1.50e+05, loss_total = 1.50e+05
Step 134 : gram_loss = 1.49e+05, loss_total = 1.49e+05
Step 135 : gram_loss = 1.47e+05, loss_total = 1.47e+05
Step 136 : gram_loss = 1.46e+05, loss_total = 1.46e+05
Step 137 : gram_loss = 1.45e+05, loss_total = 1.45e+05
Step 138 : gram_loss = 1.45e+05, loss_total = 1.45e+05
Step 139 : gram_loss = 1.44e+05, loss_total = 1.44e+05
Step 140 : gram_loss = 1.43e+05, loss_total = 1.43e+05
Step 141 : gram_loss = 1.42e+05, loss_total = 1.42e+05
Step 142 : gram_loss = 1.41e+05, loss_total = 1.41e+05
Step 143 : gram_loss = 1.40e+05, loss_total = 1.40e+05
Step 144 : gram_loss = 1.39e+05, loss_total = 1.39e+05
Step 145 : gram_loss = 1.38e+05, loss_total = 1.38e+05
Step 146 : gram_loss = 1.37e+05, loss_total = 1.37e+05
Step 147 : gram_loss = 1.36e+05, loss_total = 1.36e+05
Step 148 : gram_loss = 1.35e+05, loss_total = 1.35e+05
Step 149 : gram_loss = 1.34e+05, loss_total = 1.34e+05
Step 150 : gram_loss = 1.33e+05, loss_total = 1.33e+05
Step 151 : gram_loss = 1.32e+05, loss_total = 1.32e+05
Step 152 : gram_loss = 1.31e+05, loss_total = 1.31e+05
Step 153 : gram_loss = 1.30e+05, loss_total = 1.30e+05
Step 154 : gram_loss = 1.29e+05, loss_total = 1.29e+05
Step 155 : gram_loss = 1.29e+05, loss_total = 1.29e+05
Step 156 : gram_loss = 1.28e+05, loss_total = 1.28e+05
Step 157 : gram_loss = 1.27e+05, loss_total = 1.27e+05
Step 158 : gram_loss = 1.27e+05, loss_total = 1.27e+05
Step 159 : gram_loss = 1.26e+05, loss_total = 1.26e+05
Step 160 : gram_loss = 1.26e+05, loss_total = 1.26e+05
Step 161 : gram_loss = 1.25e+05, loss_total = 1.25e+05
Step 162 : gram_loss = 1.24e+05, loss_total = 1.24e+05
Step 163 : gram_loss = 1.23e+05, loss_total = 1.23e+05
Step 164 : gram_loss = 1.23e+05, loss_total = 1.23e+05
Step 165 : gram_loss = 1.22e+05, loss_total = 1.22e+05
Step 166 : gram_loss = 1.22e+05, loss_total = 1.22e+05
Step 167 : gram_loss = 1.21e+05, loss_total = 1.21e+05
Step 168 : gram_loss = 1.20e+05, loss_total = 1.20e+05
Step 169 : gram_loss = 1.20e+05, loss_total = 1.20e+05
Step 170 : gram_loss = 1.19e+05, loss_total = 1.19e+05
Step 171 : gram_loss = 1.19e+05, loss_total = 1.19e+05
Step 172 : gram_loss = 1.18e+05, loss_total = 1.18e+05
Step 173 : gram_loss = 1.17e+05, loss_total = 1.17e+05
Step 174 : gram_loss = 1.17e+05, loss_total = 1.17e+05
Step 175 : gram_loss = 1.16e+05, loss_total = 1.16e+05
Step 176 : gram_loss = 1.15e+05, loss_total = 1.15e+05
Step 177 : gram_loss = 1.15e+05, loss_total = 1.15e+05
Step 178 : gram_loss = 1.15e+05, loss_total = 1.15e+05
Step 179 : gram_loss = 1.14e+05, loss_total = 1.14e+05
Step 180 : gram_loss = 1.13e+05, loss_total = 1.13e+05
Step 181 : gram_loss = 1.12e+05, loss_total = 1.12e+05
Step 182 : gram_loss = 1.12e+05, loss_total = 1.12e+05
Step 183 : gram_loss = 1.11e+05, loss_total = 1.11e+05
Step 184 : gram_loss = 1.11e+05, loss_total = 1.11e+05
Step 185 : gram_loss = 1.10e+05, loss_total = 1.10e+05
Step 186 : gram_loss = 1.09e+05, loss_total = 1.09e+05
Step 187 : gram_loss = 1.09e+05, loss_total = 1.09e+05
Step 188 : gram_loss = 1.09e+05, loss_total = 1.09e+05
Step 189 : gram_loss = 1.08e+05, loss_total = 1.08e+05
Step 190 : gram_loss = 1.08e+05, loss_total = 1.08e+05
Step 191 : gram_loss = 1.07e+05, loss_total = 1.07e+05
Step 192 : gram_loss = 1.07e+05, loss_total = 1.07e+05
Step 193 : gram_loss = 1.06e+05, loss_total = 1.06e+05
Step 194 : gram_loss = 1.06e+05, loss_total = 1.06e+05
Step 195 : gram_loss = 1.05e+05, loss_total = 1.05e+05
Step 196 : gram_loss = 1.05e+05, loss_total = 1.05e+05
Step 197 : gram_loss = 1.05e+05, loss_total = 1.05e+05
Step 198 : gram_loss = 1.04e+05, loss_total = 1.04e+05
Step 199 : gram_loss = 1.04e+05, loss_total = 1.04e+05
Step 200 : gram_loss = 1.04e+05, loss_total = 1.04e+05
Close Sess - End of the global optimization.
Computation total for  108.28219270706177  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0021_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0021_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0021_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0021_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0021_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0021_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.2355287075042725  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 4.79e+09, loss_total = 4.79e+09
Step 1 : gram_loss = 2.66e+09, loss_total = 2.66e+09
Step 2 : gram_loss = 1.69e+09, loss_total = 1.69e+09
Step 3 : gram_loss = 1.09e+09, loss_total = 1.09e+09
Step 4 : gram_loss = 6.16e+08, loss_total = 6.16e+08
Step 5 : gram_loss = 4.91e+08, loss_total = 4.91e+08
Step 6 : gram_loss = 3.45e+08, loss_total = 3.45e+08
Step 7 : gram_loss = 2.72e+08, loss_total = 2.72e+08
Step 8 : gram_loss = 2.19e+08, loss_total = 2.19e+08
Step 9 : gram_loss = 1.70e+08, loss_total = 1.70e+08
Step 10 : gram_loss = 1.27e+08, loss_total = 1.27e+08
Step 11 : gram_loss = 9.13e+07, loss_total = 9.13e+07
Step 12 : gram_loss = 7.48e+07, loss_total = 7.48e+07
Step 13 : gram_loss = 7.12e+07, loss_total = 7.12e+07
Step 14 : gram_loss = 6.21e+07, loss_total = 6.21e+07
Step 15 : gram_loss = 5.75e+07, loss_total = 5.75e+07
Step 16 : gram_loss = 5.47e+07, loss_total = 5.47e+07
Step 17 : gram_loss = 4.64e+07, loss_total = 4.64e+07
Step 18 : gram_loss = 3.89e+07, loss_total = 3.89e+07
Step 19 : gram_loss = 3.32e+07, loss_total = 3.32e+07
Step 20 : gram_loss = 3.00e+07, loss_total = 3.00e+07
Step 21 : gram_loss = 2.80e+07, loss_total = 2.80e+07
Step 22 : gram_loss = 2.61e+07, loss_total = 2.61e+07
Step 23 : gram_loss = 2.46e+07, loss_total = 2.46e+07
Step 24 : gram_loss = 2.09e+07, loss_total = 2.09e+07
Step 25 : gram_loss = 1.95e+07, loss_total = 1.95e+07
Step 26 : gram_loss = 1.85e+07, loss_total = 1.85e+07
Step 27 : gram_loss = 1.77e+07, loss_total = 1.77e+07
Step 28 : gram_loss = 1.69e+07, loss_total = 1.69e+07
Step 29 : gram_loss = 1.47e+07, loss_total = 1.47e+07
Step 30 : gram_loss = 1.37e+07, loss_total = 1.37e+07
Step 31 : gram_loss = 1.30e+07, loss_total = 1.30e+07
Step 32 : gram_loss = 1.25e+07, loss_total = 1.25e+07
Step 33 : gram_loss = 1.19e+07, loss_total = 1.19e+07
Step 34 : gram_loss = 1.09e+07, loss_total = 1.09e+07
Step 35 : gram_loss = 9.73e+06, loss_total = 9.73e+06
Step 36 : gram_loss = 8.85e+06, loss_total = 8.85e+06
Step 37 : gram_loss = 8.12e+06, loss_total = 8.12e+06
Step 38 : gram_loss = 7.67e+06, loss_total = 7.67e+06
Step 39 : gram_loss = 7.28e+06, loss_total = 7.28e+06
Step 40 : gram_loss = 7.02e+06, loss_total = 7.02e+06
Step 41 : gram_loss = 6.74e+06, loss_total = 6.74e+06
Step 42 : gram_loss = 6.44e+06, loss_total = 6.44e+06
Step 43 : gram_loss = 5.78e+06, loss_total = 5.78e+06
Step 44 : gram_loss = 5.24e+06, loss_total = 5.24e+06
Step 45 : gram_loss = 4.92e+06, loss_total = 4.92e+06
Step 46 : gram_loss = 4.59e+06, loss_total = 4.59e+06
Step 47 : gram_loss = 4.27e+06, loss_total = 4.27e+06
Step 48 : gram_loss = 3.81e+06, loss_total = 3.81e+06
Step 49 : gram_loss = 3.43e+06, loss_total = 3.43e+06
Step 50 : gram_loss = 3.27e+06, loss_total = 3.27e+06
Step 51 : gram_loss = 3.12e+06, loss_total = 3.12e+06
Step 52 : gram_loss = 2.83e+06, loss_total = 2.83e+06
Step 53 : gram_loss = 2.67e+06, loss_total = 2.67e+06
Step 54 : gram_loss = 2.50e+06, loss_total = 2.50e+06
Step 55 : gram_loss = 2.33e+06, loss_total = 2.33e+06
Step 56 : gram_loss = 2.21e+06, loss_total = 2.21e+06
Step 57 : gram_loss = 2.12e+06, loss_total = 2.12e+06
Step 58 : gram_loss = 2.02e+06, loss_total = 2.02e+06
Step 59 : gram_loss = 1.91e+06, loss_total = 1.91e+06
Step 60 : gram_loss = 1.84e+06, loss_total = 1.84e+06
Step 61 : gram_loss = 1.77e+06, loss_total = 1.77e+06
Step 62 : gram_loss = 1.72e+06, loss_total = 1.72e+06
Step 63 : gram_loss = 1.67e+06, loss_total = 1.67e+06
Step 64 : gram_loss = 1.61e+06, loss_total = 1.61e+06
Step 65 : gram_loss = 1.56e+06, loss_total = 1.56e+06
Step 66 : gram_loss = 1.50e+06, loss_total = 1.50e+06
Step 67 : gram_loss = 1.46e+06, loss_total = 1.46e+06
Step 68 : gram_loss = 1.40e+06, loss_total = 1.40e+06
Step 69 : gram_loss = 1.36e+06, loss_total = 1.36e+06
Step 70 : gram_loss = 1.30e+06, loss_total = 1.30e+06
Step 71 : gram_loss = 1.26e+06, loss_total = 1.26e+06
Step 72 : gram_loss = 1.22e+06, loss_total = 1.22e+06
Step 73 : gram_loss = 1.18e+06, loss_total = 1.18e+06
Step 74 : gram_loss = 1.16e+06, loss_total = 1.16e+06
Step 75 : gram_loss = 1.13e+06, loss_total = 1.13e+06
Step 76 : gram_loss = 1.12e+06, loss_total = 1.12e+06
Step 77 : gram_loss = 1.09e+06, loss_total = 1.09e+06
Step 78 : gram_loss = 1.04e+06, loss_total = 1.04e+06
Step 79 : gram_loss = 1.01e+06, loss_total = 1.01e+06
Step 80 : gram_loss = 9.86e+05, loss_total = 9.86e+05
Step 81 : gram_loss = 9.68e+05, loss_total = 9.68e+05
Step 82 : gram_loss = 9.45e+05, loss_total = 9.45e+05
Step 83 : gram_loss = 9.36e+05, loss_total = 9.36e+05
Step 84 : gram_loss = 9.06e+05, loss_total = 9.06e+05
Step 85 : gram_loss = 8.96e+05, loss_total = 8.96e+05
Step 86 : gram_loss = 8.84e+05, loss_total = 8.84e+05
Step 87 : gram_loss = 8.70e+05, loss_total = 8.70e+05
Step 88 : gram_loss = 8.62e+05, loss_total = 8.62e+05
Step 89 : gram_loss = 8.43e+05, loss_total = 8.43e+05
Step 90 : gram_loss = 8.25e+05, loss_total = 8.25e+05
Step 91 : gram_loss = 8.05e+05, loss_total = 8.05e+05
Step 92 : gram_loss = 7.90e+05, loss_total = 7.90e+05
Step 93 : gram_loss = 7.76e+05, loss_total = 7.76e+05
Step 94 : gram_loss = 7.66e+05, loss_total = 7.66e+05
Step 95 : gram_loss = 7.59e+05, loss_total = 7.59e+05
Step 96 : gram_loss = 7.42e+05, loss_total = 7.42e+05
Step 97 : gram_loss = 7.33e+05, loss_total = 7.33e+05
Step 98 : gram_loss = 7.21e+05, loss_total = 7.21e+05
Step 99 : gram_loss = 7.02e+05, loss_total = 7.02e+05
Step 100 : gram_loss = 6.85e+05, loss_total = 6.85e+05
Step 101 : gram_loss = 6.75e+05, loss_total = 6.75e+05
Step 102 : gram_loss = 6.65e+05, loss_total = 6.65e+05
Step 103 : gram_loss = 6.54e+05, loss_total = 6.54e+05
Step 104 : gram_loss = 6.43e+05, loss_total = 6.43e+05
Step 105 : gram_loss = 6.35e+05, loss_total = 6.35e+05
Step 106 : gram_loss = 6.31e+05, loss_total = 6.31e+05
Step 107 : gram_loss = 6.26e+05, loss_total = 6.26e+05
Step 108 : gram_loss = 6.21e+05, loss_total = 6.21e+05
Step 109 : gram_loss = 6.10e+05, loss_total = 6.10e+05
Step 110 : gram_loss = 5.98e+05, loss_total = 5.98e+05
Step 111 : gram_loss = 5.89e+05, loss_total = 5.89e+05
Step 112 : gram_loss = 5.84e+05, loss_total = 5.84e+05
Step 113 : gram_loss = 5.81e+05, loss_total = 5.81e+05
Step 114 : gram_loss = 5.77e+05, loss_total = 5.77e+05
Step 115 : gram_loss = 5.68e+05, loss_total = 5.68e+05
Step 116 : gram_loss = 5.66e+05, loss_total = 5.66e+05
Step 117 : gram_loss = 5.55e+05, loss_total = 5.55e+05
Step 118 : gram_loss = 5.51e+05, loss_total = 5.51e+05
Step 119 : gram_loss = 5.46e+05, loss_total = 5.46e+05
Step 120 : gram_loss = 5.38e+05, loss_total = 5.38e+05
Step 121 : gram_loss = 5.30e+05, loss_total = 5.30e+05
Step 122 : gram_loss = 5.22e+05, loss_total = 5.22e+05
Step 123 : gram_loss = 5.19e+05, loss_total = 5.19e+05
Step 124 : gram_loss = 5.12e+05, loss_total = 5.12e+05
Step 125 : gram_loss = 5.11e+05, loss_total = 5.11e+05
Step 126 : gram_loss = 5.04e+05, loss_total = 5.04e+05
Step 127 : gram_loss = 5.01e+05, loss_total = 5.01e+05
Step 128 : gram_loss = 4.99e+05, loss_total = 4.99e+05
Step 129 : gram_loss = 4.96e+05, loss_total = 4.96e+05
Step 130 : gram_loss = 4.93e+05, loss_total = 4.93e+05
Step 131 : gram_loss = 4.91e+05, loss_total = 4.91e+05
Step 132 : gram_loss = 4.86e+05, loss_total = 4.86e+05
Step 133 : gram_loss = 4.80e+05, loss_total = 4.80e+05
Step 134 : gram_loss = 4.76e+05, loss_total = 4.76e+05
Step 135 : gram_loss = 4.73e+05, loss_total = 4.73e+05
Step 136 : gram_loss = 4.70e+05, loss_total = 4.70e+05
Step 137 : gram_loss = 4.67e+05, loss_total = 4.67e+05
Step 138 : gram_loss = 4.61e+05, loss_total = 4.61e+05
Step 139 : gram_loss = 4.58e+05, loss_total = 4.58e+05
Step 140 : gram_loss = 4.55e+05, loss_total = 4.55e+05
Step 141 : gram_loss = 4.53e+05, loss_total = 4.53e+05
Step 142 : gram_loss = 4.50e+05, loss_total = 4.50e+05
Step 143 : gram_loss = 4.47e+05, loss_total = 4.47e+05
Step 144 : gram_loss = 4.42e+05, loss_total = 4.42e+05
Step 145 : gram_loss = 4.39e+05, loss_total = 4.39e+05
Step 146 : gram_loss = 4.36e+05, loss_total = 4.36e+05
Step 147 : gram_loss = 4.32e+05, loss_total = 4.32e+05
Step 148 : gram_loss = 4.29e+05, loss_total = 4.29e+05
Step 149 : gram_loss = 4.25e+05, loss_total = 4.25e+05
Step 150 : gram_loss = 4.23e+05, loss_total = 4.23e+05
Step 151 : gram_loss = 4.22e+05, loss_total = 4.22e+05
Step 152 : gram_loss = 4.20e+05, loss_total = 4.20e+05
Step 153 : gram_loss = 4.19e+05, loss_total = 4.19e+05
Step 154 : gram_loss = 4.15e+05, loss_total = 4.15e+05
Step 155 : gram_loss = 4.12e+05, loss_total = 4.12e+05
Step 156 : gram_loss = 4.10e+05, loss_total = 4.10e+05
Step 157 : gram_loss = 4.06e+05, loss_total = 4.06e+05
Step 158 : gram_loss = 4.05e+05, loss_total = 4.05e+05
Step 159 : gram_loss = 4.02e+05, loss_total = 4.02e+05
Step 160 : gram_loss = 3.99e+05, loss_total = 3.99e+05
Step 161 : gram_loss = 3.96e+05, loss_total = 3.96e+05
Step 162 : gram_loss = 3.94e+05, loss_total = 3.94e+05
Step 163 : gram_loss = 3.92e+05, loss_total = 3.92e+05
Step 164 : gram_loss = 3.90e+05, loss_total = 3.90e+05
Step 165 : gram_loss = 3.88e+05, loss_total = 3.88e+05
Step 166 : gram_loss = 3.86e+05, loss_total = 3.86e+05
Step 167 : gram_loss = 3.84e+05, loss_total = 3.84e+05
Step 168 : gram_loss = 3.81e+05, loss_total = 3.81e+05
Step 169 : gram_loss = 3.79e+05, loss_total = 3.79e+05
Step 170 : gram_loss = 3.77e+05, loss_total = 3.77e+05
Step 171 : gram_loss = 3.75e+05, loss_total = 3.75e+05
Step 172 : gram_loss = 3.72e+05, loss_total = 3.72e+05
Step 173 : gram_loss = 3.71e+05, loss_total = 3.71e+05
Step 174 : gram_loss = 3.70e+05, loss_total = 3.70e+05
Step 175 : gram_loss = 3.69e+05, loss_total = 3.69e+05
Step 176 : gram_loss = 3.67e+05, loss_total = 3.67e+05
Step 177 : gram_loss = 3.65e+05, loss_total = 3.65e+05
Step 178 : gram_loss = 3.63e+05, loss_total = 3.63e+05
Step 179 : gram_loss = 3.61e+05, loss_total = 3.61e+05
Step 180 : gram_loss = 3.60e+05, loss_total = 3.60e+05
Step 181 : gram_loss = 3.58e+05, loss_total = 3.58e+05
Step 182 : gram_loss = 3.57e+05, loss_total = 3.57e+05
Step 183 : gram_loss = 3.54e+05, loss_total = 3.54e+05
Step 184 : gram_loss = 3.53e+05, loss_total = 3.53e+05
Step 185 : gram_loss = 3.51e+05, loss_total = 3.51e+05
Step 186 : gram_loss = 3.49e+05, loss_total = 3.49e+05
Step 187 : gram_loss = 3.48e+05, loss_total = 3.48e+05
Step 188 : gram_loss = 3.46e+05, loss_total = 3.46e+05
Step 189 : gram_loss = 3.44e+05, loss_total = 3.44e+05
Step 190 : gram_loss = 3.43e+05, loss_total = 3.43e+05
Step 191 : gram_loss = 3.41e+05, loss_total = 3.41e+05
Step 192 : gram_loss = 3.40e+05, loss_total = 3.40e+05
Step 193 : gram_loss = 3.39e+05, loss_total = 3.39e+05
Step 194 : gram_loss = 3.37e+05, loss_total = 3.37e+05
Step 195 : gram_loss = 3.37e+05, loss_total = 3.37e+05
Step 196 : gram_loss = 3.36e+05, loss_total = 3.36e+05
Step 197 : gram_loss = 3.35e+05, loss_total = 3.35e+05
Step 198 : gram_loss = 3.34e+05, loss_total = 3.34e+05
Step 199 : gram_loss = 3.33e+05, loss_total = 3.33e+05
Step 200 : gram_loss = 3.31e+05, loss_total = 3.31e+05
Close Sess - End of the global optimization.
Computation total for  107.42577815055847  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0005_1_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0005_1_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0005_1_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0005_1_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0005_1_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0005_1_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.174267530441284  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 4.57e+09, loss_total = 4.57e+09
Step 1 : gram_loss = 3.10e+09, loss_total = 3.10e+09
Step 2 : gram_loss = 3.06e+09, loss_total = 3.06e+09
Step 3 : gram_loss = 1.22e+09, loss_total = 1.22e+09
Step 4 : gram_loss = 3.61e+08, loss_total = 3.61e+08
Step 5 : gram_loss = 3.06e+08, loss_total = 3.06e+08
Step 6 : gram_loss = 2.52e+08, loss_total = 2.52e+08
Step 7 : gram_loss = 2.00e+08, loss_total = 2.00e+08
Step 8 : gram_loss = 1.69e+08, loss_total = 1.69e+08
Step 9 : gram_loss = 1.21e+08, loss_total = 1.21e+08
Step 10 : gram_loss = 9.06e+07, loss_total = 9.06e+07
Step 11 : gram_loss = 7.08e+07, loss_total = 7.08e+07
Step 12 : gram_loss = 5.05e+07, loss_total = 5.05e+07
Step 13 : gram_loss = 4.22e+07, loss_total = 4.22e+07
Step 14 : gram_loss = 3.38e+07, loss_total = 3.38e+07
Step 15 : gram_loss = 3.13e+07, loss_total = 3.13e+07
Step 16 : gram_loss = 2.89e+07, loss_total = 2.89e+07
Step 17 : gram_loss = 2.49e+07, loss_total = 2.49e+07
Step 18 : gram_loss = 1.95e+07, loss_total = 1.95e+07
Step 19 : gram_loss = 1.61e+07, loss_total = 1.61e+07
Step 20 : gram_loss = 1.44e+07, loss_total = 1.44e+07
Step 21 : gram_loss = 1.30e+07, loss_total = 1.30e+07
Step 22 : gram_loss = 1.17e+07, loss_total = 1.17e+07
Step 23 : gram_loss = 9.14e+06, loss_total = 9.14e+06
Step 24 : gram_loss = 8.15e+06, loss_total = 8.15e+06
Step 25 : gram_loss = 7.68e+06, loss_total = 7.68e+06
Step 26 : gram_loss = 6.93e+06, loss_total = 6.93e+06
Step 27 : gram_loss = 6.27e+06, loss_total = 6.27e+06
Step 28 : gram_loss = 5.44e+06, loss_total = 5.44e+06
Step 29 : gram_loss = 4.70e+06, loss_total = 4.70e+06
Step 30 : gram_loss = 4.28e+06, loss_total = 4.28e+06
Step 31 : gram_loss = 4.11e+06, loss_total = 4.11e+06
Step 32 : gram_loss = 3.95e+06, loss_total = 3.95e+06
Step 33 : gram_loss = 3.49e+06, loss_total = 3.49e+06
Step 34 : gram_loss = 3.12e+06, loss_total = 3.12e+06
Step 35 : gram_loss = 2.80e+06, loss_total = 2.80e+06
Step 36 : gram_loss = 2.61e+06, loss_total = 2.61e+06
Step 37 : gram_loss = 2.46e+06, loss_total = 2.46e+06
Step 38 : gram_loss = 2.40e+06, loss_total = 2.40e+06
Step 39 : gram_loss = 2.33e+06, loss_total = 2.33e+06
Step 40 : gram_loss = 2.09e+06, loss_total = 2.09e+06
Step 41 : gram_loss = 1.92e+06, loss_total = 1.92e+06
Step 42 : gram_loss = 1.76e+06, loss_total = 1.76e+06
Step 43 : gram_loss = 1.67e+06, loss_total = 1.67e+06
Step 44 : gram_loss = 1.59e+06, loss_total = 1.59e+06
Step 45 : gram_loss = 1.52e+06, loss_total = 1.52e+06
Step 46 : gram_loss = 1.46e+06, loss_total = 1.46e+06
Step 47 : gram_loss = 1.39e+06, loss_total = 1.39e+06
Step 48 : gram_loss = 1.35e+06, loss_total = 1.35e+06
Step 49 : gram_loss = 1.22e+06, loss_total = 1.22e+06
Step 50 : gram_loss = 1.11e+06, loss_total = 1.11e+06
Step 51 : gram_loss = 1.03e+06, loss_total = 1.03e+06
Step 52 : gram_loss = 1.01e+06, loss_total = 1.01e+06
Step 53 : gram_loss = 9.67e+05, loss_total = 9.67e+05
Step 54 : gram_loss = 9.47e+05, loss_total = 9.47e+05
Step 55 : gram_loss = 9.11e+05, loss_total = 9.11e+05
Step 56 : gram_loss = 8.64e+05, loss_total = 8.64e+05
Step 57 : gram_loss = 7.92e+05, loss_total = 7.92e+05
Step 58 : gram_loss = 7.32e+05, loss_total = 7.32e+05
Step 59 : gram_loss = 6.94e+05, loss_total = 6.94e+05
Step 60 : gram_loss = 6.74e+05, loss_total = 6.74e+05
Step 61 : gram_loss = 6.41e+05, loss_total = 6.41e+05
Step 62 : gram_loss = 6.06e+05, loss_total = 6.06e+05
Step 63 : gram_loss = 5.69e+05, loss_total = 5.69e+05
Step 64 : gram_loss = 5.42e+05, loss_total = 5.42e+05
Step 65 : gram_loss = 5.33e+05, loss_total = 5.33e+05
Step 66 : gram_loss = 5.21e+05, loss_total = 5.21e+05
Step 67 : gram_loss = 5.07e+05, loss_total = 5.07e+05
Step 68 : gram_loss = 4.86e+05, loss_total = 4.86e+05
Step 69 : gram_loss = 4.71e+05, loss_total = 4.71e+05
Step 70 : gram_loss = 4.54e+05, loss_total = 4.54e+05
Step 71 : gram_loss = 4.34e+05, loss_total = 4.34e+05
Step 72 : gram_loss = 4.17e+05, loss_total = 4.17e+05
Step 73 : gram_loss = 3.96e+05, loss_total = 3.96e+05
Step 74 : gram_loss = 3.87e+05, loss_total = 3.87e+05
Step 75 : gram_loss = 3.70e+05, loss_total = 3.70e+05
Step 76 : gram_loss = 3.61e+05, loss_total = 3.61e+05
Step 77 : gram_loss = 3.49e+05, loss_total = 3.49e+05
Step 78 : gram_loss = 3.30e+05, loss_total = 3.30e+05
Step 79 : gram_loss = 3.25e+05, loss_total = 3.25e+05
Step 80 : gram_loss = 3.09e+05, loss_total = 3.09e+05
Step 81 : gram_loss = 3.04e+05, loss_total = 3.04e+05
Step 82 : gram_loss = 2.97e+05, loss_total = 2.97e+05
Step 83 : gram_loss = 2.89e+05, loss_total = 2.89e+05
Step 84 : gram_loss = 2.76e+05, loss_total = 2.76e+05
Step 85 : gram_loss = 2.62e+05, loss_total = 2.62e+05
Step 86 : gram_loss = 2.50e+05, loss_total = 2.50e+05
Step 87 : gram_loss = 2.41e+05, loss_total = 2.41e+05
Step 88 : gram_loss = 2.36e+05, loss_total = 2.36e+05
Step 89 : gram_loss = 2.30e+05, loss_total = 2.30e+05
Step 90 : gram_loss = 2.25e+05, loss_total = 2.25e+05
Step 91 : gram_loss = 2.19e+05, loss_total = 2.19e+05
Step 92 : gram_loss = 2.09e+05, loss_total = 2.09e+05
Step 93 : gram_loss = 2.04e+05, loss_total = 2.04e+05
Step 94 : gram_loss = 2.00e+05, loss_total = 2.00e+05
Step 95 : gram_loss = 1.94e+05, loss_total = 1.94e+05
Step 96 : gram_loss = 1.91e+05, loss_total = 1.91e+05
Step 97 : gram_loss = 1.87e+05, loss_total = 1.87e+05
Step 98 : gram_loss = 1.83e+05, loss_total = 1.83e+05
Step 99 : gram_loss = 1.79e+05, loss_total = 1.79e+05
Step 100 : gram_loss = 1.71e+05, loss_total = 1.71e+05
Step 101 : gram_loss = 1.66e+05, loss_total = 1.66e+05
Step 102 : gram_loss = 1.62e+05, loss_total = 1.62e+05
Step 103 : gram_loss = 1.60e+05, loss_total = 1.60e+05
Step 104 : gram_loss = 1.58e+05, loss_total = 1.58e+05
Step 105 : gram_loss = 1.53e+05, loss_total = 1.53e+05
Step 106 : gram_loss = 1.49e+05, loss_total = 1.49e+05
Step 107 : gram_loss = 1.46e+05, loss_total = 1.46e+05
Step 108 : gram_loss = 1.44e+05, loss_total = 1.44e+05
Step 109 : gram_loss = 1.40e+05, loss_total = 1.40e+05
Step 110 : gram_loss = 1.37e+05, loss_total = 1.37e+05
Step 111 : gram_loss = 1.34e+05, loss_total = 1.34e+05
Step 112 : gram_loss = 1.32e+05, loss_total = 1.32e+05
Step 113 : gram_loss = 1.30e+05, loss_total = 1.30e+05
Step 114 : gram_loss = 1.26e+05, loss_total = 1.26e+05
Step 115 : gram_loss = 1.24e+05, loss_total = 1.24e+05
Step 116 : gram_loss = 1.22e+05, loss_total = 1.22e+05
Step 117 : gram_loss = 1.20e+05, loss_total = 1.20e+05
Step 118 : gram_loss = 1.17e+05, loss_total = 1.17e+05
Step 119 : gram_loss = 1.15e+05, loss_total = 1.15e+05
Step 120 : gram_loss = 1.13e+05, loss_total = 1.13e+05
Step 121 : gram_loss = 1.13e+05, loss_total = 1.13e+05
Step 122 : gram_loss = 1.10e+05, loss_total = 1.10e+05
Step 123 : gram_loss = 1.08e+05, loss_total = 1.08e+05
Step 124 : gram_loss = 1.06e+05, loss_total = 1.06e+05
Step 125 : gram_loss = 1.04e+05, loss_total = 1.04e+05
Step 126 : gram_loss = 1.03e+05, loss_total = 1.03e+05
Step 127 : gram_loss = 1.01e+05, loss_total = 1.01e+05
Step 128 : gram_loss = 1.00e+05, loss_total = 1.00e+05
Step 129 : gram_loss = 9.93e+04, loss_total = 9.93e+04
Step 130 : gram_loss = 9.82e+04, loss_total = 9.82e+04
Step 131 : gram_loss = 9.72e+04, loss_total = 9.72e+04
Step 132 : gram_loss = 9.50e+04, loss_total = 9.50e+04
Step 133 : gram_loss = 9.31e+04, loss_total = 9.31e+04
Step 134 : gram_loss = 9.17e+04, loss_total = 9.17e+04
Step 135 : gram_loss = 8.97e+04, loss_total = 8.97e+04
Step 136 : gram_loss = 8.87e+04, loss_total = 8.87e+04
Step 137 : gram_loss = 8.77e+04, loss_total = 8.77e+04
Step 138 : gram_loss = 8.69e+04, loss_total = 8.69e+04
Step 139 : gram_loss = 8.62e+04, loss_total = 8.62e+04
Step 140 : gram_loss = 8.57e+04, loss_total = 8.57e+04
Step 141 : gram_loss = 8.38e+04, loss_total = 8.38e+04
Step 142 : gram_loss = 8.30e+04, loss_total = 8.30e+04
Step 143 : gram_loss = 8.16e+04, loss_total = 8.16e+04
Step 144 : gram_loss = 8.05e+04, loss_total = 8.05e+04
Step 145 : gram_loss = 7.98e+04, loss_total = 7.98e+04
Step 146 : gram_loss = 7.91e+04, loss_total = 7.91e+04
Step 147 : gram_loss = 7.83e+04, loss_total = 7.83e+04
Step 148 : gram_loss = 7.77e+04, loss_total = 7.77e+04
Step 149 : gram_loss = 7.66e+04, loss_total = 7.66e+04
Step 150 : gram_loss = 7.60e+04, loss_total = 7.60e+04
Step 151 : gram_loss = 7.52e+04, loss_total = 7.52e+04
Step 152 : gram_loss = 7.44e+04, loss_total = 7.44e+04
Step 153 : gram_loss = 7.33e+04, loss_total = 7.33e+04
Step 154 : gram_loss = 7.24e+04, loss_total = 7.24e+04
Step 155 : gram_loss = 7.15e+04, loss_total = 7.15e+04
Step 156 : gram_loss = 7.08e+04, loss_total = 7.08e+04
Step 157 : gram_loss = 6.99e+04, loss_total = 6.99e+04
Step 158 : gram_loss = 6.96e+04, loss_total = 6.96e+04
Step 159 : gram_loss = 6.87e+04, loss_total = 6.87e+04
Step 160 : gram_loss = 6.82e+04, loss_total = 6.82e+04
Step 161 : gram_loss = 6.76e+04, loss_total = 6.76e+04
Step 162 : gram_loss = 6.69e+04, loss_total = 6.69e+04
Step 163 : gram_loss = 6.61e+04, loss_total = 6.61e+04
Step 164 : gram_loss = 6.55e+04, loss_total = 6.55e+04
Step 165 : gram_loss = 6.49e+04, loss_total = 6.49e+04
Step 166 : gram_loss = 6.43e+04, loss_total = 6.43e+04
Step 167 : gram_loss = 6.35e+04, loss_total = 6.35e+04
Step 168 : gram_loss = 6.32e+04, loss_total = 6.32e+04
Step 169 : gram_loss = 6.27e+04, loss_total = 6.27e+04
Step 170 : gram_loss = 6.18e+04, loss_total = 6.18e+04
Step 171 : gram_loss = 6.10e+04, loss_total = 6.10e+04
Step 172 : gram_loss = 6.04e+04, loss_total = 6.04e+04
Step 173 : gram_loss = 5.96e+04, loss_total = 5.96e+04
Step 174 : gram_loss = 5.90e+04, loss_total = 5.90e+04
Step 175 : gram_loss = 5.86e+04, loss_total = 5.86e+04
Step 176 : gram_loss = 5.82e+04, loss_total = 5.82e+04
Step 177 : gram_loss = 5.74e+04, loss_total = 5.74e+04
Step 178 : gram_loss = 5.71e+04, loss_total = 5.71e+04
Step 179 : gram_loss = 5.64e+04, loss_total = 5.64e+04
Step 180 : gram_loss = 5.62e+04, loss_total = 5.62e+04
Step 181 : gram_loss = 5.57e+04, loss_total = 5.57e+04
Step 182 : gram_loss = 5.55e+04, loss_total = 5.55e+04
Step 183 : gram_loss = 5.51e+04, loss_total = 5.51e+04
Step 184 : gram_loss = 5.46e+04, loss_total = 5.46e+04
Step 185 : gram_loss = 5.42e+04, loss_total = 5.42e+04
Step 186 : gram_loss = 5.35e+04, loss_total = 5.35e+04
Step 187 : gram_loss = 5.31e+04, loss_total = 5.31e+04
Step 188 : gram_loss = 5.29e+04, loss_total = 5.29e+04
Step 189 : gram_loss = 5.25e+04, loss_total = 5.25e+04
Step 190 : gram_loss = 5.23e+04, loss_total = 5.23e+04
Step 191 : gram_loss = 5.19e+04, loss_total = 5.19e+04
Step 192 : gram_loss = 5.14e+04, loss_total = 5.14e+04
Step 193 : gram_loss = 5.07e+04, loss_total = 5.07e+04
Step 194 : gram_loss = 5.01e+04, loss_total = 5.01e+04
Step 195 : gram_loss = 5.00e+04, loss_total = 5.00e+04
Step 196 : gram_loss = 4.94e+04, loss_total = 4.94e+04
Step 197 : gram_loss = 4.92e+04, loss_total = 4.92e+04
Step 198 : gram_loss = 4.89e+04, loss_total = 4.89e+04
Step 199 : gram_loss = 4.87e+04, loss_total = 4.87e+04
Step 200 : gram_loss = 4.84e+04, loss_total = 4.84e+04
Close Sess - End of the global optimization.
Computation total for  108.34581470489502  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0047_1_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0047_1_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0047_1_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0047_1_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0047_1_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0047_1_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.208873987197876  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 3.10e+09, loss_total = 3.10e+09
Step 1 : gram_loss = 1.58e+09, loss_total = 1.58e+09
Step 2 : gram_loss = 1.52e+09, loss_total = 1.52e+09
Step 3 : gram_loss = 1.18e+09, loss_total = 1.18e+09
Step 4 : gram_loss = 6.57e+08, loss_total = 6.57e+08
Step 5 : gram_loss = 4.18e+08, loss_total = 4.18e+08
Step 6 : gram_loss = 3.64e+08, loss_total = 3.64e+08
Step 7 : gram_loss = 2.56e+08, loss_total = 2.56e+08
Step 8 : gram_loss = 1.75e+08, loss_total = 1.75e+08
Step 9 : gram_loss = 1.23e+08, loss_total = 1.23e+08
Step 10 : gram_loss = 1.03e+08, loss_total = 1.03e+08
Step 11 : gram_loss = 8.60e+07, loss_total = 8.60e+07
Step 12 : gram_loss = 7.09e+07, loss_total = 7.09e+07
Step 13 : gram_loss = 4.81e+07, loss_total = 4.81e+07
Step 14 : gram_loss = 3.98e+07, loss_total = 3.98e+07
Step 15 : gram_loss = 2.93e+07, loss_total = 2.93e+07
Step 16 : gram_loss = 2.71e+07, loss_total = 2.71e+07
Step 17 : gram_loss = 2.49e+07, loss_total = 2.49e+07
Step 18 : gram_loss = 2.19e+07, loss_total = 2.19e+07
Step 19 : gram_loss = 2.03e+07, loss_total = 2.03e+07
Step 20 : gram_loss = 1.87e+07, loss_total = 1.87e+07
Step 21 : gram_loss = 1.51e+07, loss_total = 1.51e+07
Step 22 : gram_loss = 1.22e+07, loss_total = 1.22e+07
Step 23 : gram_loss = 1.06e+07, loss_total = 1.06e+07
Step 24 : gram_loss = 9.74e+06, loss_total = 9.74e+06
Step 25 : gram_loss = 9.10e+06, loss_total = 9.10e+06
Step 26 : gram_loss = 8.47e+06, loss_total = 8.47e+06
Step 27 : gram_loss = 7.96e+06, loss_total = 7.96e+06
Step 28 : gram_loss = 7.27e+06, loss_total = 7.27e+06
Step 29 : gram_loss = 6.46e+06, loss_total = 6.46e+06
Step 30 : gram_loss = 5.84e+06, loss_total = 5.84e+06
Step 31 : gram_loss = 5.58e+06, loss_total = 5.58e+06
Step 32 : gram_loss = 5.30e+06, loss_total = 5.30e+06
Step 33 : gram_loss = 5.07e+06, loss_total = 5.07e+06
Step 34 : gram_loss = 4.70e+06, loss_total = 4.70e+06
Step 35 : gram_loss = 4.55e+06, loss_total = 4.55e+06
Step 36 : gram_loss = 4.27e+06, loss_total = 4.27e+06
Step 37 : gram_loss = 4.13e+06, loss_total = 4.13e+06
Step 38 : gram_loss = 3.90e+06, loss_total = 3.90e+06
Step 39 : gram_loss = 3.74e+06, loss_total = 3.74e+06
Step 40 : gram_loss = 3.53e+06, loss_total = 3.53e+06
Step 41 : gram_loss = 3.35e+06, loss_total = 3.35e+06
Step 42 : gram_loss = 3.21e+06, loss_total = 3.21e+06
Step 43 : gram_loss = 3.08e+06, loss_total = 3.08e+06
Step 44 : gram_loss = 2.99e+06, loss_total = 2.99e+06
Step 45 : gram_loss = 2.88e+06, loss_total = 2.88e+06
Step 46 : gram_loss = 2.80e+06, loss_total = 2.80e+06
Step 47 : gram_loss = 2.71e+06, loss_total = 2.71e+06
Step 48 : gram_loss = 2.54e+06, loss_total = 2.54e+06
Step 49 : gram_loss = 2.45e+06, loss_total = 2.45e+06
Step 50 : gram_loss = 2.35e+06, loss_total = 2.35e+06
Step 51 : gram_loss = 2.30e+06, loss_total = 2.30e+06
Step 52 : gram_loss = 2.22e+06, loss_total = 2.22e+06
Step 53 : gram_loss = 2.13e+06, loss_total = 2.13e+06
Step 54 : gram_loss = 2.01e+06, loss_total = 2.01e+06
Step 55 : gram_loss = 1.96e+06, loss_total = 1.96e+06
Step 56 : gram_loss = 1.91e+06, loss_total = 1.91e+06
Step 57 : gram_loss = 1.84e+06, loss_total = 1.84e+06
Step 58 : gram_loss = 1.83e+06, loss_total = 1.83e+06
Step 59 : gram_loss = 1.73e+06, loss_total = 1.73e+06
Step 60 : gram_loss = 1.70e+06, loss_total = 1.70e+06
Step 61 : gram_loss = 1.67e+06, loss_total = 1.67e+06
Step 62 : gram_loss = 1.61e+06, loss_total = 1.61e+06
Step 63 : gram_loss = 1.54e+06, loss_total = 1.54e+06
Step 64 : gram_loss = 1.50e+06, loss_total = 1.50e+06
Step 65 : gram_loss = 1.45e+06, loss_total = 1.45e+06
Step 66 : gram_loss = 1.43e+06, loss_total = 1.43e+06
Step 67 : gram_loss = 1.41e+06, loss_total = 1.41e+06
Step 68 : gram_loss = 1.38e+06, loss_total = 1.38e+06
Step 69 : gram_loss = 1.33e+06, loss_total = 1.33e+06
Step 70 : gram_loss = 1.29e+06, loss_total = 1.29e+06
Step 71 : gram_loss = 1.24e+06, loss_total = 1.24e+06
Step 72 : gram_loss = 1.21e+06, loss_total = 1.21e+06
Step 73 : gram_loss = 1.19e+06, loss_total = 1.19e+06
Step 74 : gram_loss = 1.18e+06, loss_total = 1.18e+06
Step 75 : gram_loss = 1.16e+06, loss_total = 1.16e+06
Step 76 : gram_loss = 1.14e+06, loss_total = 1.14e+06
Step 77 : gram_loss = 1.11e+06, loss_total = 1.11e+06
Step 78 : gram_loss = 1.09e+06, loss_total = 1.09e+06
Step 79 : gram_loss = 1.07e+06, loss_total = 1.07e+06
Step 80 : gram_loss = 1.04e+06, loss_total = 1.04e+06
Step 81 : gram_loss = 1.02e+06, loss_total = 1.02e+06
Step 82 : gram_loss = 1.01e+06, loss_total = 1.01e+06
Step 83 : gram_loss = 9.93e+05, loss_total = 9.93e+05
Step 84 : gram_loss = 9.85e+05, loss_total = 9.85e+05
Step 85 : gram_loss = 9.71e+05, loss_total = 9.71e+05
Step 86 : gram_loss = 9.54e+05, loss_total = 9.54e+05
Step 87 : gram_loss = 9.25e+05, loss_total = 9.25e+05
Step 88 : gram_loss = 9.20e+05, loss_total = 9.20e+05
Step 89 : gram_loss = 8.86e+05, loss_total = 8.86e+05
Step 90 : gram_loss = 8.76e+05, loss_total = 8.76e+05
Step 91 : gram_loss = 8.62e+05, loss_total = 8.62e+05
Step 92 : gram_loss = 8.50e+05, loss_total = 8.50e+05
Step 93 : gram_loss = 8.31e+05, loss_total = 8.31e+05
Step 94 : gram_loss = 8.24e+05, loss_total = 8.24e+05
Step 95 : gram_loss = 8.11e+05, loss_total = 8.11e+05
Step 96 : gram_loss = 7.93e+05, loss_total = 7.93e+05
Step 97 : gram_loss = 7.73e+05, loss_total = 7.73e+05
Step 98 : gram_loss = 7.55e+05, loss_total = 7.55e+05
Step 99 : gram_loss = 7.48e+05, loss_total = 7.48e+05
Step 100 : gram_loss = 7.40e+05, loss_total = 7.40e+05
Step 101 : gram_loss = 7.32e+05, loss_total = 7.32e+05
Step 102 : gram_loss = 7.18e+05, loss_total = 7.18e+05
Step 103 : gram_loss = 7.09e+05, loss_total = 7.09e+05
Step 104 : gram_loss = 6.96e+05, loss_total = 6.96e+05
Step 105 : gram_loss = 6.89e+05, loss_total = 6.89e+05
Step 106 : gram_loss = 6.80e+05, loss_total = 6.80e+05
Step 107 : gram_loss = 6.72e+05, loss_total = 6.72e+05
Step 108 : gram_loss = 6.68e+05, loss_total = 6.68e+05
Step 109 : gram_loss = 6.56e+05, loss_total = 6.56e+05
Step 110 : gram_loss = 6.51e+05, loss_total = 6.51e+05
Step 111 : gram_loss = 6.41e+05, loss_total = 6.41e+05
Step 112 : gram_loss = 6.37e+05, loss_total = 6.37e+05
Step 113 : gram_loss = 6.32e+05, loss_total = 6.32e+05
Step 114 : gram_loss = 6.23e+05, loss_total = 6.23e+05
Step 115 : gram_loss = 6.22e+05, loss_total = 6.22e+05
Step 116 : gram_loss = 6.08e+05, loss_total = 6.08e+05
Step 117 : gram_loss = 6.04e+05, loss_total = 6.04e+05
Step 118 : gram_loss = 5.99e+05, loss_total = 5.99e+05
Step 119 : gram_loss = 5.92e+05, loss_total = 5.92e+05
Step 120 : gram_loss = 5.83e+05, loss_total = 5.83e+05
Step 121 : gram_loss = 5.74e+05, loss_total = 5.74e+05
Step 122 : gram_loss = 5.70e+05, loss_total = 5.70e+05
Step 123 : gram_loss = 5.65e+05, loss_total = 5.65e+05
Step 124 : gram_loss = 5.60e+05, loss_total = 5.60e+05
Step 125 : gram_loss = 5.54e+05, loss_total = 5.54e+05
Step 126 : gram_loss = 5.47e+05, loss_total = 5.47e+05
Step 127 : gram_loss = 5.39e+05, loss_total = 5.39e+05
Step 128 : gram_loss = 5.33e+05, loss_total = 5.33e+05
Step 129 : gram_loss = 5.28e+05, loss_total = 5.28e+05
Step 130 : gram_loss = 5.25e+05, loss_total = 5.25e+05
Step 131 : gram_loss = 5.21e+05, loss_total = 5.21e+05
Step 132 : gram_loss = 5.18e+05, loss_total = 5.18e+05
Step 133 : gram_loss = 5.12e+05, loss_total = 5.12e+05
Step 134 : gram_loss = 5.08e+05, loss_total = 5.08e+05
Step 135 : gram_loss = 5.03e+05, loss_total = 5.03e+05
Step 136 : gram_loss = 4.98e+05, loss_total = 4.98e+05
Step 137 : gram_loss = 4.90e+05, loss_total = 4.90e+05
Step 138 : gram_loss = 4.86e+05, loss_total = 4.86e+05
Step 139 : gram_loss = 4.81e+05, loss_total = 4.81e+05
Step 140 : gram_loss = 4.77e+05, loss_total = 4.77e+05
Step 141 : gram_loss = 4.74e+05, loss_total = 4.74e+05
Step 142 : gram_loss = 4.70e+05, loss_total = 4.70e+05
Step 143 : gram_loss = 4.67e+05, loss_total = 4.67e+05
Step 144 : gram_loss = 4.65e+05, loss_total = 4.65e+05
Step 145 : gram_loss = 4.61e+05, loss_total = 4.61e+05
Step 146 : gram_loss = 4.57e+05, loss_total = 4.57e+05
Step 147 : gram_loss = 4.51e+05, loss_total = 4.51e+05
Step 148 : gram_loss = 4.49e+05, loss_total = 4.49e+05
Step 149 : gram_loss = 4.45e+05, loss_total = 4.45e+05
Step 150 : gram_loss = 4.43e+05, loss_total = 4.43e+05
Step 151 : gram_loss = 4.41e+05, loss_total = 4.41e+05
Step 152 : gram_loss = 4.38e+05, loss_total = 4.38e+05
Step 153 : gram_loss = 4.35e+05, loss_total = 4.35e+05
Step 154 : gram_loss = 4.32e+05, loss_total = 4.32e+05
Step 155 : gram_loss = 4.28e+05, loss_total = 4.28e+05
Step 156 : gram_loss = 4.26e+05, loss_total = 4.26e+05
Step 157 : gram_loss = 4.23e+05, loss_total = 4.23e+05
Step 158 : gram_loss = 4.21e+05, loss_total = 4.21e+05
Step 159 : gram_loss = 4.18e+05, loss_total = 4.18e+05
Step 160 : gram_loss = 4.14e+05, loss_total = 4.14e+05
Step 161 : gram_loss = 4.10e+05, loss_total = 4.10e+05
Step 162 : gram_loss = 4.08e+05, loss_total = 4.08e+05
Step 163 : gram_loss = 4.06e+05, loss_total = 4.06e+05
Step 164 : gram_loss = 4.03e+05, loss_total = 4.03e+05
Step 165 : gram_loss = 4.01e+05, loss_total = 4.01e+05
Step 166 : gram_loss = 3.98e+05, loss_total = 3.98e+05
Step 167 : gram_loss = 3.96e+05, loss_total = 3.96e+05
Step 168 : gram_loss = 3.93e+05, loss_total = 3.93e+05
Step 169 : gram_loss = 3.91e+05, loss_total = 3.91e+05
Step 170 : gram_loss = 3.89e+05, loss_total = 3.89e+05
Step 171 : gram_loss = 3.87e+05, loss_total = 3.87e+05
Step 172 : gram_loss = 3.86e+05, loss_total = 3.86e+05
Step 173 : gram_loss = 3.84e+05, loss_total = 3.84e+05
Step 174 : gram_loss = 3.81e+05, loss_total = 3.81e+05
Step 175 : gram_loss = 3.80e+05, loss_total = 3.80e+05
Step 176 : gram_loss = 3.78e+05, loss_total = 3.78e+05
Step 177 : gram_loss = 3.74e+05, loss_total = 3.74e+05
Step 178 : gram_loss = 3.72e+05, loss_total = 3.72e+05
Step 179 : gram_loss = 3.70e+05, loss_total = 3.70e+05
Step 180 : gram_loss = 3.68e+05, loss_total = 3.68e+05
Step 181 : gram_loss = 3.66e+05, loss_total = 3.66e+05
Step 182 : gram_loss = 3.65e+05, loss_total = 3.65e+05
Step 183 : gram_loss = 3.63e+05, loss_total = 3.63e+05
Step 184 : gram_loss = 3.61e+05, loss_total = 3.61e+05
Step 185 : gram_loss = 3.59e+05, loss_total = 3.59e+05
Step 186 : gram_loss = 3.58e+05, loss_total = 3.58e+05
Step 187 : gram_loss = 3.56e+05, loss_total = 3.56e+05
Step 188 : gram_loss = 3.55e+05, loss_total = 3.55e+05
Step 189 : gram_loss = 3.52e+05, loss_total = 3.52e+05
Step 190 : gram_loss = 3.51e+05, loss_total = 3.51e+05
Step 191 : gram_loss = 3.50e+05, loss_total = 3.50e+05
Step 192 : gram_loss = 3.48e+05, loss_total = 3.48e+05
Step 193 : gram_loss = 3.47e+05, loss_total = 3.47e+05
Step 194 : gram_loss = 3.45e+05, loss_total = 3.45e+05
Step 195 : gram_loss = 3.44e+05, loss_total = 3.44e+05
Step 196 : gram_loss = 3.43e+05, loss_total = 3.43e+05
Step 197 : gram_loss = 3.42e+05, loss_total = 3.42e+05
Step 198 : gram_loss = 3.41e+05, loss_total = 3.41e+05
Step 199 : gram_loss = 3.40e+05, loss_total = 3.40e+05
Step 200 : gram_loss = 3.38e+05, loss_total = 3.38e+05
Close Sess - End of the global optimization.
Computation total for  109.29388213157654  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0044_1_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0044_1_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0044_1_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0044_1_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0044_1_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0044_1_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.210253715515137  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 1.00e+10, loss_total = 1.00e+10
Step 1 : gram_loss = 6.24e+09, loss_total = 6.24e+09
Step 2 : gram_loss = 5.52e+09, loss_total = 5.52e+09
Step 3 : gram_loss = 4.21e+09, loss_total = 4.21e+09
Step 4 : gram_loss = 2.93e+09, loss_total = 2.93e+09
Step 5 : gram_loss = 2.02e+09, loss_total = 2.02e+09
Step 6 : gram_loss = 1.14e+09, loss_total = 1.14e+09
Step 7 : gram_loss = 9.13e+08, loss_total = 9.13e+08
Step 8 : gram_loss = 6.29e+08, loss_total = 6.29e+08
Step 9 : gram_loss = 4.95e+08, loss_total = 4.95e+08
Step 10 : gram_loss = 4.17e+08, loss_total = 4.17e+08
Step 11 : gram_loss = 3.23e+08, loss_total = 3.23e+08
Step 12 : gram_loss = 2.11e+08, loss_total = 2.11e+08
Step 13 : gram_loss = 1.27e+08, loss_total = 1.27e+08
Step 14 : gram_loss = 9.81e+07, loss_total = 9.81e+07
Step 15 : gram_loss = 8.68e+07, loss_total = 8.68e+07
Step 16 : gram_loss = 6.10e+07, loss_total = 6.10e+07
Step 17 : gram_loss = 4.57e+07, loss_total = 4.57e+07
Step 18 : gram_loss = 4.12e+07, loss_total = 4.12e+07
Step 19 : gram_loss = 3.64e+07, loss_total = 3.64e+07
Step 20 : gram_loss = 3.44e+07, loss_total = 3.44e+07
Step 21 : gram_loss = 3.20e+07, loss_total = 3.20e+07
Step 22 : gram_loss = 2.85e+07, loss_total = 2.85e+07
Step 23 : gram_loss = 2.22e+07, loss_total = 2.22e+07
Step 24 : gram_loss = 2.00e+07, loss_total = 2.00e+07
Step 25 : gram_loss = 1.56e+07, loss_total = 1.56e+07
Step 26 : gram_loss = 1.45e+07, loss_total = 1.45e+07
Step 27 : gram_loss = 1.35e+07, loss_total = 1.35e+07
Step 28 : gram_loss = 1.16e+07, loss_total = 1.16e+07
Step 29 : gram_loss = 1.03e+07, loss_total = 1.03e+07
Step 30 : gram_loss = 9.55e+06, loss_total = 9.55e+06
Step 31 : gram_loss = 8.28e+06, loss_total = 8.28e+06
Step 32 : gram_loss = 7.99e+06, loss_total = 7.99e+06
Step 33 : gram_loss = 7.50e+06, loss_total = 7.50e+06
Step 34 : gram_loss = 6.91e+06, loss_total = 6.91e+06
Step 35 : gram_loss = 6.24e+06, loss_total = 6.24e+06
Step 36 : gram_loss = 5.68e+06, loss_total = 5.68e+06
Step 37 : gram_loss = 5.09e+06, loss_total = 5.09e+06
Step 38 : gram_loss = 4.52e+06, loss_total = 4.52e+06
Step 39 : gram_loss = 4.28e+06, loss_total = 4.28e+06
Step 40 : gram_loss = 4.09e+06, loss_total = 4.09e+06
Step 41 : gram_loss = 3.72e+06, loss_total = 3.72e+06
Step 42 : gram_loss = 3.41e+06, loss_total = 3.41e+06
Step 43 : gram_loss = 3.20e+06, loss_total = 3.20e+06
Step 44 : gram_loss = 3.08e+06, loss_total = 3.08e+06
Step 45 : gram_loss = 2.88e+06, loss_total = 2.88e+06
Step 46 : gram_loss = 2.72e+06, loss_total = 2.72e+06
Step 47 : gram_loss = 2.62e+06, loss_total = 2.62e+06
Step 48 : gram_loss = 2.52e+06, loss_total = 2.52e+06
Step 49 : gram_loss = 2.43e+06, loss_total = 2.43e+06
Step 50 : gram_loss = 2.37e+06, loss_total = 2.37e+06
Step 51 : gram_loss = 2.20e+06, loss_total = 2.20e+06
Step 52 : gram_loss = 2.12e+06, loss_total = 2.12e+06
Step 53 : gram_loss = 2.04e+06, loss_total = 2.04e+06
Step 54 : gram_loss = 1.96e+06, loss_total = 1.96e+06
Step 55 : gram_loss = 1.90e+06, loss_total = 1.90e+06
Step 56 : gram_loss = 1.84e+06, loss_total = 1.84e+06
Step 57 : gram_loss = 1.78e+06, loss_total = 1.78e+06
Step 58 : gram_loss = 1.73e+06, loss_total = 1.73e+06
Step 59 : gram_loss = 1.65e+06, loss_total = 1.65e+06
Step 60 : gram_loss = 1.58e+06, loss_total = 1.58e+06
Step 61 : gram_loss = 1.54e+06, loss_total = 1.54e+06
Step 62 : gram_loss = 1.50e+06, loss_total = 1.50e+06
Step 63 : gram_loss = 1.46e+06, loss_total = 1.46e+06
Step 64 : gram_loss = 1.42e+06, loss_total = 1.42e+06
Step 65 : gram_loss = 1.38e+06, loss_total = 1.38e+06
Step 66 : gram_loss = 1.36e+06, loss_total = 1.36e+06
Step 67 : gram_loss = 1.31e+06, loss_total = 1.31e+06
Step 68 : gram_loss = 1.27e+06, loss_total = 1.27e+06
Step 69 : gram_loss = 1.23e+06, loss_total = 1.23e+06
Step 70 : gram_loss = 1.21e+06, loss_total = 1.21e+06
Step 71 : gram_loss = 1.20e+06, loss_total = 1.20e+06
Step 72 : gram_loss = 1.18e+06, loss_total = 1.18e+06
Step 73 : gram_loss = 1.14e+06, loss_total = 1.14e+06
Step 74 : gram_loss = 1.12e+06, loss_total = 1.12e+06
Step 75 : gram_loss = 1.09e+06, loss_total = 1.09e+06
Step 76 : gram_loss = 1.08e+06, loss_total = 1.08e+06
Step 77 : gram_loss = 1.07e+06, loss_total = 1.07e+06
Step 78 : gram_loss = 1.05e+06, loss_total = 1.05e+06
Step 79 : gram_loss = 1.02e+06, loss_total = 1.02e+06
Step 80 : gram_loss = 9.86e+05, loss_total = 9.86e+05
Step 81 : gram_loss = 9.63e+05, loss_total = 9.63e+05
Step 82 : gram_loss = 9.49e+05, loss_total = 9.49e+05
Step 83 : gram_loss = 9.40e+05, loss_total = 9.40e+05
Step 84 : gram_loss = 9.29e+05, loss_total = 9.29e+05
Step 85 : gram_loss = 9.05e+05, loss_total = 9.05e+05
Step 86 : gram_loss = 8.84e+05, loss_total = 8.84e+05
Step 87 : gram_loss = 8.68e+05, loss_total = 8.68e+05
Step 88 : gram_loss = 8.57e+05, loss_total = 8.57e+05
Step 89 : gram_loss = 8.45e+05, loss_total = 8.45e+05
Step 90 : gram_loss = 8.31e+05, loss_total = 8.31e+05
Step 91 : gram_loss = 8.20e+05, loss_total = 8.20e+05
Step 92 : gram_loss = 8.11e+05, loss_total = 8.11e+05
Step 93 : gram_loss = 8.02e+05, loss_total = 8.02e+05
Step 94 : gram_loss = 7.89e+05, loss_total = 7.89e+05
Step 95 : gram_loss = 7.71e+05, loss_total = 7.71e+05
Step 96 : gram_loss = 7.63e+05, loss_total = 7.63e+05
Step 97 : gram_loss = 7.48e+05, loss_total = 7.48e+05
Step 98 : gram_loss = 7.34e+05, loss_total = 7.34e+05
Step 99 : gram_loss = 7.21e+05, loss_total = 7.21e+05
Step 100 : gram_loss = 7.12e+05, loss_total = 7.12e+05
Step 101 : gram_loss = 7.05e+05, loss_total = 7.05e+05
Step 102 : gram_loss = 6.98e+05, loss_total = 6.98e+05
Step 103 : gram_loss = 6.92e+05, loss_total = 6.92e+05
Step 104 : gram_loss = 6.80e+05, loss_total = 6.80e+05
Step 105 : gram_loss = 6.73e+05, loss_total = 6.73e+05
Step 106 : gram_loss = 6.61e+05, loss_total = 6.61e+05
Step 107 : gram_loss = 6.56e+05, loss_total = 6.56e+05
Step 108 : gram_loss = 6.50e+05, loss_total = 6.50e+05
Step 109 : gram_loss = 6.45e+05, loss_total = 6.45e+05
Step 110 : gram_loss = 6.39e+05, loss_total = 6.39e+05
Step 111 : gram_loss = 6.32e+05, loss_total = 6.32e+05
Step 112 : gram_loss = 6.22e+05, loss_total = 6.22e+05
Step 113 : gram_loss = 6.15e+05, loss_total = 6.15e+05
Step 114 : gram_loss = 6.06e+05, loss_total = 6.06e+05
Step 115 : gram_loss = 6.01e+05, loss_total = 6.01e+05
Step 116 : gram_loss = 5.95e+05, loss_total = 5.95e+05
Step 117 : gram_loss = 5.84e+05, loss_total = 5.84e+05
Step 118 : gram_loss = 5.78e+05, loss_total = 5.78e+05
Step 119 : gram_loss = 5.73e+05, loss_total = 5.73e+05
Step 120 : gram_loss = 5.70e+05, loss_total = 5.70e+05
Step 121 : gram_loss = 5.67e+05, loss_total = 5.67e+05
Step 122 : gram_loss = 5.61e+05, loss_total = 5.61e+05
Step 123 : gram_loss = 5.56e+05, loss_total = 5.56e+05
Step 124 : gram_loss = 5.50e+05, loss_total = 5.50e+05
Step 125 : gram_loss = 5.45e+05, loss_total = 5.45e+05
Step 126 : gram_loss = 5.37e+05, loss_total = 5.37e+05
Step 127 : gram_loss = 5.31e+05, loss_total = 5.31e+05
Step 128 : gram_loss = 5.26e+05, loss_total = 5.26e+05
Step 129 : gram_loss = 5.23e+05, loss_total = 5.23e+05
Step 130 : gram_loss = 5.21e+05, loss_total = 5.21e+05
Step 131 : gram_loss = 5.17e+05, loss_total = 5.17e+05
Step 132 : gram_loss = 5.12e+05, loss_total = 5.12e+05
Step 133 : gram_loss = 5.08e+05, loss_total = 5.08e+05
Step 134 : gram_loss = 5.05e+05, loss_total = 5.05e+05
Step 135 : gram_loss = 5.02e+05, loss_total = 5.02e+05
Step 136 : gram_loss = 4.99e+05, loss_total = 4.99e+05
Step 137 : gram_loss = 4.93e+05, loss_total = 4.93e+05
Step 138 : gram_loss = 4.87e+05, loss_total = 4.87e+05
Step 139 : gram_loss = 4.83e+05, loss_total = 4.83e+05
Step 140 : gram_loss = 4.80e+05, loss_total = 4.80e+05
Step 141 : gram_loss = 4.77e+05, loss_total = 4.77e+05
Step 142 : gram_loss = 4.74e+05, loss_total = 4.74e+05
Step 143 : gram_loss = 4.72e+05, loss_total = 4.72e+05
Step 144 : gram_loss = 4.70e+05, loss_total = 4.70e+05
Step 145 : gram_loss = 4.67e+05, loss_total = 4.67e+05
Step 146 : gram_loss = 4.63e+05, loss_total = 4.63e+05
Step 147 : gram_loss = 4.60e+05, loss_total = 4.60e+05
Step 148 : gram_loss = 4.56e+05, loss_total = 4.56e+05
Step 149 : gram_loss = 4.52e+05, loss_total = 4.52e+05
Step 150 : gram_loss = 4.50e+05, loss_total = 4.50e+05
Step 151 : gram_loss = 4.46e+05, loss_total = 4.46e+05
Step 152 : gram_loss = 4.43e+05, loss_total = 4.43e+05
Step 153 : gram_loss = 4.41e+05, loss_total = 4.41e+05
Step 154 : gram_loss = 4.38e+05, loss_total = 4.38e+05
Step 155 : gram_loss = 4.36e+05, loss_total = 4.36e+05
Step 156 : gram_loss = 4.33e+05, loss_total = 4.33e+05
Step 157 : gram_loss = 4.31e+05, loss_total = 4.31e+05
Step 158 : gram_loss = 4.29e+05, loss_total = 4.29e+05
Step 159 : gram_loss = 4.28e+05, loss_total = 4.28e+05
Step 160 : gram_loss = 4.26e+05, loss_total = 4.26e+05
Step 161 : gram_loss = 4.22e+05, loss_total = 4.22e+05
Step 162 : gram_loss = 4.19e+05, loss_total = 4.19e+05
Step 163 : gram_loss = 4.17e+05, loss_total = 4.17e+05
Step 164 : gram_loss = 4.15e+05, loss_total = 4.15e+05
Step 165 : gram_loss = 4.13e+05, loss_total = 4.13e+05
Step 166 : gram_loss = 4.12e+05, loss_total = 4.12e+05
Step 167 : gram_loss = 4.10e+05, loss_total = 4.10e+05
Step 168 : gram_loss = 4.09e+05, loss_total = 4.09e+05
Step 169 : gram_loss = 4.07e+05, loss_total = 4.07e+05
Step 170 : gram_loss = 4.04e+05, loss_total = 4.04e+05
Step 171 : gram_loss = 4.03e+05, loss_total = 4.03e+05
Step 172 : gram_loss = 4.01e+05, loss_total = 4.01e+05
Step 173 : gram_loss = 3.99e+05, loss_total = 3.99e+05
Step 174 : gram_loss = 3.97e+05, loss_total = 3.97e+05
Step 175 : gram_loss = 3.94e+05, loss_total = 3.94e+05
Step 176 : gram_loss = 3.92e+05, loss_total = 3.92e+05
Step 177 : gram_loss = 3.91e+05, loss_total = 3.91e+05
Step 178 : gram_loss = 3.90e+05, loss_total = 3.90e+05
Step 179 : gram_loss = 3.88e+05, loss_total = 3.88e+05
Step 180 : gram_loss = 3.85e+05, loss_total = 3.85e+05
Step 181 : gram_loss = 3.83e+05, loss_total = 3.83e+05
Step 182 : gram_loss = 3.82e+05, loss_total = 3.82e+05
Step 183 : gram_loss = 3.80e+05, loss_total = 3.80e+05
Step 184 : gram_loss = 3.78e+05, loss_total = 3.78e+05
Step 185 : gram_loss = 3.76e+05, loss_total = 3.76e+05
Step 186 : gram_loss = 3.74e+05, loss_total = 3.74e+05
Step 187 : gram_loss = 3.73e+05, loss_total = 3.73e+05
Step 188 : gram_loss = 3.72e+05, loss_total = 3.72e+05
Step 189 : gram_loss = 3.71e+05, loss_total = 3.71e+05
Step 190 : gram_loss = 3.70e+05, loss_total = 3.70e+05
Step 191 : gram_loss = 3.68e+05, loss_total = 3.68e+05
Step 192 : gram_loss = 3.67e+05, loss_total = 3.67e+05
Step 193 : gram_loss = 3.66e+05, loss_total = 3.66e+05
Step 194 : gram_loss = 3.65e+05, loss_total = 3.65e+05
Step 195 : gram_loss = 3.63e+05, loss_total = 3.63e+05
Step 196 : gram_loss = 3.61e+05, loss_total = 3.61e+05
Step 197 : gram_loss = 3.60e+05, loss_total = 3.60e+05
Step 198 : gram_loss = 3.59e+05, loss_total = 3.59e+05
Step 199 : gram_loss = 3.57e+05, loss_total = 3.57e+05
Step 200 : gram_loss = 3.56e+05, loss_total = 3.56e+05
Close Sess - End of the global optimization.
Computation total for  108.00463080406189  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0033_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0033_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0033_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0033_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0033_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0033_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.215451002120972  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 3.21e+09, loss_total = 3.21e+09
Step 1 : gram_loss = 2.69e+09, loss_total = 2.69e+09
Step 2 : gram_loss = 1.91e+09, loss_total = 1.91e+09
Step 3 : gram_loss = 1.52e+09, loss_total = 1.52e+09
Step 4 : gram_loss = 6.81e+08, loss_total = 6.81e+08
Step 5 : gram_loss = 6.36e+08, loss_total = 6.36e+08
Step 6 : gram_loss = 4.58e+08, loss_total = 4.58e+08
Step 7 : gram_loss = 3.42e+08, loss_total = 3.42e+08
Step 8 : gram_loss = 2.68e+08, loss_total = 2.68e+08
Step 9 : gram_loss = 2.08e+08, loss_total = 2.08e+08
Step 10 : gram_loss = 1.50e+08, loss_total = 1.50e+08
Step 11 : gram_loss = 1.06e+08, loss_total = 1.06e+08
Step 12 : gram_loss = 9.04e+07, loss_total = 9.04e+07
Step 13 : gram_loss = 7.99e+07, loss_total = 7.99e+07
Step 14 : gram_loss = 7.11e+07, loss_total = 7.11e+07
Step 15 : gram_loss = 6.40e+07, loss_total = 6.40e+07
Step 16 : gram_loss = 5.64e+07, loss_total = 5.64e+07
Step 17 : gram_loss = 5.30e+07, loss_total = 5.30e+07
Step 18 : gram_loss = 4.15e+07, loss_total = 4.15e+07
Step 19 : gram_loss = 3.44e+07, loss_total = 3.44e+07
Step 20 : gram_loss = 3.18e+07, loss_total = 3.18e+07
Step 21 : gram_loss = 2.85e+07, loss_total = 2.85e+07
Step 22 : gram_loss = 2.59e+07, loss_total = 2.59e+07
Step 23 : gram_loss = 2.30e+07, loss_total = 2.30e+07
Step 24 : gram_loss = 2.07e+07, loss_total = 2.07e+07
Step 25 : gram_loss = 1.85e+07, loss_total = 1.85e+07
Step 26 : gram_loss = 1.54e+07, loss_total = 1.54e+07
Step 27 : gram_loss = 1.36e+07, loss_total = 1.36e+07
Step 28 : gram_loss = 1.27e+07, loss_total = 1.27e+07
Step 29 : gram_loss = 1.25e+07, loss_total = 1.25e+07
Step 30 : gram_loss = 1.18e+07, loss_total = 1.18e+07
Step 31 : gram_loss = 1.11e+07, loss_total = 1.11e+07
Step 32 : gram_loss = 1.02e+07, loss_total = 1.02e+07
Step 33 : gram_loss = 9.16e+06, loss_total = 9.16e+06
Step 34 : gram_loss = 8.46e+06, loss_total = 8.46e+06
Step 35 : gram_loss = 8.03e+06, loss_total = 8.03e+06
Step 36 : gram_loss = 7.62e+06, loss_total = 7.62e+06
Step 37 : gram_loss = 7.32e+06, loss_total = 7.32e+06
Step 38 : gram_loss = 6.83e+06, loss_total = 6.83e+06
Step 39 : gram_loss = 6.25e+06, loss_total = 6.25e+06
Step 40 : gram_loss = 5.75e+06, loss_total = 5.75e+06
Step 41 : gram_loss = 5.54e+06, loss_total = 5.54e+06
Step 42 : gram_loss = 5.43e+06, loss_total = 5.43e+06
Step 43 : gram_loss = 5.21e+06, loss_total = 5.21e+06
Step 44 : gram_loss = 5.09e+06, loss_total = 5.09e+06
Step 45 : gram_loss = 4.84e+06, loss_total = 4.84e+06
Step 46 : gram_loss = 4.66e+06, loss_total = 4.66e+06
Step 47 : gram_loss = 4.33e+06, loss_total = 4.33e+06
Step 48 : gram_loss = 4.02e+06, loss_total = 4.02e+06
Step 49 : gram_loss = 3.90e+06, loss_total = 3.90e+06
Step 50 : gram_loss = 3.80e+06, loss_total = 3.80e+06
Step 51 : gram_loss = 3.71e+06, loss_total = 3.71e+06
Step 52 : gram_loss = 3.57e+06, loss_total = 3.57e+06
Step 53 : gram_loss = 3.43e+06, loss_total = 3.43e+06
Step 54 : gram_loss = 3.28e+06, loss_total = 3.28e+06
Step 55 : gram_loss = 3.17e+06, loss_total = 3.17e+06
Step 56 : gram_loss = 3.08e+06, loss_total = 3.08e+06
Step 57 : gram_loss = 2.94e+06, loss_total = 2.94e+06
Step 58 : gram_loss = 2.85e+06, loss_total = 2.85e+06
Step 59 : gram_loss = 2.73e+06, loss_total = 2.73e+06
Step 60 : gram_loss = 2.62e+06, loss_total = 2.62e+06
Step 61 : gram_loss = 2.55e+06, loss_total = 2.55e+06
Step 62 : gram_loss = 2.46e+06, loss_total = 2.46e+06
Step 63 : gram_loss = 2.39e+06, loss_total = 2.39e+06
Step 64 : gram_loss = 2.28e+06, loss_total = 2.28e+06
Step 65 : gram_loss = 2.17e+06, loss_total = 2.17e+06
Step 66 : gram_loss = 2.10e+06, loss_total = 2.10e+06
Step 67 : gram_loss = 2.06e+06, loss_total = 2.06e+06
Step 68 : gram_loss = 1.99e+06, loss_total = 1.99e+06
Step 69 : gram_loss = 1.92e+06, loss_total = 1.92e+06
Step 70 : gram_loss = 1.86e+06, loss_total = 1.86e+06
Step 71 : gram_loss = 1.76e+06, loss_total = 1.76e+06
Step 72 : gram_loss = 1.72e+06, loss_total = 1.72e+06
Step 73 : gram_loss = 1.68e+06, loss_total = 1.68e+06
Step 74 : gram_loss = 1.64e+06, loss_total = 1.64e+06
Step 75 : gram_loss = 1.61e+06, loss_total = 1.61e+06
Step 76 : gram_loss = 1.59e+06, loss_total = 1.59e+06
Step 77 : gram_loss = 1.54e+06, loss_total = 1.54e+06
Step 78 : gram_loss = 1.52e+06, loss_total = 1.52e+06
Step 79 : gram_loss = 1.47e+06, loss_total = 1.47e+06
Step 80 : gram_loss = 1.40e+06, loss_total = 1.40e+06
Step 81 : gram_loss = 1.33e+06, loss_total = 1.33e+06
Step 82 : gram_loss = 1.30e+06, loss_total = 1.30e+06
Step 83 : gram_loss = 1.28e+06, loss_total = 1.28e+06
Step 84 : gram_loss = 1.28e+06, loss_total = 1.28e+06
Step 85 : gram_loss = 1.24e+06, loss_total = 1.24e+06
Step 86 : gram_loss = 1.21e+06, loss_total = 1.21e+06
Step 87 : gram_loss = 1.18e+06, loss_total = 1.18e+06
Step 88 : gram_loss = 1.14e+06, loss_total = 1.14e+06
Step 89 : gram_loss = 1.09e+06, loss_total = 1.09e+06
Step 90 : gram_loss = 1.06e+06, loss_total = 1.06e+06
Step 91 : gram_loss = 1.03e+06, loss_total = 1.03e+06
Step 92 : gram_loss = 9.96e+05, loss_total = 9.96e+05
Step 93 : gram_loss = 9.81e+05, loss_total = 9.81e+05
Step 94 : gram_loss = 9.50e+05, loss_total = 9.50e+05
Step 95 : gram_loss = 9.44e+05, loss_total = 9.44e+05
Step 96 : gram_loss = 9.28e+05, loss_total = 9.28e+05
Step 97 : gram_loss = 9.10e+05, loss_total = 9.10e+05
Step 98 : gram_loss = 8.72e+05, loss_total = 8.72e+05
Step 99 : gram_loss = 8.65e+05, loss_total = 8.65e+05
Step 100 : gram_loss = 8.56e+05, loss_total = 8.56e+05
Step 101 : gram_loss = 8.41e+05, loss_total = 8.41e+05
Step 102 : gram_loss = 8.27e+05, loss_total = 8.27e+05
Step 103 : gram_loss = 7.99e+05, loss_total = 7.99e+05
Step 104 : gram_loss = 7.87e+05, loss_total = 7.87e+05
Step 105 : gram_loss = 7.77e+05, loss_total = 7.77e+05
Step 106 : gram_loss = 7.65e+05, loss_total = 7.65e+05
Step 107 : gram_loss = 7.56e+05, loss_total = 7.56e+05
Step 108 : gram_loss = 7.41e+05, loss_total = 7.41e+05
Step 109 : gram_loss = 7.23e+05, loss_total = 7.23e+05
Step 110 : gram_loss = 7.02e+05, loss_total = 7.02e+05
Step 111 : gram_loss = 6.89e+05, loss_total = 6.89e+05
Step 112 : gram_loss = 6.76e+05, loss_total = 6.76e+05
Step 113 : gram_loss = 6.70e+05, loss_total = 6.70e+05
Step 114 : gram_loss = 6.65e+05, loss_total = 6.65e+05
Step 115 : gram_loss = 6.55e+05, loss_total = 6.55e+05
Step 116 : gram_loss = 6.40e+05, loss_total = 6.40e+05
Step 117 : gram_loss = 6.35e+05, loss_total = 6.35e+05
Step 118 : gram_loss = 6.24e+05, loss_total = 6.24e+05
Step 119 : gram_loss = 6.12e+05, loss_total = 6.12e+05
Step 120 : gram_loss = 6.07e+05, loss_total = 6.07e+05
Step 121 : gram_loss = 5.98e+05, loss_total = 5.98e+05
Step 122 : gram_loss = 5.92e+05, loss_total = 5.92e+05
Step 123 : gram_loss = 5.86e+05, loss_total = 5.86e+05
Step 124 : gram_loss = 5.81e+05, loss_total = 5.81e+05
Step 125 : gram_loss = 5.71e+05, loss_total = 5.71e+05
Step 126 : gram_loss = 5.65e+05, loss_total = 5.65e+05
Step 127 : gram_loss = 5.59e+05, loss_total = 5.59e+05
Step 128 : gram_loss = 5.50e+05, loss_total = 5.50e+05
Step 129 : gram_loss = 5.36e+05, loss_total = 5.36e+05
Step 130 : gram_loss = 5.28e+05, loss_total = 5.28e+05
Step 131 : gram_loss = 5.25e+05, loss_total = 5.25e+05
Step 132 : gram_loss = 5.19e+05, loss_total = 5.19e+05
Step 133 : gram_loss = 5.13e+05, loss_total = 5.13e+05
Step 134 : gram_loss = 5.07e+05, loss_total = 5.07e+05
Step 135 : gram_loss = 5.01e+05, loss_total = 5.01e+05
Step 136 : gram_loss = 4.97e+05, loss_total = 4.97e+05
Step 137 : gram_loss = 4.89e+05, loss_total = 4.89e+05
Step 138 : gram_loss = 4.83e+05, loss_total = 4.83e+05
Step 139 : gram_loss = 4.77e+05, loss_total = 4.77e+05
Step 140 : gram_loss = 4.73e+05, loss_total = 4.73e+05
Step 141 : gram_loss = 4.69e+05, loss_total = 4.69e+05
Step 142 : gram_loss = 4.65e+05, loss_total = 4.65e+05
Step 143 : gram_loss = 4.62e+05, loss_total = 4.62e+05
Step 144 : gram_loss = 4.60e+05, loss_total = 4.60e+05
Step 145 : gram_loss = 4.54e+05, loss_total = 4.54e+05
Step 146 : gram_loss = 4.47e+05, loss_total = 4.47e+05
Step 147 : gram_loss = 4.42e+05, loss_total = 4.42e+05
Step 148 : gram_loss = 4.39e+05, loss_total = 4.39e+05
Step 149 : gram_loss = 4.36e+05, loss_total = 4.36e+05
Step 150 : gram_loss = 4.33e+05, loss_total = 4.33e+05
Step 151 : gram_loss = 4.28e+05, loss_total = 4.28e+05
Step 152 : gram_loss = 4.23e+05, loss_total = 4.23e+05
Step 153 : gram_loss = 4.20e+05, loss_total = 4.20e+05
Step 154 : gram_loss = 4.15e+05, loss_total = 4.15e+05
Step 155 : gram_loss = 4.10e+05, loss_total = 4.10e+05
Step 156 : gram_loss = 4.06e+05, loss_total = 4.06e+05
Step 157 : gram_loss = 4.02e+05, loss_total = 4.02e+05
Step 158 : gram_loss = 3.99e+05, loss_total = 3.99e+05
Step 159 : gram_loss = 3.95e+05, loss_total = 3.95e+05
Step 160 : gram_loss = 3.93e+05, loss_total = 3.93e+05
Step 161 : gram_loss = 3.88e+05, loss_total = 3.88e+05
Step 162 : gram_loss = 3.86e+05, loss_total = 3.86e+05
Step 163 : gram_loss = 3.83e+05, loss_total = 3.83e+05
Step 164 : gram_loss = 3.81e+05, loss_total = 3.81e+05
Step 165 : gram_loss = 3.79e+05, loss_total = 3.79e+05
Step 166 : gram_loss = 3.77e+05, loss_total = 3.77e+05
Step 167 : gram_loss = 3.74e+05, loss_total = 3.74e+05
Step 168 : gram_loss = 3.69e+05, loss_total = 3.69e+05
Step 169 : gram_loss = 3.67e+05, loss_total = 3.67e+05
Step 170 : gram_loss = 3.65e+05, loss_total = 3.65e+05
Step 171 : gram_loss = 3.64e+05, loss_total = 3.64e+05
Step 172 : gram_loss = 3.62e+05, loss_total = 3.62e+05
Step 173 : gram_loss = 3.58e+05, loss_total = 3.58e+05
Step 174 : gram_loss = 3.55e+05, loss_total = 3.55e+05
Step 175 : gram_loss = 3.53e+05, loss_total = 3.53e+05
Step 176 : gram_loss = 3.51e+05, loss_total = 3.51e+05
Step 177 : gram_loss = 3.48e+05, loss_total = 3.48e+05
Step 178 : gram_loss = 3.47e+05, loss_total = 3.47e+05
Step 179 : gram_loss = 3.43e+05, loss_total = 3.43e+05
Step 180 : gram_loss = 3.41e+05, loss_total = 3.41e+05
Step 181 : gram_loss = 3.40e+05, loss_total = 3.40e+05
Step 182 : gram_loss = 3.38e+05, loss_total = 3.38e+05
Step 183 : gram_loss = 3.32e+05, loss_total = 3.32e+05
Step 184 : gram_loss = 3.29e+05, loss_total = 3.29e+05
Step 185 : gram_loss = 3.26e+05, loss_total = 3.26e+05
Step 186 : gram_loss = 3.25e+05, loss_total = 3.25e+05
Step 187 : gram_loss = 3.24e+05, loss_total = 3.24e+05
Step 188 : gram_loss = 3.22e+05, loss_total = 3.22e+05
Step 189 : gram_loss = 3.20e+05, loss_total = 3.20e+05
Step 190 : gram_loss = 3.19e+05, loss_total = 3.19e+05
Step 191 : gram_loss = 3.17e+05, loss_total = 3.17e+05
Step 192 : gram_loss = 3.16e+05, loss_total = 3.16e+05
Step 193 : gram_loss = 3.14e+05, loss_total = 3.14e+05
Step 194 : gram_loss = 3.13e+05, loss_total = 3.13e+05
Step 195 : gram_loss = 3.11e+05, loss_total = 3.11e+05
Step 196 : gram_loss = 3.08e+05, loss_total = 3.08e+05
Step 197 : gram_loss = 3.06e+05, loss_total = 3.06e+05
Step 198 : gram_loss = 3.05e+05, loss_total = 3.05e+05
Step 199 : gram_loss = 3.03e+05, loss_total = 3.03e+05
Step 200 : gram_loss = 3.01e+05, loss_total = 3.01e+05
Close Sess - End of the global optimization.
Computation total for  108.35555219650269  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0002_1_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0002_1_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0002_1_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0002_1_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0002_1_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0002_1_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.1494526863098145  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 3.55e+09, loss_total = 3.55e+09
Step 1 : gram_loss = 9.14e+08, loss_total = 9.14e+08
Step 2 : gram_loss = 8.52e+08, loss_total = 8.52e+08
Step 3 : gram_loss = 5.53e+08, loss_total = 5.53e+08
Step 4 : gram_loss = 2.76e+08, loss_total = 2.76e+08
Step 5 : gram_loss = 1.78e+08, loss_total = 1.78e+08
Step 6 : gram_loss = 8.53e+07, loss_total = 8.53e+07
Step 7 : gram_loss = 5.25e+07, loss_total = 5.25e+07
Step 8 : gram_loss = 4.19e+07, loss_total = 4.19e+07
Step 9 : gram_loss = 3.05e+07, loss_total = 3.05e+07
Step 10 : gram_loss = 2.35e+07, loss_total = 2.35e+07
Step 11 : gram_loss = 1.53e+07, loss_total = 1.53e+07
Step 12 : gram_loss = 1.01e+07, loss_total = 1.01e+07
Step 13 : gram_loss = 7.45e+06, loss_total = 7.45e+06
Step 14 : gram_loss = 6.43e+06, loss_total = 6.43e+06
Step 15 : gram_loss = 5.33e+06, loss_total = 5.33e+06
Step 16 : gram_loss = 4.44e+06, loss_total = 4.44e+06
Step 17 : gram_loss = 3.77e+06, loss_total = 3.77e+06
Step 18 : gram_loss = 3.17e+06, loss_total = 3.17e+06
Step 19 : gram_loss = 2.55e+06, loss_total = 2.55e+06
Step 20 : gram_loss = 2.32e+06, loss_total = 2.32e+06
Step 21 : gram_loss = 2.15e+06, loss_total = 2.15e+06
Step 22 : gram_loss = 1.98e+06, loss_total = 1.98e+06
Step 23 : gram_loss = 1.82e+06, loss_total = 1.82e+06
Step 24 : gram_loss = 1.67e+06, loss_total = 1.67e+06
Step 25 : gram_loss = 1.52e+06, loss_total = 1.52e+06
Step 26 : gram_loss = 1.43e+06, loss_total = 1.43e+06
Step 27 : gram_loss = 1.25e+06, loss_total = 1.25e+06
Step 28 : gram_loss = 1.16e+06, loss_total = 1.16e+06
Step 29 : gram_loss = 1.06e+06, loss_total = 1.06e+06
Step 30 : gram_loss = 1.02e+06, loss_total = 1.02e+06
Step 31 : gram_loss = 9.82e+05, loss_total = 9.82e+05
Step 32 : gram_loss = 9.39e+05, loss_total = 9.39e+05
Step 33 : gram_loss = 8.25e+05, loss_total = 8.25e+05
Step 34 : gram_loss = 8.16e+05, loss_total = 8.16e+05
Step 35 : gram_loss = 7.56e+05, loss_total = 7.56e+05
Step 36 : gram_loss = 7.33e+05, loss_total = 7.33e+05
Step 37 : gram_loss = 7.04e+05, loss_total = 7.04e+05
Step 38 : gram_loss = 6.68e+05, loss_total = 6.68e+05
Step 39 : gram_loss = 6.16e+05, loss_total = 6.16e+05
Step 40 : gram_loss = 5.75e+05, loss_total = 5.75e+05
Step 41 : gram_loss = 5.34e+05, loss_total = 5.34e+05
Step 42 : gram_loss = 5.19e+05, loss_total = 5.19e+05
Step 43 : gram_loss = 5.07e+05, loss_total = 5.07e+05
Step 44 : gram_loss = 4.91e+05, loss_total = 4.91e+05
Step 45 : gram_loss = 4.75e+05, loss_total = 4.75e+05
Step 46 : gram_loss = 4.44e+05, loss_total = 4.44e+05
Step 47 : gram_loss = 4.16e+05, loss_total = 4.16e+05
Step 48 : gram_loss = 3.99e+05, loss_total = 3.99e+05
Step 49 : gram_loss = 3.86e+05, loss_total = 3.86e+05
Step 50 : gram_loss = 3.72e+05, loss_total = 3.72e+05
Step 51 : gram_loss = 3.63e+05, loss_total = 3.63e+05
Step 52 : gram_loss = 3.50e+05, loss_total = 3.50e+05
Step 53 : gram_loss = 3.40e+05, loss_total = 3.40e+05
Step 54 : gram_loss = 3.31e+05, loss_total = 3.31e+05
Step 55 : gram_loss = 3.16e+05, loss_total = 3.16e+05
Step 56 : gram_loss = 3.09e+05, loss_total = 3.09e+05
Step 57 : gram_loss = 2.98e+05, loss_total = 2.98e+05
Step 58 : gram_loss = 2.88e+05, loss_total = 2.88e+05
Step 59 : gram_loss = 2.77e+05, loss_total = 2.77e+05
Step 60 : gram_loss = 2.71e+05, loss_total = 2.71e+05
Step 61 : gram_loss = 2.68e+05, loss_total = 2.68e+05
Step 62 : gram_loss = 2.58e+05, loss_total = 2.58e+05
Step 63 : gram_loss = 2.55e+05, loss_total = 2.55e+05
Step 64 : gram_loss = 2.47e+05, loss_total = 2.47e+05
Step 65 : gram_loss = 2.38e+05, loss_total = 2.38e+05
Step 66 : gram_loss = 2.27e+05, loss_total = 2.27e+05
Step 67 : gram_loss = 2.18e+05, loss_total = 2.18e+05
Step 68 : gram_loss = 2.12e+05, loss_total = 2.12e+05
Step 69 : gram_loss = 2.09e+05, loss_total = 2.09e+05
Step 70 : gram_loss = 2.04e+05, loss_total = 2.04e+05
Step 71 : gram_loss = 1.97e+05, loss_total = 1.97e+05
Step 72 : gram_loss = 1.91e+05, loss_total = 1.91e+05
Step 73 : gram_loss = 1.87e+05, loss_total = 1.87e+05
Step 74 : gram_loss = 1.83e+05, loss_total = 1.83e+05
Step 75 : gram_loss = 1.75e+05, loss_total = 1.75e+05
Step 76 : gram_loss = 1.68e+05, loss_total = 1.68e+05
Step 77 : gram_loss = 1.65e+05, loss_total = 1.65e+05
Step 78 : gram_loss = 1.62e+05, loss_total = 1.62e+05
Step 79 : gram_loss = 1.60e+05, loss_total = 1.60e+05
Step 80 : gram_loss = 1.57e+05, loss_total = 1.57e+05
Step 81 : gram_loss = 1.53e+05, loss_total = 1.53e+05
Step 82 : gram_loss = 1.48e+05, loss_total = 1.48e+05
Step 83 : gram_loss = 1.44e+05, loss_total = 1.44e+05
Step 84 : gram_loss = 1.42e+05, loss_total = 1.42e+05
Step 85 : gram_loss = 1.40e+05, loss_total = 1.40e+05
Step 86 : gram_loss = 1.36e+05, loss_total = 1.36e+05
Step 87 : gram_loss = 1.31e+05, loss_total = 1.31e+05
Step 88 : gram_loss = 1.28e+05, loss_total = 1.28e+05
Step 89 : gram_loss = 1.25e+05, loss_total = 1.25e+05
Step 90 : gram_loss = 1.23e+05, loss_total = 1.23e+05
Step 91 : gram_loss = 1.22e+05, loss_total = 1.22e+05
Step 92 : gram_loss = 1.19e+05, loss_total = 1.19e+05
Step 93 : gram_loss = 1.15e+05, loss_total = 1.15e+05
Step 94 : gram_loss = 1.12e+05, loss_total = 1.12e+05
Step 95 : gram_loss = 1.09e+05, loss_total = 1.09e+05
Step 96 : gram_loss = 1.07e+05, loss_total = 1.07e+05
Step 97 : gram_loss = 1.06e+05, loss_total = 1.06e+05
Step 98 : gram_loss = 1.04e+05, loss_total = 1.04e+05
Step 99 : gram_loss = 1.02e+05, loss_total = 1.02e+05
Step 100 : gram_loss = 9.96e+04, loss_total = 9.96e+04
Step 101 : gram_loss = 9.71e+04, loss_total = 9.71e+04
Step 102 : gram_loss = 9.46e+04, loss_total = 9.46e+04
Step 103 : gram_loss = 9.27e+04, loss_total = 9.27e+04
Step 104 : gram_loss = 9.04e+04, loss_total = 9.04e+04
Step 105 : gram_loss = 8.80e+04, loss_total = 8.80e+04
Step 106 : gram_loss = 8.67e+04, loss_total = 8.67e+04
Step 107 : gram_loss = 8.56e+04, loss_total = 8.56e+04
Step 108 : gram_loss = 8.48e+04, loss_total = 8.48e+04
Step 109 : gram_loss = 8.26e+04, loss_total = 8.26e+04
Step 110 : gram_loss = 8.14e+04, loss_total = 8.14e+04
Step 111 : gram_loss = 7.98e+04, loss_total = 7.98e+04
Step 112 : gram_loss = 7.87e+04, loss_total = 7.87e+04
Step 113 : gram_loss = 7.73e+04, loss_total = 7.73e+04
Step 114 : gram_loss = 7.50e+04, loss_total = 7.50e+04
Step 115 : gram_loss = 7.38e+04, loss_total = 7.38e+04
Step 116 : gram_loss = 7.30e+04, loss_total = 7.30e+04
Step 117 : gram_loss = 7.17e+04, loss_total = 7.17e+04
Step 118 : gram_loss = 7.11e+04, loss_total = 7.11e+04
Step 119 : gram_loss = 7.03e+04, loss_total = 7.03e+04
Step 120 : gram_loss = 6.87e+04, loss_total = 6.87e+04
Step 121 : gram_loss = 6.75e+04, loss_total = 6.75e+04
Step 122 : gram_loss = 6.60e+04, loss_total = 6.60e+04
Step 123 : gram_loss = 6.51e+04, loss_total = 6.51e+04
Step 124 : gram_loss = 6.42e+04, loss_total = 6.42e+04
Step 125 : gram_loss = 6.32e+04, loss_total = 6.32e+04
Step 126 : gram_loss = 6.24e+04, loss_total = 6.24e+04
Step 127 : gram_loss = 6.10e+04, loss_total = 6.10e+04
Step 128 : gram_loss = 6.06e+04, loss_total = 6.06e+04
Step 129 : gram_loss = 5.97e+04, loss_total = 5.97e+04
Step 130 : gram_loss = 5.89e+04, loss_total = 5.89e+04
Step 131 : gram_loss = 5.81e+04, loss_total = 5.81e+04
Step 132 : gram_loss = 5.75e+04, loss_total = 5.75e+04
Step 133 : gram_loss = 5.66e+04, loss_total = 5.66e+04
Step 134 : gram_loss = 5.59e+04, loss_total = 5.59e+04
Step 135 : gram_loss = 5.52e+04, loss_total = 5.52e+04
Step 136 : gram_loss = 5.47e+04, loss_total = 5.47e+04
Step 137 : gram_loss = 5.42e+04, loss_total = 5.42e+04
Step 138 : gram_loss = 5.36e+04, loss_total = 5.36e+04
Step 139 : gram_loss = 5.29e+04, loss_total = 5.29e+04
Step 140 : gram_loss = 5.20e+04, loss_total = 5.20e+04
Step 141 : gram_loss = 5.15e+04, loss_total = 5.15e+04
Step 142 : gram_loss = 5.06e+04, loss_total = 5.06e+04
Step 143 : gram_loss = 5.00e+04, loss_total = 5.00e+04
Step 144 : gram_loss = 4.95e+04, loss_total = 4.95e+04
Step 145 : gram_loss = 4.92e+04, loss_total = 4.92e+04
Step 146 : gram_loss = 4.88e+04, loss_total = 4.88e+04
Step 147 : gram_loss = 4.82e+04, loss_total = 4.82e+04
Step 148 : gram_loss = 4.73e+04, loss_total = 4.73e+04
Step 149 : gram_loss = 4.69e+04, loss_total = 4.69e+04
Step 150 : gram_loss = 4.63e+04, loss_total = 4.63e+04
Step 151 : gram_loss = 4.59e+04, loss_total = 4.59e+04
Step 152 : gram_loss = 4.54e+04, loss_total = 4.54e+04
Step 153 : gram_loss = 4.51e+04, loss_total = 4.51e+04
Step 154 : gram_loss = 4.47e+04, loss_total = 4.47e+04
Step 155 : gram_loss = 4.43e+04, loss_total = 4.43e+04
Step 156 : gram_loss = 4.35e+04, loss_total = 4.35e+04
Step 157 : gram_loss = 4.30e+04, loss_total = 4.30e+04
Step 158 : gram_loss = 4.27e+04, loss_total = 4.27e+04
Step 159 : gram_loss = 4.23e+04, loss_total = 4.23e+04
Step 160 : gram_loss = 4.20e+04, loss_total = 4.20e+04
Step 161 : gram_loss = 4.15e+04, loss_total = 4.15e+04
Step 162 : gram_loss = 4.09e+04, loss_total = 4.09e+04
Step 163 : gram_loss = 4.03e+04, loss_total = 4.03e+04
Step 164 : gram_loss = 3.98e+04, loss_total = 3.98e+04
Step 165 : gram_loss = 3.96e+04, loss_total = 3.96e+04
Step 166 : gram_loss = 3.93e+04, loss_total = 3.93e+04
Step 167 : gram_loss = 3.89e+04, loss_total = 3.89e+04
Step 168 : gram_loss = 3.82e+04, loss_total = 3.82e+04
Step 169 : gram_loss = 3.79e+04, loss_total = 3.79e+04
Step 170 : gram_loss = 3.75e+04, loss_total = 3.75e+04
Step 171 : gram_loss = 3.72e+04, loss_total = 3.72e+04
Step 172 : gram_loss = 3.70e+04, loss_total = 3.70e+04
Step 173 : gram_loss = 3.68e+04, loss_total = 3.68e+04
Step 174 : gram_loss = 3.63e+04, loss_total = 3.63e+04
Step 175 : gram_loss = 3.59e+04, loss_total = 3.59e+04
Step 176 : gram_loss = 3.56e+04, loss_total = 3.56e+04
Step 177 : gram_loss = 3.53e+04, loss_total = 3.53e+04
Step 178 : gram_loss = 3.49e+04, loss_total = 3.49e+04
Step 179 : gram_loss = 3.45e+04, loss_total = 3.45e+04
Step 180 : gram_loss = 3.42e+04, loss_total = 3.42e+04
Step 181 : gram_loss = 3.41e+04, loss_total = 3.41e+04
Step 182 : gram_loss = 3.39e+04, loss_total = 3.39e+04
Step 183 : gram_loss = 3.36e+04, loss_total = 3.36e+04
Step 184 : gram_loss = 3.34e+04, loss_total = 3.34e+04
Step 185 : gram_loss = 3.30e+04, loss_total = 3.30e+04
Step 186 : gram_loss = 3.27e+04, loss_total = 3.27e+04
Step 187 : gram_loss = 3.25e+04, loss_total = 3.25e+04
Step 188 : gram_loss = 3.23e+04, loss_total = 3.23e+04
Step 189 : gram_loss = 3.21e+04, loss_total = 3.21e+04
Step 190 : gram_loss = 3.18e+04, loss_total = 3.18e+04
Step 191 : gram_loss = 3.14e+04, loss_total = 3.14e+04
Step 192 : gram_loss = 3.11e+04, loss_total = 3.11e+04
Step 193 : gram_loss = 3.09e+04, loss_total = 3.09e+04
Step 194 : gram_loss = 3.07e+04, loss_total = 3.07e+04
Step 195 : gram_loss = 3.05e+04, loss_total = 3.05e+04
Step 196 : gram_loss = 3.03e+04, loss_total = 3.03e+04
Step 197 : gram_loss = 3.01e+04, loss_total = 3.01e+04
Step 198 : gram_loss = 2.99e+04, loss_total = 2.99e+04
Step 199 : gram_loss = 2.97e+04, loss_total = 2.97e+04
Step 200 : gram_loss = 2.95e+04, loss_total = 2.95e+04
Close Sess - End of the global optimization.
Computation total for  107.80697679519653  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0024_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0024_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0024_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0024_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0024_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0024_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.225249528884888  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 2.57e+09, loss_total = 2.57e+09
Step 1 : gram_loss = 2.10e+09, loss_total = 2.10e+09
Step 2 : gram_loss = 1.73e+09, loss_total = 1.73e+09
Step 3 : gram_loss = 9.61e+08, loss_total = 9.61e+08
Step 4 : gram_loss = 3.46e+08, loss_total = 3.46e+08
Step 5 : gram_loss = 2.67e+08, loss_total = 2.67e+08
Step 6 : gram_loss = 1.74e+08, loss_total = 1.74e+08
Step 7 : gram_loss = 1.23e+08, loss_total = 1.23e+08
Step 8 : gram_loss = 9.49e+07, loss_total = 9.49e+07
Step 9 : gram_loss = 7.22e+07, loss_total = 7.22e+07
Step 10 : gram_loss = 5.68e+07, loss_total = 5.68e+07
Step 11 : gram_loss = 4.01e+07, loss_total = 4.01e+07
Step 12 : gram_loss = 3.38e+07, loss_total = 3.38e+07
Step 13 : gram_loss = 2.94e+07, loss_total = 2.94e+07
Step 14 : gram_loss = 2.55e+07, loss_total = 2.55e+07
Step 15 : gram_loss = 2.32e+07, loss_total = 2.32e+07
Step 16 : gram_loss = 2.06e+07, loss_total = 2.06e+07
Step 17 : gram_loss = 1.73e+07, loss_total = 1.73e+07
Step 18 : gram_loss = 1.47e+07, loss_total = 1.47e+07
Step 19 : gram_loss = 1.22e+07, loss_total = 1.22e+07
Step 20 : gram_loss = 1.08e+07, loss_total = 1.08e+07
Step 21 : gram_loss = 9.82e+06, loss_total = 9.82e+06
Step 22 : gram_loss = 9.00e+06, loss_total = 9.00e+06
Step 23 : gram_loss = 8.57e+06, loss_total = 8.57e+06
Step 24 : gram_loss = 8.11e+06, loss_total = 8.11e+06
Step 25 : gram_loss = 7.26e+06, loss_total = 7.26e+06
Step 26 : gram_loss = 6.60e+06, loss_total = 6.60e+06
Step 27 : gram_loss = 6.17e+06, loss_total = 6.17e+06
Step 28 : gram_loss = 5.79e+06, loss_total = 5.79e+06
Step 29 : gram_loss = 5.33e+06, loss_total = 5.33e+06
Step 30 : gram_loss = 4.74e+06, loss_total = 4.74e+06
Step 31 : gram_loss = 4.53e+06, loss_total = 4.53e+06
Step 32 : gram_loss = 4.32e+06, loss_total = 4.32e+06
Step 33 : gram_loss = 4.14e+06, loss_total = 4.14e+06
Step 34 : gram_loss = 3.98e+06, loss_total = 3.98e+06
Step 35 : gram_loss = 3.86e+06, loss_total = 3.86e+06
Step 36 : gram_loss = 3.58e+06, loss_total = 3.58e+06
Step 37 : gram_loss = 3.41e+06, loss_total = 3.41e+06
Step 38 : gram_loss = 3.17e+06, loss_total = 3.17e+06
Step 39 : gram_loss = 2.96e+06, loss_total = 2.96e+06
Step 40 : gram_loss = 2.79e+06, loss_total = 2.79e+06
Step 41 : gram_loss = 2.71e+06, loss_total = 2.71e+06
Step 42 : gram_loss = 2.58e+06, loss_total = 2.58e+06
Step 43 : gram_loss = 2.49e+06, loss_total = 2.49e+06
Step 44 : gram_loss = 2.39e+06, loss_total = 2.39e+06
Step 45 : gram_loss = 2.21e+06, loss_total = 2.21e+06
Step 46 : gram_loss = 2.13e+06, loss_total = 2.13e+06
Step 47 : gram_loss = 2.04e+06, loss_total = 2.04e+06
Step 48 : gram_loss = 1.97e+06, loss_total = 1.97e+06
Step 49 : gram_loss = 1.93e+06, loss_total = 1.93e+06
Step 50 : gram_loss = 1.84e+06, loss_total = 1.84e+06
Step 51 : gram_loss = 1.76e+06, loss_total = 1.76e+06
Step 52 : gram_loss = 1.62e+06, loss_total = 1.62e+06
Step 53 : gram_loss = 1.56e+06, loss_total = 1.56e+06
Step 54 : gram_loss = 1.50e+06, loss_total = 1.50e+06
Step 55 : gram_loss = 1.48e+06, loss_total = 1.48e+06
Step 56 : gram_loss = 1.45e+06, loss_total = 1.45e+06
Step 57 : gram_loss = 1.38e+06, loss_total = 1.38e+06
Step 58 : gram_loss = 1.31e+06, loss_total = 1.31e+06
Step 59 : gram_loss = 1.26e+06, loss_total = 1.26e+06
Step 60 : gram_loss = 1.23e+06, loss_total = 1.23e+06
Step 61 : gram_loss = 1.18e+06, loss_total = 1.18e+06
Step 62 : gram_loss = 1.15e+06, loss_total = 1.15e+06
Step 63 : gram_loss = 1.10e+06, loss_total = 1.10e+06
Step 64 : gram_loss = 1.07e+06, loss_total = 1.07e+06
Step 65 : gram_loss = 1.04e+06, loss_total = 1.04e+06
Step 66 : gram_loss = 1.01e+06, loss_total = 1.01e+06
Step 67 : gram_loss = 9.87e+05, loss_total = 9.87e+05
Step 68 : gram_loss = 9.57e+05, loss_total = 9.57e+05
Step 69 : gram_loss = 9.06e+05, loss_total = 9.06e+05
Step 70 : gram_loss = 8.68e+05, loss_total = 8.68e+05
Step 71 : gram_loss = 8.44e+05, loss_total = 8.44e+05
Step 72 : gram_loss = 8.25e+05, loss_total = 8.25e+05
Step 73 : gram_loss = 8.08e+05, loss_total = 8.08e+05
Step 74 : gram_loss = 7.92e+05, loss_total = 7.92e+05
Step 75 : gram_loss = 7.57e+05, loss_total = 7.57e+05
Step 76 : gram_loss = 7.43e+05, loss_total = 7.43e+05
Step 77 : gram_loss = 7.14e+05, loss_total = 7.14e+05
Step 78 : gram_loss = 6.75e+05, loss_total = 6.75e+05
Step 79 : gram_loss = 6.52e+05, loss_total = 6.52e+05
Step 80 : gram_loss = 6.35e+05, loss_total = 6.35e+05
Step 81 : gram_loss = 6.25e+05, loss_total = 6.25e+05
Step 82 : gram_loss = 6.09e+05, loss_total = 6.09e+05
Step 83 : gram_loss = 5.97e+05, loss_total = 5.97e+05
Step 84 : gram_loss = 5.81e+05, loss_total = 5.81e+05
Step 85 : gram_loss = 5.62e+05, loss_total = 5.62e+05
Step 86 : gram_loss = 5.45e+05, loss_total = 5.45e+05
Step 87 : gram_loss = 5.34e+05, loss_total = 5.34e+05
Step 88 : gram_loss = 5.12e+05, loss_total = 5.12e+05
Step 89 : gram_loss = 4.98e+05, loss_total = 4.98e+05
Step 90 : gram_loss = 4.87e+05, loss_total = 4.87e+05
Step 91 : gram_loss = 4.74e+05, loss_total = 4.74e+05
Step 92 : gram_loss = 4.67e+05, loss_total = 4.67e+05
Step 93 : gram_loss = 4.61e+05, loss_total = 4.61e+05
Step 94 : gram_loss = 4.46e+05, loss_total = 4.46e+05
Step 95 : gram_loss = 4.37e+05, loss_total = 4.37e+05
Step 96 : gram_loss = 4.30e+05, loss_total = 4.30e+05
Step 97 : gram_loss = 4.19e+05, loss_total = 4.19e+05
Step 98 : gram_loss = 4.09e+05, loss_total = 4.09e+05
Step 99 : gram_loss = 4.01e+05, loss_total = 4.01e+05
Step 100 : gram_loss = 3.91e+05, loss_total = 3.91e+05
Step 101 : gram_loss = 3.85e+05, loss_total = 3.85e+05
Step 102 : gram_loss = 3.75e+05, loss_total = 3.75e+05
Step 103 : gram_loss = 3.72e+05, loss_total = 3.72e+05
Step 104 : gram_loss = 3.68e+05, loss_total = 3.68e+05
Step 105 : gram_loss = 3.63e+05, loss_total = 3.63e+05
Step 106 : gram_loss = 3.59e+05, loss_total = 3.59e+05
Step 107 : gram_loss = 3.50e+05, loss_total = 3.50e+05
Step 108 : gram_loss = 3.39e+05, loss_total = 3.39e+05
Step 109 : gram_loss = 3.32e+05, loss_total = 3.32e+05
Step 110 : gram_loss = 3.26e+05, loss_total = 3.26e+05
Step 111 : gram_loss = 3.25e+05, loss_total = 3.25e+05
Step 112 : gram_loss = 3.20e+05, loss_total = 3.20e+05
Step 113 : gram_loss = 3.17e+05, loss_total = 3.17e+05
Step 114 : gram_loss = 3.11e+05, loss_total = 3.11e+05
Step 115 : gram_loss = 3.06e+05, loss_total = 3.06e+05
Step 116 : gram_loss = 2.99e+05, loss_total = 2.99e+05
Step 117 : gram_loss = 2.94e+05, loss_total = 2.94e+05
Step 118 : gram_loss = 2.90e+05, loss_total = 2.90e+05
Step 119 : gram_loss = 2.84e+05, loss_total = 2.84e+05
Step 120 : gram_loss = 2.82e+05, loss_total = 2.82e+05
Step 121 : gram_loss = 2.77e+05, loss_total = 2.77e+05
Step 122 : gram_loss = 2.75e+05, loss_total = 2.75e+05
Step 123 : gram_loss = 2.72e+05, loss_total = 2.72e+05
Step 124 : gram_loss = 2.67e+05, loss_total = 2.67e+05
Step 125 : gram_loss = 2.62e+05, loss_total = 2.62e+05
Step 126 : gram_loss = 2.59e+05, loss_total = 2.59e+05
Step 127 : gram_loss = 2.57e+05, loss_total = 2.57e+05
Step 128 : gram_loss = 2.54e+05, loss_total = 2.54e+05
Step 129 : gram_loss = 2.51e+05, loss_total = 2.51e+05
Step 130 : gram_loss = 2.48e+05, loss_total = 2.48e+05
Step 131 : gram_loss = 2.46e+05, loss_total = 2.46e+05
Step 132 : gram_loss = 2.40e+05, loss_total = 2.40e+05
Step 133 : gram_loss = 2.39e+05, loss_total = 2.39e+05
Step 134 : gram_loss = 2.33e+05, loss_total = 2.33e+05
Step 135 : gram_loss = 2.32e+05, loss_total = 2.32e+05
Step 136 : gram_loss = 2.30e+05, loss_total = 2.30e+05
Step 137 : gram_loss = 2.29e+05, loss_total = 2.29e+05
Step 138 : gram_loss = 2.26e+05, loss_total = 2.26e+05
Step 139 : gram_loss = 2.23e+05, loss_total = 2.23e+05
Step 140 : gram_loss = 2.20e+05, loss_total = 2.20e+05
Step 141 : gram_loss = 2.17e+05, loss_total = 2.17e+05
Step 142 : gram_loss = 2.15e+05, loss_total = 2.15e+05
Step 143 : gram_loss = 2.13e+05, loss_total = 2.13e+05
Step 144 : gram_loss = 2.11e+05, loss_total = 2.11e+05
Step 145 : gram_loss = 2.10e+05, loss_total = 2.10e+05
Step 146 : gram_loss = 2.07e+05, loss_total = 2.07e+05
Step 147 : gram_loss = 2.05e+05, loss_total = 2.05e+05
Step 148 : gram_loss = 2.03e+05, loss_total = 2.03e+05
Step 149 : gram_loss = 2.02e+05, loss_total = 2.02e+05
Step 150 : gram_loss = 2.00e+05, loss_total = 2.00e+05
Step 151 : gram_loss = 1.98e+05, loss_total = 1.98e+05
Step 152 : gram_loss = 1.96e+05, loss_total = 1.96e+05
Step 153 : gram_loss = 1.95e+05, loss_total = 1.95e+05
Step 154 : gram_loss = 1.93e+05, loss_total = 1.93e+05
Step 155 : gram_loss = 1.92e+05, loss_total = 1.92e+05
Step 156 : gram_loss = 1.90e+05, loss_total = 1.90e+05
Step 157 : gram_loss = 1.88e+05, loss_total = 1.88e+05
Step 158 : gram_loss = 1.86e+05, loss_total = 1.86e+05
Step 159 : gram_loss = 1.84e+05, loss_total = 1.84e+05
Step 160 : gram_loss = 1.82e+05, loss_total = 1.82e+05
Step 161 : gram_loss = 1.80e+05, loss_total = 1.80e+05
Step 162 : gram_loss = 1.78e+05, loss_total = 1.78e+05
Step 163 : gram_loss = 1.77e+05, loss_total = 1.77e+05
Step 164 : gram_loss = 1.76e+05, loss_total = 1.76e+05
Step 165 : gram_loss = 1.75e+05, loss_total = 1.75e+05
Step 166 : gram_loss = 1.72e+05, loss_total = 1.72e+05
Step 167 : gram_loss = 1.71e+05, loss_total = 1.71e+05
Step 168 : gram_loss = 1.70e+05, loss_total = 1.70e+05
Step 169 : gram_loss = 1.69e+05, loss_total = 1.69e+05
Step 170 : gram_loss = 1.68e+05, loss_total = 1.68e+05
Step 171 : gram_loss = 1.67e+05, loss_total = 1.67e+05
Step 172 : gram_loss = 1.66e+05, loss_total = 1.66e+05
Step 173 : gram_loss = 1.65e+05, loss_total = 1.65e+05
Step 174 : gram_loss = 1.63e+05, loss_total = 1.63e+05
Step 175 : gram_loss = 1.62e+05, loss_total = 1.62e+05
Step 176 : gram_loss = 1.61e+05, loss_total = 1.61e+05
Step 177 : gram_loss = 1.61e+05, loss_total = 1.61e+05
Step 178 : gram_loss = 1.60e+05, loss_total = 1.60e+05
Step 179 : gram_loss = 1.58e+05, loss_total = 1.58e+05
Step 180 : gram_loss = 1.57e+05, loss_total = 1.57e+05
Step 181 : gram_loss = 1.56e+05, loss_total = 1.56e+05
Step 182 : gram_loss = 1.54e+05, loss_total = 1.54e+05
Step 183 : gram_loss = 1.54e+05, loss_total = 1.54e+05
Step 184 : gram_loss = 1.53e+05, loss_total = 1.53e+05
Step 185 : gram_loss = 1.52e+05, loss_total = 1.52e+05
Step 186 : gram_loss = 1.51e+05, loss_total = 1.51e+05
Step 187 : gram_loss = 1.50e+05, loss_total = 1.50e+05
Step 188 : gram_loss = 1.49e+05, loss_total = 1.49e+05
Step 189 : gram_loss = 1.48e+05, loss_total = 1.48e+05
Step 190 : gram_loss = 1.47e+05, loss_total = 1.47e+05
Step 191 : gram_loss = 1.47e+05, loss_total = 1.47e+05
Step 192 : gram_loss = 1.46e+05, loss_total = 1.46e+05
Step 193 : gram_loss = 1.45e+05, loss_total = 1.45e+05
Step 194 : gram_loss = 1.44e+05, loss_total = 1.44e+05
Step 195 : gram_loss = 1.43e+05, loss_total = 1.43e+05
Step 196 : gram_loss = 1.42e+05, loss_total = 1.42e+05
Step 197 : gram_loss = 1.41e+05, loss_total = 1.41e+05
Step 198 : gram_loss = 1.41e+05, loss_total = 1.41e+05
Step 199 : gram_loss = 1.40e+05, loss_total = 1.40e+05
Step 200 : gram_loss = 1.40e+05, loss_total = 1.40e+05
Close Sess - End of the global optimization.
Computation total for  107.38988971710205  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0032_1_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0032_1_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0032_1_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0032_1_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0032_1_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0032_1_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.202011346817017  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 5.62e+09, loss_total = 5.62e+09
Step 1 : gram_loss = 4.53e+09, loss_total = 4.53e+09
Step 2 : gram_loss = 4.23e+09, loss_total = 4.23e+09
Step 3 : gram_loss = 3.29e+09, loss_total = 3.29e+09
Step 4 : gram_loss = 1.45e+09, loss_total = 1.45e+09
Step 5 : gram_loss = 4.38e+08, loss_total = 4.38e+08
Step 6 : gram_loss = 2.82e+08, loss_total = 2.82e+08
Step 7 : gram_loss = 1.93e+08, loss_total = 1.93e+08
Step 8 : gram_loss = 1.25e+08, loss_total = 1.25e+08
Step 9 : gram_loss = 9.51e+07, loss_total = 9.51e+07
Step 10 : gram_loss = 7.87e+07, loss_total = 7.87e+07
Step 11 : gram_loss = 6.39e+07, loss_total = 6.39e+07
Step 12 : gram_loss = 4.66e+07, loss_total = 4.66e+07
Step 13 : gram_loss = 3.07e+07, loss_total = 3.07e+07
Step 14 : gram_loss = 2.23e+07, loss_total = 2.23e+07
Step 15 : gram_loss = 2.06e+07, loss_total = 2.06e+07
Step 16 : gram_loss = 1.82e+07, loss_total = 1.82e+07
Step 17 : gram_loss = 1.66e+07, loss_total = 1.66e+07
Step 18 : gram_loss = 1.24e+07, loss_total = 1.24e+07
Step 19 : gram_loss = 9.63e+06, loss_total = 9.63e+06
Step 20 : gram_loss = 8.23e+06, loss_total = 8.23e+06
Step 21 : gram_loss = 7.54e+06, loss_total = 7.54e+06
Step 22 : gram_loss = 6.84e+06, loss_total = 6.84e+06
Step 23 : gram_loss = 5.94e+06, loss_total = 5.94e+06
Step 24 : gram_loss = 5.47e+06, loss_total = 5.47e+06
Step 25 : gram_loss = 4.83e+06, loss_total = 4.83e+06
Step 26 : gram_loss = 4.25e+06, loss_total = 4.25e+06
Step 27 : gram_loss = 3.64e+06, loss_total = 3.64e+06
Step 28 : gram_loss = 3.28e+06, loss_total = 3.28e+06
Step 29 : gram_loss = 3.16e+06, loss_total = 3.16e+06
Step 30 : gram_loss = 3.00e+06, loss_total = 3.00e+06
Step 31 : gram_loss = 2.86e+06, loss_total = 2.86e+06
Step 32 : gram_loss = 2.59e+06, loss_total = 2.59e+06
Step 33 : gram_loss = 2.31e+06, loss_total = 2.31e+06
Step 34 : gram_loss = 2.08e+06, loss_total = 2.08e+06
Step 35 : gram_loss = 1.96e+06, loss_total = 1.96e+06
Step 36 : gram_loss = 1.89e+06, loss_total = 1.89e+06
Step 37 : gram_loss = 1.82e+06, loss_total = 1.82e+06
Step 38 : gram_loss = 1.72e+06, loss_total = 1.72e+06
Step 39 : gram_loss = 1.60e+06, loss_total = 1.60e+06
Step 40 : gram_loss = 1.44e+06, loss_total = 1.44e+06
Step 41 : gram_loss = 1.35e+06, loss_total = 1.35e+06
Step 42 : gram_loss = 1.26e+06, loss_total = 1.26e+06
Step 43 : gram_loss = 1.18e+06, loss_total = 1.18e+06
Step 44 : gram_loss = 1.11e+06, loss_total = 1.11e+06
Step 45 : gram_loss = 1.04e+06, loss_total = 1.04e+06
Step 46 : gram_loss = 1.01e+06, loss_total = 1.01e+06
Step 47 : gram_loss = 9.74e+05, loss_total = 9.74e+05
Step 48 : gram_loss = 9.54e+05, loss_total = 9.54e+05
Step 49 : gram_loss = 9.27e+05, loss_total = 9.27e+05
Step 50 : gram_loss = 8.88e+05, loss_total = 8.88e+05
Step 51 : gram_loss = 8.26e+05, loss_total = 8.26e+05
Step 52 : gram_loss = 7.89e+05, loss_total = 7.89e+05
Step 53 : gram_loss = 7.47e+05, loss_total = 7.47e+05
Step 54 : gram_loss = 7.28e+05, loss_total = 7.28e+05
Step 55 : gram_loss = 7.03e+05, loss_total = 7.03e+05
Step 56 : gram_loss = 6.59e+05, loss_total = 6.59e+05
Step 57 : gram_loss = 6.40e+05, loss_total = 6.40e+05
Step 58 : gram_loss = 6.22e+05, loss_total = 6.22e+05
Step 59 : gram_loss = 6.09e+05, loss_total = 6.09e+05
Step 60 : gram_loss = 5.93e+05, loss_total = 5.93e+05
Step 61 : gram_loss = 5.73e+05, loss_total = 5.73e+05
Step 62 : gram_loss = 5.47e+05, loss_total = 5.47e+05
Step 63 : gram_loss = 5.26e+05, loss_total = 5.26e+05
Step 64 : gram_loss = 5.07e+05, loss_total = 5.07e+05
Step 65 : gram_loss = 4.86e+05, loss_total = 4.86e+05
Step 66 : gram_loss = 4.72e+05, loss_total = 4.72e+05
Step 67 : gram_loss = 4.55e+05, loss_total = 4.55e+05
Step 68 : gram_loss = 4.42e+05, loss_total = 4.42e+05
Step 69 : gram_loss = 4.25e+05, loss_total = 4.25e+05
Step 70 : gram_loss = 4.17e+05, loss_total = 4.17e+05
Step 71 : gram_loss = 4.03e+05, loss_total = 4.03e+05
Step 72 : gram_loss = 3.91e+05, loss_total = 3.91e+05
Step 73 : gram_loss = 3.84e+05, loss_total = 3.84e+05
Step 74 : gram_loss = 3.76e+05, loss_total = 3.76e+05
Step 75 : gram_loss = 3.66e+05, loss_total = 3.66e+05
Step 76 : gram_loss = 3.54e+05, loss_total = 3.54e+05
Step 77 : gram_loss = 3.48e+05, loss_total = 3.48e+05
Step 78 : gram_loss = 3.40e+05, loss_total = 3.40e+05
Step 79 : gram_loss = 3.34e+05, loss_total = 3.34e+05
Step 80 : gram_loss = 3.27e+05, loss_total = 3.27e+05
Step 81 : gram_loss = 3.21e+05, loss_total = 3.21e+05
Step 82 : gram_loss = 3.16e+05, loss_total = 3.16e+05
Step 83 : gram_loss = 3.12e+05, loss_total = 3.12e+05
Step 84 : gram_loss = 3.04e+05, loss_total = 3.04e+05
Step 85 : gram_loss = 2.95e+05, loss_total = 2.95e+05
Step 86 : gram_loss = 2.86e+05, loss_total = 2.86e+05
Step 87 : gram_loss = 2.78e+05, loss_total = 2.78e+05
Step 88 : gram_loss = 2.72e+05, loss_total = 2.72e+05
Step 89 : gram_loss = 2.66e+05, loss_total = 2.66e+05
Step 90 : gram_loss = 2.65e+05, loss_total = 2.65e+05
Step 91 : gram_loss = 2.58e+05, loss_total = 2.58e+05
Step 92 : gram_loss = 2.55e+05, loss_total = 2.55e+05
Step 93 : gram_loss = 2.51e+05, loss_total = 2.51e+05
Step 94 : gram_loss = 2.45e+05, loss_total = 2.45e+05
Step 95 : gram_loss = 2.37e+05, loss_total = 2.37e+05
Step 96 : gram_loss = 2.30e+05, loss_total = 2.30e+05
Step 97 : gram_loss = 2.26e+05, loss_total = 2.26e+05
Step 98 : gram_loss = 2.23e+05, loss_total = 2.23e+05
Step 99 : gram_loss = 2.19e+05, loss_total = 2.19e+05
Step 100 : gram_loss = 2.14e+05, loss_total = 2.14e+05
Step 101 : gram_loss = 2.08e+05, loss_total = 2.08e+05
Step 102 : gram_loss = 2.05e+05, loss_total = 2.05e+05
Step 103 : gram_loss = 2.03e+05, loss_total = 2.03e+05
Step 104 : gram_loss = 2.00e+05, loss_total = 2.00e+05
Step 105 : gram_loss = 1.95e+05, loss_total = 1.95e+05
Step 106 : gram_loss = 1.94e+05, loss_total = 1.94e+05
Step 107 : gram_loss = 1.90e+05, loss_total = 1.90e+05
Step 108 : gram_loss = 1.87e+05, loss_total = 1.87e+05
Step 109 : gram_loss = 1.85e+05, loss_total = 1.85e+05
Step 110 : gram_loss = 1.80e+05, loss_total = 1.80e+05
Step 111 : gram_loss = 1.76e+05, loss_total = 1.76e+05
Step 112 : gram_loss = 1.74e+05, loss_total = 1.74e+05
Step 113 : gram_loss = 1.71e+05, loss_total = 1.71e+05
Step 114 : gram_loss = 1.69e+05, loss_total = 1.69e+05
Step 115 : gram_loss = 1.68e+05, loss_total = 1.68e+05
Step 116 : gram_loss = 1.64e+05, loss_total = 1.64e+05
Step 117 : gram_loss = 1.61e+05, loss_total = 1.61e+05
Step 118 : gram_loss = 1.59e+05, loss_total = 1.59e+05
Step 119 : gram_loss = 1.56e+05, loss_total = 1.56e+05
Step 120 : gram_loss = 1.54e+05, loss_total = 1.54e+05
Step 121 : gram_loss = 1.51e+05, loss_total = 1.51e+05
Step 122 : gram_loss = 1.50e+05, loss_total = 1.50e+05
Step 123 : gram_loss = 1.48e+05, loss_total = 1.48e+05
Step 124 : gram_loss = 1.47e+05, loss_total = 1.47e+05
Step 125 : gram_loss = 1.46e+05, loss_total = 1.46e+05
Step 126 : gram_loss = 1.43e+05, loss_total = 1.43e+05
Step 127 : gram_loss = 1.41e+05, loss_total = 1.41e+05
Step 128 : gram_loss = 1.40e+05, loss_total = 1.40e+05
Step 129 : gram_loss = 1.39e+05, loss_total = 1.39e+05
Step 130 : gram_loss = 1.37e+05, loss_total = 1.37e+05
Step 131 : gram_loss = 1.33e+05, loss_total = 1.33e+05
Step 132 : gram_loss = 1.32e+05, loss_total = 1.32e+05
Step 133 : gram_loss = 1.31e+05, loss_total = 1.31e+05
Step 134 : gram_loss = 1.30e+05, loss_total = 1.30e+05
Step 135 : gram_loss = 1.29e+05, loss_total = 1.29e+05
Step 136 : gram_loss = 1.27e+05, loss_total = 1.27e+05
Step 137 : gram_loss = 1.26e+05, loss_total = 1.26e+05
Step 138 : gram_loss = 1.25e+05, loss_total = 1.25e+05
Step 139 : gram_loss = 1.24e+05, loss_total = 1.24e+05
Step 140 : gram_loss = 1.22e+05, loss_total = 1.22e+05
Step 141 : gram_loss = 1.20e+05, loss_total = 1.20e+05
Step 142 : gram_loss = 1.19e+05, loss_total = 1.19e+05
Step 143 : gram_loss = 1.17e+05, loss_total = 1.17e+05
Step 144 : gram_loss = 1.16e+05, loss_total = 1.16e+05
Step 145 : gram_loss = 1.15e+05, loss_total = 1.15e+05
Step 146 : gram_loss = 1.13e+05, loss_total = 1.13e+05
Step 147 : gram_loss = 1.12e+05, loss_total = 1.12e+05
Step 148 : gram_loss = 1.10e+05, loss_total = 1.10e+05
Step 149 : gram_loss = 1.09e+05, loss_total = 1.09e+05
Step 150 : gram_loss = 1.08e+05, loss_total = 1.08e+05
Step 151 : gram_loss = 1.07e+05, loss_total = 1.07e+05
Step 152 : gram_loss = 1.06e+05, loss_total = 1.06e+05
Step 153 : gram_loss = 1.05e+05, loss_total = 1.05e+05
Step 154 : gram_loss = 1.04e+05, loss_total = 1.04e+05
Step 155 : gram_loss = 1.03e+05, loss_total = 1.03e+05
Step 156 : gram_loss = 1.02e+05, loss_total = 1.02e+05
Step 157 : gram_loss = 1.01e+05, loss_total = 1.01e+05
Step 158 : gram_loss = 1.00e+05, loss_total = 1.00e+05
Step 159 : gram_loss = 9.92e+04, loss_total = 9.92e+04
Step 160 : gram_loss = 9.77e+04, loss_total = 9.77e+04
Step 161 : gram_loss = 9.70e+04, loss_total = 9.70e+04
Step 162 : gram_loss = 9.60e+04, loss_total = 9.60e+04
Step 163 : gram_loss = 9.57e+04, loss_total = 9.57e+04
Step 164 : gram_loss = 9.45e+04, loss_total = 9.45e+04
Step 165 : gram_loss = 9.40e+04, loss_total = 9.40e+04
Step 166 : gram_loss = 9.34e+04, loss_total = 9.34e+04
Step 167 : gram_loss = 9.27e+04, loss_total = 9.27e+04
Step 168 : gram_loss = 9.13e+04, loss_total = 9.13e+04
Step 169 : gram_loss = 9.05e+04, loss_total = 9.05e+04
Step 170 : gram_loss = 8.95e+04, loss_total = 8.95e+04
Step 171 : gram_loss = 8.87e+04, loss_total = 8.87e+04
Step 172 : gram_loss = 8.80e+04, loss_total = 8.80e+04
Step 173 : gram_loss = 8.72e+04, loss_total = 8.72e+04
Step 174 : gram_loss = 8.63e+04, loss_total = 8.63e+04
Step 175 : gram_loss = 8.58e+04, loss_total = 8.58e+04
Step 176 : gram_loss = 8.52e+04, loss_total = 8.52e+04
Step 177 : gram_loss = 8.44e+04, loss_total = 8.44e+04
Step 178 : gram_loss = 8.35e+04, loss_total = 8.35e+04
Step 179 : gram_loss = 8.25e+04, loss_total = 8.25e+04
Step 180 : gram_loss = 8.16e+04, loss_total = 8.16e+04
Step 181 : gram_loss = 8.11e+04, loss_total = 8.11e+04
Step 182 : gram_loss = 8.07e+04, loss_total = 8.07e+04
Step 183 : gram_loss = 8.03e+04, loss_total = 8.03e+04
Step 184 : gram_loss = 7.98e+04, loss_total = 7.98e+04
Step 185 : gram_loss = 7.91e+04, loss_total = 7.91e+04
Step 186 : gram_loss = 7.85e+04, loss_total = 7.85e+04
Step 187 : gram_loss = 7.79e+04, loss_total = 7.79e+04
Step 188 : gram_loss = 7.76e+04, loss_total = 7.76e+04
Step 189 : gram_loss = 7.73e+04, loss_total = 7.73e+04
Step 190 : gram_loss = 7.65e+04, loss_total = 7.65e+04
Step 191 : gram_loss = 7.58e+04, loss_total = 7.58e+04
Step 192 : gram_loss = 7.53e+04, loss_total = 7.53e+04
Step 193 : gram_loss = 7.47e+04, loss_total = 7.47e+04
Step 194 : gram_loss = 7.40e+04, loss_total = 7.40e+04
Step 195 : gram_loss = 7.31e+04, loss_total = 7.31e+04
Step 196 : gram_loss = 7.28e+04, loss_total = 7.28e+04
Step 197 : gram_loss = 7.22e+04, loss_total = 7.22e+04
Step 198 : gram_loss = 7.18e+04, loss_total = 7.18e+04
Step 199 : gram_loss = 7.14e+04, loss_total = 7.14e+04
Step 200 : gram_loss = 7.07e+04, loss_total = 7.07e+04
Close Sess - End of the global optimization.
Computation total for  107.26842641830444  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0014_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0014_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0014_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0014_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0014_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0014_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.167516708374023  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 2.48e+09, loss_total = 2.48e+09
Step 1 : gram_loss = 1.60e+09, loss_total = 1.60e+09
Step 2 : gram_loss = 1.37e+09, loss_total = 1.37e+09
Step 3 : gram_loss = 9.23e+08, loss_total = 9.23e+08
Step 4 : gram_loss = 3.35e+08, loss_total = 3.35e+08
Step 5 : gram_loss = 1.61e+08, loss_total = 1.61e+08
Step 6 : gram_loss = 1.26e+08, loss_total = 1.26e+08
Step 7 : gram_loss = 6.59e+07, loss_total = 6.59e+07
Step 8 : gram_loss = 4.72e+07, loss_total = 4.72e+07
Step 9 : gram_loss = 3.49e+07, loss_total = 3.49e+07
Step 10 : gram_loss = 2.89e+07, loss_total = 2.89e+07
Step 11 : gram_loss = 1.73e+07, loss_total = 1.73e+07
Step 12 : gram_loss = 1.35e+07, loss_total = 1.35e+07
Step 13 : gram_loss = 1.14e+07, loss_total = 1.14e+07
Step 14 : gram_loss = 9.51e+06, loss_total = 9.51e+06
Step 15 : gram_loss = 8.54e+06, loss_total = 8.54e+06
Step 16 : gram_loss = 7.65e+06, loss_total = 7.65e+06
Step 17 : gram_loss = 6.98e+06, loss_total = 6.98e+06
Step 18 : gram_loss = 6.10e+06, loss_total = 6.10e+06
Step 19 : gram_loss = 5.13e+06, loss_total = 5.13e+06
Step 20 : gram_loss = 4.60e+06, loss_total = 4.60e+06
Step 21 : gram_loss = 4.35e+06, loss_total = 4.35e+06
Step 22 : gram_loss = 4.09e+06, loss_total = 4.09e+06
Step 23 : gram_loss = 3.81e+06, loss_total = 3.81e+06
Step 24 : gram_loss = 3.42e+06, loss_total = 3.42e+06
Step 25 : gram_loss = 3.22e+06, loss_total = 3.22e+06
Step 26 : gram_loss = 3.10e+06, loss_total = 3.10e+06
Step 27 : gram_loss = 3.01e+06, loss_total = 3.01e+06
Step 28 : gram_loss = 2.91e+06, loss_total = 2.91e+06
Step 29 : gram_loss = 2.68e+06, loss_total = 2.68e+06
Step 30 : gram_loss = 2.55e+06, loss_total = 2.55e+06
Step 31 : gram_loss = 2.38e+06, loss_total = 2.38e+06
Step 32 : gram_loss = 2.19e+06, loss_total = 2.19e+06
Step 33 : gram_loss = 2.10e+06, loss_total = 2.10e+06
Step 34 : gram_loss = 2.01e+06, loss_total = 2.01e+06
Step 35 : gram_loss = 1.96e+06, loss_total = 1.96e+06
Step 36 : gram_loss = 1.84e+06, loss_total = 1.84e+06
Step 37 : gram_loss = 1.78e+06, loss_total = 1.78e+06
Step 38 : gram_loss = 1.67e+06, loss_total = 1.67e+06
Step 39 : gram_loss = 1.59e+06, loss_total = 1.59e+06
Step 40 : gram_loss = 1.53e+06, loss_total = 1.53e+06
Step 41 : gram_loss = 1.46e+06, loss_total = 1.46e+06
Step 42 : gram_loss = 1.41e+06, loss_total = 1.41e+06
Step 43 : gram_loss = 1.35e+06, loss_total = 1.35e+06
Step 44 : gram_loss = 1.26e+06, loss_total = 1.26e+06
Step 45 : gram_loss = 1.19e+06, loss_total = 1.19e+06
Step 46 : gram_loss = 1.15e+06, loss_total = 1.15e+06
Step 47 : gram_loss = 1.12e+06, loss_total = 1.12e+06
Step 48 : gram_loss = 1.08e+06, loss_total = 1.08e+06
Step 49 : gram_loss = 1.05e+06, loss_total = 1.05e+06
Step 50 : gram_loss = 1.01e+06, loss_total = 1.01e+06
Step 51 : gram_loss = 9.90e+05, loss_total = 9.90e+05
Step 52 : gram_loss = 9.49e+05, loss_total = 9.49e+05
Step 53 : gram_loss = 9.21e+05, loss_total = 9.21e+05
Step 54 : gram_loss = 8.77e+05, loss_total = 8.77e+05
Step 55 : gram_loss = 8.60e+05, loss_total = 8.60e+05
Step 56 : gram_loss = 8.35e+05, loss_total = 8.35e+05
Step 57 : gram_loss = 7.96e+05, loss_total = 7.96e+05
Step 58 : gram_loss = 7.75e+05, loss_total = 7.75e+05
Step 59 : gram_loss = 7.49e+05, loss_total = 7.49e+05
Step 60 : gram_loss = 7.26e+05, loss_total = 7.26e+05
Step 61 : gram_loss = 7.07e+05, loss_total = 7.07e+05
Step 62 : gram_loss = 6.89e+05, loss_total = 6.89e+05
Step 63 : gram_loss = 6.71e+05, loss_total = 6.71e+05
Step 64 : gram_loss = 6.46e+05, loss_total = 6.46e+05
Step 65 : gram_loss = 6.22e+05, loss_total = 6.22e+05
Step 66 : gram_loss = 6.00e+05, loss_total = 6.00e+05
Step 67 : gram_loss = 5.69e+05, loss_total = 5.69e+05
Step 68 : gram_loss = 5.57e+05, loss_total = 5.57e+05
Step 69 : gram_loss = 5.37e+05, loss_total = 5.37e+05
Step 70 : gram_loss = 5.17e+05, loss_total = 5.17e+05
Step 71 : gram_loss = 5.06e+05, loss_total = 5.06e+05
Step 72 : gram_loss = 4.94e+05, loss_total = 4.94e+05
Step 73 : gram_loss = 4.83e+05, loss_total = 4.83e+05
Step 74 : gram_loss = 4.61e+05, loss_total = 4.61e+05
Step 75 : gram_loss = 4.50e+05, loss_total = 4.50e+05
Step 76 : gram_loss = 4.39e+05, loss_total = 4.39e+05
Step 77 : gram_loss = 4.28e+05, loss_total = 4.28e+05
Step 78 : gram_loss = 4.23e+05, loss_total = 4.23e+05
Step 79 : gram_loss = 4.16e+05, loss_total = 4.16e+05
Step 80 : gram_loss = 4.01e+05, loss_total = 4.01e+05
Step 81 : gram_loss = 3.79e+05, loss_total = 3.79e+05
Step 82 : gram_loss = 3.70e+05, loss_total = 3.70e+05
Step 83 : gram_loss = 3.62e+05, loss_total = 3.62e+05
Step 84 : gram_loss = 3.56e+05, loss_total = 3.56e+05
Step 85 : gram_loss = 3.47e+05, loss_total = 3.47e+05
Step 86 : gram_loss = 3.37e+05, loss_total = 3.37e+05
Step 87 : gram_loss = 3.30e+05, loss_total = 3.30e+05
Step 88 : gram_loss = 3.21e+05, loss_total = 3.21e+05
Step 89 : gram_loss = 3.15e+05, loss_total = 3.15e+05
Step 90 : gram_loss = 3.06e+05, loss_total = 3.06e+05
Step 91 : gram_loss = 3.00e+05, loss_total = 3.00e+05
Step 92 : gram_loss = 2.95e+05, loss_total = 2.95e+05
Step 93 : gram_loss = 2.90e+05, loss_total = 2.90e+05
Step 94 : gram_loss = 2.82e+05, loss_total = 2.82e+05
Step 95 : gram_loss = 2.78e+05, loss_total = 2.78e+05
Step 96 : gram_loss = 2.75e+05, loss_total = 2.75e+05
Step 97 : gram_loss = 2.72e+05, loss_total = 2.72e+05
Step 98 : gram_loss = 2.64e+05, loss_total = 2.64e+05
Step 99 : gram_loss = 2.62e+05, loss_total = 2.62e+05
Step 100 : gram_loss = 2.56e+05, loss_total = 2.56e+05
Step 101 : gram_loss = 2.51e+05, loss_total = 2.51e+05
Step 102 : gram_loss = 2.46e+05, loss_total = 2.46e+05
Step 103 : gram_loss = 2.41e+05, loss_total = 2.41e+05
Step 104 : gram_loss = 2.34e+05, loss_total = 2.34e+05
Step 105 : gram_loss = 2.29e+05, loss_total = 2.29e+05
Step 106 : gram_loss = 2.25e+05, loss_total = 2.25e+05
Step 107 : gram_loss = 2.21e+05, loss_total = 2.21e+05
Step 108 : gram_loss = 2.18e+05, loss_total = 2.18e+05
Step 109 : gram_loss = 2.14e+05, loss_total = 2.14e+05
Step 110 : gram_loss = 2.10e+05, loss_total = 2.10e+05
Step 111 : gram_loss = 2.07e+05, loss_total = 2.07e+05
Step 112 : gram_loss = 2.04e+05, loss_total = 2.04e+05
Step 113 : gram_loss = 2.03e+05, loss_total = 2.03e+05
Step 114 : gram_loss = 1.99e+05, loss_total = 1.99e+05
Step 115 : gram_loss = 1.96e+05, loss_total = 1.96e+05
Step 116 : gram_loss = 1.90e+05, loss_total = 1.90e+05
Step 117 : gram_loss = 1.87e+05, loss_total = 1.87e+05
Step 118 : gram_loss = 1.83e+05, loss_total = 1.83e+05
Step 119 : gram_loss = 1.80e+05, loss_total = 1.80e+05
Step 120 : gram_loss = 1.77e+05, loss_total = 1.77e+05
Step 121 : gram_loss = 1.73e+05, loss_total = 1.73e+05
Step 122 : gram_loss = 1.71e+05, loss_total = 1.71e+05
Step 123 : gram_loss = 1.69e+05, loss_total = 1.69e+05
Step 124 : gram_loss = 1.67e+05, loss_total = 1.67e+05
Step 125 : gram_loss = 1.66e+05, loss_total = 1.66e+05
Step 126 : gram_loss = 1.64e+05, loss_total = 1.64e+05
Step 127 : gram_loss = 1.61e+05, loss_total = 1.61e+05
Step 128 : gram_loss = 1.60e+05, loss_total = 1.60e+05
Step 129 : gram_loss = 1.58e+05, loss_total = 1.58e+05
Step 130 : gram_loss = 1.54e+05, loss_total = 1.54e+05
Step 131 : gram_loss = 1.52e+05, loss_total = 1.52e+05
Step 132 : gram_loss = 1.50e+05, loss_total = 1.50e+05
Step 133 : gram_loss = 1.48e+05, loss_total = 1.48e+05
Step 134 : gram_loss = 1.46e+05, loss_total = 1.46e+05
Step 135 : gram_loss = 1.44e+05, loss_total = 1.44e+05
Step 136 : gram_loss = 1.42e+05, loss_total = 1.42e+05
Step 137 : gram_loss = 1.40e+05, loss_total = 1.40e+05
Step 138 : gram_loss = 1.39e+05, loss_total = 1.39e+05
Step 139 : gram_loss = 1.38e+05, loss_total = 1.38e+05
Step 140 : gram_loss = 1.36e+05, loss_total = 1.36e+05
Step 141 : gram_loss = 1.35e+05, loss_total = 1.35e+05
Step 142 : gram_loss = 1.33e+05, loss_total = 1.33e+05
Step 143 : gram_loss = 1.31e+05, loss_total = 1.31e+05
Step 144 : gram_loss = 1.29e+05, loss_total = 1.29e+05
Step 145 : gram_loss = 1.28e+05, loss_total = 1.28e+05
Step 146 : gram_loss = 1.26e+05, loss_total = 1.26e+05
Step 147 : gram_loss = 1.25e+05, loss_total = 1.25e+05
Step 148 : gram_loss = 1.24e+05, loss_total = 1.24e+05
Step 149 : gram_loss = 1.23e+05, loss_total = 1.23e+05
Step 150 : gram_loss = 1.22e+05, loss_total = 1.22e+05
Step 151 : gram_loss = 1.21e+05, loss_total = 1.21e+05
Step 152 : gram_loss = 1.19e+05, loss_total = 1.19e+05
Step 153 : gram_loss = 1.18e+05, loss_total = 1.18e+05
Step 154 : gram_loss = 1.17e+05, loss_total = 1.17e+05
Step 155 : gram_loss = 1.16e+05, loss_total = 1.16e+05
Step 156 : gram_loss = 1.15e+05, loss_total = 1.15e+05
Step 157 : gram_loss = 1.14e+05, loss_total = 1.14e+05
Step 158 : gram_loss = 1.14e+05, loss_total = 1.14e+05
Step 159 : gram_loss = 1.12e+05, loss_total = 1.12e+05
Step 160 : gram_loss = 1.10e+05, loss_total = 1.10e+05
Step 161 : gram_loss = 1.09e+05, loss_total = 1.09e+05
Step 162 : gram_loss = 1.08e+05, loss_total = 1.08e+05
Step 163 : gram_loss = 1.07e+05, loss_total = 1.07e+05
Step 164 : gram_loss = 1.07e+05, loss_total = 1.07e+05
Step 165 : gram_loss = 1.06e+05, loss_total = 1.06e+05
Step 166 : gram_loss = 1.05e+05, loss_total = 1.05e+05
Step 167 : gram_loss = 1.04e+05, loss_total = 1.04e+05
Step 168 : gram_loss = 1.02e+05, loss_total = 1.02e+05
Step 169 : gram_loss = 1.01e+05, loss_total = 1.01e+05
Step 170 : gram_loss = 1.00e+05, loss_total = 1.00e+05
Step 171 : gram_loss = 9.97e+04, loss_total = 9.97e+04
Step 172 : gram_loss = 9.86e+04, loss_total = 9.86e+04
Step 173 : gram_loss = 9.78e+04, loss_total = 9.78e+04
Step 174 : gram_loss = 9.67e+04, loss_total = 9.67e+04
Step 175 : gram_loss = 9.63e+04, loss_total = 9.63e+04
Step 176 : gram_loss = 9.59e+04, loss_total = 9.59e+04
Step 177 : gram_loss = 9.50e+04, loss_total = 9.50e+04
Step 178 : gram_loss = 9.44e+04, loss_total = 9.44e+04
Step 179 : gram_loss = 9.36e+04, loss_total = 9.36e+04
Step 180 : gram_loss = 9.31e+04, loss_total = 9.31e+04
Step 181 : gram_loss = 9.28e+04, loss_total = 9.28e+04
Step 182 : gram_loss = 9.20e+04, loss_total = 9.20e+04
Step 183 : gram_loss = 9.08e+04, loss_total = 9.08e+04
Step 184 : gram_loss = 8.99e+04, loss_total = 8.99e+04
Step 185 : gram_loss = 8.94e+04, loss_total = 8.94e+04
Step 186 : gram_loss = 8.88e+04, loss_total = 8.88e+04
Step 187 : gram_loss = 8.78e+04, loss_total = 8.78e+04
Step 188 : gram_loss = 8.70e+04, loss_total = 8.70e+04
Step 189 : gram_loss = 8.65e+04, loss_total = 8.65e+04
Step 190 : gram_loss = 8.59e+04, loss_total = 8.59e+04
Step 191 : gram_loss = 8.53e+04, loss_total = 8.53e+04
Step 192 : gram_loss = 8.48e+04, loss_total = 8.48e+04
Step 193 : gram_loss = 8.36e+04, loss_total = 8.36e+04
Step 194 : gram_loss = 8.33e+04, loss_total = 8.33e+04
Step 195 : gram_loss = 8.29e+04, loss_total = 8.29e+04
Step 196 : gram_loss = 8.26e+04, loss_total = 8.26e+04
Step 197 : gram_loss = 8.20e+04, loss_total = 8.20e+04
Step 198 : gram_loss = 8.15e+04, loss_total = 8.15e+04
Step 199 : gram_loss = 8.11e+04, loss_total = 8.11e+04
Step 200 : gram_loss = 8.08e+04, loss_total = 8.08e+04
Close Sess - End of the global optimization.
Computation total for  108.09263896942139  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0037_1_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0037_1_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0037_1_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0037_1_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0037_1_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0037_1_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.249969720840454  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 4.23e+09, loss_total = 4.23e+09
Step 1 : gram_loss = 3.50e+09, loss_total = 3.50e+09
Step 2 : gram_loss = 3.22e+09, loss_total = 3.22e+09
Step 3 : gram_loss = 2.16e+09, loss_total = 2.16e+09
Step 4 : gram_loss = 1.96e+09, loss_total = 1.96e+09
Step 5 : gram_loss = 9.58e+08, loss_total = 9.58e+08
Step 6 : gram_loss = 9.53e+08, loss_total = 9.53e+08
Step 7 : gram_loss = 7.55e+08, loss_total = 7.55e+08
Step 8 : gram_loss = 5.60e+08, loss_total = 5.60e+08
Step 9 : gram_loss = 4.84e+08, loss_total = 4.84e+08
Step 10 : gram_loss = 3.72e+08, loss_total = 3.72e+08
Step 11 : gram_loss = 3.21e+08, loss_total = 3.21e+08
Step 12 : gram_loss = 2.41e+08, loss_total = 2.41e+08
Step 13 : gram_loss = 1.60e+08, loss_total = 1.60e+08
Step 14 : gram_loss = 1.17e+08, loss_total = 1.17e+08
Step 15 : gram_loss = 1.05e+08, loss_total = 1.05e+08
Step 16 : gram_loss = 9.01e+07, loss_total = 9.01e+07
Step 17 : gram_loss = 8.45e+07, loss_total = 8.45e+07
Step 18 : gram_loss = 7.55e+07, loss_total = 7.55e+07
Step 19 : gram_loss = 6.44e+07, loss_total = 6.44e+07
Step 20 : gram_loss = 5.01e+07, loss_total = 5.01e+07
Step 21 : gram_loss = 3.71e+07, loss_total = 3.71e+07
Step 22 : gram_loss = 3.01e+07, loss_total = 3.01e+07
Step 23 : gram_loss = 2.78e+07, loss_total = 2.78e+07
Step 24 : gram_loss = 2.48e+07, loss_total = 2.48e+07
Step 25 : gram_loss = 2.26e+07, loss_total = 2.26e+07
Step 26 : gram_loss = 2.06e+07, loss_total = 2.06e+07
Step 27 : gram_loss = 1.97e+07, loss_total = 1.97e+07
Step 28 : gram_loss = 1.91e+07, loss_total = 1.91e+07
Step 29 : gram_loss = 1.71e+07, loss_total = 1.71e+07
Step 30 : gram_loss = 1.58e+07, loss_total = 1.58e+07
Step 31 : gram_loss = 1.40e+07, loss_total = 1.40e+07
Step 32 : gram_loss = 1.34e+07, loss_total = 1.34e+07
Step 33 : gram_loss = 1.24e+07, loss_total = 1.24e+07
Step 34 : gram_loss = 1.13e+07, loss_total = 1.13e+07
Step 35 : gram_loss = 1.08e+07, loss_total = 1.08e+07
Step 36 : gram_loss = 1.02e+07, loss_total = 1.02e+07
Step 37 : gram_loss = 9.95e+06, loss_total = 9.95e+06
Step 38 : gram_loss = 9.49e+06, loss_total = 9.49e+06
Step 39 : gram_loss = 8.67e+06, loss_total = 8.67e+06
Step 40 : gram_loss = 7.99e+06, loss_total = 7.99e+06
Step 41 : gram_loss = 7.42e+06, loss_total = 7.42e+06
Step 42 : gram_loss = 7.20e+06, loss_total = 7.20e+06
Step 43 : gram_loss = 6.75e+06, loss_total = 6.75e+06
Step 44 : gram_loss = 6.53e+06, loss_total = 6.53e+06
Step 45 : gram_loss = 6.29e+06, loss_total = 6.29e+06
Step 46 : gram_loss = 5.88e+06, loss_total = 5.88e+06
Step 47 : gram_loss = 5.66e+06, loss_total = 5.66e+06
Step 48 : gram_loss = 5.47e+06, loss_total = 5.47e+06
Step 49 : gram_loss = 5.36e+06, loss_total = 5.36e+06
Step 50 : gram_loss = 5.15e+06, loss_total = 5.15e+06
Step 51 : gram_loss = 4.97e+06, loss_total = 4.97e+06
Step 52 : gram_loss = 4.88e+06, loss_total = 4.88e+06
Step 53 : gram_loss = 4.63e+06, loss_total = 4.63e+06
Step 54 : gram_loss = 4.38e+06, loss_total = 4.38e+06
Step 55 : gram_loss = 4.12e+06, loss_total = 4.12e+06
Step 56 : gram_loss = 4.02e+06, loss_total = 4.02e+06
Step 57 : gram_loss = 3.81e+06, loss_total = 3.81e+06
Step 58 : gram_loss = 3.72e+06, loss_total = 3.72e+06
Step 59 : gram_loss = 3.58e+06, loss_total = 3.58e+06
Step 60 : gram_loss = 3.51e+06, loss_total = 3.51e+06
Step 61 : gram_loss = 3.35e+06, loss_total = 3.35e+06
Step 62 : gram_loss = 3.28e+06, loss_total = 3.28e+06
Step 63 : gram_loss = 3.12e+06, loss_total = 3.12e+06
Step 64 : gram_loss = 3.00e+06, loss_total = 3.00e+06
Step 65 : gram_loss = 2.75e+06, loss_total = 2.75e+06
Step 66 : gram_loss = 2.60e+06, loss_total = 2.60e+06
Step 67 : gram_loss = 2.50e+06, loss_total = 2.50e+06
Step 68 : gram_loss = 2.43e+06, loss_total = 2.43e+06
Step 69 : gram_loss = 2.36e+06, loss_total = 2.36e+06
Step 70 : gram_loss = 2.21e+06, loss_total = 2.21e+06
Step 71 : gram_loss = 2.10e+06, loss_total = 2.10e+06
Step 72 : gram_loss = 1.96e+06, loss_total = 1.96e+06
Step 73 : gram_loss = 1.93e+06, loss_total = 1.93e+06
Step 74 : gram_loss = 1.83e+06, loss_total = 1.83e+06
Step 75 : gram_loss = 1.79e+06, loss_total = 1.79e+06
Step 76 : gram_loss = 1.74e+06, loss_total = 1.74e+06
Step 77 : gram_loss = 1.66e+06, loss_total = 1.66e+06
Step 78 : gram_loss = 1.60e+06, loss_total = 1.60e+06
Step 79 : gram_loss = 1.55e+06, loss_total = 1.55e+06
Step 80 : gram_loss = 1.51e+06, loss_total = 1.51e+06
Step 81 : gram_loss = 1.47e+06, loss_total = 1.47e+06
Step 82 : gram_loss = 1.42e+06, loss_total = 1.42e+06
Step 83 : gram_loss = 1.37e+06, loss_total = 1.37e+06
Step 84 : gram_loss = 1.33e+06, loss_total = 1.33e+06
Step 85 : gram_loss = 1.24e+06, loss_total = 1.24e+06
Step 86 : gram_loss = 1.21e+06, loss_total = 1.21e+06
Step 87 : gram_loss = 1.18e+06, loss_total = 1.18e+06
Step 88 : gram_loss = 1.13e+06, loss_total = 1.13e+06
Step 89 : gram_loss = 1.08e+06, loss_total = 1.08e+06
Step 90 : gram_loss = 1.04e+06, loss_total = 1.04e+06
Step 91 : gram_loss = 1.01e+06, loss_total = 1.01e+06
Step 92 : gram_loss = 9.85e+05, loss_total = 9.85e+05
Step 93 : gram_loss = 9.60e+05, loss_total = 9.60e+05
Step 94 : gram_loss = 9.27e+05, loss_total = 9.27e+05
Step 95 : gram_loss = 8.81e+05, loss_total = 8.81e+05
Step 96 : gram_loss = 8.58e+05, loss_total = 8.58e+05
Step 97 : gram_loss = 8.38e+05, loss_total = 8.38e+05
Step 98 : gram_loss = 8.11e+05, loss_total = 8.11e+05
Step 99 : gram_loss = 7.90e+05, loss_total = 7.90e+05
Step 100 : gram_loss = 7.78e+05, loss_total = 7.78e+05
Step 101 : gram_loss = 7.60e+05, loss_total = 7.60e+05
Step 102 : gram_loss = 7.49e+05, loss_total = 7.49e+05
Step 103 : gram_loss = 7.37e+05, loss_total = 7.37e+05
Step 104 : gram_loss = 7.25e+05, loss_total = 7.25e+05
Step 105 : gram_loss = 7.17e+05, loss_total = 7.17e+05
Step 106 : gram_loss = 6.95e+05, loss_total = 6.95e+05
Step 107 : gram_loss = 6.74e+05, loss_total = 6.74e+05
Step 108 : gram_loss = 6.58e+05, loss_total = 6.58e+05
Step 109 : gram_loss = 6.41e+05, loss_total = 6.41e+05
Step 110 : gram_loss = 6.34e+05, loss_total = 6.34e+05
Step 111 : gram_loss = 6.22e+05, loss_total = 6.22e+05
Step 112 : gram_loss = 6.16e+05, loss_total = 6.16e+05
Step 113 : gram_loss = 6.08e+05, loss_total = 6.08e+05
Step 114 : gram_loss = 5.90e+05, loss_total = 5.90e+05
Step 115 : gram_loss = 5.74e+05, loss_total = 5.74e+05
Step 116 : gram_loss = 5.57e+05, loss_total = 5.57e+05
Step 117 : gram_loss = 5.48e+05, loss_total = 5.48e+05
Step 118 : gram_loss = 5.37e+05, loss_total = 5.37e+05
Step 119 : gram_loss = 5.29e+05, loss_total = 5.29e+05
Step 120 : gram_loss = 5.20e+05, loss_total = 5.20e+05
Step 121 : gram_loss = 5.09e+05, loss_total = 5.09e+05
Step 122 : gram_loss = 4.99e+05, loss_total = 4.99e+05
Step 123 : gram_loss = 4.91e+05, loss_total = 4.91e+05
Step 124 : gram_loss = 4.86e+05, loss_total = 4.86e+05
Step 125 : gram_loss = 4.83e+05, loss_total = 4.83e+05
Step 126 : gram_loss = 4.79e+05, loss_total = 4.79e+05
Step 127 : gram_loss = 4.71e+05, loss_total = 4.71e+05
Step 128 : gram_loss = 4.64e+05, loss_total = 4.64e+05
Step 129 : gram_loss = 4.61e+05, loss_total = 4.61e+05
Step 130 : gram_loss = 4.56e+05, loss_total = 4.56e+05
Step 131 : gram_loss = 4.49e+05, loss_total = 4.49e+05
Step 132 : gram_loss = 4.42e+05, loss_total = 4.42e+05
Step 133 : gram_loss = 4.37e+05, loss_total = 4.37e+05
Step 134 : gram_loss = 4.33e+05, loss_total = 4.33e+05
Step 135 : gram_loss = 4.27e+05, loss_total = 4.27e+05
Step 136 : gram_loss = 4.20e+05, loss_total = 4.20e+05
Step 137 : gram_loss = 4.15e+05, loss_total = 4.15e+05
Step 138 : gram_loss = 4.12e+05, loss_total = 4.12e+05
Step 139 : gram_loss = 4.09e+05, loss_total = 4.09e+05
Step 140 : gram_loss = 4.07e+05, loss_total = 4.07e+05
Step 141 : gram_loss = 4.01e+05, loss_total = 4.01e+05
Step 142 : gram_loss = 3.98e+05, loss_total = 3.98e+05
Step 143 : gram_loss = 3.92e+05, loss_total = 3.92e+05
Step 144 : gram_loss = 3.88e+05, loss_total = 3.88e+05
Step 145 : gram_loss = 3.86e+05, loss_total = 3.86e+05
Step 146 : gram_loss = 3.83e+05, loss_total = 3.83e+05
Step 147 : gram_loss = 3.82e+05, loss_total = 3.82e+05
Step 148 : gram_loss = 3.80e+05, loss_total = 3.80e+05
Step 149 : gram_loss = 3.75e+05, loss_total = 3.75e+05
Step 150 : gram_loss = 3.73e+05, loss_total = 3.73e+05
Step 151 : gram_loss = 3.69e+05, loss_total = 3.69e+05
Step 152 : gram_loss = 3.68e+05, loss_total = 3.68e+05
Step 153 : gram_loss = 3.65e+05, loss_total = 3.65e+05
Step 154 : gram_loss = 3.64e+05, loss_total = 3.64e+05
Step 155 : gram_loss = 3.62e+05, loss_total = 3.62e+05
Step 156 : gram_loss = 3.59e+05, loss_total = 3.59e+05
Step 157 : gram_loss = 3.56e+05, loss_total = 3.56e+05
Step 158 : gram_loss = 3.50e+05, loss_total = 3.50e+05
Step 159 : gram_loss = 3.48e+05, loss_total = 3.48e+05
Step 160 : gram_loss = 3.45e+05, loss_total = 3.45e+05
Step 161 : gram_loss = 3.43e+05, loss_total = 3.43e+05
Step 162 : gram_loss = 3.40e+05, loss_total = 3.40e+05
Step 163 : gram_loss = 3.38e+05, loss_total = 3.38e+05
Step 164 : gram_loss = 3.36e+05, loss_total = 3.36e+05
Step 165 : gram_loss = 3.35e+05, loss_total = 3.35e+05
Step 166 : gram_loss = 3.32e+05, loss_total = 3.32e+05
Step 167 : gram_loss = 3.31e+05, loss_total = 3.31e+05
Step 168 : gram_loss = 3.30e+05, loss_total = 3.30e+05
Step 169 : gram_loss = 3.28e+05, loss_total = 3.28e+05
Step 170 : gram_loss = 3.26e+05, loss_total = 3.26e+05
Step 171 : gram_loss = 3.25e+05, loss_total = 3.25e+05
Step 172 : gram_loss = 3.22e+05, loss_total = 3.22e+05
Step 173 : gram_loss = 3.20e+05, loss_total = 3.20e+05
Step 174 : gram_loss = 3.18e+05, loss_total = 3.18e+05
Step 175 : gram_loss = 3.16e+05, loss_total = 3.16e+05
Step 176 : gram_loss = 3.15e+05, loss_total = 3.15e+05
Step 177 : gram_loss = 3.12e+05, loss_total = 3.12e+05
Step 178 : gram_loss = 3.10e+05, loss_total = 3.10e+05
Step 179 : gram_loss = 3.08e+05, loss_total = 3.08e+05
Step 180 : gram_loss = 3.05e+05, loss_total = 3.05e+05
Step 181 : gram_loss = 3.03e+05, loss_total = 3.03e+05
Step 182 : gram_loss = 3.01e+05, loss_total = 3.01e+05
Step 183 : gram_loss = 3.00e+05, loss_total = 3.00e+05
Step 184 : gram_loss = 2.99e+05, loss_total = 2.99e+05
Step 185 : gram_loss = 2.96e+05, loss_total = 2.96e+05
Step 186 : gram_loss = 2.94e+05, loss_total = 2.94e+05
Step 187 : gram_loss = 2.93e+05, loss_total = 2.93e+05
Step 188 : gram_loss = 2.90e+05, loss_total = 2.90e+05
Step 189 : gram_loss = 2.88e+05, loss_total = 2.88e+05
Step 190 : gram_loss = 2.87e+05, loss_total = 2.87e+05
Step 191 : gram_loss = 2.86e+05, loss_total = 2.86e+05
Step 192 : gram_loss = 2.85e+05, loss_total = 2.85e+05
Step 193 : gram_loss = 2.84e+05, loss_total = 2.84e+05
Step 194 : gram_loss = 2.83e+05, loss_total = 2.83e+05
Step 195 : gram_loss = 2.81e+05, loss_total = 2.81e+05
Step 196 : gram_loss = 2.80e+05, loss_total = 2.80e+05
Step 197 : gram_loss = 2.78e+05, loss_total = 2.78e+05
Step 198 : gram_loss = 2.77e+05, loss_total = 2.77e+05
Step 199 : gram_loss = 2.77e+05, loss_total = 2.77e+05
Step 200 : gram_loss = 2.75e+05, loss_total = 2.75e+05
Close Sess - End of the global optimization.
Computation total for  108.92445874214172  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0010_1_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0010_1_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0010_1_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0010_1_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0010_1_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0010_1_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.329709529876709  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 2.37e+09, loss_total = 2.37e+09
Step 1 : gram_loss = 3.66e+08, loss_total = 3.66e+08
Step 2 : gram_loss = 3.53e+08, loss_total = 3.53e+08
Step 3 : gram_loss = 2.02e+08, loss_total = 2.02e+08
Step 4 : gram_loss = 1.42e+08, loss_total = 1.42e+08
Step 5 : gram_loss = 1.16e+08, loss_total = 1.16e+08
Step 6 : gram_loss = 9.61e+07, loss_total = 9.61e+07
Step 7 : gram_loss = 6.95e+07, loss_total = 6.95e+07
Step 8 : gram_loss = 5.57e+07, loss_total = 5.57e+07
Step 9 : gram_loss = 4.74e+07, loss_total = 4.74e+07
Step 10 : gram_loss = 4.23e+07, loss_total = 4.23e+07
Step 11 : gram_loss = 4.02e+07, loss_total = 4.02e+07
Step 12 : gram_loss = 3.47e+07, loss_total = 3.47e+07
Step 13 : gram_loss = 3.00e+07, loss_total = 3.00e+07
Step 14 : gram_loss = 2.69e+07, loss_total = 2.69e+07
Step 15 : gram_loss = 2.33e+07, loss_total = 2.33e+07
Step 16 : gram_loss = 2.19e+07, loss_total = 2.19e+07
Step 17 : gram_loss = 1.88e+07, loss_total = 1.88e+07
Step 18 : gram_loss = 1.65e+07, loss_total = 1.65e+07
Step 19 : gram_loss = 1.50e+07, loss_total = 1.50e+07
Step 20 : gram_loss = 1.45e+07, loss_total = 1.45e+07
Step 21 : gram_loss = 1.29e+07, loss_total = 1.29e+07
Step 22 : gram_loss = 1.24e+07, loss_total = 1.24e+07
Step 23 : gram_loss = 1.19e+07, loss_total = 1.19e+07
Step 24 : gram_loss = 1.06e+07, loss_total = 1.06e+07
Step 25 : gram_loss = 9.83e+06, loss_total = 9.83e+06
Step 26 : gram_loss = 8.96e+06, loss_total = 8.96e+06
Step 27 : gram_loss = 8.55e+06, loss_total = 8.55e+06
Step 28 : gram_loss = 8.25e+06, loss_total = 8.25e+06
Step 29 : gram_loss = 7.71e+06, loss_total = 7.71e+06
Step 30 : gram_loss = 7.38e+06, loss_total = 7.38e+06
Step 31 : gram_loss = 6.95e+06, loss_total = 6.95e+06
Step 32 : gram_loss = 6.47e+06, loss_total = 6.47e+06
Step 33 : gram_loss = 6.24e+06, loss_total = 6.24e+06
Step 34 : gram_loss = 5.83e+06, loss_total = 5.83e+06
Step 35 : gram_loss = 5.50e+06, loss_total = 5.50e+06
Step 36 : gram_loss = 5.02e+06, loss_total = 5.02e+06
Step 37 : gram_loss = 4.76e+06, loss_total = 4.76e+06
Step 38 : gram_loss = 4.43e+06, loss_total = 4.43e+06
Step 39 : gram_loss = 4.25e+06, loss_total = 4.25e+06
Step 40 : gram_loss = 4.01e+06, loss_total = 4.01e+06
Step 41 : gram_loss = 3.75e+06, loss_total = 3.75e+06
Step 42 : gram_loss = 3.44e+06, loss_total = 3.44e+06
Step 43 : gram_loss = 3.28e+06, loss_total = 3.28e+06
Step 44 : gram_loss = 3.16e+06, loss_total = 3.16e+06
Step 45 : gram_loss = 3.01e+06, loss_total = 3.01e+06
Step 46 : gram_loss = 2.90e+06, loss_total = 2.90e+06
Step 47 : gram_loss = 2.65e+06, loss_total = 2.65e+06
Step 48 : gram_loss = 2.49e+06, loss_total = 2.49e+06
Step 49 : gram_loss = 2.26e+06, loss_total = 2.26e+06
Step 50 : gram_loss = 2.03e+06, loss_total = 2.03e+06
Step 51 : gram_loss = 1.93e+06, loss_total = 1.93e+06
Step 52 : gram_loss = 1.83e+06, loss_total = 1.83e+06
Step 53 : gram_loss = 1.74e+06, loss_total = 1.74e+06
Step 54 : gram_loss = 1.68e+06, loss_total = 1.68e+06
Step 55 : gram_loss = 1.61e+06, loss_total = 1.61e+06
Step 56 : gram_loss = 1.51e+06, loss_total = 1.51e+06
Step 57 : gram_loss = 1.35e+06, loss_total = 1.35e+06
Step 58 : gram_loss = 1.25e+06, loss_total = 1.25e+06
Step 59 : gram_loss = 1.23e+06, loss_total = 1.23e+06
Step 60 : gram_loss = 1.17e+06, loss_total = 1.17e+06
Step 61 : gram_loss = 1.14e+06, loss_total = 1.14e+06
Step 62 : gram_loss = 1.07e+06, loss_total = 1.07e+06
Step 63 : gram_loss = 1.01e+06, loss_total = 1.01e+06
Step 64 : gram_loss = 9.55e+05, loss_total = 9.55e+05
Step 65 : gram_loss = 8.84e+05, loss_total = 8.84e+05
Step 66 : gram_loss = 8.56e+05, loss_total = 8.56e+05
Step 67 : gram_loss = 8.23e+05, loss_total = 8.23e+05
Step 68 : gram_loss = 7.98e+05, loss_total = 7.98e+05
Step 69 : gram_loss = 7.53e+05, loss_total = 7.53e+05
Step 70 : gram_loss = 7.08e+05, loss_total = 7.08e+05
Step 71 : gram_loss = 6.78e+05, loss_total = 6.78e+05
Step 72 : gram_loss = 6.53e+05, loss_total = 6.53e+05
Step 73 : gram_loss = 6.25e+05, loss_total = 6.25e+05
Step 74 : gram_loss = 6.09e+05, loss_total = 6.09e+05
Step 75 : gram_loss = 5.72e+05, loss_total = 5.72e+05
Step 76 : gram_loss = 5.52e+05, loss_total = 5.52e+05
Step 77 : gram_loss = 5.31e+05, loss_total = 5.31e+05
Step 78 : gram_loss = 5.06e+05, loss_total = 5.06e+05
Step 79 : gram_loss = 4.97e+05, loss_total = 4.97e+05
Step 80 : gram_loss = 4.85e+05, loss_total = 4.85e+05
Step 81 : gram_loss = 4.63e+05, loss_total = 4.63e+05
Step 82 : gram_loss = 4.44e+05, loss_total = 4.44e+05
Step 83 : gram_loss = 4.27e+05, loss_total = 4.27e+05
Step 84 : gram_loss = 4.07e+05, loss_total = 4.07e+05
Step 85 : gram_loss = 3.96e+05, loss_total = 3.96e+05
Step 86 : gram_loss = 3.89e+05, loss_total = 3.89e+05
Step 87 : gram_loss = 3.77e+05, loss_total = 3.77e+05
Step 88 : gram_loss = 3.72e+05, loss_total = 3.72e+05
Step 89 : gram_loss = 3.64e+05, loss_total = 3.64e+05
Step 90 : gram_loss = 3.53e+05, loss_total = 3.53e+05
Step 91 : gram_loss = 3.40e+05, loss_total = 3.40e+05
Step 92 : gram_loss = 3.31e+05, loss_total = 3.31e+05
Step 93 : gram_loss = 3.23e+05, loss_total = 3.23e+05
Step 94 : gram_loss = 3.17e+05, loss_total = 3.17e+05
Step 95 : gram_loss = 3.07e+05, loss_total = 3.07e+05
Step 96 : gram_loss = 2.95e+05, loss_total = 2.95e+05
Step 97 : gram_loss = 2.84e+05, loss_total = 2.84e+05
Step 98 : gram_loss = 2.79e+05, loss_total = 2.79e+05
Step 99 : gram_loss = 2.73e+05, loss_total = 2.73e+05
Step 100 : gram_loss = 2.67e+05, loss_total = 2.67e+05
Step 101 : gram_loss = 2.59e+05, loss_total = 2.59e+05
Step 102 : gram_loss = 2.53e+05, loss_total = 2.53e+05
Step 103 : gram_loss = 2.45e+05, loss_total = 2.45e+05
Step 104 : gram_loss = 2.42e+05, loss_total = 2.42e+05
Step 105 : gram_loss = 2.36e+05, loss_total = 2.36e+05
Step 106 : gram_loss = 2.33e+05, loss_total = 2.33e+05
Step 107 : gram_loss = 2.29e+05, loss_total = 2.29e+05
Step 108 : gram_loss = 2.22e+05, loss_total = 2.22e+05
Step 109 : gram_loss = 2.14e+05, loss_total = 2.14e+05
Step 110 : gram_loss = 2.09e+05, loss_total = 2.09e+05
Step 111 : gram_loss = 2.02e+05, loss_total = 2.02e+05
Step 112 : gram_loss = 1.99e+05, loss_total = 1.99e+05
Step 113 : gram_loss = 1.95e+05, loss_total = 1.95e+05
Step 114 : gram_loss = 1.92e+05, loss_total = 1.92e+05
Step 115 : gram_loss = 1.89e+05, loss_total = 1.89e+05
Step 116 : gram_loss = 1.85e+05, loss_total = 1.85e+05
Step 117 : gram_loss = 1.80e+05, loss_total = 1.80e+05
Step 118 : gram_loss = 1.76e+05, loss_total = 1.76e+05
Step 119 : gram_loss = 1.72e+05, loss_total = 1.72e+05
Step 120 : gram_loss = 1.70e+05, loss_total = 1.70e+05
Step 121 : gram_loss = 1.67e+05, loss_total = 1.67e+05
Step 122 : gram_loss = 1.65e+05, loss_total = 1.65e+05
Step 123 : gram_loss = 1.62e+05, loss_total = 1.62e+05
Step 124 : gram_loss = 1.59e+05, loss_total = 1.59e+05
Step 125 : gram_loss = 1.56e+05, loss_total = 1.56e+05
Step 126 : gram_loss = 1.53e+05, loss_total = 1.53e+05
Step 127 : gram_loss = 1.51e+05, loss_total = 1.51e+05
Step 128 : gram_loss = 1.48e+05, loss_total = 1.48e+05
Step 129 : gram_loss = 1.46e+05, loss_total = 1.46e+05
Step 130 : gram_loss = 1.45e+05, loss_total = 1.45e+05
Step 131 : gram_loss = 1.43e+05, loss_total = 1.43e+05
Step 132 : gram_loss = 1.41e+05, loss_total = 1.41e+05
Step 133 : gram_loss = 1.39e+05, loss_total = 1.39e+05
Step 134 : gram_loss = 1.36e+05, loss_total = 1.36e+05
Step 135 : gram_loss = 1.34e+05, loss_total = 1.34e+05
Step 136 : gram_loss = 1.33e+05, loss_total = 1.33e+05
Step 137 : gram_loss = 1.30e+05, loss_total = 1.30e+05
Step 138 : gram_loss = 1.28e+05, loss_total = 1.28e+05
Step 139 : gram_loss = 1.26e+05, loss_total = 1.26e+05
Step 140 : gram_loss = 1.24e+05, loss_total = 1.24e+05
Step 141 : gram_loss = 1.23e+05, loss_total = 1.23e+05
Step 142 : gram_loss = 1.22e+05, loss_total = 1.22e+05
Step 143 : gram_loss = 1.20e+05, loss_total = 1.20e+05
Step 144 : gram_loss = 1.18e+05, loss_total = 1.18e+05
Step 145 : gram_loss = 1.16e+05, loss_total = 1.16e+05
Step 146 : gram_loss = 1.15e+05, loss_total = 1.15e+05
Step 147 : gram_loss = 1.13e+05, loss_total = 1.13e+05
Step 148 : gram_loss = 1.13e+05, loss_total = 1.13e+05
Step 149 : gram_loss = 1.11e+05, loss_total = 1.11e+05
Step 150 : gram_loss = 1.09e+05, loss_total = 1.09e+05
Step 151 : gram_loss = 1.08e+05, loss_total = 1.08e+05
Step 152 : gram_loss = 1.07e+05, loss_total = 1.07e+05
Step 153 : gram_loss = 1.06e+05, loss_total = 1.06e+05
Step 154 : gram_loss = 1.05e+05, loss_total = 1.05e+05
Step 155 : gram_loss = 1.04e+05, loss_total = 1.04e+05
Step 156 : gram_loss = 1.03e+05, loss_total = 1.03e+05
Step 157 : gram_loss = 1.01e+05, loss_total = 1.01e+05
Step 158 : gram_loss = 1.00e+05, loss_total = 1.00e+05
Step 159 : gram_loss = 9.94e+04, loss_total = 9.94e+04
Step 160 : gram_loss = 9.84e+04, loss_total = 9.84e+04
Step 161 : gram_loss = 9.74e+04, loss_total = 9.74e+04
Step 162 : gram_loss = 9.64e+04, loss_total = 9.64e+04
Step 163 : gram_loss = 9.56e+04, loss_total = 9.56e+04
Step 164 : gram_loss = 9.43e+04, loss_total = 9.43e+04
Step 165 : gram_loss = 9.33e+04, loss_total = 9.33e+04
Step 166 : gram_loss = 9.26e+04, loss_total = 9.26e+04
Step 167 : gram_loss = 9.15e+04, loss_total = 9.15e+04
Step 168 : gram_loss = 9.10e+04, loss_total = 9.10e+04
Step 169 : gram_loss = 9.03e+04, loss_total = 9.03e+04
Step 170 : gram_loss = 8.97e+04, loss_total = 8.97e+04
Step 171 : gram_loss = 8.92e+04, loss_total = 8.92e+04
Step 172 : gram_loss = 8.80e+04, loss_total = 8.80e+04
Step 173 : gram_loss = 8.74e+04, loss_total = 8.74e+04
Step 174 : gram_loss = 8.66e+04, loss_total = 8.66e+04
Step 175 : gram_loss = 8.61e+04, loss_total = 8.61e+04
Step 176 : gram_loss = 8.59e+04, loss_total = 8.59e+04
Step 177 : gram_loss = 8.53e+04, loss_total = 8.53e+04
Step 178 : gram_loss = 8.45e+04, loss_total = 8.45e+04
Step 179 : gram_loss = 8.38e+04, loss_total = 8.38e+04
Step 180 : gram_loss = 8.26e+04, loss_total = 8.26e+04
Step 181 : gram_loss = 8.23e+04, loss_total = 8.23e+04
Step 182 : gram_loss = 8.17e+04, loss_total = 8.17e+04
Step 183 : gram_loss = 8.10e+04, loss_total = 8.10e+04
Step 184 : gram_loss = 8.02e+04, loss_total = 8.02e+04
Step 185 : gram_loss = 7.97e+04, loss_total = 7.97e+04
Step 186 : gram_loss = 7.89e+04, loss_total = 7.89e+04
Step 187 : gram_loss = 7.87e+04, loss_total = 7.87e+04
Step 188 : gram_loss = 7.78e+04, loss_total = 7.78e+04
Step 189 : gram_loss = 7.75e+04, loss_total = 7.75e+04
Step 190 : gram_loss = 7.72e+04, loss_total = 7.72e+04
Step 191 : gram_loss = 7.67e+04, loss_total = 7.67e+04
Step 192 : gram_loss = 7.59e+04, loss_total = 7.59e+04
Step 193 : gram_loss = 7.53e+04, loss_total = 7.53e+04
Step 194 : gram_loss = 7.49e+04, loss_total = 7.49e+04
Step 195 : gram_loss = 7.42e+04, loss_total = 7.42e+04
Step 196 : gram_loss = 7.40e+04, loss_total = 7.40e+04
Step 197 : gram_loss = 7.32e+04, loss_total = 7.32e+04
Step 198 : gram_loss = 7.30e+04, loss_total = 7.30e+04
Step 199 : gram_loss = 7.26e+04, loss_total = 7.26e+04
Step 200 : gram_loss = 7.22e+04, loss_total = 7.22e+04
Close Sess - End of the global optimization.
Computation total for  108.24999594688416  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0042_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0042_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0042_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0042_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0042_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0042_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.165092706680298  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 2.12e+09, loss_total = 2.12e+09
Step 1 : gram_loss = 1.09e+09, loss_total = 1.09e+09
Step 2 : gram_loss = 9.21e+08, loss_total = 9.21e+08
Step 3 : gram_loss = 4.82e+08, loss_total = 4.82e+08
Step 4 : gram_loss = 3.31e+08, loss_total = 3.31e+08
Step 5 : gram_loss = 2.29e+08, loss_total = 2.29e+08
Step 6 : gram_loss = 1.89e+08, loss_total = 1.89e+08
Step 7 : gram_loss = 1.36e+08, loss_total = 1.36e+08
Step 8 : gram_loss = 1.11e+08, loss_total = 1.11e+08
Step 9 : gram_loss = 7.55e+07, loss_total = 7.55e+07
Step 10 : gram_loss = 6.00e+07, loss_total = 6.00e+07
Step 11 : gram_loss = 4.04e+07, loss_total = 4.04e+07
Step 12 : gram_loss = 2.91e+07, loss_total = 2.91e+07
Step 13 : gram_loss = 2.39e+07, loss_total = 2.39e+07
Step 14 : gram_loss = 1.78e+07, loss_total = 1.78e+07
Step 15 : gram_loss = 1.57e+07, loss_total = 1.57e+07
Step 16 : gram_loss = 1.42e+07, loss_total = 1.42e+07
Step 17 : gram_loss = 1.32e+07, loss_total = 1.32e+07
Step 18 : gram_loss = 1.15e+07, loss_total = 1.15e+07
Step 19 : gram_loss = 9.13e+06, loss_total = 9.13e+06
Step 20 : gram_loss = 8.00e+06, loss_total = 8.00e+06
Step 21 : gram_loss = 6.55e+06, loss_total = 6.55e+06
Step 22 : gram_loss = 6.32e+06, loss_total = 6.32e+06
Step 23 : gram_loss = 5.97e+06, loss_total = 5.97e+06
Step 24 : gram_loss = 5.40e+06, loss_total = 5.40e+06
Step 25 : gram_loss = 5.07e+06, loss_total = 5.07e+06
Step 26 : gram_loss = 4.40e+06, loss_total = 4.40e+06
Step 27 : gram_loss = 4.13e+06, loss_total = 4.13e+06
Step 28 : gram_loss = 3.93e+06, loss_total = 3.93e+06
Step 29 : gram_loss = 3.71e+06, loss_total = 3.71e+06
Step 30 : gram_loss = 3.54e+06, loss_total = 3.54e+06
Step 31 : gram_loss = 3.29e+06, loss_total = 3.29e+06
Step 32 : gram_loss = 3.08e+06, loss_total = 3.08e+06
Step 33 : gram_loss = 2.97e+06, loss_total = 2.97e+06
Step 34 : gram_loss = 2.76e+06, loss_total = 2.76e+06
Step 35 : gram_loss = 2.65e+06, loss_total = 2.65e+06
Step 36 : gram_loss = 2.41e+06, loss_total = 2.41e+06
Step 37 : gram_loss = 2.29e+06, loss_total = 2.29e+06
Step 38 : gram_loss = 2.17e+06, loss_total = 2.17e+06
Step 39 : gram_loss = 2.01e+06, loss_total = 2.01e+06
Step 40 : gram_loss = 1.91e+06, loss_total = 1.91e+06
Step 41 : gram_loss = 1.81e+06, loss_total = 1.81e+06
Step 42 : gram_loss = 1.74e+06, loss_total = 1.74e+06
Step 43 : gram_loss = 1.66e+06, loss_total = 1.66e+06
Step 44 : gram_loss = 1.56e+06, loss_total = 1.56e+06
Step 45 : gram_loss = 1.48e+06, loss_total = 1.48e+06
Step 46 : gram_loss = 1.43e+06, loss_total = 1.43e+06
Step 47 : gram_loss = 1.39e+06, loss_total = 1.39e+06
Step 48 : gram_loss = 1.26e+06, loss_total = 1.26e+06
Step 49 : gram_loss = 1.21e+06, loss_total = 1.21e+06
Step 50 : gram_loss = 1.16e+06, loss_total = 1.16e+06
Step 51 : gram_loss = 1.14e+06, loss_total = 1.14e+06
Step 52 : gram_loss = 1.09e+06, loss_total = 1.09e+06
Step 53 : gram_loss = 1.07e+06, loss_total = 1.07e+06
Step 54 : gram_loss = 1.02e+06, loss_total = 1.02e+06
Step 55 : gram_loss = 9.95e+05, loss_total = 9.95e+05
Step 56 : gram_loss = 9.60e+05, loss_total = 9.60e+05
Step 57 : gram_loss = 9.15e+05, loss_total = 9.15e+05
Step 58 : gram_loss = 9.00e+05, loss_total = 9.00e+05
Step 59 : gram_loss = 8.64e+05, loss_total = 8.64e+05
Step 60 : gram_loss = 8.40e+05, loss_total = 8.40e+05
Step 61 : gram_loss = 7.93e+05, loss_total = 7.93e+05
Step 62 : gram_loss = 7.76e+05, loss_total = 7.76e+05
Step 63 : gram_loss = 7.62e+05, loss_total = 7.62e+05
Step 64 : gram_loss = 7.56e+05, loss_total = 7.56e+05
Step 65 : gram_loss = 7.35e+05, loss_total = 7.35e+05
Step 66 : gram_loss = 7.21e+05, loss_total = 7.21e+05
Step 67 : gram_loss = 7.05e+05, loss_total = 7.05e+05
Step 68 : gram_loss = 6.77e+05, loss_total = 6.77e+05
Step 69 : gram_loss = 6.50e+05, loss_total = 6.50e+05
Step 70 : gram_loss = 6.30e+05, loss_total = 6.30e+05
Step 71 : gram_loss = 6.17e+05, loss_total = 6.17e+05
Step 72 : gram_loss = 6.06e+05, loss_total = 6.06e+05
Step 73 : gram_loss = 5.90e+05, loss_total = 5.90e+05
Step 74 : gram_loss = 5.76e+05, loss_total = 5.76e+05
Step 75 : gram_loss = 5.58e+05, loss_total = 5.58e+05
Step 76 : gram_loss = 5.46e+05, loss_total = 5.46e+05
Step 77 : gram_loss = 5.39e+05, loss_total = 5.39e+05
Step 78 : gram_loss = 5.31e+05, loss_total = 5.31e+05
Step 79 : gram_loss = 5.23e+05, loss_total = 5.23e+05
Step 80 : gram_loss = 5.12e+05, loss_total = 5.12e+05
Step 81 : gram_loss = 4.97e+05, loss_total = 4.97e+05
Step 82 : gram_loss = 4.88e+05, loss_total = 4.88e+05
Step 83 : gram_loss = 4.82e+05, loss_total = 4.82e+05
Step 84 : gram_loss = 4.75e+05, loss_total = 4.75e+05
Step 85 : gram_loss = 4.66e+05, loss_total = 4.66e+05
Step 86 : gram_loss = 4.55e+05, loss_total = 4.55e+05
Step 87 : gram_loss = 4.48e+05, loss_total = 4.48e+05
Step 88 : gram_loss = 4.41e+05, loss_total = 4.41e+05
Step 89 : gram_loss = 4.35e+05, loss_total = 4.35e+05
Step 90 : gram_loss = 4.31e+05, loss_total = 4.31e+05
Step 91 : gram_loss = 4.24e+05, loss_total = 4.24e+05
Step 92 : gram_loss = 4.17e+05, loss_total = 4.17e+05
Step 93 : gram_loss = 4.10e+05, loss_total = 4.10e+05
Step 94 : gram_loss = 4.04e+05, loss_total = 4.04e+05
Step 95 : gram_loss = 3.95e+05, loss_total = 3.95e+05
Step 96 : gram_loss = 3.87e+05, loss_total = 3.87e+05
Step 97 : gram_loss = 3.81e+05, loss_total = 3.81e+05
Step 98 : gram_loss = 3.76e+05, loss_total = 3.76e+05
Step 99 : gram_loss = 3.72e+05, loss_total = 3.72e+05
Step 100 : gram_loss = 3.68e+05, loss_total = 3.68e+05
Step 101 : gram_loss = 3.64e+05, loss_total = 3.64e+05
Step 102 : gram_loss = 3.55e+05, loss_total = 3.55e+05
Step 103 : gram_loss = 3.51e+05, loss_total = 3.51e+05
Step 104 : gram_loss = 3.46e+05, loss_total = 3.46e+05
Step 105 : gram_loss = 3.42e+05, loss_total = 3.42e+05
Step 106 : gram_loss = 3.39e+05, loss_total = 3.39e+05
Step 107 : gram_loss = 3.35e+05, loss_total = 3.35e+05
Step 108 : gram_loss = 3.30e+05, loss_total = 3.30e+05
Step 109 : gram_loss = 3.25e+05, loss_total = 3.25e+05
Step 110 : gram_loss = 3.20e+05, loss_total = 3.20e+05
Step 111 : gram_loss = 3.17e+05, loss_total = 3.17e+05
Step 112 : gram_loss = 3.14e+05, loss_total = 3.14e+05
Step 113 : gram_loss = 3.09e+05, loss_total = 3.09e+05
Step 114 : gram_loss = 3.06e+05, loss_total = 3.06e+05
Step 115 : gram_loss = 3.02e+05, loss_total = 3.02e+05
Step 116 : gram_loss = 2.99e+05, loss_total = 2.99e+05
Step 117 : gram_loss = 2.97e+05, loss_total = 2.97e+05
Step 118 : gram_loss = 2.94e+05, loss_total = 2.94e+05
Step 119 : gram_loss = 2.89e+05, loss_total = 2.89e+05
Step 120 : gram_loss = 2.86e+05, loss_total = 2.86e+05
Step 121 : gram_loss = 2.82e+05, loss_total = 2.82e+05
Step 122 : gram_loss = 2.79e+05, loss_total = 2.79e+05
Step 123 : gram_loss = 2.77e+05, loss_total = 2.77e+05
Step 124 : gram_loss = 2.75e+05, loss_total = 2.75e+05
Step 125 : gram_loss = 2.72e+05, loss_total = 2.72e+05
Step 126 : gram_loss = 2.70e+05, loss_total = 2.70e+05
Step 127 : gram_loss = 2.67e+05, loss_total = 2.67e+05
Step 128 : gram_loss = 2.65e+05, loss_total = 2.65e+05
Step 129 : gram_loss = 2.63e+05, loss_total = 2.63e+05
Step 130 : gram_loss = 2.62e+05, loss_total = 2.62e+05
Step 131 : gram_loss = 2.60e+05, loss_total = 2.60e+05
Step 132 : gram_loss = 2.57e+05, loss_total = 2.57e+05
Step 133 : gram_loss = 2.55e+05, loss_total = 2.55e+05
Step 134 : gram_loss = 2.54e+05, loss_total = 2.54e+05
Step 135 : gram_loss = 2.51e+05, loss_total = 2.51e+05
Step 136 : gram_loss = 2.50e+05, loss_total = 2.50e+05
Step 137 : gram_loss = 2.48e+05, loss_total = 2.48e+05
Step 138 : gram_loss = 2.46e+05, loss_total = 2.46e+05
Step 139 : gram_loss = 2.43e+05, loss_total = 2.43e+05
Step 140 : gram_loss = 2.41e+05, loss_total = 2.41e+05
Step 141 : gram_loss = 2.38e+05, loss_total = 2.38e+05
Step 142 : gram_loss = 2.37e+05, loss_total = 2.37e+05
Step 143 : gram_loss = 2.36e+05, loss_total = 2.36e+05
Step 144 : gram_loss = 2.34e+05, loss_total = 2.34e+05
Step 145 : gram_loss = 2.32e+05, loss_total = 2.32e+05
Step 146 : gram_loss = 2.31e+05, loss_total = 2.31e+05
Step 147 : gram_loss = 2.28e+05, loss_total = 2.28e+05
Step 148 : gram_loss = 2.28e+05, loss_total = 2.28e+05
Step 149 : gram_loss = 2.26e+05, loss_total = 2.26e+05
Step 150 : gram_loss = 2.25e+05, loss_total = 2.25e+05
Step 151 : gram_loss = 2.24e+05, loss_total = 2.24e+05
Step 152 : gram_loss = 2.22e+05, loss_total = 2.22e+05
Step 153 : gram_loss = 2.21e+05, loss_total = 2.21e+05
Step 154 : gram_loss = 2.20e+05, loss_total = 2.20e+05
Step 155 : gram_loss = 2.18e+05, loss_total = 2.18e+05
Step 156 : gram_loss = 2.17e+05, loss_total = 2.17e+05
Step 157 : gram_loss = 2.15e+05, loss_total = 2.15e+05
Step 158 : gram_loss = 2.14e+05, loss_total = 2.14e+05
Step 159 : gram_loss = 2.13e+05, loss_total = 2.13e+05
Step 160 : gram_loss = 2.12e+05, loss_total = 2.12e+05
Step 161 : gram_loss = 2.11e+05, loss_total = 2.11e+05
Step 162 : gram_loss = 2.10e+05, loss_total = 2.10e+05
Step 163 : gram_loss = 2.08e+05, loss_total = 2.08e+05
Step 164 : gram_loss = 2.07e+05, loss_total = 2.07e+05
Step 165 : gram_loss = 2.06e+05, loss_total = 2.06e+05
Step 166 : gram_loss = 2.05e+05, loss_total = 2.05e+05
Step 167 : gram_loss = 2.05e+05, loss_total = 2.05e+05
Step 168 : gram_loss = 2.03e+05, loss_total = 2.03e+05
Step 169 : gram_loss = 2.01e+05, loss_total = 2.01e+05
Step 170 : gram_loss = 2.00e+05, loss_total = 2.00e+05
Step 171 : gram_loss = 1.99e+05, loss_total = 1.99e+05
Step 172 : gram_loss = 1.98e+05, loss_total = 1.98e+05
Step 173 : gram_loss = 1.96e+05, loss_total = 1.96e+05
Step 174 : gram_loss = 1.96e+05, loss_total = 1.96e+05
Step 175 : gram_loss = 1.95e+05, loss_total = 1.95e+05
Step 176 : gram_loss = 1.94e+05, loss_total = 1.94e+05
Step 177 : gram_loss = 1.93e+05, loss_total = 1.93e+05
Step 178 : gram_loss = 1.92e+05, loss_total = 1.92e+05
Step 179 : gram_loss = 1.91e+05, loss_total = 1.91e+05
Step 180 : gram_loss = 1.90e+05, loss_total = 1.90e+05
Step 181 : gram_loss = 1.89e+05, loss_total = 1.89e+05
Step 182 : gram_loss = 1.89e+05, loss_total = 1.89e+05
Step 183 : gram_loss = 1.88e+05, loss_total = 1.88e+05
Step 184 : gram_loss = 1.87e+05, loss_total = 1.87e+05
Step 185 : gram_loss = 1.85e+05, loss_total = 1.85e+05
Step 186 : gram_loss = 1.85e+05, loss_total = 1.85e+05
Step 187 : gram_loss = 1.84e+05, loss_total = 1.84e+05
Step 188 : gram_loss = 1.83e+05, loss_total = 1.83e+05
Step 189 : gram_loss = 1.82e+05, loss_total = 1.82e+05
Step 190 : gram_loss = 1.81e+05, loss_total = 1.81e+05
Step 191 : gram_loss = 1.81e+05, loss_total = 1.81e+05
Step 192 : gram_loss = 1.80e+05, loss_total = 1.80e+05
Step 193 : gram_loss = 1.79e+05, loss_total = 1.79e+05
Step 194 : gram_loss = 1.78e+05, loss_total = 1.78e+05
Step 195 : gram_loss = 1.78e+05, loss_total = 1.78e+05
Step 196 : gram_loss = 1.77e+05, loss_total = 1.77e+05
Step 197 : gram_loss = 1.76e+05, loss_total = 1.76e+05
Step 198 : gram_loss = 1.75e+05, loss_total = 1.75e+05
Step 199 : gram_loss = 1.74e+05, loss_total = 1.74e+05
Step 200 : gram_loss = 1.73e+05, loss_total = 1.73e+05
Close Sess - End of the global optimization.
Computation total for  107.37726545333862  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0038_1_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0038_1_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0038_1_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0038_1_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0038_1_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0038_1_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.176835775375366  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 5.77e+09, loss_total = 5.77e+09
Step 1 : gram_loss = 4.19e+09, loss_total = 4.19e+09
Step 2 : gram_loss = 3.66e+09, loss_total = 3.66e+09
Step 3 : gram_loss = 2.75e+09, loss_total = 2.75e+09
Step 4 : gram_loss = 1.68e+09, loss_total = 1.68e+09
Step 5 : gram_loss = 9.56e+08, loss_total = 9.56e+08
Step 6 : gram_loss = 7.30e+08, loss_total = 7.30e+08
Step 7 : gram_loss = 4.35e+08, loss_total = 4.35e+08
Step 8 : gram_loss = 2.86e+08, loss_total = 2.86e+08
Step 9 : gram_loss = 2.46e+08, loss_total = 2.46e+08
Step 10 : gram_loss = 1.84e+08, loss_total = 1.84e+08
Step 11 : gram_loss = 1.46e+08, loss_total = 1.46e+08
Step 12 : gram_loss = 9.04e+07, loss_total = 9.04e+07
Step 13 : gram_loss = 7.15e+07, loss_total = 7.15e+07
Step 14 : gram_loss = 5.51e+07, loss_total = 5.51e+07
Step 15 : gram_loss = 4.89e+07, loss_total = 4.89e+07
Step 16 : gram_loss = 4.24e+07, loss_total = 4.24e+07
Step 17 : gram_loss = 3.35e+07, loss_total = 3.35e+07
Step 18 : gram_loss = 2.57e+07, loss_total = 2.57e+07
Step 19 : gram_loss = 2.23e+07, loss_total = 2.23e+07
Step 20 : gram_loss = 1.88e+07, loss_total = 1.88e+07
Step 21 : gram_loss = 1.66e+07, loss_total = 1.66e+07
Step 22 : gram_loss = 1.42e+07, loss_total = 1.42e+07
Step 23 : gram_loss = 1.34e+07, loss_total = 1.34e+07
Step 24 : gram_loss = 1.16e+07, loss_total = 1.16e+07
Step 25 : gram_loss = 1.11e+07, loss_total = 1.11e+07
Step 26 : gram_loss = 9.83e+06, loss_total = 9.83e+06
Step 27 : gram_loss = 9.03e+06, loss_total = 9.03e+06
Step 28 : gram_loss = 8.22e+06, loss_total = 8.22e+06
Step 29 : gram_loss = 7.43e+06, loss_total = 7.43e+06
Step 30 : gram_loss = 6.74e+06, loss_total = 6.74e+06
Step 31 : gram_loss = 6.24e+06, loss_total = 6.24e+06
Step 32 : gram_loss = 5.82e+06, loss_total = 5.82e+06
Step 33 : gram_loss = 5.35e+06, loss_total = 5.35e+06
Step 34 : gram_loss = 4.68e+06, loss_total = 4.68e+06
Step 35 : gram_loss = 4.31e+06, loss_total = 4.31e+06
Step 36 : gram_loss = 3.88e+06, loss_total = 3.88e+06
Step 37 : gram_loss = 3.68e+06, loss_total = 3.68e+06
Step 38 : gram_loss = 3.37e+06, loss_total = 3.37e+06
Step 39 : gram_loss = 3.24e+06, loss_total = 3.24e+06
Step 40 : gram_loss = 2.85e+06, loss_total = 2.85e+06
Step 41 : gram_loss = 2.68e+06, loss_total = 2.68e+06
Step 42 : gram_loss = 2.53e+06, loss_total = 2.53e+06
Step 43 : gram_loss = 2.41e+06, loss_total = 2.41e+06
Step 44 : gram_loss = 2.27e+06, loss_total = 2.27e+06
Step 45 : gram_loss = 2.10e+06, loss_total = 2.10e+06
Step 46 : gram_loss = 1.97e+06, loss_total = 1.97e+06
Step 47 : gram_loss = 1.90e+06, loss_total = 1.90e+06
Step 48 : gram_loss = 1.84e+06, loss_total = 1.84e+06
Step 49 : gram_loss = 1.77e+06, loss_total = 1.77e+06
Step 50 : gram_loss = 1.61e+06, loss_total = 1.61e+06
Step 51 : gram_loss = 1.46e+06, loss_total = 1.46e+06
Step 52 : gram_loss = 1.34e+06, loss_total = 1.34e+06
Step 53 : gram_loss = 1.26e+06, loss_total = 1.26e+06
Step 54 : gram_loss = 1.21e+06, loss_total = 1.21e+06
Step 55 : gram_loss = 1.16e+06, loss_total = 1.16e+06
Step 56 : gram_loss = 1.08e+06, loss_total = 1.08e+06
Step 57 : gram_loss = 1.04e+06, loss_total = 1.04e+06
Step 58 : gram_loss = 9.89e+05, loss_total = 9.89e+05
Step 59 : gram_loss = 9.46e+05, loss_total = 9.46e+05
Step 60 : gram_loss = 9.01e+05, loss_total = 9.01e+05
Step 61 : gram_loss = 8.49e+05, loss_total = 8.49e+05
Step 62 : gram_loss = 8.12e+05, loss_total = 8.12e+05
Step 63 : gram_loss = 7.90e+05, loss_total = 7.90e+05
Step 64 : gram_loss = 7.71e+05, loss_total = 7.71e+05
Step 65 : gram_loss = 7.53e+05, loss_total = 7.53e+05
Step 66 : gram_loss = 7.23e+05, loss_total = 7.23e+05
Step 67 : gram_loss = 6.93e+05, loss_total = 6.93e+05
Step 68 : gram_loss = 6.81e+05, loss_total = 6.81e+05
Step 69 : gram_loss = 6.68e+05, loss_total = 6.68e+05
Step 70 : gram_loss = 6.52e+05, loss_total = 6.52e+05
Step 71 : gram_loss = 6.12e+05, loss_total = 6.12e+05
Step 72 : gram_loss = 5.89e+05, loss_total = 5.89e+05
Step 73 : gram_loss = 5.73e+05, loss_total = 5.73e+05
Step 74 : gram_loss = 5.56e+05, loss_total = 5.56e+05
Step 75 : gram_loss = 5.41e+05, loss_total = 5.41e+05
Step 76 : gram_loss = 5.25e+05, loss_total = 5.25e+05
Step 77 : gram_loss = 5.08e+05, loss_total = 5.08e+05
Step 78 : gram_loss = 4.94e+05, loss_total = 4.94e+05
Step 79 : gram_loss = 4.74e+05, loss_total = 4.74e+05
Step 80 : gram_loss = 4.62e+05, loss_total = 4.62e+05
Step 81 : gram_loss = 4.53e+05, loss_total = 4.53e+05
Step 82 : gram_loss = 4.42e+05, loss_total = 4.42e+05
Step 83 : gram_loss = 4.34e+05, loss_total = 4.34e+05
Step 84 : gram_loss = 4.21e+05, loss_total = 4.21e+05
Step 85 : gram_loss = 4.13e+05, loss_total = 4.13e+05
Step 86 : gram_loss = 4.06e+05, loss_total = 4.06e+05
Step 87 : gram_loss = 3.99e+05, loss_total = 3.99e+05
Step 88 : gram_loss = 3.91e+05, loss_total = 3.91e+05
Step 89 : gram_loss = 3.84e+05, loss_total = 3.84e+05
Step 90 : gram_loss = 3.77e+05, loss_total = 3.77e+05
Step 91 : gram_loss = 3.69e+05, loss_total = 3.69e+05
Step 92 : gram_loss = 3.64e+05, loss_total = 3.64e+05
Step 93 : gram_loss = 3.52e+05, loss_total = 3.52e+05
Step 94 : gram_loss = 3.45e+05, loss_total = 3.45e+05
Step 95 : gram_loss = 3.38e+05, loss_total = 3.38e+05
Step 96 : gram_loss = 3.34e+05, loss_total = 3.34e+05
Step 97 : gram_loss = 3.30e+05, loss_total = 3.30e+05
Step 98 : gram_loss = 3.21e+05, loss_total = 3.21e+05
Step 99 : gram_loss = 3.14e+05, loss_total = 3.14e+05
Step 100 : gram_loss = 3.06e+05, loss_total = 3.06e+05
Step 101 : gram_loss = 3.01e+05, loss_total = 3.01e+05
Step 102 : gram_loss = 2.97e+05, loss_total = 2.97e+05
Step 103 : gram_loss = 2.94e+05, loss_total = 2.94e+05
Step 104 : gram_loss = 2.88e+05, loss_total = 2.88e+05
Step 105 : gram_loss = 2.86e+05, loss_total = 2.86e+05
Step 106 : gram_loss = 2.82e+05, loss_total = 2.82e+05
Step 107 : gram_loss = 2.76e+05, loss_total = 2.76e+05
Step 108 : gram_loss = 2.74e+05, loss_total = 2.74e+05
Step 109 : gram_loss = 2.66e+05, loss_total = 2.66e+05
Step 110 : gram_loss = 2.65e+05, loss_total = 2.65e+05
Step 111 : gram_loss = 2.63e+05, loss_total = 2.63e+05
Step 112 : gram_loss = 2.59e+05, loss_total = 2.59e+05
Step 113 : gram_loss = 2.57e+05, loss_total = 2.57e+05
Step 114 : gram_loss = 2.53e+05, loss_total = 2.53e+05
Step 115 : gram_loss = 2.50e+05, loss_total = 2.50e+05
Step 116 : gram_loss = 2.48e+05, loss_total = 2.48e+05
Step 117 : gram_loss = 2.44e+05, loss_total = 2.44e+05
Step 118 : gram_loss = 2.40e+05, loss_total = 2.40e+05
Step 119 : gram_loss = 2.38e+05, loss_total = 2.38e+05
Step 120 : gram_loss = 2.35e+05, loss_total = 2.35e+05
Step 121 : gram_loss = 2.31e+05, loss_total = 2.31e+05
Step 122 : gram_loss = 2.29e+05, loss_total = 2.29e+05
Step 123 : gram_loss = 2.26e+05, loss_total = 2.26e+05
Step 124 : gram_loss = 2.25e+05, loss_total = 2.25e+05
Step 125 : gram_loss = 2.22e+05, loss_total = 2.22e+05
Step 126 : gram_loss = 2.19e+05, loss_total = 2.19e+05
Step 127 : gram_loss = 2.16e+05, loss_total = 2.16e+05
Step 128 : gram_loss = 2.13e+05, loss_total = 2.13e+05
Step 129 : gram_loss = 2.11e+05, loss_total = 2.11e+05
Step 130 : gram_loss = 2.09e+05, loss_total = 2.09e+05
Step 131 : gram_loss = 2.07e+05, loss_total = 2.07e+05
Step 132 : gram_loss = 2.05e+05, loss_total = 2.05e+05
Step 133 : gram_loss = 2.02e+05, loss_total = 2.02e+05
Step 134 : gram_loss = 2.00e+05, loss_total = 2.00e+05
Step 135 : gram_loss = 1.99e+05, loss_total = 1.99e+05
Step 136 : gram_loss = 1.98e+05, loss_total = 1.98e+05
Step 137 : gram_loss = 1.97e+05, loss_total = 1.97e+05
Step 138 : gram_loss = 1.95e+05, loss_total = 1.95e+05
Step 139 : gram_loss = 1.93e+05, loss_total = 1.93e+05
Step 140 : gram_loss = 1.90e+05, loss_total = 1.90e+05
Step 141 : gram_loss = 1.88e+05, loss_total = 1.88e+05
Step 142 : gram_loss = 1.86e+05, loss_total = 1.86e+05
Step 143 : gram_loss = 1.85e+05, loss_total = 1.85e+05
Step 144 : gram_loss = 1.83e+05, loss_total = 1.83e+05
Step 145 : gram_loss = 1.82e+05, loss_total = 1.82e+05
Step 146 : gram_loss = 1.79e+05, loss_total = 1.79e+05
Step 147 : gram_loss = 1.78e+05, loss_total = 1.78e+05
Step 148 : gram_loss = 1.77e+05, loss_total = 1.77e+05
Step 149 : gram_loss = 1.76e+05, loss_total = 1.76e+05
Step 150 : gram_loss = 1.75e+05, loss_total = 1.75e+05
Step 151 : gram_loss = 1.74e+05, loss_total = 1.74e+05
Step 152 : gram_loss = 1.72e+05, loss_total = 1.72e+05
Step 153 : gram_loss = 1.70e+05, loss_total = 1.70e+05
Step 154 : gram_loss = 1.69e+05, loss_total = 1.69e+05
Step 155 : gram_loss = 1.68e+05, loss_total = 1.68e+05
Step 156 : gram_loss = 1.66e+05, loss_total = 1.66e+05
Step 157 : gram_loss = 1.65e+05, loss_total = 1.65e+05
Step 158 : gram_loss = 1.64e+05, loss_total = 1.64e+05
Step 159 : gram_loss = 1.63e+05, loss_total = 1.63e+05
Step 160 : gram_loss = 1.62e+05, loss_total = 1.62e+05
Step 161 : gram_loss = 1.61e+05, loss_total = 1.61e+05
Step 162 : gram_loss = 1.59e+05, loss_total = 1.59e+05
Step 163 : gram_loss = 1.58e+05, loss_total = 1.58e+05
Step 164 : gram_loss = 1.57e+05, loss_total = 1.57e+05
Step 165 : gram_loss = 1.56e+05, loss_total = 1.56e+05
Step 166 : gram_loss = 1.56e+05, loss_total = 1.56e+05
Step 167 : gram_loss = 1.55e+05, loss_total = 1.55e+05
Step 168 : gram_loss = 1.54e+05, loss_total = 1.54e+05
Step 169 : gram_loss = 1.53e+05, loss_total = 1.53e+05
Step 170 : gram_loss = 1.52e+05, loss_total = 1.52e+05
Step 171 : gram_loss = 1.51e+05, loss_total = 1.51e+05
Step 172 : gram_loss = 1.50e+05, loss_total = 1.50e+05
Step 173 : gram_loss = 1.49e+05, loss_total = 1.49e+05
Step 174 : gram_loss = 1.48e+05, loss_total = 1.48e+05
Step 175 : gram_loss = 1.47e+05, loss_total = 1.47e+05
Step 176 : gram_loss = 1.46e+05, loss_total = 1.46e+05
Step 177 : gram_loss = 1.46e+05, loss_total = 1.46e+05
Step 178 : gram_loss = 1.45e+05, loss_total = 1.45e+05
Step 179 : gram_loss = 1.44e+05, loss_total = 1.44e+05
Step 180 : gram_loss = 1.43e+05, loss_total = 1.43e+05
Step 181 : gram_loss = 1.43e+05, loss_total = 1.43e+05
Step 182 : gram_loss = 1.42e+05, loss_total = 1.42e+05
Step 183 : gram_loss = 1.41e+05, loss_total = 1.41e+05
Step 184 : gram_loss = 1.41e+05, loss_total = 1.41e+05
Step 185 : gram_loss = 1.40e+05, loss_total = 1.40e+05
Step 186 : gram_loss = 1.39e+05, loss_total = 1.39e+05
Step 187 : gram_loss = 1.39e+05, loss_total = 1.39e+05
Step 188 : gram_loss = 1.38e+05, loss_total = 1.38e+05
Step 189 : gram_loss = 1.37e+05, loss_total = 1.37e+05
Step 190 : gram_loss = 1.36e+05, loss_total = 1.36e+05
Step 191 : gram_loss = 1.36e+05, loss_total = 1.36e+05
Step 192 : gram_loss = 1.35e+05, loss_total = 1.35e+05
Step 193 : gram_loss = 1.34e+05, loss_total = 1.34e+05
Step 194 : gram_loss = 1.34e+05, loss_total = 1.34e+05
Step 195 : gram_loss = 1.34e+05, loss_total = 1.34e+05
Step 196 : gram_loss = 1.33e+05, loss_total = 1.33e+05
Step 197 : gram_loss = 1.32e+05, loss_total = 1.32e+05
Step 198 : gram_loss = 1.31e+05, loss_total = 1.31e+05
Step 199 : gram_loss = 1.31e+05, loss_total = 1.31e+05
Step 200 : gram_loss = 1.31e+05, loss_total = 1.31e+05
Close Sess - End of the global optimization.
Computation total for  107.93559980392456  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0046_1_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0046_1_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0046_1_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0046_1_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0046_1_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0046_1_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.23360276222229  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 5.05e+09, loss_total = 5.05e+09
Step 1 : gram_loss = 3.99e+09, loss_total = 3.99e+09
Step 2 : gram_loss = 3.34e+09, loss_total = 3.34e+09
Step 3 : gram_loss = 2.62e+09, loss_total = 2.62e+09
Step 4 : gram_loss = 1.31e+09, loss_total = 1.31e+09
Step 5 : gram_loss = 6.74e+08, loss_total = 6.74e+08
Step 6 : gram_loss = 4.29e+08, loss_total = 4.29e+08
Step 7 : gram_loss = 3.29e+08, loss_total = 3.29e+08
Step 8 : gram_loss = 2.82e+08, loss_total = 2.82e+08
Step 9 : gram_loss = 2.39e+08, loss_total = 2.39e+08
Step 10 : gram_loss = 2.20e+08, loss_total = 2.20e+08
Step 11 : gram_loss = 1.70e+08, loss_total = 1.70e+08
Step 12 : gram_loss = 1.22e+08, loss_total = 1.22e+08
Step 13 : gram_loss = 8.26e+07, loss_total = 8.26e+07
Step 14 : gram_loss = 6.92e+07, loss_total = 6.92e+07
Step 15 : gram_loss = 6.14e+07, loss_total = 6.14e+07
Step 16 : gram_loss = 5.46e+07, loss_total = 5.46e+07
Step 17 : gram_loss = 5.05e+07, loss_total = 5.05e+07
Step 18 : gram_loss = 4.43e+07, loss_total = 4.43e+07
Step 19 : gram_loss = 3.68e+07, loss_total = 3.68e+07
Step 20 : gram_loss = 3.02e+07, loss_total = 3.02e+07
Step 21 : gram_loss = 2.49e+07, loss_total = 2.49e+07
Step 22 : gram_loss = 1.86e+07, loss_total = 1.86e+07
Step 23 : gram_loss = 1.60e+07, loss_total = 1.60e+07
Step 24 : gram_loss = 1.45e+07, loss_total = 1.45e+07
Step 25 : gram_loss = 1.33e+07, loss_total = 1.33e+07
Step 26 : gram_loss = 1.25e+07, loss_total = 1.25e+07
Step 27 : gram_loss = 1.20e+07, loss_total = 1.20e+07
Step 28 : gram_loss = 1.10e+07, loss_total = 1.10e+07
Step 29 : gram_loss = 9.25e+06, loss_total = 9.25e+06
Step 30 : gram_loss = 7.71e+06, loss_total = 7.71e+06
Step 31 : gram_loss = 7.11e+06, loss_total = 7.11e+06
Step 32 : gram_loss = 6.32e+06, loss_total = 6.32e+06
Step 33 : gram_loss = 5.69e+06, loss_total = 5.69e+06
Step 34 : gram_loss = 4.93e+06, loss_total = 4.93e+06
Step 35 : gram_loss = 4.54e+06, loss_total = 4.54e+06
Step 36 : gram_loss = 4.22e+06, loss_total = 4.22e+06
Step 37 : gram_loss = 3.78e+06, loss_total = 3.78e+06
Step 38 : gram_loss = 3.42e+06, loss_total = 3.42e+06
Step 39 : gram_loss = 3.11e+06, loss_total = 3.11e+06
Step 40 : gram_loss = 2.85e+06, loss_total = 2.85e+06
Step 41 : gram_loss = 2.67e+06, loss_total = 2.67e+06
Step 42 : gram_loss = 2.55e+06, loss_total = 2.55e+06
Step 43 : gram_loss = 2.47e+06, loss_total = 2.47e+06
Step 44 : gram_loss = 2.35e+06, loss_total = 2.35e+06
Step 45 : gram_loss = 2.15e+06, loss_total = 2.15e+06
Step 46 : gram_loss = 1.99e+06, loss_total = 1.99e+06
Step 47 : gram_loss = 1.89e+06, loss_total = 1.89e+06
Step 48 : gram_loss = 1.82e+06, loss_total = 1.82e+06
Step 49 : gram_loss = 1.77e+06, loss_total = 1.77e+06
Step 50 : gram_loss = 1.72e+06, loss_total = 1.72e+06
Step 51 : gram_loss = 1.68e+06, loss_total = 1.68e+06
Step 52 : gram_loss = 1.58e+06, loss_total = 1.58e+06
Step 53 : gram_loss = 1.48e+06, loss_total = 1.48e+06
Step 54 : gram_loss = 1.42e+06, loss_total = 1.42e+06
Step 55 : gram_loss = 1.36e+06, loss_total = 1.36e+06
Step 56 : gram_loss = 1.30e+06, loss_total = 1.30e+06
Step 57 : gram_loss = 1.23e+06, loss_total = 1.23e+06
Step 58 : gram_loss = 1.16e+06, loss_total = 1.16e+06
Step 59 : gram_loss = 1.08e+06, loss_total = 1.08e+06
Step 60 : gram_loss = 1.04e+06, loss_total = 1.04e+06
Step 61 : gram_loss = 9.94e+05, loss_total = 9.94e+05
Step 62 : gram_loss = 9.75e+05, loss_total = 9.75e+05
Step 63 : gram_loss = 9.50e+05, loss_total = 9.50e+05
Step 64 : gram_loss = 9.14e+05, loss_total = 9.14e+05
Step 65 : gram_loss = 8.86e+05, loss_total = 8.86e+05
Step 66 : gram_loss = 8.46e+05, loss_total = 8.46e+05
Step 67 : gram_loss = 8.30e+05, loss_total = 8.30e+05
Step 68 : gram_loss = 7.91e+05, loss_total = 7.91e+05
Step 69 : gram_loss = 7.77e+05, loss_total = 7.77e+05
Step 70 : gram_loss = 7.68e+05, loss_total = 7.68e+05
Step 71 : gram_loss = 7.43e+05, loss_total = 7.43e+05
Step 72 : gram_loss = 7.41e+05, loss_total = 7.41e+05
Step 73 : gram_loss = 7.14e+05, loss_total = 7.14e+05
Step 74 : gram_loss = 7.08e+05, loss_total = 7.08e+05
Step 75 : gram_loss = 6.98e+05, loss_total = 6.98e+05
Step 76 : gram_loss = 6.80e+05, loss_total = 6.80e+05
Step 77 : gram_loss = 6.49e+05, loss_total = 6.49e+05
Step 78 : gram_loss = 6.37e+05, loss_total = 6.37e+05
Step 79 : gram_loss = 6.18e+05, loss_total = 6.18e+05
Step 80 : gram_loss = 5.99e+05, loss_total = 5.99e+05
Step 81 : gram_loss = 5.83e+05, loss_total = 5.83e+05
Step 82 : gram_loss = 5.69e+05, loss_total = 5.69e+05
Step 83 : gram_loss = 5.62e+05, loss_total = 5.62e+05
Step 84 : gram_loss = 5.56e+05, loss_total = 5.56e+05
Step 85 : gram_loss = 5.45e+05, loss_total = 5.45e+05
Step 86 : gram_loss = 5.35e+05, loss_total = 5.35e+05
Step 87 : gram_loss = 5.18e+05, loss_total = 5.18e+05
Step 88 : gram_loss = 4.95e+05, loss_total = 4.95e+05
Step 89 : gram_loss = 4.84e+05, loss_total = 4.84e+05
Step 90 : gram_loss = 4.74e+05, loss_total = 4.74e+05
Step 91 : gram_loss = 4.66e+05, loss_total = 4.66e+05
Step 92 : gram_loss = 4.57e+05, loss_total = 4.57e+05
Step 93 : gram_loss = 4.48e+05, loss_total = 4.48e+05
Step 94 : gram_loss = 4.45e+05, loss_total = 4.45e+05
Step 95 : gram_loss = 4.38e+05, loss_total = 4.38e+05
Step 96 : gram_loss = 4.36e+05, loss_total = 4.36e+05
Step 97 : gram_loss = 4.28e+05, loss_total = 4.28e+05
Step 98 : gram_loss = 4.18e+05, loss_total = 4.18e+05
Step 99 : gram_loss = 4.09e+05, loss_total = 4.09e+05
Step 100 : gram_loss = 4.01e+05, loss_total = 4.01e+05
Step 101 : gram_loss = 3.94e+05, loss_total = 3.94e+05
Step 102 : gram_loss = 3.84e+05, loss_total = 3.84e+05
Step 103 : gram_loss = 3.78e+05, loss_total = 3.78e+05
Step 104 : gram_loss = 3.72e+05, loss_total = 3.72e+05
Step 105 : gram_loss = 3.68e+05, loss_total = 3.68e+05
Step 106 : gram_loss = 3.63e+05, loss_total = 3.63e+05
Step 107 : gram_loss = 3.60e+05, loss_total = 3.60e+05
Step 108 : gram_loss = 3.51e+05, loss_total = 3.51e+05
Step 109 : gram_loss = 3.45e+05, loss_total = 3.45e+05
Step 110 : gram_loss = 3.41e+05, loss_total = 3.41e+05
Step 111 : gram_loss = 3.37e+05, loss_total = 3.37e+05
Step 112 : gram_loss = 3.32e+05, loss_total = 3.32e+05
Step 113 : gram_loss = 3.27e+05, loss_total = 3.27e+05
Step 114 : gram_loss = 3.23e+05, loss_total = 3.23e+05
Step 115 : gram_loss = 3.18e+05, loss_total = 3.18e+05
Step 116 : gram_loss = 3.18e+05, loss_total = 3.18e+05
Step 117 : gram_loss = 3.12e+05, loss_total = 3.12e+05
Step 118 : gram_loss = 3.11e+05, loss_total = 3.11e+05
Step 119 : gram_loss = 3.09e+05, loss_total = 3.09e+05
Step 120 : gram_loss = 3.06e+05, loss_total = 3.06e+05
Step 121 : gram_loss = 3.02e+05, loss_total = 3.02e+05
Step 122 : gram_loss = 2.97e+05, loss_total = 2.97e+05
Step 123 : gram_loss = 2.95e+05, loss_total = 2.95e+05
Step 124 : gram_loss = 2.93e+05, loss_total = 2.93e+05
Step 125 : gram_loss = 2.89e+05, loss_total = 2.89e+05
Step 126 : gram_loss = 2.85e+05, loss_total = 2.85e+05
Step 127 : gram_loss = 2.82e+05, loss_total = 2.82e+05
Step 128 : gram_loss = 2.78e+05, loss_total = 2.78e+05
Step 129 : gram_loss = 2.76e+05, loss_total = 2.76e+05
Step 130 : gram_loss = 2.74e+05, loss_total = 2.74e+05
Step 131 : gram_loss = 2.69e+05, loss_total = 2.69e+05
Step 132 : gram_loss = 2.67e+05, loss_total = 2.67e+05
Step 133 : gram_loss = 2.63e+05, loss_total = 2.63e+05
Step 134 : gram_loss = 2.62e+05, loss_total = 2.62e+05
Step 135 : gram_loss = 2.60e+05, loss_total = 2.60e+05
Step 136 : gram_loss = 2.58e+05, loss_total = 2.58e+05
Step 137 : gram_loss = 2.55e+05, loss_total = 2.55e+05
Step 138 : gram_loss = 2.53e+05, loss_total = 2.53e+05
Step 139 : gram_loss = 2.51e+05, loss_total = 2.51e+05
Step 140 : gram_loss = 2.50e+05, loss_total = 2.50e+05
Step 141 : gram_loss = 2.49e+05, loss_total = 2.49e+05
Step 142 : gram_loss = 2.47e+05, loss_total = 2.47e+05
Step 143 : gram_loss = 2.44e+05, loss_total = 2.44e+05
Step 144 : gram_loss = 2.41e+05, loss_total = 2.41e+05
Step 145 : gram_loss = 2.39e+05, loss_total = 2.39e+05
Step 146 : gram_loss = 2.38e+05, loss_total = 2.38e+05
Step 147 : gram_loss = 2.37e+05, loss_total = 2.37e+05
Step 148 : gram_loss = 2.35e+05, loss_total = 2.35e+05
Step 149 : gram_loss = 2.33e+05, loss_total = 2.33e+05
Step 150 : gram_loss = 2.30e+05, loss_total = 2.30e+05
Step 151 : gram_loss = 2.29e+05, loss_total = 2.29e+05
Step 152 : gram_loss = 2.28e+05, loss_total = 2.28e+05
Step 153 : gram_loss = 2.26e+05, loss_total = 2.26e+05
Step 154 : gram_loss = 2.22e+05, loss_total = 2.22e+05
Step 155 : gram_loss = 2.20e+05, loss_total = 2.20e+05
Step 156 : gram_loss = 2.18e+05, loss_total = 2.18e+05
Step 157 : gram_loss = 2.17e+05, loss_total = 2.17e+05
Step 158 : gram_loss = 2.16e+05, loss_total = 2.16e+05
Step 159 : gram_loss = 2.15e+05, loss_total = 2.15e+05
Step 160 : gram_loss = 2.13e+05, loss_total = 2.13e+05
Step 161 : gram_loss = 2.12e+05, loss_total = 2.12e+05
Step 162 : gram_loss = 2.11e+05, loss_total = 2.11e+05
Step 163 : gram_loss = 2.10e+05, loss_total = 2.10e+05
Step 164 : gram_loss = 2.08e+05, loss_total = 2.08e+05
Step 165 : gram_loss = 2.07e+05, loss_total = 2.07e+05
Step 166 : gram_loss = 2.05e+05, loss_total = 2.05e+05
Step 167 : gram_loss = 2.03e+05, loss_total = 2.03e+05
Step 168 : gram_loss = 2.01e+05, loss_total = 2.01e+05
Step 169 : gram_loss = 2.00e+05, loss_total = 2.00e+05
Step 170 : gram_loss = 1.99e+05, loss_total = 1.99e+05
Step 171 : gram_loss = 1.98e+05, loss_total = 1.98e+05
Step 172 : gram_loss = 1.96e+05, loss_total = 1.96e+05
Step 173 : gram_loss = 1.94e+05, loss_total = 1.94e+05
Step 174 : gram_loss = 1.93e+05, loss_total = 1.93e+05
Step 175 : gram_loss = 1.92e+05, loss_total = 1.92e+05
Step 176 : gram_loss = 1.90e+05, loss_total = 1.90e+05
Step 177 : gram_loss = 1.88e+05, loss_total = 1.88e+05
Step 178 : gram_loss = 1.87e+05, loss_total = 1.87e+05
Step 179 : gram_loss = 1.86e+05, loss_total = 1.86e+05
Step 180 : gram_loss = 1.85e+05, loss_total = 1.85e+05
Step 181 : gram_loss = 1.84e+05, loss_total = 1.84e+05
Step 182 : gram_loss = 1.83e+05, loss_total = 1.83e+05
Step 183 : gram_loss = 1.82e+05, loss_total = 1.82e+05
Step 184 : gram_loss = 1.82e+05, loss_total = 1.82e+05
Step 185 : gram_loss = 1.81e+05, loss_total = 1.81e+05
Step 186 : gram_loss = 1.79e+05, loss_total = 1.79e+05
Step 187 : gram_loss = 1.78e+05, loss_total = 1.78e+05
Step 188 : gram_loss = 1.78e+05, loss_total = 1.78e+05
Step 189 : gram_loss = 1.77e+05, loss_total = 1.77e+05
Step 190 : gram_loss = 1.75e+05, loss_total = 1.75e+05
Step 191 : gram_loss = 1.75e+05, loss_total = 1.75e+05
Step 192 : gram_loss = 1.73e+05, loss_total = 1.73e+05
Step 193 : gram_loss = 1.73e+05, loss_total = 1.73e+05
Step 194 : gram_loss = 1.72e+05, loss_total = 1.72e+05
Step 195 : gram_loss = 1.71e+05, loss_total = 1.71e+05
Step 196 : gram_loss = 1.69e+05, loss_total = 1.69e+05
Step 197 : gram_loss = 1.68e+05, loss_total = 1.68e+05
Step 198 : gram_loss = 1.67e+05, loss_total = 1.67e+05
Step 199 : gram_loss = 1.66e+05, loss_total = 1.66e+05
Step 200 : gram_loss = 1.65e+05, loss_total = 1.65e+05
Close Sess - End of the global optimization.
Computation total for  107.80779337882996  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0035_1_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0035_1_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0035_1_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0035_1_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0035_1_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0035_1_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.148040771484375  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 3.00e+09, loss_total = 3.00e+09
Step 1 : gram_loss = 2.55e+09, loss_total = 2.55e+09
Step 2 : gram_loss = 2.38e+09, loss_total = 2.38e+09
Step 3 : gram_loss = 1.97e+09, loss_total = 1.97e+09
Step 4 : gram_loss = 1.51e+09, loss_total = 1.51e+09
Step 5 : gram_loss = 6.68e+08, loss_total = 6.68e+08
Step 6 : gram_loss = 4.93e+08, loss_total = 4.93e+08
Step 7 : gram_loss = 3.39e+08, loss_total = 3.39e+08
Step 8 : gram_loss = 2.69e+08, loss_total = 2.69e+08
Step 9 : gram_loss = 2.17e+08, loss_total = 2.17e+08
Step 10 : gram_loss = 1.92e+08, loss_total = 1.92e+08
Step 11 : gram_loss = 1.67e+08, loss_total = 1.67e+08
Step 12 : gram_loss = 1.54e+08, loss_total = 1.54e+08
Step 13 : gram_loss = 1.14e+08, loss_total = 1.14e+08
Step 14 : gram_loss = 9.08e+07, loss_total = 9.08e+07
Step 15 : gram_loss = 8.00e+07, loss_total = 8.00e+07
Step 16 : gram_loss = 6.47e+07, loss_total = 6.47e+07
Step 17 : gram_loss = 5.47e+07, loss_total = 5.47e+07
Step 18 : gram_loss = 4.86e+07, loss_total = 4.86e+07
Step 19 : gram_loss = 3.85e+07, loss_total = 3.85e+07
Step 20 : gram_loss = 2.84e+07, loss_total = 2.84e+07
Step 21 : gram_loss = 2.41e+07, loss_total = 2.41e+07
Step 22 : gram_loss = 2.12e+07, loss_total = 2.12e+07
Step 23 : gram_loss = 1.51e+07, loss_total = 1.51e+07
Step 24 : gram_loss = 1.26e+07, loss_total = 1.26e+07
Step 25 : gram_loss = 1.20e+07, loss_total = 1.20e+07
Step 26 : gram_loss = 1.07e+07, loss_total = 1.07e+07
Step 27 : gram_loss = 1.00e+07, loss_total = 1.00e+07
Step 28 : gram_loss = 9.16e+06, loss_total = 9.16e+06
Step 29 : gram_loss = 8.18e+06, loss_total = 8.18e+06
Step 30 : gram_loss = 7.26e+06, loss_total = 7.26e+06
Step 31 : gram_loss = 6.72e+06, loss_total = 6.72e+06
Step 32 : gram_loss = 6.22e+06, loss_total = 6.22e+06
Step 33 : gram_loss = 6.00e+06, loss_total = 6.00e+06
Step 34 : gram_loss = 5.69e+06, loss_total = 5.69e+06
Step 35 : gram_loss = 5.32e+06, loss_total = 5.32e+06
Step 36 : gram_loss = 4.84e+06, loss_total = 4.84e+06
Step 37 : gram_loss = 4.44e+06, loss_total = 4.44e+06
Step 38 : gram_loss = 4.20e+06, loss_total = 4.20e+06
Step 39 : gram_loss = 4.05e+06, loss_total = 4.05e+06
Step 40 : gram_loss = 3.90e+06, loss_total = 3.90e+06
Step 41 : gram_loss = 3.58e+06, loss_total = 3.58e+06
Step 42 : gram_loss = 3.37e+06, loss_total = 3.37e+06
Step 43 : gram_loss = 3.12e+06, loss_total = 3.12e+06
Step 44 : gram_loss = 2.96e+06, loss_total = 2.96e+06
Step 45 : gram_loss = 2.82e+06, loss_total = 2.82e+06
Step 46 : gram_loss = 2.63e+06, loss_total = 2.63e+06
Step 47 : gram_loss = 2.48e+06, loss_total = 2.48e+06
Step 48 : gram_loss = 2.37e+06, loss_total = 2.37e+06
Step 49 : gram_loss = 2.14e+06, loss_total = 2.14e+06
Step 50 : gram_loss = 2.01e+06, loss_total = 2.01e+06
Step 51 : gram_loss = 1.94e+06, loss_total = 1.94e+06
Step 52 : gram_loss = 1.86e+06, loss_total = 1.86e+06
Step 53 : gram_loss = 1.78e+06, loss_total = 1.78e+06
Step 54 : gram_loss = 1.65e+06, loss_total = 1.65e+06
Step 55 : gram_loss = 1.55e+06, loss_total = 1.55e+06
Step 56 : gram_loss = 1.43e+06, loss_total = 1.43e+06
Step 57 : gram_loss = 1.37e+06, loss_total = 1.37e+06
Step 58 : gram_loss = 1.28e+06, loss_total = 1.28e+06
Step 59 : gram_loss = 1.20e+06, loss_total = 1.20e+06
Step 60 : gram_loss = 1.12e+06, loss_total = 1.12e+06
Step 61 : gram_loss = 1.08e+06, loss_total = 1.08e+06
Step 62 : gram_loss = 1.04e+06, loss_total = 1.04e+06
Step 63 : gram_loss = 1.01e+06, loss_total = 1.01e+06
Step 64 : gram_loss = 9.82e+05, loss_total = 9.82e+05
Step 65 : gram_loss = 9.50e+05, loss_total = 9.50e+05
Step 66 : gram_loss = 8.94e+05, loss_total = 8.94e+05
Step 67 : gram_loss = 8.29e+05, loss_total = 8.29e+05
Step 68 : gram_loss = 7.85e+05, loss_total = 7.85e+05
Step 69 : gram_loss = 7.52e+05, loss_total = 7.52e+05
Step 70 : gram_loss = 7.38e+05, loss_total = 7.38e+05
Step 71 : gram_loss = 7.22e+05, loss_total = 7.22e+05
Step 72 : gram_loss = 6.96e+05, loss_total = 6.96e+05
Step 73 : gram_loss = 6.46e+05, loss_total = 6.46e+05
Step 74 : gram_loss = 5.99e+05, loss_total = 5.99e+05
Step 75 : gram_loss = 5.80e+05, loss_total = 5.80e+05
Step 76 : gram_loss = 5.66e+05, loss_total = 5.66e+05
Step 77 : gram_loss = 5.49e+05, loss_total = 5.49e+05
Step 78 : gram_loss = 5.39e+05, loss_total = 5.39e+05
Step 79 : gram_loss = 5.21e+05, loss_total = 5.21e+05
Step 80 : gram_loss = 5.04e+05, loss_total = 5.04e+05
Step 81 : gram_loss = 4.82e+05, loss_total = 4.82e+05
Step 82 : gram_loss = 4.64e+05, loss_total = 4.64e+05
Step 83 : gram_loss = 4.46e+05, loss_total = 4.46e+05
Step 84 : gram_loss = 4.22e+05, loss_total = 4.22e+05
Step 85 : gram_loss = 4.11e+05, loss_total = 4.11e+05
Step 86 : gram_loss = 3.98e+05, loss_total = 3.98e+05
Step 87 : gram_loss = 3.91e+05, loss_total = 3.91e+05
Step 88 : gram_loss = 3.80e+05, loss_total = 3.80e+05
Step 89 : gram_loss = 3.66e+05, loss_total = 3.66e+05
Step 90 : gram_loss = 3.51e+05, loss_total = 3.51e+05
Step 91 : gram_loss = 3.41e+05, loss_total = 3.41e+05
Step 92 : gram_loss = 3.29e+05, loss_total = 3.29e+05
Step 93 : gram_loss = 3.19e+05, loss_total = 3.19e+05
Step 94 : gram_loss = 3.12e+05, loss_total = 3.12e+05
Step 95 : gram_loss = 3.05e+05, loss_total = 3.05e+05
Step 96 : gram_loss = 3.04e+05, loss_total = 3.04e+05
Step 97 : gram_loss = 2.95e+05, loss_total = 2.95e+05
Step 98 : gram_loss = 2.90e+05, loss_total = 2.90e+05
Step 99 : gram_loss = 2.84e+05, loss_total = 2.84e+05
Step 100 : gram_loss = 2.77e+05, loss_total = 2.77e+05
Step 101 : gram_loss = 2.65e+05, loss_total = 2.65e+05
Step 102 : gram_loss = 2.63e+05, loss_total = 2.63e+05
Step 103 : gram_loss = 2.54e+05, loss_total = 2.54e+05
Step 104 : gram_loss = 2.52e+05, loss_total = 2.52e+05
Step 105 : gram_loss = 2.49e+05, loss_total = 2.49e+05
Step 106 : gram_loss = 2.41e+05, loss_total = 2.41e+05
Step 107 : gram_loss = 2.33e+05, loss_total = 2.33e+05
Step 108 : gram_loss = 2.30e+05, loss_total = 2.30e+05
Step 109 : gram_loss = 2.22e+05, loss_total = 2.22e+05
Step 110 : gram_loss = 2.19e+05, loss_total = 2.19e+05
Step 111 : gram_loss = 2.17e+05, loss_total = 2.17e+05
Step 112 : gram_loss = 2.12e+05, loss_total = 2.12e+05
Step 113 : gram_loss = 2.06e+05, loss_total = 2.06e+05
Step 114 : gram_loss = 2.01e+05, loss_total = 2.01e+05
Step 115 : gram_loss = 1.95e+05, loss_total = 1.95e+05
Step 116 : gram_loss = 1.92e+05, loss_total = 1.92e+05
Step 117 : gram_loss = 1.90e+05, loss_total = 1.90e+05
Step 118 : gram_loss = 1.88e+05, loss_total = 1.88e+05
Step 119 : gram_loss = 1.85e+05, loss_total = 1.85e+05
Step 120 : gram_loss = 1.82e+05, loss_total = 1.82e+05
Step 121 : gram_loss = 1.78e+05, loss_total = 1.78e+05
Step 122 : gram_loss = 1.76e+05, loss_total = 1.76e+05
Step 123 : gram_loss = 1.73e+05, loss_total = 1.73e+05
Step 124 : gram_loss = 1.72e+05, loss_total = 1.72e+05
Step 125 : gram_loss = 1.71e+05, loss_total = 1.71e+05
Step 126 : gram_loss = 1.69e+05, loss_total = 1.69e+05
Step 127 : gram_loss = 1.66e+05, loss_total = 1.66e+05
Step 128 : gram_loss = 1.62e+05, loss_total = 1.62e+05
Step 129 : gram_loss = 1.59e+05, loss_total = 1.59e+05
Step 130 : gram_loss = 1.57e+05, loss_total = 1.57e+05
Step 131 : gram_loss = 1.56e+05, loss_total = 1.56e+05
Step 132 : gram_loss = 1.54e+05, loss_total = 1.54e+05
Step 133 : gram_loss = 1.51e+05, loss_total = 1.51e+05
Step 134 : gram_loss = 1.48e+05, loss_total = 1.48e+05
Step 135 : gram_loss = 1.46e+05, loss_total = 1.46e+05
Step 136 : gram_loss = 1.44e+05, loss_total = 1.44e+05
Step 137 : gram_loss = 1.43e+05, loss_total = 1.43e+05
Step 138 : gram_loss = 1.41e+05, loss_total = 1.41e+05
Step 139 : gram_loss = 1.40e+05, loss_total = 1.40e+05
Step 140 : gram_loss = 1.39e+05, loss_total = 1.39e+05
Step 141 : gram_loss = 1.38e+05, loss_total = 1.38e+05
Step 142 : gram_loss = 1.36e+05, loss_total = 1.36e+05
Step 143 : gram_loss = 1.35e+05, loss_total = 1.35e+05
Step 144 : gram_loss = 1.34e+05, loss_total = 1.34e+05
Step 145 : gram_loss = 1.32e+05, loss_total = 1.32e+05
Step 146 : gram_loss = 1.30e+05, loss_total = 1.30e+05
Step 147 : gram_loss = 1.29e+05, loss_total = 1.29e+05
Step 148 : gram_loss = 1.28e+05, loss_total = 1.28e+05
Step 149 : gram_loss = 1.27e+05, loss_total = 1.27e+05
Step 150 : gram_loss = 1.25e+05, loss_total = 1.25e+05
Step 151 : gram_loss = 1.24e+05, loss_total = 1.24e+05
Step 152 : gram_loss = 1.23e+05, loss_total = 1.23e+05
Step 153 : gram_loss = 1.22e+05, loss_total = 1.22e+05
Step 154 : gram_loss = 1.21e+05, loss_total = 1.21e+05
Step 155 : gram_loss = 1.20e+05, loss_total = 1.20e+05
Step 156 : gram_loss = 1.19e+05, loss_total = 1.19e+05
Step 157 : gram_loss = 1.18e+05, loss_total = 1.18e+05
Step 158 : gram_loss = 1.18e+05, loss_total = 1.18e+05
Step 159 : gram_loss = 1.16e+05, loss_total = 1.16e+05
Step 160 : gram_loss = 1.15e+05, loss_total = 1.15e+05
Step 161 : gram_loss = 1.14e+05, loss_total = 1.14e+05
Step 162 : gram_loss = 1.13e+05, loss_total = 1.13e+05
Step 163 : gram_loss = 1.12e+05, loss_total = 1.12e+05
Step 164 : gram_loss = 1.12e+05, loss_total = 1.12e+05
Step 165 : gram_loss = 1.11e+05, loss_total = 1.11e+05
Step 166 : gram_loss = 1.09e+05, loss_total = 1.09e+05
Step 167 : gram_loss = 1.09e+05, loss_total = 1.09e+05
Step 168 : gram_loss = 1.08e+05, loss_total = 1.08e+05
Step 169 : gram_loss = 1.08e+05, loss_total = 1.08e+05
Step 170 : gram_loss = 1.07e+05, loss_total = 1.07e+05
Step 171 : gram_loss = 1.06e+05, loss_total = 1.06e+05
Step 172 : gram_loss = 1.05e+05, loss_total = 1.05e+05
Step 173 : gram_loss = 1.04e+05, loss_total = 1.04e+05
Step 174 : gram_loss = 1.04e+05, loss_total = 1.04e+05
Step 175 : gram_loss = 1.03e+05, loss_total = 1.03e+05
Step 176 : gram_loss = 1.02e+05, loss_total = 1.02e+05
Step 177 : gram_loss = 1.02e+05, loss_total = 1.02e+05
Step 178 : gram_loss = 1.01e+05, loss_total = 1.01e+05
Step 179 : gram_loss = 1.01e+05, loss_total = 1.01e+05
Step 180 : gram_loss = 9.99e+04, loss_total = 9.99e+04
Step 181 : gram_loss = 9.96e+04, loss_total = 9.96e+04
Step 182 : gram_loss = 9.91e+04, loss_total = 9.91e+04
Step 183 : gram_loss = 9.87e+04, loss_total = 9.87e+04
Step 184 : gram_loss = 9.83e+04, loss_total = 9.83e+04
Step 185 : gram_loss = 9.76e+04, loss_total = 9.76e+04
Step 186 : gram_loss = 9.67e+04, loss_total = 9.67e+04
Step 187 : gram_loss = 9.62e+04, loss_total = 9.62e+04
Step 188 : gram_loss = 9.58e+04, loss_total = 9.58e+04
Step 189 : gram_loss = 9.55e+04, loss_total = 9.55e+04
Step 190 : gram_loss = 9.51e+04, loss_total = 9.51e+04
Step 191 : gram_loss = 9.47e+04, loss_total = 9.47e+04
Step 192 : gram_loss = 9.43e+04, loss_total = 9.43e+04
Step 193 : gram_loss = 9.37e+04, loss_total = 9.37e+04
Step 194 : gram_loss = 9.34e+04, loss_total = 9.34e+04
Step 195 : gram_loss = 9.29e+04, loss_total = 9.29e+04
Step 196 : gram_loss = 9.22e+04, loss_total = 9.22e+04
Step 197 : gram_loss = 9.16e+04, loss_total = 9.16e+04
Step 198 : gram_loss = 9.10e+04, loss_total = 9.10e+04
Step 199 : gram_loss = 9.07e+04, loss_total = 9.07e+04
Step 200 : gram_loss = 9.06e+04, loss_total = 9.06e+04
Close Sess - End of the global optimization.
Computation total for  107.28947138786316  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0006_1_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0006_1_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0006_1_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0006_1_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0006_1_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0006_1_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.197694778442383  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 7.34e+09, loss_total = 7.34e+09
Step 1 : gram_loss = 3.82e+09, loss_total = 3.82e+09
Step 2 : gram_loss = 3.55e+09, loss_total = 3.55e+09
Step 3 : gram_loss = 2.15e+09, loss_total = 2.15e+09
Step 4 : gram_loss = 9.23e+08, loss_total = 9.23e+08
Step 5 : gram_loss = 5.97e+08, loss_total = 5.97e+08
Step 6 : gram_loss = 3.11e+08, loss_total = 3.11e+08
Step 7 : gram_loss = 1.70e+08, loss_total = 1.70e+08
Step 8 : gram_loss = 1.09e+08, loss_total = 1.09e+08
Step 9 : gram_loss = 8.02e+07, loss_total = 8.02e+07
Step 10 : gram_loss = 6.35e+07, loss_total = 6.35e+07
Step 11 : gram_loss = 4.24e+07, loss_total = 4.24e+07
Step 12 : gram_loss = 2.83e+07, loss_total = 2.83e+07
Step 13 : gram_loss = 2.47e+07, loss_total = 2.47e+07
Step 14 : gram_loss = 1.80e+07, loss_total = 1.80e+07
Step 15 : gram_loss = 1.45e+07, loss_total = 1.45e+07
Step 16 : gram_loss = 1.12e+07, loss_total = 1.12e+07
Step 17 : gram_loss = 9.70e+06, loss_total = 9.70e+06
Step 18 : gram_loss = 8.54e+06, loss_total = 8.54e+06
Step 19 : gram_loss = 7.56e+06, loss_total = 7.56e+06
Step 20 : gram_loss = 6.10e+06, loss_total = 6.10e+06
Step 21 : gram_loss = 5.55e+06, loss_total = 5.55e+06
Step 22 : gram_loss = 4.94e+06, loss_total = 4.94e+06
Step 23 : gram_loss = 4.63e+06, loss_total = 4.63e+06
Step 24 : gram_loss = 4.27e+06, loss_total = 4.27e+06
Step 25 : gram_loss = 4.04e+06, loss_total = 4.04e+06
Step 26 : gram_loss = 3.47e+06, loss_total = 3.47e+06
Step 27 : gram_loss = 3.12e+06, loss_total = 3.12e+06
Step 28 : gram_loss = 2.81e+06, loss_total = 2.81e+06
Step 29 : gram_loss = 2.66e+06, loss_total = 2.66e+06
Step 30 : gram_loss = 2.55e+06, loss_total = 2.55e+06
Step 31 : gram_loss = 2.46e+06, loss_total = 2.46e+06
Step 32 : gram_loss = 2.25e+06, loss_total = 2.25e+06
Step 33 : gram_loss = 2.05e+06, loss_total = 2.05e+06
Step 34 : gram_loss = 1.98e+06, loss_total = 1.98e+06
Step 35 : gram_loss = 1.86e+06, loss_total = 1.86e+06
Step 36 : gram_loss = 1.78e+06, loss_total = 1.78e+06
Step 37 : gram_loss = 1.63e+06, loss_total = 1.63e+06
Step 38 : gram_loss = 1.59e+06, loss_total = 1.59e+06
Step 39 : gram_loss = 1.51e+06, loss_total = 1.51e+06
Step 40 : gram_loss = 1.48e+06, loss_total = 1.48e+06
Step 41 : gram_loss = 1.42e+06, loss_total = 1.42e+06
Step 42 : gram_loss = 1.35e+06, loss_total = 1.35e+06
Step 43 : gram_loss = 1.24e+06, loss_total = 1.24e+06
Step 44 : gram_loss = 1.19e+06, loss_total = 1.19e+06
Step 45 : gram_loss = 1.13e+06, loss_total = 1.13e+06
Step 46 : gram_loss = 1.10e+06, loss_total = 1.10e+06
Step 47 : gram_loss = 1.07e+06, loss_total = 1.07e+06
Step 48 : gram_loss = 1.02e+06, loss_total = 1.02e+06
Step 49 : gram_loss = 9.95e+05, loss_total = 9.95e+05
Step 50 : gram_loss = 9.28e+05, loss_total = 9.28e+05
Step 51 : gram_loss = 9.03e+05, loss_total = 9.03e+05
Step 52 : gram_loss = 8.68e+05, loss_total = 8.68e+05
Step 53 : gram_loss = 8.33e+05, loss_total = 8.33e+05
Step 54 : gram_loss = 7.92e+05, loss_total = 7.92e+05
Step 55 : gram_loss = 7.69e+05, loss_total = 7.69e+05
Step 56 : gram_loss = 7.38e+05, loss_total = 7.38e+05
Step 57 : gram_loss = 7.35e+05, loss_total = 7.35e+05
Step 58 : gram_loss = 7.07e+05, loss_total = 7.07e+05
Step 59 : gram_loss = 6.92e+05, loss_total = 6.92e+05
Step 60 : gram_loss = 6.76e+05, loss_total = 6.76e+05
Step 61 : gram_loss = 6.47e+05, loss_total = 6.47e+05
Step 62 : gram_loss = 6.15e+05, loss_total = 6.15e+05
Step 63 : gram_loss = 5.92e+05, loss_total = 5.92e+05
Step 64 : gram_loss = 5.77e+05, loss_total = 5.77e+05
Step 65 : gram_loss = 5.75e+05, loss_total = 5.75e+05
Step 66 : gram_loss = 5.61e+05, loss_total = 5.61e+05
Step 67 : gram_loss = 5.50e+05, loss_total = 5.50e+05
Step 68 : gram_loss = 5.34e+05, loss_total = 5.34e+05
Step 69 : gram_loss = 5.04e+05, loss_total = 5.04e+05
Step 70 : gram_loss = 4.71e+05, loss_total = 4.71e+05
Step 71 : gram_loss = 4.46e+05, loss_total = 4.46e+05
Step 72 : gram_loss = 4.30e+05, loss_total = 4.30e+05
Step 73 : gram_loss = 4.20e+05, loss_total = 4.20e+05
Step 74 : gram_loss = 4.13e+05, loss_total = 4.13e+05
Step 75 : gram_loss = 4.03e+05, loss_total = 4.03e+05
Step 76 : gram_loss = 3.93e+05, loss_total = 3.93e+05
Step 77 : gram_loss = 3.79e+05, loss_total = 3.79e+05
Step 78 : gram_loss = 3.66e+05, loss_total = 3.66e+05
Step 79 : gram_loss = 3.51e+05, loss_total = 3.51e+05
Step 80 : gram_loss = 3.41e+05, loss_total = 3.41e+05
Step 81 : gram_loss = 3.33e+05, loss_total = 3.33e+05
Step 82 : gram_loss = 3.26e+05, loss_total = 3.26e+05
Step 83 : gram_loss = 3.16e+05, loss_total = 3.16e+05
Step 84 : gram_loss = 3.08e+05, loss_total = 3.08e+05
Step 85 : gram_loss = 3.07e+05, loss_total = 3.07e+05
Step 86 : gram_loss = 2.96e+05, loss_total = 2.96e+05
Step 87 : gram_loss = 2.92e+05, loss_total = 2.92e+05
Step 88 : gram_loss = 2.84e+05, loss_total = 2.84e+05
Step 89 : gram_loss = 2.74e+05, loss_total = 2.74e+05
Step 90 : gram_loss = 2.63e+05, loss_total = 2.63e+05
Step 91 : gram_loss = 2.51e+05, loss_total = 2.51e+05
Step 92 : gram_loss = 2.46e+05, loss_total = 2.46e+05
Step 93 : gram_loss = 2.40e+05, loss_total = 2.40e+05
Step 94 : gram_loss = 2.35e+05, loss_total = 2.35e+05
Step 95 : gram_loss = 2.29e+05, loss_total = 2.29e+05
Step 96 : gram_loss = 2.22e+05, loss_total = 2.22e+05
Step 97 : gram_loss = 2.17e+05, loss_total = 2.17e+05
Step 98 : gram_loss = 2.08e+05, loss_total = 2.08e+05
Step 99 : gram_loss = 2.01e+05, loss_total = 2.01e+05
Step 100 : gram_loss = 1.96e+05, loss_total = 1.96e+05
Step 101 : gram_loss = 1.92e+05, loss_total = 1.92e+05
Step 102 : gram_loss = 1.88e+05, loss_total = 1.88e+05
Step 103 : gram_loss = 1.85e+05, loss_total = 1.85e+05
Step 104 : gram_loss = 1.83e+05, loss_total = 1.83e+05
Step 105 : gram_loss = 1.81e+05, loss_total = 1.81e+05
Step 106 : gram_loss = 1.78e+05, loss_total = 1.78e+05
Step 107 : gram_loss = 1.74e+05, loss_total = 1.74e+05
Step 108 : gram_loss = 1.69e+05, loss_total = 1.69e+05
Step 109 : gram_loss = 1.65e+05, loss_total = 1.65e+05
Step 110 : gram_loss = 1.61e+05, loss_total = 1.61e+05
Step 111 : gram_loss = 1.58e+05, loss_total = 1.58e+05
Step 112 : gram_loss = 1.55e+05, loss_total = 1.55e+05
Step 113 : gram_loss = 1.51e+05, loss_total = 1.51e+05
Step 114 : gram_loss = 1.48e+05, loss_total = 1.48e+05
Step 115 : gram_loss = 1.44e+05, loss_total = 1.44e+05
Step 116 : gram_loss = 1.42e+05, loss_total = 1.42e+05
Step 117 : gram_loss = 1.38e+05, loss_total = 1.38e+05
Step 118 : gram_loss = 1.34e+05, loss_total = 1.34e+05
Step 119 : gram_loss = 1.32e+05, loss_total = 1.32e+05
Step 120 : gram_loss = 1.31e+05, loss_total = 1.31e+05
Step 121 : gram_loss = 1.29e+05, loss_total = 1.29e+05
Step 122 : gram_loss = 1.27e+05, loss_total = 1.27e+05
Step 123 : gram_loss = 1.26e+05, loss_total = 1.26e+05
Step 124 : gram_loss = 1.23e+05, loss_total = 1.23e+05
Step 125 : gram_loss = 1.22e+05, loss_total = 1.22e+05
Step 126 : gram_loss = 1.20e+05, loss_total = 1.20e+05
Step 127 : gram_loss = 1.19e+05, loss_total = 1.19e+05
Step 128 : gram_loss = 1.17e+05, loss_total = 1.17e+05
Step 129 : gram_loss = 1.14e+05, loss_total = 1.14e+05
Step 130 : gram_loss = 1.13e+05, loss_total = 1.13e+05
Step 131 : gram_loss = 1.11e+05, loss_total = 1.11e+05
Step 132 : gram_loss = 1.10e+05, loss_total = 1.10e+05
Step 133 : gram_loss = 1.09e+05, loss_total = 1.09e+05
Step 134 : gram_loss = 1.08e+05, loss_total = 1.08e+05
Step 135 : gram_loss = 1.06e+05, loss_total = 1.06e+05
Step 136 : gram_loss = 1.04e+05, loss_total = 1.04e+05
Step 137 : gram_loss = 1.02e+05, loss_total = 1.02e+05
Step 138 : gram_loss = 1.01e+05, loss_total = 1.01e+05
Step 139 : gram_loss = 9.92e+04, loss_total = 9.92e+04
Step 140 : gram_loss = 9.73e+04, loss_total = 9.73e+04
Step 141 : gram_loss = 9.64e+04, loss_total = 9.64e+04
Step 142 : gram_loss = 9.42e+04, loss_total = 9.42e+04
Step 143 : gram_loss = 9.32e+04, loss_total = 9.32e+04
Step 144 : gram_loss = 9.17e+04, loss_total = 9.17e+04
Step 145 : gram_loss = 8.98e+04, loss_total = 8.98e+04
Step 146 : gram_loss = 8.85e+04, loss_total = 8.85e+04
Step 147 : gram_loss = 8.77e+04, loss_total = 8.77e+04
Step 148 : gram_loss = 8.71e+04, loss_total = 8.71e+04
Step 149 : gram_loss = 8.64e+04, loss_total = 8.64e+04
Step 150 : gram_loss = 8.50e+04, loss_total = 8.50e+04
Step 151 : gram_loss = 8.40e+04, loss_total = 8.40e+04
Step 152 : gram_loss = 8.31e+04, loss_total = 8.31e+04
Step 153 : gram_loss = 8.16e+04, loss_total = 8.16e+04
Step 154 : gram_loss = 8.05e+04, loss_total = 8.05e+04
Step 155 : gram_loss = 7.99e+04, loss_total = 7.99e+04
Step 156 : gram_loss = 7.91e+04, loss_total = 7.91e+04
Step 157 : gram_loss = 7.85e+04, loss_total = 7.85e+04
Step 158 : gram_loss = 7.77e+04, loss_total = 7.77e+04
Step 159 : gram_loss = 7.64e+04, loss_total = 7.64e+04
Step 160 : gram_loss = 7.58e+04, loss_total = 7.58e+04
Step 161 : gram_loss = 7.45e+04, loss_total = 7.45e+04
Step 162 : gram_loss = 7.41e+04, loss_total = 7.41e+04
Step 163 : gram_loss = 7.37e+04, loss_total = 7.37e+04
Step 164 : gram_loss = 7.28e+04, loss_total = 7.28e+04
Step 165 : gram_loss = 7.17e+04, loss_total = 7.17e+04
Step 166 : gram_loss = 7.06e+04, loss_total = 7.06e+04
Step 167 : gram_loss = 6.99e+04, loss_total = 6.99e+04
Step 168 : gram_loss = 6.92e+04, loss_total = 6.92e+04
Step 169 : gram_loss = 6.86e+04, loss_total = 6.86e+04
Step 170 : gram_loss = 6.83e+04, loss_total = 6.83e+04
Step 171 : gram_loss = 6.75e+04, loss_total = 6.75e+04
Step 172 : gram_loss = 6.72e+04, loss_total = 6.72e+04
Step 173 : gram_loss = 6.67e+04, loss_total = 6.67e+04
Step 174 : gram_loss = 6.58e+04, loss_total = 6.58e+04
Step 175 : gram_loss = 6.50e+04, loss_total = 6.50e+04
Step 176 : gram_loss = 6.44e+04, loss_total = 6.44e+04
Step 177 : gram_loss = 6.37e+04, loss_total = 6.37e+04
Step 178 : gram_loss = 6.31e+04, loss_total = 6.31e+04
Step 179 : gram_loss = 6.25e+04, loss_total = 6.25e+04
Step 180 : gram_loss = 6.21e+04, loss_total = 6.21e+04
Step 181 : gram_loss = 6.18e+04, loss_total = 6.18e+04
Step 182 : gram_loss = 6.14e+04, loss_total = 6.14e+04
Step 183 : gram_loss = 6.07e+04, loss_total = 6.07e+04
Step 184 : gram_loss = 6.03e+04, loss_total = 6.03e+04
Step 185 : gram_loss = 5.97e+04, loss_total = 5.97e+04
Step 186 : gram_loss = 5.89e+04, loss_total = 5.89e+04
Step 187 : gram_loss = 5.85e+04, loss_total = 5.85e+04
Step 188 : gram_loss = 5.81e+04, loss_total = 5.81e+04
Step 189 : gram_loss = 5.78e+04, loss_total = 5.78e+04
Step 190 : gram_loss = 5.70e+04, loss_total = 5.70e+04
Step 191 : gram_loss = 5.65e+04, loss_total = 5.65e+04
Step 192 : gram_loss = 5.60e+04, loss_total = 5.60e+04
Step 193 : gram_loss = 5.57e+04, loss_total = 5.57e+04
Step 194 : gram_loss = 5.54e+04, loss_total = 5.54e+04
Step 195 : gram_loss = 5.49e+04, loss_total = 5.49e+04
Step 196 : gram_loss = 5.44e+04, loss_total = 5.44e+04
Step 197 : gram_loss = 5.39e+04, loss_total = 5.39e+04
Step 198 : gram_loss = 5.36e+04, loss_total = 5.36e+04
Step 199 : gram_loss = 5.32e+04, loss_total = 5.32e+04
Step 200 : gram_loss = 5.30e+04, loss_total = 5.30e+04
Close Sess - End of the global optimization.
Computation total for  107.06514048576355  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0026_1_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0026_1_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0026_1_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0026_1_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0026_1_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0026_1_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.217566013336182  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 4.94e+09, loss_total = 4.94e+09
Step 1 : gram_loss = 3.39e+09, loss_total = 3.39e+09
Step 2 : gram_loss = 3.16e+09, loss_total = 3.16e+09
Step 3 : gram_loss = 2.39e+09, loss_total = 2.39e+09
Step 4 : gram_loss = 1.49e+09, loss_total = 1.49e+09
Step 5 : gram_loss = 5.11e+08, loss_total = 5.11e+08
Step 6 : gram_loss = 3.43e+08, loss_total = 3.43e+08
Step 7 : gram_loss = 2.35e+08, loss_total = 2.35e+08
Step 8 : gram_loss = 1.41e+08, loss_total = 1.41e+08
Step 9 : gram_loss = 9.33e+07, loss_total = 9.33e+07
Step 10 : gram_loss = 7.99e+07, loss_total = 7.99e+07
Step 11 : gram_loss = 5.69e+07, loss_total = 5.69e+07
Step 12 : gram_loss = 4.18e+07, loss_total = 4.18e+07
Step 13 : gram_loss = 3.33e+07, loss_total = 3.33e+07
Step 14 : gram_loss = 2.28e+07, loss_total = 2.28e+07
Step 15 : gram_loss = 2.15e+07, loss_total = 2.15e+07
Step 16 : gram_loss = 1.87e+07, loss_total = 1.87e+07
Step 17 : gram_loss = 1.63e+07, loss_total = 1.63e+07
Step 18 : gram_loss = 1.21e+07, loss_total = 1.21e+07
Step 19 : gram_loss = 1.03e+07, loss_total = 1.03e+07
Step 20 : gram_loss = 8.74e+06, loss_total = 8.74e+06
Step 21 : gram_loss = 7.96e+06, loss_total = 7.96e+06
Step 22 : gram_loss = 7.21e+06, loss_total = 7.21e+06
Step 23 : gram_loss = 5.90e+06, loss_total = 5.90e+06
Step 24 : gram_loss = 5.30e+06, loss_total = 5.30e+06
Step 25 : gram_loss = 4.63e+06, loss_total = 4.63e+06
Step 26 : gram_loss = 4.24e+06, loss_total = 4.24e+06
Step 27 : gram_loss = 3.92e+06, loss_total = 3.92e+06
Step 28 : gram_loss = 3.54e+06, loss_total = 3.54e+06
Step 29 : gram_loss = 3.09e+06, loss_total = 3.09e+06
Step 30 : gram_loss = 2.79e+06, loss_total = 2.79e+06
Step 31 : gram_loss = 2.68e+06, loss_total = 2.68e+06
Step 32 : gram_loss = 2.54e+06, loss_total = 2.54e+06
Step 33 : gram_loss = 2.41e+06, loss_total = 2.41e+06
Step 34 : gram_loss = 2.27e+06, loss_total = 2.27e+06
Step 35 : gram_loss = 2.04e+06, loss_total = 2.04e+06
Step 36 : gram_loss = 1.90e+06, loss_total = 1.90e+06
Step 37 : gram_loss = 1.67e+06, loss_total = 1.67e+06
Step 38 : gram_loss = 1.50e+06, loss_total = 1.50e+06
Step 39 : gram_loss = 1.42e+06, loss_total = 1.42e+06
Step 40 : gram_loss = 1.35e+06, loss_total = 1.35e+06
Step 41 : gram_loss = 1.28e+06, loss_total = 1.28e+06
Step 42 : gram_loss = 1.18e+06, loss_total = 1.18e+06
Step 43 : gram_loss = 1.12e+06, loss_total = 1.12e+06
Step 44 : gram_loss = 1.03e+06, loss_total = 1.03e+06
Step 45 : gram_loss = 9.83e+05, loss_total = 9.83e+05
Step 46 : gram_loss = 9.04e+05, loss_total = 9.04e+05
Step 47 : gram_loss = 8.58e+05, loss_total = 8.58e+05
Step 48 : gram_loss = 8.02e+05, loss_total = 8.02e+05
Step 49 : gram_loss = 7.75e+05, loss_total = 7.75e+05
Step 50 : gram_loss = 7.45e+05, loss_total = 7.45e+05
Step 51 : gram_loss = 6.99e+05, loss_total = 6.99e+05
Step 52 : gram_loss = 6.82e+05, loss_total = 6.82e+05
Step 53 : gram_loss = 6.47e+05, loss_total = 6.47e+05
Step 54 : gram_loss = 6.18e+05, loss_total = 6.18e+05
Step 55 : gram_loss = 5.91e+05, loss_total = 5.91e+05
Step 56 : gram_loss = 5.80e+05, loss_total = 5.80e+05
Step 57 : gram_loss = 5.59e+05, loss_total = 5.59e+05
Step 58 : gram_loss = 5.50e+05, loss_total = 5.50e+05
Step 59 : gram_loss = 5.37e+05, loss_total = 5.37e+05
Step 60 : gram_loss = 5.12e+05, loss_total = 5.12e+05
Step 61 : gram_loss = 4.84e+05, loss_total = 4.84e+05
Step 62 : gram_loss = 4.54e+05, loss_total = 4.54e+05
Step 63 : gram_loss = 4.35e+05, loss_total = 4.35e+05
Step 64 : gram_loss = 4.26e+05, loss_total = 4.26e+05
Step 65 : gram_loss = 4.15e+05, loss_total = 4.15e+05
Step 66 : gram_loss = 4.07e+05, loss_total = 4.07e+05
Step 67 : gram_loss = 3.85e+05, loss_total = 3.85e+05
Step 68 : gram_loss = 3.75e+05, loss_total = 3.75e+05
Step 69 : gram_loss = 3.62e+05, loss_total = 3.62e+05
Step 70 : gram_loss = 3.55e+05, loss_total = 3.55e+05
Step 71 : gram_loss = 3.46e+05, loss_total = 3.46e+05
Step 72 : gram_loss = 3.37e+05, loss_total = 3.37e+05
Step 73 : gram_loss = 3.27e+05, loss_total = 3.27e+05
Step 74 : gram_loss = 3.18e+05, loss_total = 3.18e+05
Step 75 : gram_loss = 3.15e+05, loss_total = 3.15e+05
Step 76 : gram_loss = 3.09e+05, loss_total = 3.09e+05
Step 77 : gram_loss = 3.01e+05, loss_total = 3.01e+05
Step 78 : gram_loss = 2.94e+05, loss_total = 2.94e+05
Step 79 : gram_loss = 2.86e+05, loss_total = 2.86e+05
Step 80 : gram_loss = 2.77e+05, loss_total = 2.77e+05
Step 81 : gram_loss = 2.69e+05, loss_total = 2.69e+05
Step 82 : gram_loss = 2.58e+05, loss_total = 2.58e+05
Step 83 : gram_loss = 2.53e+05, loss_total = 2.53e+05
Step 84 : gram_loss = 2.45e+05, loss_total = 2.45e+05
Step 85 : gram_loss = 2.40e+05, loss_total = 2.40e+05
Step 86 : gram_loss = 2.35e+05, loss_total = 2.35e+05
Step 87 : gram_loss = 2.32e+05, loss_total = 2.32e+05
Step 88 : gram_loss = 2.23e+05, loss_total = 2.23e+05
Step 89 : gram_loss = 2.17e+05, loss_total = 2.17e+05
Step 90 : gram_loss = 2.13e+05, loss_total = 2.13e+05
Step 91 : gram_loss = 2.04e+05, loss_total = 2.04e+05
Step 92 : gram_loss = 2.01e+05, loss_total = 2.01e+05
Step 93 : gram_loss = 1.96e+05, loss_total = 1.96e+05
Step 94 : gram_loss = 1.92e+05, loss_total = 1.92e+05
Step 95 : gram_loss = 1.88e+05, loss_total = 1.88e+05
Step 96 : gram_loss = 1.85e+05, loss_total = 1.85e+05
Step 97 : gram_loss = 1.82e+05, loss_total = 1.82e+05
Step 98 : gram_loss = 1.80e+05, loss_total = 1.80e+05
Step 99 : gram_loss = 1.76e+05, loss_total = 1.76e+05
Step 100 : gram_loss = 1.72e+05, loss_total = 1.72e+05
Step 101 : gram_loss = 1.67e+05, loss_total = 1.67e+05
Step 102 : gram_loss = 1.64e+05, loss_total = 1.64e+05
Step 103 : gram_loss = 1.61e+05, loss_total = 1.61e+05
Step 104 : gram_loss = 1.58e+05, loss_total = 1.58e+05
Step 105 : gram_loss = 1.56e+05, loss_total = 1.56e+05
Step 106 : gram_loss = 1.54e+05, loss_total = 1.54e+05
Step 107 : gram_loss = 1.49e+05, loss_total = 1.49e+05
Step 108 : gram_loss = 1.48e+05, loss_total = 1.48e+05
Step 109 : gram_loss = 1.41e+05, loss_total = 1.41e+05
Step 110 : gram_loss = 1.40e+05, loss_total = 1.40e+05
Step 111 : gram_loss = 1.38e+05, loss_total = 1.38e+05
Step 112 : gram_loss = 1.37e+05, loss_total = 1.37e+05
Step 113 : gram_loss = 1.34e+05, loss_total = 1.34e+05
Step 114 : gram_loss = 1.31e+05, loss_total = 1.31e+05
Step 115 : gram_loss = 1.29e+05, loss_total = 1.29e+05
Step 116 : gram_loss = 1.27e+05, loss_total = 1.27e+05
Step 117 : gram_loss = 1.24e+05, loss_total = 1.24e+05
Step 118 : gram_loss = 1.21e+05, loss_total = 1.21e+05
Step 119 : gram_loss = 1.19e+05, loss_total = 1.19e+05
Step 120 : gram_loss = 1.17e+05, loss_total = 1.17e+05
Step 121 : gram_loss = 1.16e+05, loss_total = 1.16e+05
Step 122 : gram_loss = 1.15e+05, loss_total = 1.15e+05
Step 123 : gram_loss = 1.14e+05, loss_total = 1.14e+05
Step 124 : gram_loss = 1.12e+05, loss_total = 1.12e+05
Step 125 : gram_loss = 1.10e+05, loss_total = 1.10e+05
Step 126 : gram_loss = 1.08e+05, loss_total = 1.08e+05
Step 127 : gram_loss = 1.06e+05, loss_total = 1.06e+05
Step 128 : gram_loss = 1.05e+05, loss_total = 1.05e+05
Step 129 : gram_loss = 1.04e+05, loss_total = 1.04e+05
Step 130 : gram_loss = 1.02e+05, loss_total = 1.02e+05
Step 131 : gram_loss = 1.01e+05, loss_total = 1.01e+05
Step 132 : gram_loss = 9.92e+04, loss_total = 9.92e+04
Step 133 : gram_loss = 9.71e+04, loss_total = 9.71e+04
Step 134 : gram_loss = 9.59e+04, loss_total = 9.59e+04
Step 135 : gram_loss = 9.44e+04, loss_total = 9.44e+04
Step 136 : gram_loss = 9.32e+04, loss_total = 9.32e+04
Step 137 : gram_loss = 9.19e+04, loss_total = 9.19e+04
Step 138 : gram_loss = 9.08e+04, loss_total = 9.08e+04
Step 139 : gram_loss = 9.01e+04, loss_total = 9.01e+04
Step 140 : gram_loss = 8.83e+04, loss_total = 8.83e+04
Step 141 : gram_loss = 8.76e+04, loss_total = 8.76e+04
Step 142 : gram_loss = 8.63e+04, loss_total = 8.63e+04
Step 143 : gram_loss = 8.55e+04, loss_total = 8.55e+04
Step 144 : gram_loss = 8.47e+04, loss_total = 8.47e+04
Step 145 : gram_loss = 8.39e+04, loss_total = 8.39e+04
Step 146 : gram_loss = 8.32e+04, loss_total = 8.32e+04
Step 147 : gram_loss = 8.24e+04, loss_total = 8.24e+04
Step 148 : gram_loss = 8.14e+04, loss_total = 8.14e+04
Step 149 : gram_loss = 8.03e+04, loss_total = 8.03e+04
Step 150 : gram_loss = 7.91e+04, loss_total = 7.91e+04
Step 151 : gram_loss = 7.79e+04, loss_total = 7.79e+04
Step 152 : gram_loss = 7.70e+04, loss_total = 7.70e+04
Step 153 : gram_loss = 7.64e+04, loss_total = 7.64e+04
Step 154 : gram_loss = 7.57e+04, loss_total = 7.57e+04
Step 155 : gram_loss = 7.46e+04, loss_total = 7.46e+04
Step 156 : gram_loss = 7.35e+04, loss_total = 7.35e+04
Step 157 : gram_loss = 7.25e+04, loss_total = 7.25e+04
Step 158 : gram_loss = 7.19e+04, loss_total = 7.19e+04
Step 159 : gram_loss = 7.13e+04, loss_total = 7.13e+04
Step 160 : gram_loss = 7.05e+04, loss_total = 7.05e+04
Step 161 : gram_loss = 6.94e+04, loss_total = 6.94e+04
Step 162 : gram_loss = 6.87e+04, loss_total = 6.87e+04
Step 163 : gram_loss = 6.80e+04, loss_total = 6.80e+04
Step 164 : gram_loss = 6.74e+04, loss_total = 6.74e+04
Step 165 : gram_loss = 6.69e+04, loss_total = 6.69e+04
Step 166 : gram_loss = 6.63e+04, loss_total = 6.63e+04
Step 167 : gram_loss = 6.57e+04, loss_total = 6.57e+04
Step 168 : gram_loss = 6.51e+04, loss_total = 6.51e+04
Step 169 : gram_loss = 6.47e+04, loss_total = 6.47e+04
Step 170 : gram_loss = 6.42e+04, loss_total = 6.42e+04
Step 171 : gram_loss = 6.35e+04, loss_total = 6.35e+04
Step 172 : gram_loss = 6.26e+04, loss_total = 6.26e+04
Step 173 : gram_loss = 6.20e+04, loss_total = 6.20e+04
Step 174 : gram_loss = 6.14e+04, loss_total = 6.14e+04
Step 175 : gram_loss = 6.09e+04, loss_total = 6.09e+04
Step 176 : gram_loss = 6.03e+04, loss_total = 6.03e+04
Step 177 : gram_loss = 5.98e+04, loss_total = 5.98e+04
Step 178 : gram_loss = 5.94e+04, loss_total = 5.94e+04
Step 179 : gram_loss = 5.87e+04, loss_total = 5.87e+04
Step 180 : gram_loss = 5.82e+04, loss_total = 5.82e+04
Step 181 : gram_loss = 5.76e+04, loss_total = 5.76e+04
Step 182 : gram_loss = 5.70e+04, loss_total = 5.70e+04
Step 183 : gram_loss = 5.64e+04, loss_total = 5.64e+04
Step 184 : gram_loss = 5.62e+04, loss_total = 5.62e+04
Step 185 : gram_loss = 5.53e+04, loss_total = 5.53e+04
Step 186 : gram_loss = 5.52e+04, loss_total = 5.52e+04
Step 187 : gram_loss = 5.47e+04, loss_total = 5.47e+04
Step 188 : gram_loss = 5.46e+04, loss_total = 5.46e+04
Step 189 : gram_loss = 5.42e+04, loss_total = 5.42e+04
Step 190 : gram_loss = 5.40e+04, loss_total = 5.40e+04
Step 191 : gram_loss = 5.36e+04, loss_total = 5.36e+04
Step 192 : gram_loss = 5.32e+04, loss_total = 5.32e+04
Step 193 : gram_loss = 5.28e+04, loss_total = 5.28e+04
Step 194 : gram_loss = 5.23e+04, loss_total = 5.23e+04
Step 195 : gram_loss = 5.20e+04, loss_total = 5.20e+04
Step 196 : gram_loss = 5.15e+04, loss_total = 5.15e+04
Step 197 : gram_loss = 5.11e+04, loss_total = 5.11e+04
Step 198 : gram_loss = 5.08e+04, loss_total = 5.08e+04
Step 199 : gram_loss = 5.04e+04, loss_total = 5.04e+04
Step 200 : gram_loss = 4.99e+04, loss_total = 4.99e+04
Close Sess - End of the global optimization.
Computation total for  108.1935293674469  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0011_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0011_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0011_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0011_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0011_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0011_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.205242872238159  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 1.74e+09, loss_total = 1.74e+09
Step 1 : gram_loss = 1.49e+09, loss_total = 1.49e+09
Step 2 : gram_loss = 1.35e+09, loss_total = 1.35e+09
Step 3 : gram_loss = 6.57e+08, loss_total = 6.57e+08
Step 4 : gram_loss = 4.29e+08, loss_total = 4.29e+08
Step 5 : gram_loss = 3.19e+08, loss_total = 3.19e+08
Step 6 : gram_loss = 2.55e+08, loss_total = 2.55e+08
Step 7 : gram_loss = 2.24e+08, loss_total = 2.24e+08
Step 8 : gram_loss = 1.95e+08, loss_total = 1.95e+08
Step 9 : gram_loss = 1.72e+08, loss_total = 1.72e+08
Step 10 : gram_loss = 1.48e+08, loss_total = 1.48e+08
Step 11 : gram_loss = 1.24e+08, loss_total = 1.24e+08
Step 12 : gram_loss = 1.01e+08, loss_total = 1.01e+08
Step 13 : gram_loss = 9.25e+07, loss_total = 9.25e+07
Step 14 : gram_loss = 8.05e+07, loss_total = 8.05e+07
Step 15 : gram_loss = 7.45e+07, loss_total = 7.45e+07
Step 16 : gram_loss = 6.82e+07, loss_total = 6.82e+07
Step 17 : gram_loss = 5.95e+07, loss_total = 5.95e+07
Step 18 : gram_loss = 5.06e+07, loss_total = 5.06e+07
Step 19 : gram_loss = 4.50e+07, loss_total = 4.50e+07
Step 20 : gram_loss = 4.21e+07, loss_total = 4.21e+07
Step 21 : gram_loss = 3.95e+07, loss_total = 3.95e+07
Step 22 : gram_loss = 3.79e+07, loss_total = 3.79e+07
Step 23 : gram_loss = 3.40e+07, loss_total = 3.40e+07
Step 24 : gram_loss = 3.10e+07, loss_total = 3.10e+07
Step 25 : gram_loss = 2.80e+07, loss_total = 2.80e+07
Step 26 : gram_loss = 2.56e+07, loss_total = 2.56e+07
Step 27 : gram_loss = 2.37e+07, loss_total = 2.37e+07
Step 28 : gram_loss = 2.26e+07, loss_total = 2.26e+07
Step 29 : gram_loss = 2.18e+07, loss_total = 2.18e+07
Step 30 : gram_loss = 2.09e+07, loss_total = 2.09e+07
Step 31 : gram_loss = 2.01e+07, loss_total = 2.01e+07
Step 32 : gram_loss = 1.94e+07, loss_total = 1.94e+07
Step 33 : gram_loss = 1.78e+07, loss_total = 1.78e+07
Step 34 : gram_loss = 1.66e+07, loss_total = 1.66e+07
Step 35 : gram_loss = 1.57e+07, loss_total = 1.57e+07
Step 36 : gram_loss = 1.54e+07, loss_total = 1.54e+07
Step 37 : gram_loss = 1.46e+07, loss_total = 1.46e+07
Step 38 : gram_loss = 1.41e+07, loss_total = 1.41e+07
Step 39 : gram_loss = 1.35e+07, loss_total = 1.35e+07
Step 40 : gram_loss = 1.27e+07, loss_total = 1.27e+07
Step 41 : gram_loss = 1.22e+07, loss_total = 1.22e+07
Step 42 : gram_loss = 1.18e+07, loss_total = 1.18e+07
Step 43 : gram_loss = 1.13e+07, loss_total = 1.13e+07
Step 44 : gram_loss = 1.08e+07, loss_total = 1.08e+07
Step 45 : gram_loss = 1.04e+07, loss_total = 1.04e+07
Step 46 : gram_loss = 9.70e+06, loss_total = 9.70e+06
Step 47 : gram_loss = 9.38e+06, loss_total = 9.38e+06
Step 48 : gram_loss = 9.08e+06, loss_total = 9.08e+06
Step 49 : gram_loss = 8.77e+06, loss_total = 8.77e+06
Step 50 : gram_loss = 8.46e+06, loss_total = 8.46e+06
Step 51 : gram_loss = 8.07e+06, loss_total = 8.07e+06
Step 52 : gram_loss = 7.61e+06, loss_total = 7.61e+06
Step 53 : gram_loss = 7.37e+06, loss_total = 7.37e+06
Step 54 : gram_loss = 7.13e+06, loss_total = 7.13e+06
Step 55 : gram_loss = 6.94e+06, loss_total = 6.94e+06
Step 56 : gram_loss = 6.78e+06, loss_total = 6.78e+06
Step 57 : gram_loss = 6.60e+06, loss_total = 6.60e+06
Step 58 : gram_loss = 6.40e+06, loss_total = 6.40e+06
Step 59 : gram_loss = 6.08e+06, loss_total = 6.08e+06
Step 60 : gram_loss = 5.84e+06, loss_total = 5.84e+06
Step 61 : gram_loss = 5.63e+06, loss_total = 5.63e+06
Step 62 : gram_loss = 5.45e+06, loss_total = 5.45e+06
Step 63 : gram_loss = 5.25e+06, loss_total = 5.25e+06
Step 64 : gram_loss = 4.97e+06, loss_total = 4.97e+06
Step 65 : gram_loss = 4.75e+06, loss_total = 4.75e+06
Step 66 : gram_loss = 4.67e+06, loss_total = 4.67e+06
Step 67 : gram_loss = 4.55e+06, loss_total = 4.55e+06
Step 68 : gram_loss = 4.46e+06, loss_total = 4.46e+06
Step 69 : gram_loss = 4.30e+06, loss_total = 4.30e+06
Step 70 : gram_loss = 4.11e+06, loss_total = 4.11e+06
Step 71 : gram_loss = 4.00e+06, loss_total = 4.00e+06
Step 72 : gram_loss = 3.85e+06, loss_total = 3.85e+06
Step 73 : gram_loss = 3.75e+06, loss_total = 3.75e+06
Step 74 : gram_loss = 3.63e+06, loss_total = 3.63e+06
Step 75 : gram_loss = 3.53e+06, loss_total = 3.53e+06
Step 76 : gram_loss = 3.41e+06, loss_total = 3.41e+06
Step 77 : gram_loss = 3.36e+06, loss_total = 3.36e+06
Step 78 : gram_loss = 3.25e+06, loss_total = 3.25e+06
Step 79 : gram_loss = 3.12e+06, loss_total = 3.12e+06
Step 80 : gram_loss = 3.00e+06, loss_total = 3.00e+06
Step 81 : gram_loss = 2.91e+06, loss_total = 2.91e+06
Step 82 : gram_loss = 2.86e+06, loss_total = 2.86e+06
Step 83 : gram_loss = 2.77e+06, loss_total = 2.77e+06
Step 84 : gram_loss = 2.63e+06, loss_total = 2.63e+06
Step 85 : gram_loss = 2.57e+06, loss_total = 2.57e+06
Step 86 : gram_loss = 2.49e+06, loss_total = 2.49e+06
Step 87 : gram_loss = 2.45e+06, loss_total = 2.45e+06
Step 88 : gram_loss = 2.42e+06, loss_total = 2.42e+06
Step 89 : gram_loss = 2.38e+06, loss_total = 2.38e+06
Step 90 : gram_loss = 2.31e+06, loss_total = 2.31e+06
Step 91 : gram_loss = 2.26e+06, loss_total = 2.26e+06
Step 92 : gram_loss = 2.22e+06, loss_total = 2.22e+06
Step 93 : gram_loss = 2.17e+06, loss_total = 2.17e+06
Step 94 : gram_loss = 2.12e+06, loss_total = 2.12e+06
Step 95 : gram_loss = 2.06e+06, loss_total = 2.06e+06
Step 96 : gram_loss = 2.01e+06, loss_total = 2.01e+06
Step 97 : gram_loss = 1.98e+06, loss_total = 1.98e+06
Step 98 : gram_loss = 1.96e+06, loss_total = 1.96e+06
Step 99 : gram_loss = 1.92e+06, loss_total = 1.92e+06
Step 100 : gram_loss = 1.87e+06, loss_total = 1.87e+06
Step 101 : gram_loss = 1.83e+06, loss_total = 1.83e+06
Step 102 : gram_loss = 1.80e+06, loss_total = 1.80e+06
Step 103 : gram_loss = 1.77e+06, loss_total = 1.77e+06
Step 104 : gram_loss = 1.74e+06, loss_total = 1.74e+06
Step 105 : gram_loss = 1.69e+06, loss_total = 1.69e+06
Step 106 : gram_loss = 1.67e+06, loss_total = 1.67e+06
Step 107 : gram_loss = 1.63e+06, loss_total = 1.63e+06
Step 108 : gram_loss = 1.60e+06, loss_total = 1.60e+06
Step 109 : gram_loss = 1.58e+06, loss_total = 1.58e+06
Step 110 : gram_loss = 1.55e+06, loss_total = 1.55e+06
Step 111 : gram_loss = 1.53e+06, loss_total = 1.53e+06
Step 112 : gram_loss = 1.49e+06, loss_total = 1.49e+06
Step 113 : gram_loss = 1.47e+06, loss_total = 1.47e+06
Step 114 : gram_loss = 1.46e+06, loss_total = 1.46e+06
Step 115 : gram_loss = 1.43e+06, loss_total = 1.43e+06
Step 116 : gram_loss = 1.40e+06, loss_total = 1.40e+06
Step 117 : gram_loss = 1.38e+06, loss_total = 1.38e+06
Step 118 : gram_loss = 1.35e+06, loss_total = 1.35e+06
Step 119 : gram_loss = 1.34e+06, loss_total = 1.34e+06
Step 120 : gram_loss = 1.32e+06, loss_total = 1.32e+06
Step 121 : gram_loss = 1.29e+06, loss_total = 1.29e+06
Step 122 : gram_loss = 1.27e+06, loss_total = 1.27e+06
Step 123 : gram_loss = 1.25e+06, loss_total = 1.25e+06
Step 124 : gram_loss = 1.25e+06, loss_total = 1.25e+06
Step 125 : gram_loss = 1.23e+06, loss_total = 1.23e+06
Step 126 : gram_loss = 1.20e+06, loss_total = 1.20e+06
Step 127 : gram_loss = 1.18e+06, loss_total = 1.18e+06
Step 128 : gram_loss = 1.17e+06, loss_total = 1.17e+06
Step 129 : gram_loss = 1.16e+06, loss_total = 1.16e+06
Step 130 : gram_loss = 1.14e+06, loss_total = 1.14e+06
Step 131 : gram_loss = 1.13e+06, loss_total = 1.13e+06
Step 132 : gram_loss = 1.11e+06, loss_total = 1.11e+06
Step 133 : gram_loss = 1.10e+06, loss_total = 1.10e+06
Step 134 : gram_loss = 1.09e+06, loss_total = 1.09e+06
Step 135 : gram_loss = 1.07e+06, loss_total = 1.07e+06
Step 136 : gram_loss = 1.06e+06, loss_total = 1.06e+06
Step 137 : gram_loss = 1.05e+06, loss_total = 1.05e+06
Step 138 : gram_loss = 1.04e+06, loss_total = 1.04e+06
Step 139 : gram_loss = 1.03e+06, loss_total = 1.03e+06
Step 140 : gram_loss = 1.01e+06, loss_total = 1.01e+06
Step 141 : gram_loss = 1.00e+06, loss_total = 1.00e+06
Step 142 : gram_loss = 9.90e+05, loss_total = 9.90e+05
Step 143 : gram_loss = 9.78e+05, loss_total = 9.78e+05
Step 144 : gram_loss = 9.65e+05, loss_total = 9.65e+05
Step 145 : gram_loss = 9.58e+05, loss_total = 9.58e+05
Step 146 : gram_loss = 9.52e+05, loss_total = 9.52e+05
Step 147 : gram_loss = 9.43e+05, loss_total = 9.43e+05
Step 148 : gram_loss = 9.31e+05, loss_total = 9.31e+05
Step 149 : gram_loss = 9.22e+05, loss_total = 9.22e+05
Step 150 : gram_loss = 9.13e+05, loss_total = 9.13e+05
Step 151 : gram_loss = 9.03e+05, loss_total = 9.03e+05
Step 152 : gram_loss = 8.94e+05, loss_total = 8.94e+05
Step 153 : gram_loss = 8.89e+05, loss_total = 8.89e+05
Step 154 : gram_loss = 8.79e+05, loss_total = 8.79e+05
Step 155 : gram_loss = 8.68e+05, loss_total = 8.68e+05
Step 156 : gram_loss = 8.59e+05, loss_total = 8.59e+05
Step 157 : gram_loss = 8.52e+05, loss_total = 8.52e+05
Step 158 : gram_loss = 8.43e+05, loss_total = 8.43e+05
Step 159 : gram_loss = 8.34e+05, loss_total = 8.34e+05
Step 160 : gram_loss = 8.30e+05, loss_total = 8.30e+05
Step 161 : gram_loss = 8.24e+05, loss_total = 8.24e+05
Step 162 : gram_loss = 8.19e+05, loss_total = 8.19e+05
Step 163 : gram_loss = 8.10e+05, loss_total = 8.10e+05
Step 164 : gram_loss = 8.03e+05, loss_total = 8.03e+05
Step 165 : gram_loss = 8.00e+05, loss_total = 8.00e+05
Step 166 : gram_loss = 7.94e+05, loss_total = 7.94e+05
Step 167 : gram_loss = 7.88e+05, loss_total = 7.88e+05
Step 168 : gram_loss = 7.83e+05, loss_total = 7.83e+05
Step 169 : gram_loss = 7.78e+05, loss_total = 7.78e+05
Step 170 : gram_loss = 7.75e+05, loss_total = 7.75e+05
Step 171 : gram_loss = 7.69e+05, loss_total = 7.69e+05
Step 172 : gram_loss = 7.62e+05, loss_total = 7.62e+05
Step 173 : gram_loss = 7.59e+05, loss_total = 7.59e+05
Step 174 : gram_loss = 7.54e+05, loss_total = 7.54e+05
Step 175 : gram_loss = 7.49e+05, loss_total = 7.49e+05
Step 176 : gram_loss = 7.45e+05, loss_total = 7.45e+05
Step 177 : gram_loss = 7.39e+05, loss_total = 7.39e+05
Step 178 : gram_loss = 7.36e+05, loss_total = 7.36e+05
Step 179 : gram_loss = 7.33e+05, loss_total = 7.33e+05
Step 180 : gram_loss = 7.27e+05, loss_total = 7.27e+05
Step 181 : gram_loss = 7.24e+05, loss_total = 7.24e+05
Step 182 : gram_loss = 7.17e+05, loss_total = 7.17e+05
Step 183 : gram_loss = 7.13e+05, loss_total = 7.13e+05
Step 184 : gram_loss = 7.10e+05, loss_total = 7.10e+05
Step 185 : gram_loss = 7.08e+05, loss_total = 7.08e+05
Step 186 : gram_loss = 7.06e+05, loss_total = 7.06e+05
Step 187 : gram_loss = 7.00e+05, loss_total = 7.00e+05
Step 188 : gram_loss = 6.97e+05, loss_total = 6.97e+05
Step 189 : gram_loss = 6.92e+05, loss_total = 6.92e+05
Step 190 : gram_loss = 6.91e+05, loss_total = 6.91e+05
Step 191 : gram_loss = 6.88e+05, loss_total = 6.88e+05
Step 192 : gram_loss = 6.84e+05, loss_total = 6.84e+05
Step 193 : gram_loss = 6.81e+05, loss_total = 6.81e+05
Step 194 : gram_loss = 6.76e+05, loss_total = 6.76e+05
Step 195 : gram_loss = 6.73e+05, loss_total = 6.73e+05
Step 196 : gram_loss = 6.70e+05, loss_total = 6.70e+05
Step 197 : gram_loss = 6.70e+05, loss_total = 6.70e+05
Step 198 : gram_loss = 6.66e+05, loss_total = 6.66e+05
Step 199 : gram_loss = 6.64e+05, loss_total = 6.64e+05
Step 200 : gram_loss = 6.62e+05, loss_total = 6.62e+05
Close Sess - End of the global optimization.
Computation total for  107.19653248786926  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0039_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0039_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0039_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0039_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0039_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0039_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.199889421463013  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 5.13e+09, loss_total = 5.13e+09
Step 1 : gram_loss = 3.89e+09, loss_total = 3.89e+09
Step 2 : gram_loss = 3.73e+09, loss_total = 3.73e+09
Step 3 : gram_loss = 3.43e+09, loss_total = 3.43e+09
Step 4 : gram_loss = 1.61e+09, loss_total = 1.61e+09
Step 5 : gram_loss = 9.59e+08, loss_total = 9.59e+08
Step 6 : gram_loss = 6.42e+08, loss_total = 6.42e+08
Step 7 : gram_loss = 3.74e+08, loss_total = 3.74e+08
Step 8 : gram_loss = 2.59e+08, loss_total = 2.59e+08
Step 9 : gram_loss = 1.79e+08, loss_total = 1.79e+08
Step 10 : gram_loss = 1.27e+08, loss_total = 1.27e+08
Step 11 : gram_loss = 8.88e+07, loss_total = 8.88e+07
Step 12 : gram_loss = 6.83e+07, loss_total = 6.83e+07
Step 13 : gram_loss = 5.08e+07, loss_total = 5.08e+07
Step 14 : gram_loss = 4.47e+07, loss_total = 4.47e+07
Step 15 : gram_loss = 3.87e+07, loss_total = 3.87e+07
Step 16 : gram_loss = 3.33e+07, loss_total = 3.33e+07
Step 17 : gram_loss = 2.69e+07, loss_total = 2.69e+07
Step 18 : gram_loss = 2.19e+07, loss_total = 2.19e+07
Step 19 : gram_loss = 1.90e+07, loss_total = 1.90e+07
Step 20 : gram_loss = 1.77e+07, loss_total = 1.77e+07
Step 21 : gram_loss = 1.63e+07, loss_total = 1.63e+07
Step 22 : gram_loss = 1.57e+07, loss_total = 1.57e+07
Step 23 : gram_loss = 1.49e+07, loss_total = 1.49e+07
Step 24 : gram_loss = 1.35e+07, loss_total = 1.35e+07
Step 25 : gram_loss = 1.21e+07, loss_total = 1.21e+07
Step 26 : gram_loss = 1.05e+07, loss_total = 1.05e+07
Step 27 : gram_loss = 8.70e+06, loss_total = 8.70e+06
Step 28 : gram_loss = 8.00e+06, loss_total = 8.00e+06
Step 29 : gram_loss = 7.24e+06, loss_total = 7.24e+06
Step 30 : gram_loss = 6.79e+06, loss_total = 6.79e+06
Step 31 : gram_loss = 6.43e+06, loss_total = 6.43e+06
Step 32 : gram_loss = 5.93e+06, loss_total = 5.93e+06
Step 33 : gram_loss = 5.38e+06, loss_total = 5.38e+06
Step 34 : gram_loss = 4.73e+06, loss_total = 4.73e+06
Step 35 : gram_loss = 4.23e+06, loss_total = 4.23e+06
Step 36 : gram_loss = 4.00e+06, loss_total = 4.00e+06
Step 37 : gram_loss = 3.74e+06, loss_total = 3.74e+06
Step 38 : gram_loss = 3.36e+06, loss_total = 3.36e+06
Step 39 : gram_loss = 2.96e+06, loss_total = 2.96e+06
Step 40 : gram_loss = 2.69e+06, loss_total = 2.69e+06
Step 41 : gram_loss = 2.53e+06, loss_total = 2.53e+06
Step 42 : gram_loss = 2.36e+06, loss_total = 2.36e+06
Step 43 : gram_loss = 2.16e+06, loss_total = 2.16e+06
Step 44 : gram_loss = 2.00e+06, loss_total = 2.00e+06
Step 45 : gram_loss = 1.90e+06, loss_total = 1.90e+06
Step 46 : gram_loss = 1.78e+06, loss_total = 1.78e+06
Step 47 : gram_loss = 1.65e+06, loss_total = 1.65e+06
Step 48 : gram_loss = 1.52e+06, loss_total = 1.52e+06
Step 49 : gram_loss = 1.41e+06, loss_total = 1.41e+06
Step 50 : gram_loss = 1.29e+06, loss_total = 1.29e+06
Step 51 : gram_loss = 1.23e+06, loss_total = 1.23e+06
Step 52 : gram_loss = 1.17e+06, loss_total = 1.17e+06
Step 53 : gram_loss = 1.13e+06, loss_total = 1.13e+06
Step 54 : gram_loss = 1.03e+06, loss_total = 1.03e+06
Step 55 : gram_loss = 9.30e+05, loss_total = 9.30e+05
Step 56 : gram_loss = 8.61e+05, loss_total = 8.61e+05
Step 57 : gram_loss = 8.29e+05, loss_total = 8.29e+05
Step 58 : gram_loss = 8.08e+05, loss_total = 8.08e+05
Step 59 : gram_loss = 7.83e+05, loss_total = 7.83e+05
Step 60 : gram_loss = 7.27e+05, loss_total = 7.27e+05
Step 61 : gram_loss = 6.82e+05, loss_total = 6.82e+05
Step 62 : gram_loss = 6.38e+05, loss_total = 6.38e+05
Step 63 : gram_loss = 6.21e+05, loss_total = 6.21e+05
Step 64 : gram_loss = 6.09e+05, loss_total = 6.09e+05
Step 65 : gram_loss = 5.82e+05, loss_total = 5.82e+05
Step 66 : gram_loss = 5.54e+05, loss_total = 5.54e+05
Step 67 : gram_loss = 5.26e+05, loss_total = 5.26e+05
Step 68 : gram_loss = 5.09e+05, loss_total = 5.09e+05
Step 69 : gram_loss = 4.95e+05, loss_total = 4.95e+05
Step 70 : gram_loss = 4.82e+05, loss_total = 4.82e+05
Step 71 : gram_loss = 4.60e+05, loss_total = 4.60e+05
Step 72 : gram_loss = 4.49e+05, loss_total = 4.49e+05
Step 73 : gram_loss = 4.32e+05, loss_total = 4.32e+05
Step 74 : gram_loss = 4.19e+05, loss_total = 4.19e+05
Step 75 : gram_loss = 4.06e+05, loss_total = 4.06e+05
Step 76 : gram_loss = 3.96e+05, loss_total = 3.96e+05
Step 77 : gram_loss = 3.82e+05, loss_total = 3.82e+05
Step 78 : gram_loss = 3.73e+05, loss_total = 3.73e+05
Step 79 : gram_loss = 3.53e+05, loss_total = 3.53e+05
Step 80 : gram_loss = 3.47e+05, loss_total = 3.47e+05
Step 81 : gram_loss = 3.39e+05, loss_total = 3.39e+05
Step 82 : gram_loss = 3.22e+05, loss_total = 3.22e+05
Step 83 : gram_loss = 3.12e+05, loss_total = 3.12e+05
Step 84 : gram_loss = 3.07e+05, loss_total = 3.07e+05
Step 85 : gram_loss = 2.98e+05, loss_total = 2.98e+05
Step 86 : gram_loss = 2.87e+05, loss_total = 2.87e+05
Step 87 : gram_loss = 2.76e+05, loss_total = 2.76e+05
Step 88 : gram_loss = 2.67e+05, loss_total = 2.67e+05
Step 89 : gram_loss = 2.62e+05, loss_total = 2.62e+05
Step 90 : gram_loss = 2.57e+05, loss_total = 2.57e+05
Step 91 : gram_loss = 2.50e+05, loss_total = 2.50e+05
Step 92 : gram_loss = 2.42e+05, loss_total = 2.42e+05
Step 93 : gram_loss = 2.38e+05, loss_total = 2.38e+05
Step 94 : gram_loss = 2.31e+05, loss_total = 2.31e+05
Step 95 : gram_loss = 2.28e+05, loss_total = 2.28e+05
Step 96 : gram_loss = 2.24e+05, loss_total = 2.24e+05
Step 97 : gram_loss = 2.19e+05, loss_total = 2.19e+05
Step 98 : gram_loss = 2.14e+05, loss_total = 2.14e+05
Step 99 : gram_loss = 2.09e+05, loss_total = 2.09e+05
Step 100 : gram_loss = 2.04e+05, loss_total = 2.04e+05
Step 101 : gram_loss = 1.98e+05, loss_total = 1.98e+05
Step 102 : gram_loss = 1.91e+05, loss_total = 1.91e+05
Step 103 : gram_loss = 1.88e+05, loss_total = 1.88e+05
Step 104 : gram_loss = 1.85e+05, loss_total = 1.85e+05
Step 105 : gram_loss = 1.82e+05, loss_total = 1.82e+05
Step 106 : gram_loss = 1.80e+05, loss_total = 1.80e+05
Step 107 : gram_loss = 1.77e+05, loss_total = 1.77e+05
Step 108 : gram_loss = 1.72e+05, loss_total = 1.72e+05
Step 109 : gram_loss = 1.71e+05, loss_total = 1.71e+05
Step 110 : gram_loss = 1.65e+05, loss_total = 1.65e+05
Step 111 : gram_loss = 1.63e+05, loss_total = 1.63e+05
Step 112 : gram_loss = 1.60e+05, loss_total = 1.60e+05
Step 113 : gram_loss = 1.56e+05, loss_total = 1.56e+05
Step 114 : gram_loss = 1.53e+05, loss_total = 1.53e+05
Step 115 : gram_loss = 1.51e+05, loss_total = 1.51e+05
Step 116 : gram_loss = 1.47e+05, loss_total = 1.47e+05
Step 117 : gram_loss = 1.46e+05, loss_total = 1.46e+05
Step 118 : gram_loss = 1.44e+05, loss_total = 1.44e+05
Step 119 : gram_loss = 1.42e+05, loss_total = 1.42e+05
Step 120 : gram_loss = 1.40e+05, loss_total = 1.40e+05
Step 121 : gram_loss = 1.38e+05, loss_total = 1.38e+05
Step 122 : gram_loss = 1.36e+05, loss_total = 1.36e+05
Step 123 : gram_loss = 1.33e+05, loss_total = 1.33e+05
Step 124 : gram_loss = 1.32e+05, loss_total = 1.32e+05
Step 125 : gram_loss = 1.28e+05, loss_total = 1.28e+05
Step 126 : gram_loss = 1.27e+05, loss_total = 1.27e+05
Step 127 : gram_loss = 1.25e+05, loss_total = 1.25e+05
Step 128 : gram_loss = 1.24e+05, loss_total = 1.24e+05
Step 129 : gram_loss = 1.22e+05, loss_total = 1.22e+05
Step 130 : gram_loss = 1.20e+05, loss_total = 1.20e+05
Step 131 : gram_loss = 1.19e+05, loss_total = 1.19e+05
Step 132 : gram_loss = 1.17e+05, loss_total = 1.17e+05
Step 133 : gram_loss = 1.15e+05, loss_total = 1.15e+05
Step 134 : gram_loss = 1.14e+05, loss_total = 1.14e+05
Step 135 : gram_loss = 1.13e+05, loss_total = 1.13e+05
Step 136 : gram_loss = 1.11e+05, loss_total = 1.11e+05
Step 137 : gram_loss = 1.10e+05, loss_total = 1.10e+05
Step 138 : gram_loss = 1.08e+05, loss_total = 1.08e+05
Step 139 : gram_loss = 1.07e+05, loss_total = 1.07e+05
Step 140 : gram_loss = 1.06e+05, loss_total = 1.06e+05
Step 141 : gram_loss = 1.05e+05, loss_total = 1.05e+05
Step 142 : gram_loss = 1.04e+05, loss_total = 1.04e+05
Step 143 : gram_loss = 1.02e+05, loss_total = 1.02e+05
Step 144 : gram_loss = 1.01e+05, loss_total = 1.01e+05
Step 145 : gram_loss = 1.00e+05, loss_total = 1.00e+05
Step 146 : gram_loss = 9.92e+04, loss_total = 9.92e+04
Step 147 : gram_loss = 9.83e+04, loss_total = 9.83e+04
Step 148 : gram_loss = 9.68e+04, loss_total = 9.68e+04
Step 149 : gram_loss = 9.59e+04, loss_total = 9.59e+04
Step 150 : gram_loss = 9.49e+04, loss_total = 9.49e+04
Step 151 : gram_loss = 9.37e+04, loss_total = 9.37e+04
Step 152 : gram_loss = 9.28e+04, loss_total = 9.28e+04
Step 153 : gram_loss = 9.15e+04, loss_total = 9.15e+04
Step 154 : gram_loss = 9.07e+04, loss_total = 9.07e+04
Step 155 : gram_loss = 8.99e+04, loss_total = 8.99e+04
Step 156 : gram_loss = 8.93e+04, loss_total = 8.93e+04
Step 157 : gram_loss = 8.87e+04, loss_total = 8.87e+04
Step 158 : gram_loss = 8.77e+04, loss_total = 8.77e+04
Step 159 : gram_loss = 8.69e+04, loss_total = 8.69e+04
Step 160 : gram_loss = 8.63e+04, loss_total = 8.63e+04
Step 161 : gram_loss = 8.53e+04, loss_total = 8.53e+04
Step 162 : gram_loss = 8.46e+04, loss_total = 8.46e+04
Step 163 : gram_loss = 8.36e+04, loss_total = 8.36e+04
Step 164 : gram_loss = 8.28e+04, loss_total = 8.28e+04
Step 165 : gram_loss = 8.24e+04, loss_total = 8.24e+04
Step 166 : gram_loss = 8.17e+04, loss_total = 8.17e+04
Step 167 : gram_loss = 8.09e+04, loss_total = 8.09e+04
Step 168 : gram_loss = 7.98e+04, loss_total = 7.98e+04
Step 169 : gram_loss = 7.89e+04, loss_total = 7.89e+04
Step 170 : gram_loss = 7.81e+04, loss_total = 7.81e+04
Step 171 : gram_loss = 7.73e+04, loss_total = 7.73e+04
Step 172 : gram_loss = 7.66e+04, loss_total = 7.66e+04
Step 173 : gram_loss = 7.61e+04, loss_total = 7.61e+04
Step 174 : gram_loss = 7.57e+04, loss_total = 7.57e+04
Step 175 : gram_loss = 7.52e+04, loss_total = 7.52e+04
Step 176 : gram_loss = 7.45e+04, loss_total = 7.45e+04
Step 177 : gram_loss = 7.37e+04, loss_total = 7.37e+04
Step 178 : gram_loss = 7.28e+04, loss_total = 7.28e+04
Step 179 : gram_loss = 7.24e+04, loss_total = 7.24e+04
Step 180 : gram_loss = 7.19e+04, loss_total = 7.19e+04
Step 181 : gram_loss = 7.15e+04, loss_total = 7.15e+04
Step 182 : gram_loss = 7.09e+04, loss_total = 7.09e+04
Step 183 : gram_loss = 7.02e+04, loss_total = 7.02e+04
Step 184 : gram_loss = 6.95e+04, loss_total = 6.95e+04
Step 185 : gram_loss = 6.92e+04, loss_total = 6.92e+04
Step 186 : gram_loss = 6.81e+04, loss_total = 6.81e+04
Step 187 : gram_loss = 6.79e+04, loss_total = 6.79e+04
Step 188 : gram_loss = 6.74e+04, loss_total = 6.74e+04
Step 189 : gram_loss = 6.69e+04, loss_total = 6.69e+04
Step 190 : gram_loss = 6.63e+04, loss_total = 6.63e+04
Step 191 : gram_loss = 6.59e+04, loss_total = 6.59e+04
Step 192 : gram_loss = 6.56e+04, loss_total = 6.56e+04
Step 193 : gram_loss = 6.49e+04, loss_total = 6.49e+04
Step 194 : gram_loss = 6.43e+04, loss_total = 6.43e+04
Step 195 : gram_loss = 6.39e+04, loss_total = 6.39e+04
Step 196 : gram_loss = 6.35e+04, loss_total = 6.35e+04
Step 197 : gram_loss = 6.32e+04, loss_total = 6.32e+04
Step 198 : gram_loss = 6.27e+04, loss_total = 6.27e+04
Step 199 : gram_loss = 6.21e+04, loss_total = 6.21e+04
Step 200 : gram_loss = 6.16e+04, loss_total = 6.16e+04
Close Sess - End of the global optimization.
Computation total for  108.23326253890991  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0001_1_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0001_1_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0001_1_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0001_1_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0001_1_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0001_1_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.195806503295898  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 3.26e+09, loss_total = 3.26e+09
Step 1 : gram_loss = 2.35e+09, loss_total = 2.35e+09
Step 2 : gram_loss = 2.22e+09, loss_total = 2.22e+09
Step 3 : gram_loss = 1.70e+09, loss_total = 1.70e+09
Step 4 : gram_loss = 6.41e+08, loss_total = 6.41e+08
Step 5 : gram_loss = 1.57e+08, loss_total = 1.57e+08
Step 6 : gram_loss = 9.80e+07, loss_total = 9.80e+07
Step 7 : gram_loss = 6.86e+07, loss_total = 6.86e+07
Step 8 : gram_loss = 5.18e+07, loss_total = 5.18e+07
Step 9 : gram_loss = 4.23e+07, loss_total = 4.23e+07
Step 10 : gram_loss = 3.32e+07, loss_total = 3.32e+07
Step 11 : gram_loss = 2.40e+07, loss_total = 2.40e+07
Step 12 : gram_loss = 1.50e+07, loss_total = 1.50e+07
Step 13 : gram_loss = 9.23e+06, loss_total = 9.23e+06
Step 14 : gram_loss = 7.92e+06, loss_total = 7.92e+06
Step 15 : gram_loss = 7.53e+06, loss_total = 7.53e+06
Step 16 : gram_loss = 7.00e+06, loss_total = 7.00e+06
Step 17 : gram_loss = 5.48e+06, loss_total = 5.48e+06
Step 18 : gram_loss = 4.88e+06, loss_total = 4.88e+06
Step 19 : gram_loss = 3.58e+06, loss_total = 3.58e+06
Step 20 : gram_loss = 2.96e+06, loss_total = 2.96e+06
Step 21 : gram_loss = 2.16e+06, loss_total = 2.16e+06
Step 22 : gram_loss = 1.97e+06, loss_total = 1.97e+06
Step 23 : gram_loss = 1.80e+06, loss_total = 1.80e+06
Step 24 : gram_loss = 1.69e+06, loss_total = 1.69e+06
Step 25 : gram_loss = 1.60e+06, loss_total = 1.60e+06
Step 26 : gram_loss = 1.46e+06, loss_total = 1.46e+06
Step 27 : gram_loss = 1.31e+06, loss_total = 1.31e+06
Step 28 : gram_loss = 1.22e+06, loss_total = 1.22e+06
Step 29 : gram_loss = 1.02e+06, loss_total = 1.02e+06
Step 30 : gram_loss = 9.76e+05, loss_total = 9.76e+05
Step 31 : gram_loss = 9.00e+05, loss_total = 9.00e+05
Step 32 : gram_loss = 8.09e+05, loss_total = 8.09e+05
Step 33 : gram_loss = 7.35e+05, loss_total = 7.35e+05
Step 34 : gram_loss = 6.80e+05, loss_total = 6.80e+05
Step 35 : gram_loss = 6.55e+05, loss_total = 6.55e+05
Step 36 : gram_loss = 6.04e+05, loss_total = 6.04e+05
Step 37 : gram_loss = 5.94e+05, loss_total = 5.94e+05
Step 38 : gram_loss = 5.47e+05, loss_total = 5.47e+05
Step 39 : gram_loss = 5.26e+05, loss_total = 5.26e+05
Step 40 : gram_loss = 5.07e+05, loss_total = 5.07e+05
Step 41 : gram_loss = 4.85e+05, loss_total = 4.85e+05
Step 42 : gram_loss = 4.59e+05, loss_total = 4.59e+05
Step 43 : gram_loss = 4.29e+05, loss_total = 4.29e+05
Step 44 : gram_loss = 3.99e+05, loss_total = 3.99e+05
Step 45 : gram_loss = 3.75e+05, loss_total = 3.75e+05
Step 46 : gram_loss = 3.56e+05, loss_total = 3.56e+05
Step 47 : gram_loss = 3.43e+05, loss_total = 3.43e+05
Step 48 : gram_loss = 3.31e+05, loss_total = 3.31e+05
Step 49 : gram_loss = 3.10e+05, loss_total = 3.10e+05
Step 50 : gram_loss = 2.92e+05, loss_total = 2.92e+05
Step 51 : gram_loss = 2.84e+05, loss_total = 2.84e+05
Step 52 : gram_loss = 2.69e+05, loss_total = 2.69e+05
Step 53 : gram_loss = 2.63e+05, loss_total = 2.63e+05
Step 54 : gram_loss = 2.55e+05, loss_total = 2.55e+05
Step 55 : gram_loss = 2.45e+05, loss_total = 2.45e+05
Step 56 : gram_loss = 2.36e+05, loss_total = 2.36e+05
Step 57 : gram_loss = 2.30e+05, loss_total = 2.30e+05
Step 58 : gram_loss = 2.19e+05, loss_total = 2.19e+05
Step 59 : gram_loss = 2.03e+05, loss_total = 2.03e+05
Step 60 : gram_loss = 1.92e+05, loss_total = 1.92e+05
Step 61 : gram_loss = 1.89e+05, loss_total = 1.89e+05
Step 62 : gram_loss = 1.81e+05, loss_total = 1.81e+05
Step 63 : gram_loss = 1.77e+05, loss_total = 1.77e+05
Step 64 : gram_loss = 1.75e+05, loss_total = 1.75e+05
Step 65 : gram_loss = 1.70e+05, loss_total = 1.70e+05
Step 66 : gram_loss = 1.67e+05, loss_total = 1.67e+05
Step 67 : gram_loss = 1.60e+05, loss_total = 1.60e+05
Step 68 : gram_loss = 1.54e+05, loss_total = 1.54e+05
Step 69 : gram_loss = 1.49e+05, loss_total = 1.49e+05
Step 70 : gram_loss = 1.41e+05, loss_total = 1.41e+05
Step 71 : gram_loss = 1.37e+05, loss_total = 1.37e+05
Step 72 : gram_loss = 1.34e+05, loss_total = 1.34e+05
Step 73 : gram_loss = 1.31e+05, loss_total = 1.31e+05
Step 74 : gram_loss = 1.27e+05, loss_total = 1.27e+05
Step 75 : gram_loss = 1.24e+05, loss_total = 1.24e+05
Step 76 : gram_loss = 1.19e+05, loss_total = 1.19e+05
Step 77 : gram_loss = 1.15e+05, loss_total = 1.15e+05
Step 78 : gram_loss = 1.10e+05, loss_total = 1.10e+05
Step 79 : gram_loss = 1.08e+05, loss_total = 1.08e+05
Step 80 : gram_loss = 1.06e+05, loss_total = 1.06e+05
Step 81 : gram_loss = 1.04e+05, loss_total = 1.04e+05
Step 82 : gram_loss = 9.98e+04, loss_total = 9.98e+04
Step 83 : gram_loss = 9.79e+04, loss_total = 9.79e+04
Step 84 : gram_loss = 9.50e+04, loss_total = 9.50e+04
Step 85 : gram_loss = 9.28e+04, loss_total = 9.28e+04
Step 86 : gram_loss = 9.06e+04, loss_total = 9.06e+04
Step 87 : gram_loss = 8.87e+04, loss_total = 8.87e+04
Step 88 : gram_loss = 8.68e+04, loss_total = 8.68e+04
Step 89 : gram_loss = 8.51e+04, loss_total = 8.51e+04
Step 90 : gram_loss = 8.29e+04, loss_total = 8.29e+04
Step 91 : gram_loss = 8.00e+04, loss_total = 8.00e+04
Step 92 : gram_loss = 7.80e+04, loss_total = 7.80e+04
Step 93 : gram_loss = 7.61e+04, loss_total = 7.61e+04
Step 94 : gram_loss = 7.50e+04, loss_total = 7.50e+04
Step 95 : gram_loss = 7.34e+04, loss_total = 7.34e+04
Step 96 : gram_loss = 7.19e+04, loss_total = 7.19e+04
Step 97 : gram_loss = 6.99e+04, loss_total = 6.99e+04
Step 98 : gram_loss = 6.81e+04, loss_total = 6.81e+04
Step 99 : gram_loss = 6.68e+04, loss_total = 6.68e+04
Step 100 : gram_loss = 6.60e+04, loss_total = 6.60e+04
Step 101 : gram_loss = 6.55e+04, loss_total = 6.55e+04
Step 102 : gram_loss = 6.44e+04, loss_total = 6.44e+04
Step 103 : gram_loss = 6.30e+04, loss_total = 6.30e+04
Step 104 : gram_loss = 6.15e+04, loss_total = 6.15e+04
Step 105 : gram_loss = 6.02e+04, loss_total = 6.02e+04
Step 106 : gram_loss = 5.93e+04, loss_total = 5.93e+04
Step 107 : gram_loss = 5.82e+04, loss_total = 5.82e+04
Step 108 : gram_loss = 5.64e+04, loss_total = 5.64e+04
Step 109 : gram_loss = 5.61e+04, loss_total = 5.61e+04
Step 110 : gram_loss = 5.51e+04, loss_total = 5.51e+04
Step 111 : gram_loss = 5.47e+04, loss_total = 5.47e+04
Step 112 : gram_loss = 5.41e+04, loss_total = 5.41e+04
Step 113 : gram_loss = 5.28e+04, loss_total = 5.28e+04
Step 114 : gram_loss = 5.18e+04, loss_total = 5.18e+04
Step 115 : gram_loss = 5.07e+04, loss_total = 5.07e+04
Step 116 : gram_loss = 5.02e+04, loss_total = 5.02e+04
Step 117 : gram_loss = 4.93e+04, loss_total = 4.93e+04
Step 118 : gram_loss = 4.85e+04, loss_total = 4.85e+04
Step 119 : gram_loss = 4.78e+04, loss_total = 4.78e+04
Step 120 : gram_loss = 4.74e+04, loss_total = 4.74e+04
Step 121 : gram_loss = 4.68e+04, loss_total = 4.68e+04
Step 122 : gram_loss = 4.61e+04, loss_total = 4.61e+04
Step 123 : gram_loss = 4.58e+04, loss_total = 4.58e+04
Step 124 : gram_loss = 4.48e+04, loss_total = 4.48e+04
Step 125 : gram_loss = 4.45e+04, loss_total = 4.45e+04
Step 126 : gram_loss = 4.41e+04, loss_total = 4.41e+04
Step 127 : gram_loss = 4.33e+04, loss_total = 4.33e+04
Step 128 : gram_loss = 4.25e+04, loss_total = 4.25e+04
Step 129 : gram_loss = 4.19e+04, loss_total = 4.19e+04
Step 130 : gram_loss = 4.17e+04, loss_total = 4.17e+04
Step 131 : gram_loss = 4.14e+04, loss_total = 4.14e+04
Step 132 : gram_loss = 4.09e+04, loss_total = 4.09e+04
Step 133 : gram_loss = 4.05e+04, loss_total = 4.05e+04
Step 134 : gram_loss = 3.95e+04, loss_total = 3.95e+04
Step 135 : gram_loss = 3.90e+04, loss_total = 3.90e+04
Step 136 : gram_loss = 3.82e+04, loss_total = 3.82e+04
Step 137 : gram_loss = 3.79e+04, loss_total = 3.79e+04
Step 138 : gram_loss = 3.76e+04, loss_total = 3.76e+04
Step 139 : gram_loss = 3.73e+04, loss_total = 3.73e+04
Step 140 : gram_loss = 3.70e+04, loss_total = 3.70e+04
Step 141 : gram_loss = 3.67e+04, loss_total = 3.67e+04
Step 142 : gram_loss = 3.59e+04, loss_total = 3.59e+04
Step 143 : gram_loss = 3.56e+04, loss_total = 3.56e+04
Step 144 : gram_loss = 3.49e+04, loss_total = 3.49e+04
Step 145 : gram_loss = 3.47e+04, loss_total = 3.47e+04
Step 146 : gram_loss = 3.42e+04, loss_total = 3.42e+04
Step 147 : gram_loss = 3.38e+04, loss_total = 3.38e+04
Step 148 : gram_loss = 3.34e+04, loss_total = 3.34e+04
Step 149 : gram_loss = 3.32e+04, loss_total = 3.32e+04
Step 150 : gram_loss = 3.30e+04, loss_total = 3.30e+04
Step 151 : gram_loss = 3.27e+04, loss_total = 3.27e+04
Step 152 : gram_loss = 3.23e+04, loss_total = 3.23e+04
Step 153 : gram_loss = 3.17e+04, loss_total = 3.17e+04
Step 154 : gram_loss = 3.14e+04, loss_total = 3.14e+04
Step 155 : gram_loss = 3.10e+04, loss_total = 3.10e+04
Step 156 : gram_loss = 3.06e+04, loss_total = 3.06e+04
Step 157 : gram_loss = 3.04e+04, loss_total = 3.04e+04
Step 158 : gram_loss = 3.01e+04, loss_total = 3.01e+04
Step 159 : gram_loss = 2.98e+04, loss_total = 2.98e+04
Step 160 : gram_loss = 2.96e+04, loss_total = 2.96e+04
Step 161 : gram_loss = 2.94e+04, loss_total = 2.94e+04
Step 162 : gram_loss = 2.91e+04, loss_total = 2.91e+04
Step 163 : gram_loss = 2.88e+04, loss_total = 2.88e+04
Step 164 : gram_loss = 2.86e+04, loss_total = 2.86e+04
Step 165 : gram_loss = 2.83e+04, loss_total = 2.83e+04
Step 166 : gram_loss = 2.80e+04, loss_total = 2.80e+04
Step 167 : gram_loss = 2.75e+04, loss_total = 2.75e+04
Step 168 : gram_loss = 2.72e+04, loss_total = 2.72e+04
Step 169 : gram_loss = 2.69e+04, loss_total = 2.69e+04
Step 170 : gram_loss = 2.67e+04, loss_total = 2.67e+04
Step 171 : gram_loss = 2.66e+04, loss_total = 2.66e+04
Step 172 : gram_loss = 2.64e+04, loss_total = 2.64e+04
Step 173 : gram_loss = 2.63e+04, loss_total = 2.63e+04
Step 174 : gram_loss = 2.60e+04, loss_total = 2.60e+04
Step 175 : gram_loss = 2.58e+04, loss_total = 2.58e+04
Step 176 : gram_loss = 2.56e+04, loss_total = 2.56e+04
Step 177 : gram_loss = 2.54e+04, loss_total = 2.54e+04
Step 178 : gram_loss = 2.51e+04, loss_total = 2.51e+04
Step 179 : gram_loss = 2.48e+04, loss_total = 2.48e+04
Step 180 : gram_loss = 2.44e+04, loss_total = 2.44e+04
Step 181 : gram_loss = 2.43e+04, loss_total = 2.43e+04
Step 182 : gram_loss = 2.41e+04, loss_total = 2.41e+04
Step 183 : gram_loss = 2.40e+04, loss_total = 2.40e+04
Step 184 : gram_loss = 2.39e+04, loss_total = 2.39e+04
Step 185 : gram_loss = 2.36e+04, loss_total = 2.36e+04
Step 186 : gram_loss = 2.35e+04, loss_total = 2.35e+04
Step 187 : gram_loss = 2.32e+04, loss_total = 2.32e+04
Step 188 : gram_loss = 2.31e+04, loss_total = 2.31e+04
Step 189 : gram_loss = 2.29e+04, loss_total = 2.29e+04
Step 190 : gram_loss = 2.27e+04, loss_total = 2.27e+04
Step 191 : gram_loss = 2.25e+04, loss_total = 2.25e+04
Step 192 : gram_loss = 2.23e+04, loss_total = 2.23e+04
Step 193 : gram_loss = 2.22e+04, loss_total = 2.22e+04
Step 194 : gram_loss = 2.21e+04, loss_total = 2.21e+04
Step 195 : gram_loss = 2.19e+04, loss_total = 2.19e+04
Step 196 : gram_loss = 2.18e+04, loss_total = 2.18e+04
Step 197 : gram_loss = 2.16e+04, loss_total = 2.16e+04
Step 198 : gram_loss = 2.15e+04, loss_total = 2.15e+04
Step 199 : gram_loss = 2.14e+04, loss_total = 2.14e+04
Step 200 : gram_loss = 2.12e+04, loss_total = 2.12e+04
Close Sess - End of the global optimization.
Computation total for  106.76003551483154  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0016_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0016_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0016_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0016_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0016_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0016_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.16806173324585  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 4.59e+09, loss_total = 4.59e+09
Step 1 : gram_loss = 2.10e+09, loss_total = 2.10e+09
Step 2 : gram_loss = 1.59e+09, loss_total = 1.59e+09
Step 3 : gram_loss = 1.20e+09, loss_total = 1.20e+09
Step 4 : gram_loss = 6.58e+08, loss_total = 6.58e+08
Step 5 : gram_loss = 5.07e+08, loss_total = 5.07e+08
Step 6 : gram_loss = 3.69e+08, loss_total = 3.69e+08
Step 7 : gram_loss = 3.04e+08, loss_total = 3.04e+08
Step 8 : gram_loss = 2.41e+08, loss_total = 2.41e+08
Step 9 : gram_loss = 2.09e+08, loss_total = 2.09e+08
Step 10 : gram_loss = 1.76e+08, loss_total = 1.76e+08
Step 11 : gram_loss = 1.38e+08, loss_total = 1.38e+08
Step 12 : gram_loss = 1.16e+08, loss_total = 1.16e+08
Step 13 : gram_loss = 9.72e+07, loss_total = 9.72e+07
Step 14 : gram_loss = 8.62e+07, loss_total = 8.62e+07
Step 15 : gram_loss = 7.99e+07, loss_total = 7.99e+07
Step 16 : gram_loss = 7.24e+07, loss_total = 7.24e+07
Step 17 : gram_loss = 6.42e+07, loss_total = 6.42e+07
Step 18 : gram_loss = 5.63e+07, loss_total = 5.63e+07
Step 19 : gram_loss = 5.21e+07, loss_total = 5.21e+07
Step 20 : gram_loss = 4.76e+07, loss_total = 4.76e+07
Step 21 : gram_loss = 4.24e+07, loss_total = 4.24e+07
Step 22 : gram_loss = 3.64e+07, loss_total = 3.64e+07
Step 23 : gram_loss = 3.48e+07, loss_total = 3.48e+07
Step 24 : gram_loss = 3.19e+07, loss_total = 3.19e+07
Step 25 : gram_loss = 3.11e+07, loss_total = 3.11e+07
Step 26 : gram_loss = 2.92e+07, loss_total = 2.92e+07
Step 27 : gram_loss = 2.69e+07, loss_total = 2.69e+07
Step 28 : gram_loss = 2.52e+07, loss_total = 2.52e+07
Step 29 : gram_loss = 2.31e+07, loss_total = 2.31e+07
Step 30 : gram_loss = 2.13e+07, loss_total = 2.13e+07
Step 31 : gram_loss = 1.99e+07, loss_total = 1.99e+07
Step 32 : gram_loss = 1.91e+07, loss_total = 1.91e+07
Step 33 : gram_loss = 1.86e+07, loss_total = 1.86e+07
Step 34 : gram_loss = 1.81e+07, loss_total = 1.81e+07
Step 35 : gram_loss = 1.73e+07, loss_total = 1.73e+07
Step 36 : gram_loss = 1.58e+07, loss_total = 1.58e+07
Step 37 : gram_loss = 1.49e+07, loss_total = 1.49e+07
Step 38 : gram_loss = 1.42e+07, loss_total = 1.42e+07
Step 39 : gram_loss = 1.35e+07, loss_total = 1.35e+07
Step 40 : gram_loss = 1.32e+07, loss_total = 1.32e+07
Step 41 : gram_loss = 1.27e+07, loss_total = 1.27e+07
Step 42 : gram_loss = 1.23e+07, loss_total = 1.23e+07
Step 43 : gram_loss = 1.18e+07, loss_total = 1.18e+07
Step 44 : gram_loss = 1.13e+07, loss_total = 1.13e+07
Step 45 : gram_loss = 1.09e+07, loss_total = 1.09e+07
Step 46 : gram_loss = 1.04e+07, loss_total = 1.04e+07
Step 47 : gram_loss = 9.78e+06, loss_total = 9.78e+06
Step 48 : gram_loss = 9.21e+06, loss_total = 9.21e+06
Step 49 : gram_loss = 8.66e+06, loss_total = 8.66e+06
Step 50 : gram_loss = 8.23e+06, loss_total = 8.23e+06
Step 51 : gram_loss = 7.91e+06, loss_total = 7.91e+06
Step 52 : gram_loss = 7.63e+06, loss_total = 7.63e+06
Step 53 : gram_loss = 7.44e+06, loss_total = 7.44e+06
Step 54 : gram_loss = 6.98e+06, loss_total = 6.98e+06
Step 55 : gram_loss = 6.60e+06, loss_total = 6.60e+06
Step 56 : gram_loss = 6.34e+06, loss_total = 6.34e+06
Step 57 : gram_loss = 6.05e+06, loss_total = 6.05e+06
Step 58 : gram_loss = 5.76e+06, loss_total = 5.76e+06
Step 59 : gram_loss = 5.54e+06, loss_total = 5.54e+06
Step 60 : gram_loss = 5.15e+06, loss_total = 5.15e+06
Step 61 : gram_loss = 4.85e+06, loss_total = 4.85e+06
Step 62 : gram_loss = 4.71e+06, loss_total = 4.71e+06
Step 63 : gram_loss = 4.56e+06, loss_total = 4.56e+06
Step 64 : gram_loss = 4.43e+06, loss_total = 4.43e+06
Step 65 : gram_loss = 4.21e+06, loss_total = 4.21e+06
Step 66 : gram_loss = 4.02e+06, loss_total = 4.02e+06
Step 67 : gram_loss = 3.83e+06, loss_total = 3.83e+06
Step 68 : gram_loss = 3.74e+06, loss_total = 3.74e+06
Step 69 : gram_loss = 3.64e+06, loss_total = 3.64e+06
Step 70 : gram_loss = 3.56e+06, loss_total = 3.56e+06
Step 71 : gram_loss = 3.41e+06, loss_total = 3.41e+06
Step 72 : gram_loss = 3.22e+06, loss_total = 3.22e+06
Step 73 : gram_loss = 3.07e+06, loss_total = 3.07e+06
Step 74 : gram_loss = 2.92e+06, loss_total = 2.92e+06
Step 75 : gram_loss = 2.88e+06, loss_total = 2.88e+06
Step 76 : gram_loss = 2.79e+06, loss_total = 2.79e+06
Step 77 : gram_loss = 2.75e+06, loss_total = 2.75e+06
Step 78 : gram_loss = 2.63e+06, loss_total = 2.63e+06
Step 79 : gram_loss = 2.52e+06, loss_total = 2.52e+06
Step 80 : gram_loss = 2.46e+06, loss_total = 2.46e+06
Step 81 : gram_loss = 2.35e+06, loss_total = 2.35e+06
Step 82 : gram_loss = 2.26e+06, loss_total = 2.26e+06
Step 83 : gram_loss = 2.19e+06, loss_total = 2.19e+06
Step 84 : gram_loss = 2.14e+06, loss_total = 2.14e+06
Step 85 : gram_loss = 2.09e+06, loss_total = 2.09e+06
Step 86 : gram_loss = 2.00e+06, loss_total = 2.00e+06
Step 87 : gram_loss = 1.97e+06, loss_total = 1.97e+06
Step 88 : gram_loss = 1.93e+06, loss_total = 1.93e+06
Step 89 : gram_loss = 1.91e+06, loss_total = 1.91e+06
Step 90 : gram_loss = 1.90e+06, loss_total = 1.90e+06
Step 91 : gram_loss = 1.87e+06, loss_total = 1.87e+06
Step 92 : gram_loss = 1.81e+06, loss_total = 1.81e+06
Step 93 : gram_loss = 1.77e+06, loss_total = 1.77e+06
Step 94 : gram_loss = 1.72e+06, loss_total = 1.72e+06
Step 95 : gram_loss = 1.69e+06, loss_total = 1.69e+06
Step 96 : gram_loss = 1.67e+06, loss_total = 1.67e+06
Step 97 : gram_loss = 1.64e+06, loss_total = 1.64e+06
Step 98 : gram_loss = 1.60e+06, loss_total = 1.60e+06
Step 99 : gram_loss = 1.58e+06, loss_total = 1.58e+06
Step 100 : gram_loss = 1.56e+06, loss_total = 1.56e+06
Step 101 : gram_loss = 1.53e+06, loss_total = 1.53e+06
Step 102 : gram_loss = 1.48e+06, loss_total = 1.48e+06
Step 103 : gram_loss = 1.45e+06, loss_total = 1.45e+06
Step 104 : gram_loss = 1.42e+06, loss_total = 1.42e+06
Step 105 : gram_loss = 1.40e+06, loss_total = 1.40e+06
Step 106 : gram_loss = 1.38e+06, loss_total = 1.38e+06
Step 107 : gram_loss = 1.36e+06, loss_total = 1.36e+06
Step 108 : gram_loss = 1.33e+06, loss_total = 1.33e+06
Step 109 : gram_loss = 1.30e+06, loss_total = 1.30e+06
Step 110 : gram_loss = 1.29e+06, loss_total = 1.29e+06
Step 111 : gram_loss = 1.28e+06, loss_total = 1.28e+06
Step 112 : gram_loss = 1.27e+06, loss_total = 1.27e+06
Step 113 : gram_loss = 1.26e+06, loss_total = 1.26e+06
Step 114 : gram_loss = 1.24e+06, loss_total = 1.24e+06
Step 115 : gram_loss = 1.21e+06, loss_total = 1.21e+06
Step 116 : gram_loss = 1.19e+06, loss_total = 1.19e+06
Step 117 : gram_loss = 1.17e+06, loss_total = 1.17e+06
Step 118 : gram_loss = 1.16e+06, loss_total = 1.16e+06
Step 119 : gram_loss = 1.15e+06, loss_total = 1.15e+06
Step 120 : gram_loss = 1.13e+06, loss_total = 1.13e+06
Step 121 : gram_loss = 1.11e+06, loss_total = 1.11e+06
Step 122 : gram_loss = 1.09e+06, loss_total = 1.09e+06
Step 123 : gram_loss = 1.08e+06, loss_total = 1.08e+06
Step 124 : gram_loss = 1.06e+06, loss_total = 1.06e+06
Step 125 : gram_loss = 1.05e+06, loss_total = 1.05e+06
Step 126 : gram_loss = 1.04e+06, loss_total = 1.04e+06
Step 127 : gram_loss = 1.03e+06, loss_total = 1.03e+06
Step 128 : gram_loss = 1.02e+06, loss_total = 1.02e+06
Step 129 : gram_loss = 1.01e+06, loss_total = 1.01e+06
Step 130 : gram_loss = 9.88e+05, loss_total = 9.88e+05
Step 131 : gram_loss = 9.75e+05, loss_total = 9.75e+05
Step 132 : gram_loss = 9.68e+05, loss_total = 9.68e+05
Step 133 : gram_loss = 9.65e+05, loss_total = 9.65e+05
Step 134 : gram_loss = 9.55e+05, loss_total = 9.55e+05
Step 135 : gram_loss = 9.46e+05, loss_total = 9.46e+05
Step 136 : gram_loss = 9.36e+05, loss_total = 9.36e+05
Step 137 : gram_loss = 9.27e+05, loss_total = 9.27e+05
Step 138 : gram_loss = 9.16e+05, loss_total = 9.16e+05
Step 139 : gram_loss = 9.06e+05, loss_total = 9.06e+05
Step 140 : gram_loss = 8.98e+05, loss_total = 8.98e+05
Step 141 : gram_loss = 8.88e+05, loss_total = 8.88e+05
Step 142 : gram_loss = 8.82e+05, loss_total = 8.82e+05
Step 143 : gram_loss = 8.73e+05, loss_total = 8.73e+05
Step 144 : gram_loss = 8.65e+05, loss_total = 8.65e+05
Step 145 : gram_loss = 8.59e+05, loss_total = 8.59e+05
Step 146 : gram_loss = 8.49e+05, loss_total = 8.49e+05
Step 147 : gram_loss = 8.39e+05, loss_total = 8.39e+05
Step 148 : gram_loss = 8.30e+05, loss_total = 8.30e+05
Step 149 : gram_loss = 8.23e+05, loss_total = 8.23e+05
Step 150 : gram_loss = 8.15e+05, loss_total = 8.15e+05
Step 151 : gram_loss = 8.09e+05, loss_total = 8.09e+05
Step 152 : gram_loss = 8.05e+05, loss_total = 8.05e+05
Step 153 : gram_loss = 7.98e+05, loss_total = 7.98e+05
Step 154 : gram_loss = 7.97e+05, loss_total = 7.97e+05
Step 155 : gram_loss = 7.94e+05, loss_total = 7.94e+05
Step 156 : gram_loss = 7.87e+05, loss_total = 7.87e+05
Step 157 : gram_loss = 7.83e+05, loss_total = 7.83e+05
Step 158 : gram_loss = 7.75e+05, loss_total = 7.75e+05
Step 159 : gram_loss = 7.69e+05, loss_total = 7.69e+05
Step 160 : gram_loss = 7.64e+05, loss_total = 7.64e+05
Step 161 : gram_loss = 7.60e+05, loss_total = 7.60e+05
Step 162 : gram_loss = 7.57e+05, loss_total = 7.57e+05
Step 163 : gram_loss = 7.51e+05, loss_total = 7.51e+05
Step 164 : gram_loss = 7.45e+05, loss_total = 7.45e+05
Step 165 : gram_loss = 7.41e+05, loss_total = 7.41e+05
Step 166 : gram_loss = 7.35e+05, loss_total = 7.35e+05
Step 167 : gram_loss = 7.30e+05, loss_total = 7.30e+05
Step 168 : gram_loss = 7.26e+05, loss_total = 7.26e+05
Step 169 : gram_loss = 7.20e+05, loss_total = 7.20e+05
Step 170 : gram_loss = 7.16e+05, loss_total = 7.16e+05
Step 171 : gram_loss = 7.12e+05, loss_total = 7.12e+05
Step 172 : gram_loss = 7.07e+05, loss_total = 7.07e+05
Step 173 : gram_loss = 7.04e+05, loss_total = 7.04e+05
Step 174 : gram_loss = 6.98e+05, loss_total = 6.98e+05
Step 175 : gram_loss = 6.95e+05, loss_total = 6.95e+05
Step 176 : gram_loss = 6.92e+05, loss_total = 6.92e+05
Step 177 : gram_loss = 6.90e+05, loss_total = 6.90e+05
Step 178 : gram_loss = 6.87e+05, loss_total = 6.87e+05
Step 179 : gram_loss = 6.84e+05, loss_total = 6.84e+05
Step 180 : gram_loss = 6.78e+05, loss_total = 6.78e+05
Step 181 : gram_loss = 6.73e+05, loss_total = 6.73e+05
Step 182 : gram_loss = 6.69e+05, loss_total = 6.69e+05
Step 183 : gram_loss = 6.66e+05, loss_total = 6.66e+05
Step 184 : gram_loss = 6.64e+05, loss_total = 6.64e+05
Step 185 : gram_loss = 6.61e+05, loss_total = 6.61e+05
Step 186 : gram_loss = 6.58e+05, loss_total = 6.58e+05
Step 187 : gram_loss = 6.53e+05, loss_total = 6.53e+05
Step 188 : gram_loss = 6.49e+05, loss_total = 6.49e+05
Step 189 : gram_loss = 6.45e+05, loss_total = 6.45e+05
Step 190 : gram_loss = 6.41e+05, loss_total = 6.41e+05
Step 191 : gram_loss = 6.39e+05, loss_total = 6.39e+05
Step 192 : gram_loss = 6.36e+05, loss_total = 6.36e+05
Step 193 : gram_loss = 6.32e+05, loss_total = 6.32e+05
Step 194 : gram_loss = 6.30e+05, loss_total = 6.30e+05
Step 195 : gram_loss = 6.26e+05, loss_total = 6.26e+05
Step 196 : gram_loss = 6.25e+05, loss_total = 6.25e+05
Step 197 : gram_loss = 6.23e+05, loss_total = 6.23e+05
Step 198 : gram_loss = 6.21e+05, loss_total = 6.21e+05
Step 199 : gram_loss = 6.19e+05, loss_total = 6.19e+05
Step 200 : gram_loss = 6.18e+05, loss_total = 6.18e+05
Close Sess - End of the global optimization.
Computation total for  106.97747254371643  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0003_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0003_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0003_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0003_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0003_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0003_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.248323202133179  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 3.49e+09, loss_total = 3.49e+09
Step 1 : gram_loss = 1.48e+09, loss_total = 1.48e+09
Step 2 : gram_loss = 1.39e+09, loss_total = 1.39e+09
Step 3 : gram_loss = 9.28e+08, loss_total = 9.28e+08
Step 4 : gram_loss = 4.54e+08, loss_total = 4.54e+08
Step 5 : gram_loss = 2.93e+08, loss_total = 2.93e+08
Step 6 : gram_loss = 2.55e+08, loss_total = 2.55e+08
Step 7 : gram_loss = 2.19e+08, loss_total = 2.19e+08
Step 8 : gram_loss = 1.84e+08, loss_total = 1.84e+08
Step 9 : gram_loss = 1.37e+08, loss_total = 1.37e+08
Step 10 : gram_loss = 9.36e+07, loss_total = 9.36e+07
Step 11 : gram_loss = 7.17e+07, loss_total = 7.17e+07
Step 12 : gram_loss = 5.97e+07, loss_total = 5.97e+07
Step 13 : gram_loss = 4.80e+07, loss_total = 4.80e+07
Step 14 : gram_loss = 3.82e+07, loss_total = 3.82e+07
Step 15 : gram_loss = 3.03e+07, loss_total = 3.03e+07
Step 16 : gram_loss = 2.69e+07, loss_total = 2.69e+07
Step 17 : gram_loss = 2.47e+07, loss_total = 2.47e+07
Step 18 : gram_loss = 2.31e+07, loss_total = 2.31e+07
Step 19 : gram_loss = 1.94e+07, loss_total = 1.94e+07
Step 20 : gram_loss = 1.62e+07, loss_total = 1.62e+07
Step 21 : gram_loss = 1.41e+07, loss_total = 1.41e+07
Step 22 : gram_loss = 1.23e+07, loss_total = 1.23e+07
Step 23 : gram_loss = 1.15e+07, loss_total = 1.15e+07
Step 24 : gram_loss = 1.06e+07, loss_total = 1.06e+07
Step 25 : gram_loss = 1.00e+07, loss_total = 1.00e+07
Step 26 : gram_loss = 8.30e+06, loss_total = 8.30e+06
Step 27 : gram_loss = 7.35e+06, loss_total = 7.35e+06
Step 28 : gram_loss = 6.59e+06, loss_total = 6.59e+06
Step 29 : gram_loss = 6.27e+06, loss_total = 6.27e+06
Step 30 : gram_loss = 5.87e+06, loss_total = 5.87e+06
Step 31 : gram_loss = 5.48e+06, loss_total = 5.48e+06
Step 32 : gram_loss = 4.96e+06, loss_total = 4.96e+06
Step 33 : gram_loss = 4.28e+06, loss_total = 4.28e+06
Step 34 : gram_loss = 3.85e+06, loss_total = 3.85e+06
Step 35 : gram_loss = 3.64e+06, loss_total = 3.64e+06
Step 36 : gram_loss = 3.44e+06, loss_total = 3.44e+06
Step 37 : gram_loss = 3.21e+06, loss_total = 3.21e+06
Step 38 : gram_loss = 2.86e+06, loss_total = 2.86e+06
Step 39 : gram_loss = 2.69e+06, loss_total = 2.69e+06
Step 40 : gram_loss = 2.53e+06, loss_total = 2.53e+06
Step 41 : gram_loss = 2.39e+06, loss_total = 2.39e+06
Step 42 : gram_loss = 2.32e+06, loss_total = 2.32e+06
Step 43 : gram_loss = 2.20e+06, loss_total = 2.20e+06
Step 44 : gram_loss = 2.01e+06, loss_total = 2.01e+06
Step 45 : gram_loss = 1.91e+06, loss_total = 1.91e+06
Step 46 : gram_loss = 1.81e+06, loss_total = 1.81e+06
Step 47 : gram_loss = 1.76e+06, loss_total = 1.76e+06
Step 48 : gram_loss = 1.71e+06, loss_total = 1.71e+06
Step 49 : gram_loss = 1.64e+06, loss_total = 1.64e+06
Step 50 : gram_loss = 1.56e+06, loss_total = 1.56e+06
Step 51 : gram_loss = 1.50e+06, loss_total = 1.50e+06
Step 52 : gram_loss = 1.44e+06, loss_total = 1.44e+06
Step 53 : gram_loss = 1.38e+06, loss_total = 1.38e+06
Step 54 : gram_loss = 1.28e+06, loss_total = 1.28e+06
Step 55 : gram_loss = 1.24e+06, loss_total = 1.24e+06
Step 56 : gram_loss = 1.18e+06, loss_total = 1.18e+06
Step 57 : gram_loss = 1.16e+06, loss_total = 1.16e+06
Step 58 : gram_loss = 1.11e+06, loss_total = 1.11e+06
Step 59 : gram_loss = 1.07e+06, loss_total = 1.07e+06
Step 60 : gram_loss = 1.00e+06, loss_total = 1.00e+06
Step 61 : gram_loss = 9.78e+05, loss_total = 9.78e+05
Step 62 : gram_loss = 9.47e+05, loss_total = 9.47e+05
Step 63 : gram_loss = 9.16e+05, loss_total = 9.16e+05
Step 64 : gram_loss = 9.00e+05, loss_total = 9.00e+05
Step 65 : gram_loss = 8.87e+05, loss_total = 8.87e+05
Step 66 : gram_loss = 8.63e+05, loss_total = 8.63e+05
Step 67 : gram_loss = 8.25e+05, loss_total = 8.25e+05
Step 68 : gram_loss = 7.85e+05, loss_total = 7.85e+05
Step 69 : gram_loss = 7.56e+05, loss_total = 7.56e+05
Step 70 : gram_loss = 7.35e+05, loss_total = 7.35e+05
Step 71 : gram_loss = 7.16e+05, loss_total = 7.16e+05
Step 72 : gram_loss = 7.04e+05, loss_total = 7.04e+05
Step 73 : gram_loss = 6.86e+05, loss_total = 6.86e+05
Step 74 : gram_loss = 6.59e+05, loss_total = 6.59e+05
Step 75 : gram_loss = 6.33e+05, loss_total = 6.33e+05
Step 76 : gram_loss = 6.12e+05, loss_total = 6.12e+05
Step 77 : gram_loss = 5.99e+05, loss_total = 5.99e+05
Step 78 : gram_loss = 5.87e+05, loss_total = 5.87e+05
Step 79 : gram_loss = 5.65e+05, loss_total = 5.65e+05
Step 80 : gram_loss = 5.38e+05, loss_total = 5.38e+05
Step 81 : gram_loss = 5.21e+05, loss_total = 5.21e+05
Step 82 : gram_loss = 5.07e+05, loss_total = 5.07e+05
Step 83 : gram_loss = 4.96e+05, loss_total = 4.96e+05
Step 84 : gram_loss = 4.85e+05, loss_total = 4.85e+05
Step 85 : gram_loss = 4.68e+05, loss_total = 4.68e+05
Step 86 : gram_loss = 4.62e+05, loss_total = 4.62e+05
Step 87 : gram_loss = 4.50e+05, loss_total = 4.50e+05
Step 88 : gram_loss = 4.37e+05, loss_total = 4.37e+05
Step 89 : gram_loss = 4.26e+05, loss_total = 4.26e+05
Step 90 : gram_loss = 4.15e+05, loss_total = 4.15e+05
Step 91 : gram_loss = 4.04e+05, loss_total = 4.04e+05
Step 92 : gram_loss = 3.96e+05, loss_total = 3.96e+05
Step 93 : gram_loss = 3.88e+05, loss_total = 3.88e+05
Step 94 : gram_loss = 3.81e+05, loss_total = 3.81e+05
Step 95 : gram_loss = 3.62e+05, loss_total = 3.62e+05
Step 96 : gram_loss = 3.55e+05, loss_total = 3.55e+05
Step 97 : gram_loss = 3.43e+05, loss_total = 3.43e+05
Step 98 : gram_loss = 3.38e+05, loss_total = 3.38e+05
Step 99 : gram_loss = 3.33e+05, loss_total = 3.33e+05
Step 100 : gram_loss = 3.27e+05, loss_total = 3.27e+05
Step 101 : gram_loss = 3.19e+05, loss_total = 3.19e+05
Step 102 : gram_loss = 3.14e+05, loss_total = 3.14e+05
Step 103 : gram_loss = 3.05e+05, loss_total = 3.05e+05
Step 104 : gram_loss = 2.96e+05, loss_total = 2.96e+05
Step 105 : gram_loss = 2.89e+05, loss_total = 2.89e+05
Step 106 : gram_loss = 2.85e+05, loss_total = 2.85e+05
Step 107 : gram_loss = 2.79e+05, loss_total = 2.79e+05
Step 108 : gram_loss = 2.74e+05, loss_total = 2.74e+05
Step 109 : gram_loss = 2.69e+05, loss_total = 2.69e+05
Step 110 : gram_loss = 2.64e+05, loss_total = 2.64e+05
Step 111 : gram_loss = 2.62e+05, loss_total = 2.62e+05
Step 112 : gram_loss = 2.58e+05, loss_total = 2.58e+05
Step 113 : gram_loss = 2.54e+05, loss_total = 2.54e+05
Step 114 : gram_loss = 2.51e+05, loss_total = 2.51e+05
Step 115 : gram_loss = 2.44e+05, loss_total = 2.44e+05
Step 116 : gram_loss = 2.37e+05, loss_total = 2.37e+05
Step 117 : gram_loss = 2.33e+05, loss_total = 2.33e+05
Step 118 : gram_loss = 2.30e+05, loss_total = 2.30e+05
Step 119 : gram_loss = 2.28e+05, loss_total = 2.28e+05
Step 120 : gram_loss = 2.21e+05, loss_total = 2.21e+05
Step 121 : gram_loss = 2.19e+05, loss_total = 2.19e+05
Step 122 : gram_loss = 2.15e+05, loss_total = 2.15e+05
Step 123 : gram_loss = 2.12e+05, loss_total = 2.12e+05
Step 124 : gram_loss = 2.09e+05, loss_total = 2.09e+05
Step 125 : gram_loss = 2.04e+05, loss_total = 2.04e+05
Step 126 : gram_loss = 2.00e+05, loss_total = 2.00e+05
Step 127 : gram_loss = 1.97e+05, loss_total = 1.97e+05
Step 128 : gram_loss = 1.94e+05, loss_total = 1.94e+05
Step 129 : gram_loss = 1.91e+05, loss_total = 1.91e+05
Step 130 : gram_loss = 1.88e+05, loss_total = 1.88e+05
Step 131 : gram_loss = 1.85e+05, loss_total = 1.85e+05
Step 132 : gram_loss = 1.83e+05, loss_total = 1.83e+05
Step 133 : gram_loss = 1.81e+05, loss_total = 1.81e+05
Step 134 : gram_loss = 1.80e+05, loss_total = 1.80e+05
Step 135 : gram_loss = 1.77e+05, loss_total = 1.77e+05
Step 136 : gram_loss = 1.75e+05, loss_total = 1.75e+05
Step 137 : gram_loss = 1.72e+05, loss_total = 1.72e+05
Step 138 : gram_loss = 1.69e+05, loss_total = 1.69e+05
Step 139 : gram_loss = 1.67e+05, loss_total = 1.67e+05
Step 140 : gram_loss = 1.65e+05, loss_total = 1.65e+05
Step 141 : gram_loss = 1.64e+05, loss_total = 1.64e+05
Step 142 : gram_loss = 1.60e+05, loss_total = 1.60e+05
Step 143 : gram_loss = 1.58e+05, loss_total = 1.58e+05
Step 144 : gram_loss = 1.56e+05, loss_total = 1.56e+05
Step 145 : gram_loss = 1.55e+05, loss_total = 1.55e+05
Step 146 : gram_loss = 1.52e+05, loss_total = 1.52e+05
Step 147 : gram_loss = 1.50e+05, loss_total = 1.50e+05
Step 148 : gram_loss = 1.48e+05, loss_total = 1.48e+05
Step 149 : gram_loss = 1.46e+05, loss_total = 1.46e+05
Step 150 : gram_loss = 1.44e+05, loss_total = 1.44e+05
Step 151 : gram_loss = 1.43e+05, loss_total = 1.43e+05
Step 152 : gram_loss = 1.41e+05, loss_total = 1.41e+05
Step 153 : gram_loss = 1.40e+05, loss_total = 1.40e+05
Step 154 : gram_loss = 1.39e+05, loss_total = 1.39e+05
Step 155 : gram_loss = 1.37e+05, loss_total = 1.37e+05
Step 156 : gram_loss = 1.36e+05, loss_total = 1.36e+05
Step 157 : gram_loss = 1.34e+05, loss_total = 1.34e+05
Step 158 : gram_loss = 1.33e+05, loss_total = 1.33e+05
Step 159 : gram_loss = 1.32e+05, loss_total = 1.32e+05
Step 160 : gram_loss = 1.31e+05, loss_total = 1.31e+05
Step 161 : gram_loss = 1.29e+05, loss_total = 1.29e+05
Step 162 : gram_loss = 1.28e+05, loss_total = 1.28e+05
Step 163 : gram_loss = 1.28e+05, loss_total = 1.28e+05
Step 164 : gram_loss = 1.27e+05, loss_total = 1.27e+05
Step 165 : gram_loss = 1.25e+05, loss_total = 1.25e+05
Step 166 : gram_loss = 1.24e+05, loss_total = 1.24e+05
Step 167 : gram_loss = 1.23e+05, loss_total = 1.23e+05
Step 168 : gram_loss = 1.22e+05, loss_total = 1.22e+05
Step 169 : gram_loss = 1.21e+05, loss_total = 1.21e+05
Step 170 : gram_loss = 1.19e+05, loss_total = 1.19e+05
Step 171 : gram_loss = 1.18e+05, loss_total = 1.18e+05
Step 172 : gram_loss = 1.17e+05, loss_total = 1.17e+05
Step 173 : gram_loss = 1.16e+05, loss_total = 1.16e+05
Step 174 : gram_loss = 1.14e+05, loss_total = 1.14e+05
Step 175 : gram_loss = 1.14e+05, loss_total = 1.14e+05
Step 176 : gram_loss = 1.12e+05, loss_total = 1.12e+05
Step 177 : gram_loss = 1.11e+05, loss_total = 1.11e+05
Step 178 : gram_loss = 1.10e+05, loss_total = 1.10e+05
Step 179 : gram_loss = 1.09e+05, loss_total = 1.09e+05
Step 180 : gram_loss = 1.08e+05, loss_total = 1.08e+05
Step 181 : gram_loss = 1.07e+05, loss_total = 1.07e+05
Step 182 : gram_loss = 1.07e+05, loss_total = 1.07e+05
Step 183 : gram_loss = 1.05e+05, loss_total = 1.05e+05
Step 184 : gram_loss = 1.05e+05, loss_total = 1.05e+05
Step 185 : gram_loss = 1.05e+05, loss_total = 1.05e+05
Step 186 : gram_loss = 1.04e+05, loss_total = 1.04e+05
Step 187 : gram_loss = 1.03e+05, loss_total = 1.03e+05
Step 188 : gram_loss = 1.02e+05, loss_total = 1.02e+05
Step 189 : gram_loss = 1.02e+05, loss_total = 1.02e+05
Step 190 : gram_loss = 1.01e+05, loss_total = 1.01e+05
Step 191 : gram_loss = 1.00e+05, loss_total = 1.00e+05
Step 192 : gram_loss = 9.91e+04, loss_total = 9.91e+04
Step 193 : gram_loss = 9.86e+04, loss_total = 9.86e+04
Step 194 : gram_loss = 9.81e+04, loss_total = 9.81e+04
Step 195 : gram_loss = 9.71e+04, loss_total = 9.71e+04
Step 196 : gram_loss = 9.61e+04, loss_total = 9.61e+04
Step 197 : gram_loss = 9.53e+04, loss_total = 9.53e+04
Step 198 : gram_loss = 9.45e+04, loss_total = 9.45e+04
Step 199 : gram_loss = 9.42e+04, loss_total = 9.42e+04
Step 200 : gram_loss = 9.39e+04, loss_total = 9.39e+04
Close Sess - End of the global optimization.
Computation total for  109.13047289848328  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0029_1_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0029_1_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0029_1_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0029_1_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0029_1_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0029_1_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.190909385681152  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 2.92e+09, loss_total = 2.92e+09
Step 1 : gram_loss = 2.49e+09, loss_total = 2.49e+09
Step 2 : gram_loss = 2.30e+09, loss_total = 2.30e+09
Step 3 : gram_loss = 1.95e+09, loss_total = 1.95e+09
Step 4 : gram_loss = 8.73e+08, loss_total = 8.73e+08
Step 5 : gram_loss = 2.86e+08, loss_total = 2.86e+08
Step 6 : gram_loss = 1.73e+08, loss_total = 1.73e+08
Step 7 : gram_loss = 1.49e+08, loss_total = 1.49e+08
Step 8 : gram_loss = 9.92e+07, loss_total = 9.92e+07
Step 9 : gram_loss = 7.15e+07, loss_total = 7.15e+07
Step 10 : gram_loss = 6.37e+07, loss_total = 6.37e+07
Step 11 : gram_loss = 5.73e+07, loss_total = 5.73e+07
Step 12 : gram_loss = 4.54e+07, loss_total = 4.54e+07
Step 13 : gram_loss = 3.24e+07, loss_total = 3.24e+07
Step 14 : gram_loss = 2.88e+07, loss_total = 2.88e+07
Step 15 : gram_loss = 2.19e+07, loss_total = 2.19e+07
Step 16 : gram_loss = 1.68e+07, loss_total = 1.68e+07
Step 17 : gram_loss = 1.46e+07, loss_total = 1.46e+07
Step 18 : gram_loss = 1.31e+07, loss_total = 1.31e+07
Step 19 : gram_loss = 1.14e+07, loss_total = 1.14e+07
Step 20 : gram_loss = 9.59e+06, loss_total = 9.59e+06
Step 21 : gram_loss = 7.74e+06, loss_total = 7.74e+06
Step 22 : gram_loss = 6.70e+06, loss_total = 6.70e+06
Step 23 : gram_loss = 6.26e+06, loss_total = 6.26e+06
Step 24 : gram_loss = 5.76e+06, loss_total = 5.76e+06
Step 25 : gram_loss = 5.23e+06, loss_total = 5.23e+06
Step 26 : gram_loss = 4.75e+06, loss_total = 4.75e+06
Step 27 : gram_loss = 4.26e+06, loss_total = 4.26e+06
Step 28 : gram_loss = 4.02e+06, loss_total = 4.02e+06
Step 29 : gram_loss = 3.80e+06, loss_total = 3.80e+06
Step 30 : gram_loss = 3.61e+06, loss_total = 3.61e+06
Step 31 : gram_loss = 3.51e+06, loss_total = 3.51e+06
Step 32 : gram_loss = 3.38e+06, loss_total = 3.38e+06
Step 33 : gram_loss = 3.13e+06, loss_total = 3.13e+06
Step 34 : gram_loss = 3.06e+06, loss_total = 3.06e+06
Step 35 : gram_loss = 2.89e+06, loss_total = 2.89e+06
Step 36 : gram_loss = 2.82e+06, loss_total = 2.82e+06
Step 37 : gram_loss = 2.71e+06, loss_total = 2.71e+06
Step 38 : gram_loss = 2.56e+06, loss_total = 2.56e+06
Step 39 : gram_loss = 2.37e+06, loss_total = 2.37e+06
Step 40 : gram_loss = 2.21e+06, loss_total = 2.21e+06
Step 41 : gram_loss = 2.09e+06, loss_total = 2.09e+06
Step 42 : gram_loss = 1.98e+06, loss_total = 1.98e+06
Step 43 : gram_loss = 1.91e+06, loss_total = 1.91e+06
Step 44 : gram_loss = 1.85e+06, loss_total = 1.85e+06
Step 45 : gram_loss = 1.76e+06, loss_total = 1.76e+06
Step 46 : gram_loss = 1.67e+06, loss_total = 1.67e+06
Step 47 : gram_loss = 1.60e+06, loss_total = 1.60e+06
Step 48 : gram_loss = 1.54e+06, loss_total = 1.54e+06
Step 49 : gram_loss = 1.44e+06, loss_total = 1.44e+06
Step 50 : gram_loss = 1.36e+06, loss_total = 1.36e+06
Step 51 : gram_loss = 1.30e+06, loss_total = 1.30e+06
Step 52 : gram_loss = 1.25e+06, loss_total = 1.25e+06
Step 53 : gram_loss = 1.18e+06, loss_total = 1.18e+06
Step 54 : gram_loss = 1.12e+06, loss_total = 1.12e+06
Step 55 : gram_loss = 1.08e+06, loss_total = 1.08e+06
Step 56 : gram_loss = 1.06e+06, loss_total = 1.06e+06
Step 57 : gram_loss = 1.01e+06, loss_total = 1.01e+06
Step 58 : gram_loss = 9.98e+05, loss_total = 9.98e+05
Step 59 : gram_loss = 9.58e+05, loss_total = 9.58e+05
Step 60 : gram_loss = 9.14e+05, loss_total = 9.14e+05
Step 61 : gram_loss = 8.90e+05, loss_total = 8.90e+05
Step 62 : gram_loss = 8.64e+05, loss_total = 8.64e+05
Step 63 : gram_loss = 8.32e+05, loss_total = 8.32e+05
Step 64 : gram_loss = 8.00e+05, loss_total = 8.00e+05
Step 65 : gram_loss = 7.76e+05, loss_total = 7.76e+05
Step 66 : gram_loss = 7.50e+05, loss_total = 7.50e+05
Step 67 : gram_loss = 7.33e+05, loss_total = 7.33e+05
Step 68 : gram_loss = 7.08e+05, loss_total = 7.08e+05
Step 69 : gram_loss = 6.91e+05, loss_total = 6.91e+05
Step 70 : gram_loss = 6.68e+05, loss_total = 6.68e+05
Step 71 : gram_loss = 6.33e+05, loss_total = 6.33e+05
Step 72 : gram_loss = 6.13e+05, loss_total = 6.13e+05
Step 73 : gram_loss = 6.02e+05, loss_total = 6.02e+05
Step 74 : gram_loss = 5.93e+05, loss_total = 5.93e+05
Step 75 : gram_loss = 5.77e+05, loss_total = 5.77e+05
Step 76 : gram_loss = 5.48e+05, loss_total = 5.48e+05
Step 77 : gram_loss = 5.29e+05, loss_total = 5.29e+05
Step 78 : gram_loss = 5.15e+05, loss_total = 5.15e+05
Step 79 : gram_loss = 4.99e+05, loss_total = 4.99e+05
Step 80 : gram_loss = 4.91e+05, loss_total = 4.91e+05
Step 81 : gram_loss = 4.84e+05, loss_total = 4.84e+05
Step 82 : gram_loss = 4.77e+05, loss_total = 4.77e+05
Step 83 : gram_loss = 4.67e+05, loss_total = 4.67e+05
Step 84 : gram_loss = 4.52e+05, loss_total = 4.52e+05
Step 85 : gram_loss = 4.36e+05, loss_total = 4.36e+05
Step 86 : gram_loss = 4.22e+05, loss_total = 4.22e+05
Step 87 : gram_loss = 4.10e+05, loss_total = 4.10e+05
Step 88 : gram_loss = 4.02e+05, loss_total = 4.02e+05
Step 89 : gram_loss = 3.96e+05, loss_total = 3.96e+05
Step 90 : gram_loss = 3.88e+05, loss_total = 3.88e+05
Step 91 : gram_loss = 3.78e+05, loss_total = 3.78e+05
Step 92 : gram_loss = 3.65e+05, loss_total = 3.65e+05
Step 93 : gram_loss = 3.58e+05, loss_total = 3.58e+05
Step 94 : gram_loss = 3.51e+05, loss_total = 3.51e+05
Step 95 : gram_loss = 3.40e+05, loss_total = 3.40e+05
Step 96 : gram_loss = 3.34e+05, loss_total = 3.34e+05
Step 97 : gram_loss = 3.28e+05, loss_total = 3.28e+05
Step 98 : gram_loss = 3.23e+05, loss_total = 3.23e+05
Step 99 : gram_loss = 3.19e+05, loss_total = 3.19e+05
Step 100 : gram_loss = 3.13e+05, loss_total = 3.13e+05
Step 101 : gram_loss = 3.07e+05, loss_total = 3.07e+05
Step 102 : gram_loss = 3.03e+05, loss_total = 3.03e+05
Step 103 : gram_loss = 3.00e+05, loss_total = 3.00e+05
Step 104 : gram_loss = 2.98e+05, loss_total = 2.98e+05
Step 105 : gram_loss = 2.95e+05, loss_total = 2.95e+05
Step 106 : gram_loss = 2.89e+05, loss_total = 2.89e+05
Step 107 : gram_loss = 2.83e+05, loss_total = 2.83e+05
Step 108 : gram_loss = 2.76e+05, loss_total = 2.76e+05
Step 109 : gram_loss = 2.70e+05, loss_total = 2.70e+05
Step 110 : gram_loss = 2.67e+05, loss_total = 2.67e+05
Step 111 : gram_loss = 2.61e+05, loss_total = 2.61e+05
Step 112 : gram_loss = 2.54e+05, loss_total = 2.54e+05
Step 113 : gram_loss = 2.48e+05, loss_total = 2.48e+05
Step 114 : gram_loss = 2.45e+05, loss_total = 2.45e+05
Step 115 : gram_loss = 2.42e+05, loss_total = 2.42e+05
Step 116 : gram_loss = 2.39e+05, loss_total = 2.39e+05
Step 117 : gram_loss = 2.36e+05, loss_total = 2.36e+05
Step 118 : gram_loss = 2.32e+05, loss_total = 2.32e+05
Step 119 : gram_loss = 2.30e+05, loss_total = 2.30e+05
Step 120 : gram_loss = 2.24e+05, loss_total = 2.24e+05
Step 121 : gram_loss = 2.23e+05, loss_total = 2.23e+05
Step 122 : gram_loss = 2.18e+05, loss_total = 2.18e+05
Step 123 : gram_loss = 2.17e+05, loss_total = 2.17e+05
Step 124 : gram_loss = 2.15e+05, loss_total = 2.15e+05
Step 125 : gram_loss = 2.12e+05, loss_total = 2.12e+05
Step 126 : gram_loss = 2.10e+05, loss_total = 2.10e+05
Step 127 : gram_loss = 2.08e+05, loss_total = 2.08e+05
Step 128 : gram_loss = 2.07e+05, loss_total = 2.07e+05
Step 129 : gram_loss = 2.03e+05, loss_total = 2.03e+05
Step 130 : gram_loss = 2.01e+05, loss_total = 2.01e+05
Step 131 : gram_loss = 1.98e+05, loss_total = 1.98e+05
Step 132 : gram_loss = 1.95e+05, loss_total = 1.95e+05
Step 133 : gram_loss = 1.92e+05, loss_total = 1.92e+05
Step 134 : gram_loss = 1.89e+05, loss_total = 1.89e+05
Step 135 : gram_loss = 1.87e+05, loss_total = 1.87e+05
Step 136 : gram_loss = 1.86e+05, loss_total = 1.86e+05
Step 137 : gram_loss = 1.84e+05, loss_total = 1.84e+05
Step 138 : gram_loss = 1.80e+05, loss_total = 1.80e+05
Step 139 : gram_loss = 1.79e+05, loss_total = 1.79e+05
Step 140 : gram_loss = 1.76e+05, loss_total = 1.76e+05
Step 141 : gram_loss = 1.76e+05, loss_total = 1.76e+05
Step 142 : gram_loss = 1.74e+05, loss_total = 1.74e+05
Step 143 : gram_loss = 1.72e+05, loss_total = 1.72e+05
Step 144 : gram_loss = 1.71e+05, loss_total = 1.71e+05
Step 145 : gram_loss = 1.67e+05, loss_total = 1.67e+05
Step 146 : gram_loss = 1.66e+05, loss_total = 1.66e+05
Step 147 : gram_loss = 1.65e+05, loss_total = 1.65e+05
Step 148 : gram_loss = 1.63e+05, loss_total = 1.63e+05
Step 149 : gram_loss = 1.62e+05, loss_total = 1.62e+05
Step 150 : gram_loss = 1.61e+05, loss_total = 1.61e+05
Step 151 : gram_loss = 1.60e+05, loss_total = 1.60e+05
Step 152 : gram_loss = 1.59e+05, loss_total = 1.59e+05
Step 153 : gram_loss = 1.57e+05, loss_total = 1.57e+05
Step 154 : gram_loss = 1.55e+05, loss_total = 1.55e+05
Step 155 : gram_loss = 1.54e+05, loss_total = 1.54e+05
Step 156 : gram_loss = 1.53e+05, loss_total = 1.53e+05
Step 157 : gram_loss = 1.50e+05, loss_total = 1.50e+05
Step 158 : gram_loss = 1.48e+05, loss_total = 1.48e+05
Step 159 : gram_loss = 1.46e+05, loss_total = 1.46e+05
Step 160 : gram_loss = 1.44e+05, loss_total = 1.44e+05
Step 161 : gram_loss = 1.43e+05, loss_total = 1.43e+05
Step 162 : gram_loss = 1.42e+05, loss_total = 1.42e+05
Step 163 : gram_loss = 1.41e+05, loss_total = 1.41e+05
Step 164 : gram_loss = 1.41e+05, loss_total = 1.41e+05
Step 165 : gram_loss = 1.39e+05, loss_total = 1.39e+05
Step 166 : gram_loss = 1.38e+05, loss_total = 1.38e+05
Step 167 : gram_loss = 1.37e+05, loss_total = 1.37e+05
Step 168 : gram_loss = 1.36e+05, loss_total = 1.36e+05
Step 169 : gram_loss = 1.35e+05, loss_total = 1.35e+05
Step 170 : gram_loss = 1.34e+05, loss_total = 1.34e+05
Step 171 : gram_loss = 1.34e+05, loss_total = 1.34e+05
Step 172 : gram_loss = 1.33e+05, loss_total = 1.33e+05
Step 173 : gram_loss = 1.32e+05, loss_total = 1.32e+05
Step 174 : gram_loss = 1.31e+05, loss_total = 1.31e+05
Step 175 : gram_loss = 1.30e+05, loss_total = 1.30e+05
Step 176 : gram_loss = 1.29e+05, loss_total = 1.29e+05
Step 177 : gram_loss = 1.28e+05, loss_total = 1.28e+05
Step 178 : gram_loss = 1.27e+05, loss_total = 1.27e+05
Step 179 : gram_loss = 1.26e+05, loss_total = 1.26e+05
Step 180 : gram_loss = 1.24e+05, loss_total = 1.24e+05
Step 181 : gram_loss = 1.23e+05, loss_total = 1.23e+05
Step 182 : gram_loss = 1.22e+05, loss_total = 1.22e+05
Step 183 : gram_loss = 1.21e+05, loss_total = 1.21e+05
Step 184 : gram_loss = 1.20e+05, loss_total = 1.20e+05
Step 185 : gram_loss = 1.19e+05, loss_total = 1.19e+05
Step 186 : gram_loss = 1.18e+05, loss_total = 1.18e+05
Step 187 : gram_loss = 1.17e+05, loss_total = 1.17e+05
Step 188 : gram_loss = 1.16e+05, loss_total = 1.16e+05
Step 189 : gram_loss = 1.15e+05, loss_total = 1.15e+05
Step 190 : gram_loss = 1.14e+05, loss_total = 1.14e+05
Step 191 : gram_loss = 1.14e+05, loss_total = 1.14e+05
Step 192 : gram_loss = 1.14e+05, loss_total = 1.14e+05
Step 193 : gram_loss = 1.13e+05, loss_total = 1.13e+05
Step 194 : gram_loss = 1.12e+05, loss_total = 1.12e+05
Step 195 : gram_loss = 1.12e+05, loss_total = 1.12e+05
Step 196 : gram_loss = 1.11e+05, loss_total = 1.11e+05
Step 197 : gram_loss = 1.10e+05, loss_total = 1.10e+05
Step 198 : gram_loss = 1.10e+05, loss_total = 1.10e+05
Step 199 : gram_loss = 1.09e+05, loss_total = 1.09e+05
Step 200 : gram_loss = 1.08e+05, loss_total = 1.08e+05
Close Sess - End of the global optimization.
Computation total for  107.88378572463989  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0031_1_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0031_1_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0031_1_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0031_1_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0031_1_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0031_1_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.137859106063843  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 3.16e+09, loss_total = 3.16e+09
Step 1 : gram_loss = 2.77e+09, loss_total = 2.77e+09
Step 2 : gram_loss = 2.18e+09, loss_total = 2.18e+09
Step 3 : gram_loss = 1.86e+09, loss_total = 1.86e+09
Step 4 : gram_loss = 1.34e+09, loss_total = 1.34e+09
Step 5 : gram_loss = 4.03e+08, loss_total = 4.03e+08
Step 6 : gram_loss = 2.63e+08, loss_total = 2.63e+08
Step 7 : gram_loss = 2.24e+08, loss_total = 2.24e+08
Step 8 : gram_loss = 1.27e+08, loss_total = 1.27e+08
Step 9 : gram_loss = 9.81e+07, loss_total = 9.81e+07
Step 10 : gram_loss = 8.23e+07, loss_total = 8.23e+07
Step 11 : gram_loss = 7.04e+07, loss_total = 7.04e+07
Step 12 : gram_loss = 5.46e+07, loss_total = 5.46e+07
Step 13 : gram_loss = 3.68e+07, loss_total = 3.68e+07
Step 14 : gram_loss = 2.78e+07, loss_total = 2.78e+07
Step 15 : gram_loss = 2.48e+07, loss_total = 2.48e+07
Step 16 : gram_loss = 2.29e+07, loss_total = 2.29e+07
Step 17 : gram_loss = 2.02e+07, loss_total = 2.02e+07
Step 18 : gram_loss = 1.67e+07, loss_total = 1.67e+07
Step 19 : gram_loss = 1.52e+07, loss_total = 1.52e+07
Step 20 : gram_loss = 1.26e+07, loss_total = 1.26e+07
Step 21 : gram_loss = 1.19e+07, loss_total = 1.19e+07
Step 22 : gram_loss = 1.04e+07, loss_total = 1.04e+07
Step 23 : gram_loss = 9.69e+06, loss_total = 9.69e+06
Step 24 : gram_loss = 8.81e+06, loss_total = 8.81e+06
Step 25 : gram_loss = 8.09e+06, loss_total = 8.09e+06
Step 26 : gram_loss = 7.36e+06, loss_total = 7.36e+06
Step 27 : gram_loss = 6.86e+06, loss_total = 6.86e+06
Step 28 : gram_loss = 6.38e+06, loss_total = 6.38e+06
Step 29 : gram_loss = 6.10e+06, loss_total = 6.10e+06
Step 30 : gram_loss = 5.93e+06, loss_total = 5.93e+06
Step 31 : gram_loss = 5.68e+06, loss_total = 5.68e+06
Step 32 : gram_loss = 5.25e+06, loss_total = 5.25e+06
Step 33 : gram_loss = 4.97e+06, loss_total = 4.97e+06
Step 34 : gram_loss = 4.64e+06, loss_total = 4.64e+06
Step 35 : gram_loss = 4.50e+06, loss_total = 4.50e+06
Step 36 : gram_loss = 4.31e+06, loss_total = 4.31e+06
Step 37 : gram_loss = 4.09e+06, loss_total = 4.09e+06
Step 38 : gram_loss = 3.88e+06, loss_total = 3.88e+06
Step 39 : gram_loss = 3.72e+06, loss_total = 3.72e+06
Step 40 : gram_loss = 3.47e+06, loss_total = 3.47e+06
Step 41 : gram_loss = 3.40e+06, loss_total = 3.40e+06
Step 42 : gram_loss = 3.28e+06, loss_total = 3.28e+06
Step 43 : gram_loss = 3.19e+06, loss_total = 3.19e+06
Step 44 : gram_loss = 2.99e+06, loss_total = 2.99e+06
Step 45 : gram_loss = 2.79e+06, loss_total = 2.79e+06
Step 46 : gram_loss = 2.63e+06, loss_total = 2.63e+06
Step 47 : gram_loss = 2.55e+06, loss_total = 2.55e+06
Step 48 : gram_loss = 2.49e+06, loss_total = 2.49e+06
Step 49 : gram_loss = 2.45e+06, loss_total = 2.45e+06
Step 50 : gram_loss = 2.34e+06, loss_total = 2.34e+06
Step 51 : gram_loss = 2.21e+06, loss_total = 2.21e+06
Step 52 : gram_loss = 2.15e+06, loss_total = 2.15e+06
Step 53 : gram_loss = 2.08e+06, loss_total = 2.08e+06
Step 54 : gram_loss = 2.03e+06, loss_total = 2.03e+06
Step 55 : gram_loss = 1.96e+06, loss_total = 1.96e+06
Step 56 : gram_loss = 1.92e+06, loss_total = 1.92e+06
Step 57 : gram_loss = 1.88e+06, loss_total = 1.88e+06
Step 58 : gram_loss = 1.86e+06, loss_total = 1.86e+06
Step 59 : gram_loss = 1.81e+06, loss_total = 1.81e+06
Step 60 : gram_loss = 1.73e+06, loss_total = 1.73e+06
Step 61 : gram_loss = 1.66e+06, loss_total = 1.66e+06
Step 62 : gram_loss = 1.62e+06, loss_total = 1.62e+06
Step 63 : gram_loss = 1.57e+06, loss_total = 1.57e+06
Step 64 : gram_loss = 1.55e+06, loss_total = 1.55e+06
Step 65 : gram_loss = 1.54e+06, loss_total = 1.54e+06
Step 66 : gram_loss = 1.51e+06, loss_total = 1.51e+06
Step 67 : gram_loss = 1.45e+06, loss_total = 1.45e+06
Step 68 : gram_loss = 1.43e+06, loss_total = 1.43e+06
Step 69 : gram_loss = 1.38e+06, loss_total = 1.38e+06
Step 70 : gram_loss = 1.36e+06, loss_total = 1.36e+06
Step 71 : gram_loss = 1.33e+06, loss_total = 1.33e+06
Step 72 : gram_loss = 1.29e+06, loss_total = 1.29e+06
Step 73 : gram_loss = 1.28e+06, loss_total = 1.28e+06
Step 74 : gram_loss = 1.24e+06, loss_total = 1.24e+06
Step 75 : gram_loss = 1.22e+06, loss_total = 1.22e+06
Step 76 : gram_loss = 1.20e+06, loss_total = 1.20e+06
Step 77 : gram_loss = 1.15e+06, loss_total = 1.15e+06
Step 78 : gram_loss = 1.14e+06, loss_total = 1.14e+06
Step 79 : gram_loss = 1.11e+06, loss_total = 1.11e+06
Step 80 : gram_loss = 1.08e+06, loss_total = 1.08e+06
Step 81 : gram_loss = 1.05e+06, loss_total = 1.05e+06
Step 82 : gram_loss = 1.02e+06, loss_total = 1.02e+06
Step 83 : gram_loss = 9.89e+05, loss_total = 9.89e+05
Step 84 : gram_loss = 9.66e+05, loss_total = 9.66e+05
Step 85 : gram_loss = 9.47e+05, loss_total = 9.47e+05
Step 86 : gram_loss = 9.30e+05, loss_total = 9.30e+05
Step 87 : gram_loss = 9.21e+05, loss_total = 9.21e+05
Step 88 : gram_loss = 9.04e+05, loss_total = 9.04e+05
Step 89 : gram_loss = 8.83e+05, loss_total = 8.83e+05
Step 90 : gram_loss = 8.65e+05, loss_total = 8.65e+05
Step 91 : gram_loss = 8.49e+05, loss_total = 8.49e+05
Step 92 : gram_loss = 8.34e+05, loss_total = 8.34e+05
Step 93 : gram_loss = 8.20e+05, loss_total = 8.20e+05
Step 94 : gram_loss = 7.98e+05, loss_total = 7.98e+05
Step 95 : gram_loss = 7.74e+05, loss_total = 7.74e+05
Step 96 : gram_loss = 7.54e+05, loss_total = 7.54e+05
Step 97 : gram_loss = 7.35e+05, loss_total = 7.35e+05
Step 98 : gram_loss = 7.18e+05, loss_total = 7.18e+05
Step 99 : gram_loss = 7.02e+05, loss_total = 7.02e+05
Step 100 : gram_loss = 6.86e+05, loss_total = 6.86e+05
Step 101 : gram_loss = 6.74e+05, loss_total = 6.74e+05
Step 102 : gram_loss = 6.66e+05, loss_total = 6.66e+05
Step 103 : gram_loss = 6.50e+05, loss_total = 6.50e+05
Step 104 : gram_loss = 6.40e+05, loss_total = 6.40e+05
Step 105 : gram_loss = 6.31e+05, loss_total = 6.31e+05
Step 106 : gram_loss = 6.13e+05, loss_total = 6.13e+05
Step 107 : gram_loss = 6.05e+05, loss_total = 6.05e+05
Step 108 : gram_loss = 5.96e+05, loss_total = 5.96e+05
Step 109 : gram_loss = 5.90e+05, loss_total = 5.90e+05
Step 110 : gram_loss = 5.85e+05, loss_total = 5.85e+05
Step 111 : gram_loss = 5.74e+05, loss_total = 5.74e+05
Step 112 : gram_loss = 5.52e+05, loss_total = 5.52e+05
Step 113 : gram_loss = 5.39e+05, loss_total = 5.39e+05
Step 114 : gram_loss = 5.30e+05, loss_total = 5.30e+05
Step 115 : gram_loss = 5.24e+05, loss_total = 5.24e+05
Step 116 : gram_loss = 5.17e+05, loss_total = 5.17e+05
Step 117 : gram_loss = 5.09e+05, loss_total = 5.09e+05
Step 118 : gram_loss = 5.00e+05, loss_total = 5.00e+05
Step 119 : gram_loss = 4.93e+05, loss_total = 4.93e+05
Step 120 : gram_loss = 4.82e+05, loss_total = 4.82e+05
Step 121 : gram_loss = 4.78e+05, loss_total = 4.78e+05
Step 122 : gram_loss = 4.69e+05, loss_total = 4.69e+05
Step 123 : gram_loss = 4.63e+05, loss_total = 4.63e+05
Step 124 : gram_loss = 4.59e+05, loss_total = 4.59e+05
Step 125 : gram_loss = 4.51e+05, loss_total = 4.51e+05
Step 126 : gram_loss = 4.46e+05, loss_total = 4.46e+05
Step 127 : gram_loss = 4.37e+05, loss_total = 4.37e+05
Step 128 : gram_loss = 4.30e+05, loss_total = 4.30e+05
Step 129 : gram_loss = 4.25e+05, loss_total = 4.25e+05
Step 130 : gram_loss = 4.21e+05, loss_total = 4.21e+05
Step 131 : gram_loss = 4.17e+05, loss_total = 4.17e+05
Step 132 : gram_loss = 4.12e+05, loss_total = 4.12e+05
Step 133 : gram_loss = 4.09e+05, loss_total = 4.09e+05
Step 134 : gram_loss = 4.03e+05, loss_total = 4.03e+05
Step 135 : gram_loss = 3.95e+05, loss_total = 3.95e+05
Step 136 : gram_loss = 3.88e+05, loss_total = 3.88e+05
Step 137 : gram_loss = 3.82e+05, loss_total = 3.82e+05
Step 138 : gram_loss = 3.78e+05, loss_total = 3.78e+05
Step 139 : gram_loss = 3.67e+05, loss_total = 3.67e+05
Step 140 : gram_loss = 3.63e+05, loss_total = 3.63e+05
Step 141 : gram_loss = 3.59e+05, loss_total = 3.59e+05
Step 142 : gram_loss = 3.53e+05, loss_total = 3.53e+05
Step 143 : gram_loss = 3.44e+05, loss_total = 3.44e+05
Step 144 : gram_loss = 3.43e+05, loss_total = 3.43e+05
Step 145 : gram_loss = 3.35e+05, loss_total = 3.35e+05
Step 146 : gram_loss = 3.33e+05, loss_total = 3.33e+05
Step 147 : gram_loss = 3.27e+05, loss_total = 3.27e+05
Step 148 : gram_loss = 3.21e+05, loss_total = 3.21e+05
Step 149 : gram_loss = 3.16e+05, loss_total = 3.16e+05
Step 150 : gram_loss = 3.09e+05, loss_total = 3.09e+05
Step 151 : gram_loss = 3.07e+05, loss_total = 3.07e+05
Step 152 : gram_loss = 2.99e+05, loss_total = 2.99e+05
Step 153 : gram_loss = 2.97e+05, loss_total = 2.97e+05
Step 154 : gram_loss = 2.93e+05, loss_total = 2.93e+05
Step 155 : gram_loss = 2.91e+05, loss_total = 2.91e+05
Step 156 : gram_loss = 2.88e+05, loss_total = 2.88e+05
Step 157 : gram_loss = 2.84e+05, loss_total = 2.84e+05
Step 158 : gram_loss = 2.78e+05, loss_total = 2.78e+05
Step 159 : gram_loss = 2.73e+05, loss_total = 2.73e+05
Step 160 : gram_loss = 2.68e+05, loss_total = 2.68e+05
Step 161 : gram_loss = 2.64e+05, loss_total = 2.64e+05
Step 162 : gram_loss = 2.60e+05, loss_total = 2.60e+05
Step 163 : gram_loss = 2.54e+05, loss_total = 2.54e+05
Step 164 : gram_loss = 2.49e+05, loss_total = 2.49e+05
Step 165 : gram_loss = 2.47e+05, loss_total = 2.47e+05
Step 166 : gram_loss = 2.45e+05, loss_total = 2.45e+05
Step 167 : gram_loss = 2.42e+05, loss_total = 2.42e+05
Step 168 : gram_loss = 2.39e+05, loss_total = 2.39e+05
Step 169 : gram_loss = 2.31e+05, loss_total = 2.31e+05
Step 170 : gram_loss = 2.30e+05, loss_total = 2.30e+05
Step 171 : gram_loss = 2.28e+05, loss_total = 2.28e+05
Step 172 : gram_loss = 2.26e+05, loss_total = 2.26e+05
Step 173 : gram_loss = 2.23e+05, loss_total = 2.23e+05
Step 174 : gram_loss = 2.18e+05, loss_total = 2.18e+05
Step 175 : gram_loss = 2.18e+05, loss_total = 2.18e+05
Step 176 : gram_loss = 2.16e+05, loss_total = 2.16e+05
Step 177 : gram_loss = 2.15e+05, loss_total = 2.15e+05
Step 178 : gram_loss = 2.13e+05, loss_total = 2.13e+05
Step 179 : gram_loss = 2.10e+05, loss_total = 2.10e+05
Step 180 : gram_loss = 2.06e+05, loss_total = 2.06e+05
Step 181 : gram_loss = 2.03e+05, loss_total = 2.03e+05
Step 182 : gram_loss = 2.00e+05, loss_total = 2.00e+05
Step 183 : gram_loss = 1.99e+05, loss_total = 1.99e+05
Step 184 : gram_loss = 1.97e+05, loss_total = 1.97e+05
Step 185 : gram_loss = 1.94e+05, loss_total = 1.94e+05
Step 186 : gram_loss = 1.92e+05, loss_total = 1.92e+05
Step 187 : gram_loss = 1.90e+05, loss_total = 1.90e+05
Step 188 : gram_loss = 1.89e+05, loss_total = 1.89e+05
Step 189 : gram_loss = 1.86e+05, loss_total = 1.86e+05
Step 190 : gram_loss = 1.84e+05, loss_total = 1.84e+05
Step 191 : gram_loss = 1.82e+05, loss_total = 1.82e+05
Step 192 : gram_loss = 1.80e+05, loss_total = 1.80e+05
Step 193 : gram_loss = 1.78e+05, loss_total = 1.78e+05
Step 194 : gram_loss = 1.76e+05, loss_total = 1.76e+05
Step 195 : gram_loss = 1.74e+05, loss_total = 1.74e+05
Step 196 : gram_loss = 1.73e+05, loss_total = 1.73e+05
Step 197 : gram_loss = 1.72e+05, loss_total = 1.72e+05
Step 198 : gram_loss = 1.71e+05, loss_total = 1.71e+05
Step 199 : gram_loss = 1.70e+05, loss_total = 1.70e+05
Step 200 : gram_loss = 1.70e+05, loss_total = 1.70e+05
Close Sess - End of the global optimization.
Computation total for  107.76826119422913  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0009_1_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0009_1_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0009_1_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0009_1_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0009_1_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0009_1_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.251460790634155  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 4.87e+09, loss_total = 4.87e+09
Step 1 : gram_loss = 1.68e+09, loss_total = 1.68e+09
Step 2 : gram_loss = 1.64e+09, loss_total = 1.64e+09
Step 3 : gram_loss = 7.27e+08, loss_total = 7.27e+08
Step 4 : gram_loss = 4.06e+08, loss_total = 4.06e+08
Step 5 : gram_loss = 3.04e+08, loss_total = 3.04e+08
Step 6 : gram_loss = 2.67e+08, loss_total = 2.67e+08
Step 7 : gram_loss = 2.32e+08, loss_total = 2.32e+08
Step 8 : gram_loss = 2.13e+08, loss_total = 2.13e+08
Step 9 : gram_loss = 1.69e+08, loss_total = 1.69e+08
Step 10 : gram_loss = 1.29e+08, loss_total = 1.29e+08
Step 11 : gram_loss = 8.92e+07, loss_total = 8.92e+07
Step 12 : gram_loss = 6.15e+07, loss_total = 6.15e+07
Step 13 : gram_loss = 5.08e+07, loss_total = 5.08e+07
Step 14 : gram_loss = 3.91e+07, loss_total = 3.91e+07
Step 15 : gram_loss = 3.53e+07, loss_total = 3.53e+07
Step 16 : gram_loss = 3.20e+07, loss_total = 3.20e+07
Step 17 : gram_loss = 2.57e+07, loss_total = 2.57e+07
Step 18 : gram_loss = 2.15e+07, loss_total = 2.15e+07
Step 19 : gram_loss = 1.54e+07, loss_total = 1.54e+07
Step 20 : gram_loss = 1.06e+07, loss_total = 1.06e+07
Step 21 : gram_loss = 8.44e+06, loss_total = 8.44e+06
Step 22 : gram_loss = 7.95e+06, loss_total = 7.95e+06
Step 23 : gram_loss = 7.11e+06, loss_total = 7.11e+06
Step 24 : gram_loss = 6.52e+06, loss_total = 6.52e+06
Step 25 : gram_loss = 5.65e+06, loss_total = 5.65e+06
Step 26 : gram_loss = 4.55e+06, loss_total = 4.55e+06
Step 27 : gram_loss = 3.99e+06, loss_total = 3.99e+06
Step 28 : gram_loss = 3.73e+06, loss_total = 3.73e+06
Step 29 : gram_loss = 3.42e+06, loss_total = 3.42e+06
Step 30 : gram_loss = 3.20e+06, loss_total = 3.20e+06
Step 31 : gram_loss = 2.88e+06, loss_total = 2.88e+06
Step 32 : gram_loss = 2.63e+06, loss_total = 2.63e+06
Step 33 : gram_loss = 2.44e+06, loss_total = 2.44e+06
Step 34 : gram_loss = 2.34e+06, loss_total = 2.34e+06
Step 35 : gram_loss = 2.20e+06, loss_total = 2.20e+06
Step 36 : gram_loss = 2.00e+06, loss_total = 2.00e+06
Step 37 : gram_loss = 1.87e+06, loss_total = 1.87e+06
Step 38 : gram_loss = 1.77e+06, loss_total = 1.77e+06
Step 39 : gram_loss = 1.68e+06, loss_total = 1.68e+06
Step 40 : gram_loss = 1.62e+06, loss_total = 1.62e+06
Step 41 : gram_loss = 1.55e+06, loss_total = 1.55e+06
Step 42 : gram_loss = 1.46e+06, loss_total = 1.46e+06
Step 43 : gram_loss = 1.36e+06, loss_total = 1.36e+06
Step 44 : gram_loss = 1.26e+06, loss_total = 1.26e+06
Step 45 : gram_loss = 1.21e+06, loss_total = 1.21e+06
Step 46 : gram_loss = 1.11e+06, loss_total = 1.11e+06
Step 47 : gram_loss = 1.08e+06, loss_total = 1.08e+06
Step 48 : gram_loss = 1.06e+06, loss_total = 1.06e+06
Step 49 : gram_loss = 1.02e+06, loss_total = 1.02e+06
Step 50 : gram_loss = 9.84e+05, loss_total = 9.84e+05
Step 51 : gram_loss = 9.54e+05, loss_total = 9.54e+05
Step 52 : gram_loss = 9.00e+05, loss_total = 9.00e+05
Step 53 : gram_loss = 8.25e+05, loss_total = 8.25e+05
Step 54 : gram_loss = 8.03e+05, loss_total = 8.03e+05
Step 55 : gram_loss = 7.77e+05, loss_total = 7.77e+05
Step 56 : gram_loss = 7.38e+05, loss_total = 7.38e+05
Step 57 : gram_loss = 7.17e+05, loss_total = 7.17e+05
Step 58 : gram_loss = 7.07e+05, loss_total = 7.07e+05
Step 59 : gram_loss = 6.55e+05, loss_total = 6.55e+05
Step 60 : gram_loss = 6.08e+05, loss_total = 6.08e+05
Step 61 : gram_loss = 5.65e+05, loss_total = 5.65e+05
Step 62 : gram_loss = 5.38e+05, loss_total = 5.38e+05
Step 63 : gram_loss = 5.21e+05, loss_total = 5.21e+05
Step 64 : gram_loss = 5.10e+05, loss_total = 5.10e+05
Step 65 : gram_loss = 4.98e+05, loss_total = 4.98e+05
Step 66 : gram_loss = 4.82e+05, loss_total = 4.82e+05
Step 67 : gram_loss = 4.64e+05, loss_total = 4.64e+05
Step 68 : gram_loss = 4.34e+05, loss_total = 4.34e+05
Step 69 : gram_loss = 4.21e+05, loss_total = 4.21e+05
Step 70 : gram_loss = 3.98e+05, loss_total = 3.98e+05
Step 71 : gram_loss = 3.92e+05, loss_total = 3.92e+05
Step 72 : gram_loss = 3.82e+05, loss_total = 3.82e+05
Step 73 : gram_loss = 3.74e+05, loss_total = 3.74e+05
Step 74 : gram_loss = 3.61e+05, loss_total = 3.61e+05
Step 75 : gram_loss = 3.44e+05, loss_total = 3.44e+05
Step 76 : gram_loss = 3.31e+05, loss_total = 3.31e+05
Step 77 : gram_loss = 3.22e+05, loss_total = 3.22e+05
Step 78 : gram_loss = 3.13e+05, loss_total = 3.13e+05
Step 79 : gram_loss = 3.08e+05, loss_total = 3.08e+05
Step 80 : gram_loss = 3.01e+05, loss_total = 3.01e+05
Step 81 : gram_loss = 2.89e+05, loss_total = 2.89e+05
Step 82 : gram_loss = 2.79e+05, loss_total = 2.79e+05
Step 83 : gram_loss = 2.69e+05, loss_total = 2.69e+05
Step 84 : gram_loss = 2.62e+05, loss_total = 2.62e+05
Step 85 : gram_loss = 2.54e+05, loss_total = 2.54e+05
Step 86 : gram_loss = 2.47e+05, loss_total = 2.47e+05
Step 87 : gram_loss = 2.40e+05, loss_total = 2.40e+05
Step 88 : gram_loss = 2.36e+05, loss_total = 2.36e+05
Step 89 : gram_loss = 2.32e+05, loss_total = 2.32e+05
Step 90 : gram_loss = 2.23e+05, loss_total = 2.23e+05
Step 91 : gram_loss = 2.16e+05, loss_total = 2.16e+05
Step 92 : gram_loss = 2.12e+05, loss_total = 2.12e+05
Step 93 : gram_loss = 2.08e+05, loss_total = 2.08e+05
Step 94 : gram_loss = 2.03e+05, loss_total = 2.03e+05
Step 95 : gram_loss = 1.99e+05, loss_total = 1.99e+05
Step 96 : gram_loss = 1.93e+05, loss_total = 1.93e+05
Step 97 : gram_loss = 1.89e+05, loss_total = 1.89e+05
Step 98 : gram_loss = 1.83e+05, loss_total = 1.83e+05
Step 99 : gram_loss = 1.79e+05, loss_total = 1.79e+05
Step 100 : gram_loss = 1.75e+05, loss_total = 1.75e+05
Step 101 : gram_loss = 1.72e+05, loss_total = 1.72e+05
Step 102 : gram_loss = 1.69e+05, loss_total = 1.69e+05
Step 103 : gram_loss = 1.65e+05, loss_total = 1.65e+05
Step 104 : gram_loss = 1.60e+05, loss_total = 1.60e+05
Step 105 : gram_loss = 1.57e+05, loss_total = 1.57e+05
Step 106 : gram_loss = 1.52e+05, loss_total = 1.52e+05
Step 107 : gram_loss = 1.49e+05, loss_total = 1.49e+05
Step 108 : gram_loss = 1.47e+05, loss_total = 1.47e+05
Step 109 : gram_loss = 1.45e+05, loss_total = 1.45e+05
Step 110 : gram_loss = 1.44e+05, loss_total = 1.44e+05
Step 111 : gram_loss = 1.40e+05, loss_total = 1.40e+05
Step 112 : gram_loss = 1.37e+05, loss_total = 1.37e+05
Step 113 : gram_loss = 1.34e+05, loss_total = 1.34e+05
Step 114 : gram_loss = 1.32e+05, loss_total = 1.32e+05
Step 115 : gram_loss = 1.30e+05, loss_total = 1.30e+05
Step 116 : gram_loss = 1.28e+05, loss_total = 1.28e+05
Step 117 : gram_loss = 1.26e+05, loss_total = 1.26e+05
Step 118 : gram_loss = 1.23e+05, loss_total = 1.23e+05
Step 119 : gram_loss = 1.22e+05, loss_total = 1.22e+05
Step 120 : gram_loss = 1.19e+05, loss_total = 1.19e+05
Step 121 : gram_loss = 1.17e+05, loss_total = 1.17e+05
Step 122 : gram_loss = 1.16e+05, loss_total = 1.16e+05
Step 123 : gram_loss = 1.13e+05, loss_total = 1.13e+05
Step 124 : gram_loss = 1.12e+05, loss_total = 1.12e+05
Step 125 : gram_loss = 1.10e+05, loss_total = 1.10e+05
Step 126 : gram_loss = 1.08e+05, loss_total = 1.08e+05
Step 127 : gram_loss = 1.06e+05, loss_total = 1.06e+05
Step 128 : gram_loss = 1.04e+05, loss_total = 1.04e+05
Step 129 : gram_loss = 1.04e+05, loss_total = 1.04e+05
Step 130 : gram_loss = 1.02e+05, loss_total = 1.02e+05
Step 131 : gram_loss = 1.00e+05, loss_total = 1.00e+05
Step 132 : gram_loss = 9.92e+04, loss_total = 9.92e+04
Step 133 : gram_loss = 9.73e+04, loss_total = 9.73e+04
Step 134 : gram_loss = 9.59e+04, loss_total = 9.59e+04
Step 135 : gram_loss = 9.43e+04, loss_total = 9.43e+04
Step 136 : gram_loss = 9.22e+04, loss_total = 9.22e+04
Step 137 : gram_loss = 9.17e+04, loss_total = 9.17e+04
Step 138 : gram_loss = 9.08e+04, loss_total = 9.08e+04
Step 139 : gram_loss = 9.01e+04, loss_total = 9.01e+04
Step 140 : gram_loss = 8.92e+04, loss_total = 8.92e+04
Step 141 : gram_loss = 8.83e+04, loss_total = 8.83e+04
Step 142 : gram_loss = 8.63e+04, loss_total = 8.63e+04
Step 143 : gram_loss = 8.55e+04, loss_total = 8.55e+04
Step 144 : gram_loss = 8.41e+04, loss_total = 8.41e+04
Step 145 : gram_loss = 8.30e+04, loss_total = 8.30e+04
Step 146 : gram_loss = 8.17e+04, loss_total = 8.17e+04
Step 147 : gram_loss = 8.10e+04, loss_total = 8.10e+04
Step 148 : gram_loss = 8.02e+04, loss_total = 8.02e+04
Step 149 : gram_loss = 7.98e+04, loss_total = 7.98e+04
Step 150 : gram_loss = 7.85e+04, loss_total = 7.85e+04
Step 151 : gram_loss = 7.80e+04, loss_total = 7.80e+04
Step 152 : gram_loss = 7.69e+04, loss_total = 7.69e+04
Step 153 : gram_loss = 7.63e+04, loss_total = 7.63e+04
Step 154 : gram_loss = 7.56e+04, loss_total = 7.56e+04
Step 155 : gram_loss = 7.44e+04, loss_total = 7.44e+04
Step 156 : gram_loss = 7.35e+04, loss_total = 7.35e+04
Step 157 : gram_loss = 7.28e+04, loss_total = 7.28e+04
Step 158 : gram_loss = 7.22e+04, loss_total = 7.22e+04
Step 159 : gram_loss = 7.18e+04, loss_total = 7.18e+04
Step 160 : gram_loss = 7.12e+04, loss_total = 7.12e+04
Step 161 : gram_loss = 7.07e+04, loss_total = 7.07e+04
Step 162 : gram_loss = 7.00e+04, loss_total = 7.00e+04
Step 163 : gram_loss = 6.89e+04, loss_total = 6.89e+04
Step 164 : gram_loss = 6.80e+04, loss_total = 6.80e+04
Step 165 : gram_loss = 6.71e+04, loss_total = 6.71e+04
Step 166 : gram_loss = 6.66e+04, loss_total = 6.66e+04
Step 167 : gram_loss = 6.60e+04, loss_total = 6.60e+04
Step 168 : gram_loss = 6.57e+04, loss_total = 6.57e+04
Step 169 : gram_loss = 6.53e+04, loss_total = 6.53e+04
Step 170 : gram_loss = 6.48e+04, loss_total = 6.48e+04
Step 171 : gram_loss = 6.45e+04, loss_total = 6.45e+04
Step 172 : gram_loss = 6.35e+04, loss_total = 6.35e+04
Step 173 : gram_loss = 6.32e+04, loss_total = 6.32e+04
Step 174 : gram_loss = 6.25e+04, loss_total = 6.25e+04
Step 175 : gram_loss = 6.22e+04, loss_total = 6.22e+04
Step 176 : gram_loss = 6.18e+04, loss_total = 6.18e+04
Step 177 : gram_loss = 6.11e+04, loss_total = 6.11e+04
Step 178 : gram_loss = 6.05e+04, loss_total = 6.05e+04
Step 179 : gram_loss = 5.99e+04, loss_total = 5.99e+04
Step 180 : gram_loss = 5.96e+04, loss_total = 5.96e+04
Step 181 : gram_loss = 5.93e+04, loss_total = 5.93e+04
Step 182 : gram_loss = 5.89e+04, loss_total = 5.89e+04
Step 183 : gram_loss = 5.86e+04, loss_total = 5.86e+04
Step 184 : gram_loss = 5.81e+04, loss_total = 5.81e+04
Step 185 : gram_loss = 5.76e+04, loss_total = 5.76e+04
Step 186 : gram_loss = 5.69e+04, loss_total = 5.69e+04
Step 187 : gram_loss = 5.61e+04, loss_total = 5.61e+04
Step 188 : gram_loss = 5.58e+04, loss_total = 5.58e+04
Step 189 : gram_loss = 5.54e+04, loss_total = 5.54e+04
Step 190 : gram_loss = 5.51e+04, loss_total = 5.51e+04
Step 191 : gram_loss = 5.48e+04, loss_total = 5.48e+04
Step 192 : gram_loss = 5.43e+04, loss_total = 5.43e+04
Step 193 : gram_loss = 5.37e+04, loss_total = 5.37e+04
Step 194 : gram_loss = 5.32e+04, loss_total = 5.32e+04
Step 195 : gram_loss = 5.25e+04, loss_total = 5.25e+04
Step 196 : gram_loss = 5.23e+04, loss_total = 5.23e+04
Step 197 : gram_loss = 5.20e+04, loss_total = 5.20e+04
Step 198 : gram_loss = 5.18e+04, loss_total = 5.18e+04
Step 199 : gram_loss = 5.15e+04, loss_total = 5.15e+04
Step 200 : gram_loss = 5.11e+04, loss_total = 5.11e+04
Close Sess - End of the global optimization.
Computation total for  107.91224670410156  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0018_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0018_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0018_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0018_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0018_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0018_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.250761270523071  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 6.23e+09, loss_total = 6.23e+09
Step 1 : gram_loss = 4.85e+09, loss_total = 4.85e+09
Step 2 : gram_loss = 4.48e+09, loss_total = 4.48e+09
Step 3 : gram_loss = 3.52e+09, loss_total = 3.52e+09
Step 4 : gram_loss = 2.64e+09, loss_total = 2.64e+09
Step 5 : gram_loss = 1.30e+09, loss_total = 1.30e+09
Step 6 : gram_loss = 9.94e+08, loss_total = 9.94e+08
Step 7 : gram_loss = 5.38e+08, loss_total = 5.38e+08
Step 8 : gram_loss = 3.87e+08, loss_total = 3.87e+08
Step 9 : gram_loss = 2.68e+08, loss_total = 2.68e+08
Step 10 : gram_loss = 2.28e+08, loss_total = 2.28e+08
Step 11 : gram_loss = 1.59e+08, loss_total = 1.59e+08
Step 12 : gram_loss = 1.11e+08, loss_total = 1.11e+08
Step 13 : gram_loss = 7.59e+07, loss_total = 7.59e+07
Step 14 : gram_loss = 5.42e+07, loss_total = 5.42e+07
Step 15 : gram_loss = 3.80e+07, loss_total = 3.80e+07
Step 16 : gram_loss = 3.52e+07, loss_total = 3.52e+07
Step 17 : gram_loss = 3.14e+07, loss_total = 3.14e+07
Step 18 : gram_loss = 2.87e+07, loss_total = 2.87e+07
Step 19 : gram_loss = 2.39e+07, loss_total = 2.39e+07
Step 20 : gram_loss = 2.09e+07, loss_total = 2.09e+07
Step 21 : gram_loss = 1.66e+07, loss_total = 1.66e+07
Step 22 : gram_loss = 1.45e+07, loss_total = 1.45e+07
Step 23 : gram_loss = 1.38e+07, loss_total = 1.38e+07
Step 24 : gram_loss = 1.26e+07, loss_total = 1.26e+07
Step 25 : gram_loss = 1.20e+07, loss_total = 1.20e+07
Step 26 : gram_loss = 1.11e+07, loss_total = 1.11e+07
Step 27 : gram_loss = 9.55e+06, loss_total = 9.55e+06
Step 28 : gram_loss = 8.42e+06, loss_total = 8.42e+06
Step 29 : gram_loss = 6.94e+06, loss_total = 6.94e+06
Step 30 : gram_loss = 6.36e+06, loss_total = 6.36e+06
Step 31 : gram_loss = 6.13e+06, loss_total = 6.13e+06
Step 32 : gram_loss = 5.77e+06, loss_total = 5.77e+06
Step 33 : gram_loss = 5.20e+06, loss_total = 5.20e+06
Step 34 : gram_loss = 4.57e+06, loss_total = 4.57e+06
Step 35 : gram_loss = 4.40e+06, loss_total = 4.40e+06
Step 36 : gram_loss = 4.04e+06, loss_total = 4.04e+06
Step 37 : gram_loss = 3.97e+06, loss_total = 3.97e+06
Step 38 : gram_loss = 3.88e+06, loss_total = 3.88e+06
Step 39 : gram_loss = 3.68e+06, loss_total = 3.68e+06
Step 40 : gram_loss = 3.41e+06, loss_total = 3.41e+06
Step 41 : gram_loss = 3.27e+06, loss_total = 3.27e+06
Step 42 : gram_loss = 2.99e+06, loss_total = 2.99e+06
Step 43 : gram_loss = 2.90e+06, loss_total = 2.90e+06
Step 44 : gram_loss = 2.81e+06, loss_total = 2.81e+06
Step 45 : gram_loss = 2.71e+06, loss_total = 2.71e+06
Step 46 : gram_loss = 2.57e+06, loss_total = 2.57e+06
Step 47 : gram_loss = 2.40e+06, loss_total = 2.40e+06
Step 48 : gram_loss = 2.30e+06, loss_total = 2.30e+06
Step 49 : gram_loss = 2.17e+06, loss_total = 2.17e+06
Step 50 : gram_loss = 2.11e+06, loss_total = 2.11e+06
Step 51 : gram_loss = 2.07e+06, loss_total = 2.07e+06
Step 52 : gram_loss = 1.96e+06, loss_total = 1.96e+06
Step 53 : gram_loss = 1.87e+06, loss_total = 1.87e+06
Step 54 : gram_loss = 1.81e+06, loss_total = 1.81e+06
Step 55 : gram_loss = 1.71e+06, loss_total = 1.71e+06
Step 56 : gram_loss = 1.68e+06, loss_total = 1.68e+06
Step 57 : gram_loss = 1.63e+06, loss_total = 1.63e+06
Step 58 : gram_loss = 1.56e+06, loss_total = 1.56e+06
Step 59 : gram_loss = 1.47e+06, loss_total = 1.47e+06
Step 60 : gram_loss = 1.42e+06, loss_total = 1.42e+06
Step 61 : gram_loss = 1.37e+06, loss_total = 1.37e+06
Step 62 : gram_loss = 1.36e+06, loss_total = 1.36e+06
Step 63 : gram_loss = 1.32e+06, loss_total = 1.32e+06
Step 64 : gram_loss = 1.30e+06, loss_total = 1.30e+06
Step 65 : gram_loss = 1.24e+06, loss_total = 1.24e+06
Step 66 : gram_loss = 1.19e+06, loss_total = 1.19e+06
Step 67 : gram_loss = 1.15e+06, loss_total = 1.15e+06
Step 68 : gram_loss = 1.11e+06, loss_total = 1.11e+06
Step 69 : gram_loss = 1.07e+06, loss_total = 1.07e+06
Step 70 : gram_loss = 1.05e+06, loss_total = 1.05e+06
Step 71 : gram_loss = 1.02e+06, loss_total = 1.02e+06
Step 72 : gram_loss = 1.00e+06, loss_total = 1.00e+06
Step 73 : gram_loss = 9.80e+05, loss_total = 9.80e+05
Step 74 : gram_loss = 9.34e+05, loss_total = 9.34e+05
Step 75 : gram_loss = 8.85e+05, loss_total = 8.85e+05
Step 76 : gram_loss = 8.60e+05, loss_total = 8.60e+05
Step 77 : gram_loss = 8.32e+05, loss_total = 8.32e+05
Step 78 : gram_loss = 8.20e+05, loss_total = 8.20e+05
Step 79 : gram_loss = 7.93e+05, loss_total = 7.93e+05
Step 80 : gram_loss = 7.74e+05, loss_total = 7.74e+05
Step 81 : gram_loss = 7.29e+05, loss_total = 7.29e+05
Step 82 : gram_loss = 7.13e+05, loss_total = 7.13e+05
Step 83 : gram_loss = 6.99e+05, loss_total = 6.99e+05
Step 84 : gram_loss = 6.86e+05, loss_total = 6.86e+05
Step 85 : gram_loss = 6.70e+05, loss_total = 6.70e+05
Step 86 : gram_loss = 6.49e+05, loss_total = 6.49e+05
Step 87 : gram_loss = 6.27e+05, loss_total = 6.27e+05
Step 88 : gram_loss = 6.12e+05, loss_total = 6.12e+05
Step 89 : gram_loss = 5.89e+05, loss_total = 5.89e+05
Step 90 : gram_loss = 5.71e+05, loss_total = 5.71e+05
Step 91 : gram_loss = 5.49e+05, loss_total = 5.49e+05
Step 92 : gram_loss = 5.38e+05, loss_total = 5.38e+05
Step 93 : gram_loss = 5.30e+05, loss_total = 5.30e+05
Step 94 : gram_loss = 5.21e+05, loss_total = 5.21e+05
Step 95 : gram_loss = 5.06e+05, loss_total = 5.06e+05
Step 96 : gram_loss = 4.95e+05, loss_total = 4.95e+05
Step 97 : gram_loss = 4.79e+05, loss_total = 4.79e+05
Step 98 : gram_loss = 4.58e+05, loss_total = 4.58e+05
Step 99 : gram_loss = 4.40e+05, loss_total = 4.40e+05
Step 100 : gram_loss = 4.36e+05, loss_total = 4.36e+05
Step 101 : gram_loss = 4.26e+05, loss_total = 4.26e+05
Step 102 : gram_loss = 4.22e+05, loss_total = 4.22e+05
Step 103 : gram_loss = 4.14e+05, loss_total = 4.14e+05
Step 104 : gram_loss = 4.03e+05, loss_total = 4.03e+05
Step 105 : gram_loss = 3.97e+05, loss_total = 3.97e+05
Step 106 : gram_loss = 3.85e+05, loss_total = 3.85e+05
Step 107 : gram_loss = 3.77e+05, loss_total = 3.77e+05
Step 108 : gram_loss = 3.68e+05, loss_total = 3.68e+05
Step 109 : gram_loss = 3.61e+05, loss_total = 3.61e+05
Step 110 : gram_loss = 3.57e+05, loss_total = 3.57e+05
Step 111 : gram_loss = 3.47e+05, loss_total = 3.47e+05
Step 112 : gram_loss = 3.37e+05, loss_total = 3.37e+05
Step 113 : gram_loss = 3.29e+05, loss_total = 3.29e+05
Step 114 : gram_loss = 3.24e+05, loss_total = 3.24e+05
Step 115 : gram_loss = 3.19e+05, loss_total = 3.19e+05
Step 116 : gram_loss = 3.16e+05, loss_total = 3.16e+05
Step 117 : gram_loss = 3.11e+05, loss_total = 3.11e+05
Step 118 : gram_loss = 3.00e+05, loss_total = 3.00e+05
Step 119 : gram_loss = 2.94e+05, loss_total = 2.94e+05
Step 120 : gram_loss = 2.85e+05, loss_total = 2.85e+05
Step 121 : gram_loss = 2.80e+05, loss_total = 2.80e+05
Step 122 : gram_loss = 2.76e+05, loss_total = 2.76e+05
Step 123 : gram_loss = 2.73e+05, loss_total = 2.73e+05
Step 124 : gram_loss = 2.69e+05, loss_total = 2.69e+05
Step 125 : gram_loss = 2.64e+05, loss_total = 2.64e+05
Step 126 : gram_loss = 2.57e+05, loss_total = 2.57e+05
Step 127 : gram_loss = 2.54e+05, loss_total = 2.54e+05
Step 128 : gram_loss = 2.51e+05, loss_total = 2.51e+05
Step 129 : gram_loss = 2.48e+05, loss_total = 2.48e+05
Step 130 : gram_loss = 2.44e+05, loss_total = 2.44e+05
Step 131 : gram_loss = 2.42e+05, loss_total = 2.42e+05
Step 132 : gram_loss = 2.39e+05, loss_total = 2.39e+05
Step 133 : gram_loss = 2.34e+05, loss_total = 2.34e+05
Step 134 : gram_loss = 2.28e+05, loss_total = 2.28e+05
Step 135 : gram_loss = 2.26e+05, loss_total = 2.26e+05
Step 136 : gram_loss = 2.21e+05, loss_total = 2.21e+05
Step 137 : gram_loss = 2.17e+05, loss_total = 2.17e+05
Step 138 : gram_loss = 2.15e+05, loss_total = 2.15e+05
Step 139 : gram_loss = 2.12e+05, loss_total = 2.12e+05
Step 140 : gram_loss = 2.10e+05, loss_total = 2.10e+05
Step 141 : gram_loss = 2.08e+05, loss_total = 2.08e+05
Step 142 : gram_loss = 2.03e+05, loss_total = 2.03e+05
Step 143 : gram_loss = 2.00e+05, loss_total = 2.00e+05
Step 144 : gram_loss = 1.95e+05, loss_total = 1.95e+05
Step 145 : gram_loss = 1.93e+05, loss_total = 1.93e+05
Step 146 : gram_loss = 1.92e+05, loss_total = 1.92e+05
Step 147 : gram_loss = 1.90e+05, loss_total = 1.90e+05
Step 148 : gram_loss = 1.88e+05, loss_total = 1.88e+05
Step 149 : gram_loss = 1.86e+05, loss_total = 1.86e+05
Step 150 : gram_loss = 1.85e+05, loss_total = 1.85e+05
Step 151 : gram_loss = 1.83e+05, loss_total = 1.83e+05
Step 152 : gram_loss = 1.81e+05, loss_total = 1.81e+05
Step 153 : gram_loss = 1.78e+05, loss_total = 1.78e+05
Step 154 : gram_loss = 1.75e+05, loss_total = 1.75e+05
Step 155 : gram_loss = 1.72e+05, loss_total = 1.72e+05
Step 156 : gram_loss = 1.70e+05, loss_total = 1.70e+05
Step 157 : gram_loss = 1.69e+05, loss_total = 1.69e+05
Step 158 : gram_loss = 1.67e+05, loss_total = 1.67e+05
Step 159 : gram_loss = 1.66e+05, loss_total = 1.66e+05
Step 160 : gram_loss = 1.64e+05, loss_total = 1.64e+05
Step 161 : gram_loss = 1.62e+05, loss_total = 1.62e+05
Step 162 : gram_loss = 1.60e+05, loss_total = 1.60e+05
Step 163 : gram_loss = 1.59e+05, loss_total = 1.59e+05
Step 164 : gram_loss = 1.57e+05, loss_total = 1.57e+05
Step 165 : gram_loss = 1.55e+05, loss_total = 1.55e+05
Step 166 : gram_loss = 1.54e+05, loss_total = 1.54e+05
Step 167 : gram_loss = 1.52e+05, loss_total = 1.52e+05
Step 168 : gram_loss = 1.50e+05, loss_total = 1.50e+05
Step 169 : gram_loss = 1.48e+05, loss_total = 1.48e+05
Step 170 : gram_loss = 1.46e+05, loss_total = 1.46e+05
Step 171 : gram_loss = 1.44e+05, loss_total = 1.44e+05
Step 172 : gram_loss = 1.43e+05, loss_total = 1.43e+05
Step 173 : gram_loss = 1.42e+05, loss_total = 1.42e+05
Step 174 : gram_loss = 1.41e+05, loss_total = 1.41e+05
Step 175 : gram_loss = 1.40e+05, loss_total = 1.40e+05
Step 176 : gram_loss = 1.38e+05, loss_total = 1.38e+05
Step 177 : gram_loss = 1.38e+05, loss_total = 1.38e+05
Step 178 : gram_loss = 1.37e+05, loss_total = 1.37e+05
Step 179 : gram_loss = 1.35e+05, loss_total = 1.35e+05
Step 180 : gram_loss = 1.34e+05, loss_total = 1.34e+05
Step 181 : gram_loss = 1.32e+05, loss_total = 1.32e+05
Step 182 : gram_loss = 1.32e+05, loss_total = 1.32e+05
Step 183 : gram_loss = 1.31e+05, loss_total = 1.31e+05
Step 184 : gram_loss = 1.30e+05, loss_total = 1.30e+05
Step 185 : gram_loss = 1.28e+05, loss_total = 1.28e+05
Step 186 : gram_loss = 1.27e+05, loss_total = 1.27e+05
Step 187 : gram_loss = 1.26e+05, loss_total = 1.26e+05
Step 188 : gram_loss = 1.25e+05, loss_total = 1.25e+05
Step 189 : gram_loss = 1.23e+05, loss_total = 1.23e+05
Step 190 : gram_loss = 1.22e+05, loss_total = 1.22e+05
Step 191 : gram_loss = 1.21e+05, loss_total = 1.21e+05
Step 192 : gram_loss = 1.20e+05, loss_total = 1.20e+05
Step 193 : gram_loss = 1.19e+05, loss_total = 1.19e+05
Step 194 : gram_loss = 1.19e+05, loss_total = 1.19e+05
Step 195 : gram_loss = 1.18e+05, loss_total = 1.18e+05
Step 196 : gram_loss = 1.16e+05, loss_total = 1.16e+05
Step 197 : gram_loss = 1.16e+05, loss_total = 1.16e+05
Step 198 : gram_loss = 1.15e+05, loss_total = 1.15e+05
Step 199 : gram_loss = 1.14e+05, loss_total = 1.14e+05
Step 200 : gram_loss = 1.14e+05, loss_total = 1.14e+05
Close Sess - End of the global optimization.
Computation total for  111.15754270553589  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0036_1_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0036_1_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0036_1_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0036_1_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0036_1_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0036_1_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.250135898590088  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 3.54e+09, loss_total = 3.54e+09
Step 1 : gram_loss = 2.45e+09, loss_total = 2.45e+09
Step 2 : gram_loss = 2.36e+09, loss_total = 2.36e+09
Step 3 : gram_loss = 1.68e+09, loss_total = 1.68e+09
Step 4 : gram_loss = 9.38e+08, loss_total = 9.38e+08
Step 5 : gram_loss = 4.01e+08, loss_total = 4.01e+08
Step 6 : gram_loss = 3.29e+08, loss_total = 3.29e+08
Step 7 : gram_loss = 2.23e+08, loss_total = 2.23e+08
Step 8 : gram_loss = 1.73e+08, loss_total = 1.73e+08
Step 9 : gram_loss = 1.46e+08, loss_total = 1.46e+08
Step 10 : gram_loss = 1.24e+08, loss_total = 1.24e+08
Step 11 : gram_loss = 1.08e+08, loss_total = 1.08e+08
Step 12 : gram_loss = 7.88e+07, loss_total = 7.88e+07
Step 13 : gram_loss = 7.00e+07, loss_total = 7.00e+07
Step 14 : gram_loss = 6.25e+07, loss_total = 6.25e+07
Step 15 : gram_loss = 5.36e+07, loss_total = 5.36e+07
Step 16 : gram_loss = 4.84e+07, loss_total = 4.84e+07
Step 17 : gram_loss = 4.28e+07, loss_total = 4.28e+07
Step 18 : gram_loss = 3.51e+07, loss_total = 3.51e+07
Step 19 : gram_loss = 3.18e+07, loss_total = 3.18e+07
Step 20 : gram_loss = 2.81e+07, loss_total = 2.81e+07
Step 21 : gram_loss = 2.63e+07, loss_total = 2.63e+07
Step 22 : gram_loss = 2.44e+07, loss_total = 2.44e+07
Step 23 : gram_loss = 2.29e+07, loss_total = 2.29e+07
Step 24 : gram_loss = 2.00e+07, loss_total = 2.00e+07
Step 25 : gram_loss = 1.84e+07, loss_total = 1.84e+07
Step 26 : gram_loss = 1.73e+07, loss_total = 1.73e+07
Step 27 : gram_loss = 1.66e+07, loss_total = 1.66e+07
Step 28 : gram_loss = 1.60e+07, loss_total = 1.60e+07
Step 29 : gram_loss = 1.54e+07, loss_total = 1.54e+07
Step 30 : gram_loss = 1.49e+07, loss_total = 1.49e+07
Step 31 : gram_loss = 1.40e+07, loss_total = 1.40e+07
Step 32 : gram_loss = 1.28e+07, loss_total = 1.28e+07
Step 33 : gram_loss = 1.22e+07, loss_total = 1.22e+07
Step 34 : gram_loss = 1.17e+07, loss_total = 1.17e+07
Step 35 : gram_loss = 1.13e+07, loss_total = 1.13e+07
Step 36 : gram_loss = 1.10e+07, loss_total = 1.10e+07
Step 37 : gram_loss = 1.03e+07, loss_total = 1.03e+07
Step 38 : gram_loss = 9.43e+06, loss_total = 9.43e+06
Step 39 : gram_loss = 8.67e+06, loss_total = 8.67e+06
Step 40 : gram_loss = 8.21e+06, loss_total = 8.21e+06
Step 41 : gram_loss = 7.96e+06, loss_total = 7.96e+06
Step 42 : gram_loss = 7.48e+06, loss_total = 7.48e+06
Step 43 : gram_loss = 7.19e+06, loss_total = 7.19e+06
Step 44 : gram_loss = 6.72e+06, loss_total = 6.72e+06
Step 45 : gram_loss = 6.18e+06, loss_total = 6.18e+06
Step 46 : gram_loss = 5.87e+06, loss_total = 5.87e+06
Step 47 : gram_loss = 5.38e+06, loss_total = 5.38e+06
Step 48 : gram_loss = 5.21e+06, loss_total = 5.21e+06
Step 49 : gram_loss = 4.94e+06, loss_total = 4.94e+06
Step 50 : gram_loss = 4.73e+06, loss_total = 4.73e+06
Step 51 : gram_loss = 4.39e+06, loss_total = 4.39e+06
Step 52 : gram_loss = 4.17e+06, loss_total = 4.17e+06
Step 53 : gram_loss = 3.97e+06, loss_total = 3.97e+06
Step 54 : gram_loss = 3.82e+06, loss_total = 3.82e+06
Step 55 : gram_loss = 3.70e+06, loss_total = 3.70e+06
Step 56 : gram_loss = 3.43e+06, loss_total = 3.43e+06
Step 57 : gram_loss = 3.10e+06, loss_total = 3.10e+06
Step 58 : gram_loss = 2.88e+06, loss_total = 2.88e+06
Step 59 : gram_loss = 2.65e+06, loss_total = 2.65e+06
Step 60 : gram_loss = 2.53e+06, loss_total = 2.53e+06
Step 61 : gram_loss = 2.48e+06, loss_total = 2.48e+06
Step 62 : gram_loss = 2.40e+06, loss_total = 2.40e+06
Step 63 : gram_loss = 2.29e+06, loss_total = 2.29e+06
Step 64 : gram_loss = 2.11e+06, loss_total = 2.11e+06
Step 65 : gram_loss = 1.97e+06, loss_total = 1.97e+06
Step 66 : gram_loss = 1.83e+06, loss_total = 1.83e+06
Step 67 : gram_loss = 1.78e+06, loss_total = 1.78e+06
Step 68 : gram_loss = 1.67e+06, loss_total = 1.67e+06
Step 69 : gram_loss = 1.59e+06, loss_total = 1.59e+06
Step 70 : gram_loss = 1.43e+06, loss_total = 1.43e+06
Step 71 : gram_loss = 1.29e+06, loss_total = 1.29e+06
Step 72 : gram_loss = 1.20e+06, loss_total = 1.20e+06
Step 73 : gram_loss = 1.12e+06, loss_total = 1.12e+06
Step 74 : gram_loss = 1.02e+06, loss_total = 1.02e+06
Step 75 : gram_loss = 9.32e+05, loss_total = 9.32e+05
Step 76 : gram_loss = 8.96e+05, loss_total = 8.96e+05
Step 77 : gram_loss = 8.66e+05, loss_total = 8.66e+05
Step 78 : gram_loss = 8.35e+05, loss_total = 8.35e+05
Step 79 : gram_loss = 7.70e+05, loss_total = 7.70e+05
Step 80 : gram_loss = 7.27e+05, loss_total = 7.27e+05
Step 81 : gram_loss = 6.88e+05, loss_total = 6.88e+05
Step 82 : gram_loss = 6.64e+05, loss_total = 6.64e+05
Step 83 : gram_loss = 6.36e+05, loss_total = 6.36e+05
Step 84 : gram_loss = 5.92e+05, loss_total = 5.92e+05
Step 85 : gram_loss = 5.75e+05, loss_total = 5.75e+05
Step 86 : gram_loss = 5.57e+05, loss_total = 5.57e+05
Step 87 : gram_loss = 5.43e+05, loss_total = 5.43e+05
Step 88 : gram_loss = 5.28e+05, loss_total = 5.28e+05
Step 89 : gram_loss = 4.98e+05, loss_total = 4.98e+05
Step 90 : gram_loss = 4.68e+05, loss_total = 4.68e+05
Step 91 : gram_loss = 4.54e+05, loss_total = 4.54e+05
Step 92 : gram_loss = 4.43e+05, loss_total = 4.43e+05
Step 93 : gram_loss = 4.31e+05, loss_total = 4.31e+05
Step 94 : gram_loss = 4.20e+05, loss_total = 4.20e+05
Step 95 : gram_loss = 4.04e+05, loss_total = 4.04e+05
Step 96 : gram_loss = 3.91e+05, loss_total = 3.91e+05
Step 97 : gram_loss = 3.78e+05, loss_total = 3.78e+05
Step 98 : gram_loss = 3.71e+05, loss_total = 3.71e+05
Step 99 : gram_loss = 3.63e+05, loss_total = 3.63e+05
Step 100 : gram_loss = 3.54e+05, loss_total = 3.54e+05
Step 101 : gram_loss = 3.43e+05, loss_total = 3.43e+05
Step 102 : gram_loss = 3.31e+05, loss_total = 3.31e+05
Step 103 : gram_loss = 3.26e+05, loss_total = 3.26e+05
Step 104 : gram_loss = 3.21e+05, loss_total = 3.21e+05
Step 105 : gram_loss = 3.17e+05, loss_total = 3.17e+05
Step 106 : gram_loss = 3.11e+05, loss_total = 3.11e+05
Step 107 : gram_loss = 3.04e+05, loss_total = 3.04e+05
Step 108 : gram_loss = 2.92e+05, loss_total = 2.92e+05
Step 109 : gram_loss = 2.91e+05, loss_total = 2.91e+05
Step 110 : gram_loss = 2.78e+05, loss_total = 2.78e+05
Step 111 : gram_loss = 2.75e+05, loss_total = 2.75e+05
Step 112 : gram_loss = 2.72e+05, loss_total = 2.72e+05
Step 113 : gram_loss = 2.65e+05, loss_total = 2.65e+05
Step 114 : gram_loss = 2.58e+05, loss_total = 2.58e+05
Step 115 : gram_loss = 2.53e+05, loss_total = 2.53e+05
Step 116 : gram_loss = 2.50e+05, loss_total = 2.50e+05
Step 117 : gram_loss = 2.47e+05, loss_total = 2.47e+05
Step 118 : gram_loss = 2.44e+05, loss_total = 2.44e+05
Step 119 : gram_loss = 2.35e+05, loss_total = 2.35e+05
Step 120 : gram_loss = 2.33e+05, loss_total = 2.33e+05
Step 121 : gram_loss = 2.31e+05, loss_total = 2.31e+05
Step 122 : gram_loss = 2.28e+05, loss_total = 2.28e+05
Step 123 : gram_loss = 2.24e+05, loss_total = 2.24e+05
Step 124 : gram_loss = 2.20e+05, loss_total = 2.20e+05
Step 125 : gram_loss = 2.16e+05, loss_total = 2.16e+05
Step 126 : gram_loss = 2.11e+05, loss_total = 2.11e+05
Step 127 : gram_loss = 2.08e+05, loss_total = 2.08e+05
Step 128 : gram_loss = 2.06e+05, loss_total = 2.06e+05
Step 129 : gram_loss = 2.04e+05, loss_total = 2.04e+05
Step 130 : gram_loss = 2.00e+05, loss_total = 2.00e+05
Step 131 : gram_loss = 1.96e+05, loss_total = 1.96e+05
Step 132 : gram_loss = 1.92e+05, loss_total = 1.92e+05
Step 133 : gram_loss = 1.88e+05, loss_total = 1.88e+05
Step 134 : gram_loss = 1.86e+05, loss_total = 1.86e+05
Step 135 : gram_loss = 1.84e+05, loss_total = 1.84e+05
Step 136 : gram_loss = 1.82e+05, loss_total = 1.82e+05
Step 137 : gram_loss = 1.80e+05, loss_total = 1.80e+05
Step 138 : gram_loss = 1.78e+05, loss_total = 1.78e+05
Step 139 : gram_loss = 1.76e+05, loss_total = 1.76e+05
Step 140 : gram_loss = 1.75e+05, loss_total = 1.75e+05
Step 141 : gram_loss = 1.72e+05, loss_total = 1.72e+05
Step 142 : gram_loss = 1.71e+05, loss_total = 1.71e+05
Step 143 : gram_loss = 1.70e+05, loss_total = 1.70e+05
Step 144 : gram_loss = 1.68e+05, loss_total = 1.68e+05
Step 145 : gram_loss = 1.65e+05, loss_total = 1.65e+05
Step 146 : gram_loss = 1.64e+05, loss_total = 1.64e+05
Step 147 : gram_loss = 1.62e+05, loss_total = 1.62e+05
Step 148 : gram_loss = 1.61e+05, loss_total = 1.61e+05
Step 149 : gram_loss = 1.59e+05, loss_total = 1.59e+05
Step 150 : gram_loss = 1.58e+05, loss_total = 1.58e+05
Step 151 : gram_loss = 1.56e+05, loss_total = 1.56e+05
Step 152 : gram_loss = 1.54e+05, loss_total = 1.54e+05
Step 153 : gram_loss = 1.52e+05, loss_total = 1.52e+05
Step 154 : gram_loss = 1.51e+05, loss_total = 1.51e+05
Step 155 : gram_loss = 1.50e+05, loss_total = 1.50e+05
Step 156 : gram_loss = 1.49e+05, loss_total = 1.49e+05
Step 157 : gram_loss = 1.47e+05, loss_total = 1.47e+05
Step 158 : gram_loss = 1.46e+05, loss_total = 1.46e+05
Step 159 : gram_loss = 1.44e+05, loss_total = 1.44e+05
Step 160 : gram_loss = 1.43e+05, loss_total = 1.43e+05
Step 161 : gram_loss = 1.42e+05, loss_total = 1.42e+05
Step 162 : gram_loss = 1.40e+05, loss_total = 1.40e+05
Step 163 : gram_loss = 1.39e+05, loss_total = 1.39e+05
Step 164 : gram_loss = 1.38e+05, loss_total = 1.38e+05
Step 165 : gram_loss = 1.38e+05, loss_total = 1.38e+05
Step 166 : gram_loss = 1.37e+05, loss_total = 1.37e+05
Step 167 : gram_loss = 1.36e+05, loss_total = 1.36e+05
Step 168 : gram_loss = 1.35e+05, loss_total = 1.35e+05
Step 169 : gram_loss = 1.34e+05, loss_total = 1.34e+05
Step 170 : gram_loss = 1.32e+05, loss_total = 1.32e+05
Step 171 : gram_loss = 1.31e+05, loss_total = 1.31e+05
Step 172 : gram_loss = 1.30e+05, loss_total = 1.30e+05
Step 173 : gram_loss = 1.29e+05, loss_total = 1.29e+05
Step 174 : gram_loss = 1.28e+05, loss_total = 1.28e+05
Step 175 : gram_loss = 1.27e+05, loss_total = 1.27e+05
Step 176 : gram_loss = 1.26e+05, loss_total = 1.26e+05
Step 177 : gram_loss = 1.26e+05, loss_total = 1.26e+05
Step 178 : gram_loss = 1.24e+05, loss_total = 1.24e+05
Step 179 : gram_loss = 1.24e+05, loss_total = 1.24e+05
Step 180 : gram_loss = 1.22e+05, loss_total = 1.22e+05
Step 181 : gram_loss = 1.22e+05, loss_total = 1.22e+05
Step 182 : gram_loss = 1.21e+05, loss_total = 1.21e+05
Step 183 : gram_loss = 1.20e+05, loss_total = 1.20e+05
Step 184 : gram_loss = 1.20e+05, loss_total = 1.20e+05
Step 185 : gram_loss = 1.18e+05, loss_total = 1.18e+05
Step 186 : gram_loss = 1.18e+05, loss_total = 1.18e+05
Step 187 : gram_loss = 1.17e+05, loss_total = 1.17e+05
Step 188 : gram_loss = 1.17e+05, loss_total = 1.17e+05
Step 189 : gram_loss = 1.16e+05, loss_total = 1.16e+05
Step 190 : gram_loss = 1.16e+05, loss_total = 1.16e+05
Step 191 : gram_loss = 1.15e+05, loss_total = 1.15e+05
Step 192 : gram_loss = 1.14e+05, loss_total = 1.14e+05
Step 193 : gram_loss = 1.13e+05, loss_total = 1.13e+05
Step 194 : gram_loss = 1.12e+05, loss_total = 1.12e+05
Step 195 : gram_loss = 1.12e+05, loss_total = 1.12e+05
Step 196 : gram_loss = 1.11e+05, loss_total = 1.11e+05
Step 197 : gram_loss = 1.11e+05, loss_total = 1.11e+05
Step 198 : gram_loss = 1.10e+05, loss_total = 1.10e+05
Step 199 : gram_loss = 1.09e+05, loss_total = 1.09e+05
Step 200 : gram_loss = 1.09e+05, loss_total = 1.09e+05
Close Sess - End of the global optimization.
Computation total for  108.17241621017456  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0020_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0020_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0020_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0020_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0020_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0020_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.421700477600098  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 2.94e+09, loss_total = 2.94e+09
Step 1 : gram_loss = 1.31e+09, loss_total = 1.31e+09
Step 2 : gram_loss = 1.30e+09, loss_total = 1.30e+09
Step 3 : gram_loss = 7.75e+08, loss_total = 7.75e+08
Step 4 : gram_loss = 3.68e+08, loss_total = 3.68e+08
Step 5 : gram_loss = 2.85e+08, loss_total = 2.85e+08
Step 6 : gram_loss = 2.62e+08, loss_total = 2.62e+08
Step 7 : gram_loss = 2.00e+08, loss_total = 2.00e+08
Step 8 : gram_loss = 1.65e+08, loss_total = 1.65e+08
Step 9 : gram_loss = 1.33e+08, loss_total = 1.33e+08
Step 10 : gram_loss = 1.16e+08, loss_total = 1.16e+08
Step 11 : gram_loss = 9.84e+07, loss_total = 9.84e+07
Step 12 : gram_loss = 8.15e+07, loss_total = 8.15e+07
Step 13 : gram_loss = 7.08e+07, loss_total = 7.08e+07
Step 14 : gram_loss = 6.11e+07, loss_total = 6.11e+07
Step 15 : gram_loss = 5.74e+07, loss_total = 5.74e+07
Step 16 : gram_loss = 5.10e+07, loss_total = 5.10e+07
Step 17 : gram_loss = 4.85e+07, loss_total = 4.85e+07
Step 18 : gram_loss = 4.40e+07, loss_total = 4.40e+07
Step 19 : gram_loss = 4.08e+07, loss_total = 4.08e+07
Step 20 : gram_loss = 3.89e+07, loss_total = 3.89e+07
Step 21 : gram_loss = 3.52e+07, loss_total = 3.52e+07
Step 22 : gram_loss = 3.24e+07, loss_total = 3.24e+07
Step 23 : gram_loss = 2.87e+07, loss_total = 2.87e+07
Step 24 : gram_loss = 2.59e+07, loss_total = 2.59e+07
Step 25 : gram_loss = 2.36e+07, loss_total = 2.36e+07
Step 26 : gram_loss = 2.23e+07, loss_total = 2.23e+07
Step 27 : gram_loss = 2.19e+07, loss_total = 2.19e+07
Step 28 : gram_loss = 2.12e+07, loss_total = 2.12e+07
Step 29 : gram_loss = 2.03e+07, loss_total = 2.03e+07
Step 30 : gram_loss = 1.94e+07, loss_total = 1.94e+07
Step 31 : gram_loss = 1.86e+07, loss_total = 1.86e+07
Step 32 : gram_loss = 1.75e+07, loss_total = 1.75e+07
Step 33 : gram_loss = 1.67e+07, loss_total = 1.67e+07
Step 34 : gram_loss = 1.62e+07, loss_total = 1.62e+07
Step 35 : gram_loss = 1.54e+07, loss_total = 1.54e+07
Step 36 : gram_loss = 1.48e+07, loss_total = 1.48e+07
Step 37 : gram_loss = 1.42e+07, loss_total = 1.42e+07
Step 38 : gram_loss = 1.39e+07, loss_total = 1.39e+07
Step 39 : gram_loss = 1.36e+07, loss_total = 1.36e+07
Step 40 : gram_loss = 1.32e+07, loss_total = 1.32e+07
Step 41 : gram_loss = 1.25e+07, loss_total = 1.25e+07
Step 42 : gram_loss = 1.19e+07, loss_total = 1.19e+07
Step 43 : gram_loss = 1.15e+07, loss_total = 1.15e+07
Step 44 : gram_loss = 1.11e+07, loss_total = 1.11e+07
Step 45 : gram_loss = 1.09e+07, loss_total = 1.09e+07
Step 46 : gram_loss = 1.05e+07, loss_total = 1.05e+07
Step 47 : gram_loss = 1.00e+07, loss_total = 1.00e+07
Step 48 : gram_loss = 9.63e+06, loss_total = 9.63e+06
Step 49 : gram_loss = 9.36e+06, loss_total = 9.36e+06
Step 50 : gram_loss = 9.05e+06, loss_total = 9.05e+06
Step 51 : gram_loss = 8.92e+06, loss_total = 8.92e+06
Step 52 : gram_loss = 8.58e+06, loss_total = 8.58e+06
Step 53 : gram_loss = 8.24e+06, loss_total = 8.24e+06
Step 54 : gram_loss = 7.99e+06, loss_total = 7.99e+06
Step 55 : gram_loss = 7.65e+06, loss_total = 7.65e+06
Step 56 : gram_loss = 7.40e+06, loss_total = 7.40e+06
Step 57 : gram_loss = 7.13e+06, loss_total = 7.13e+06
Step 58 : gram_loss = 6.96e+06, loss_total = 6.96e+06
Step 59 : gram_loss = 6.76e+06, loss_total = 6.76e+06
Step 60 : gram_loss = 6.53e+06, loss_total = 6.53e+06
Step 61 : gram_loss = 6.25e+06, loss_total = 6.25e+06
Step 62 : gram_loss = 5.92e+06, loss_total = 5.92e+06
Step 63 : gram_loss = 5.59e+06, loss_total = 5.59e+06
Step 64 : gram_loss = 5.37e+06, loss_total = 5.37e+06
Step 65 : gram_loss = 5.08e+06, loss_total = 5.08e+06
Step 66 : gram_loss = 4.85e+06, loss_total = 4.85e+06
Step 67 : gram_loss = 4.76e+06, loss_total = 4.76e+06
Step 68 : gram_loss = 4.60e+06, loss_total = 4.60e+06
Step 69 : gram_loss = 4.41e+06, loss_total = 4.41e+06
Step 70 : gram_loss = 4.20e+06, loss_total = 4.20e+06
Step 71 : gram_loss = 4.06e+06, loss_total = 4.06e+06
Step 72 : gram_loss = 3.86e+06, loss_total = 3.86e+06
Step 73 : gram_loss = 3.71e+06, loss_total = 3.71e+06
Step 74 : gram_loss = 3.51e+06, loss_total = 3.51e+06
Step 75 : gram_loss = 3.37e+06, loss_total = 3.37e+06
Step 76 : gram_loss = 3.21e+06, loss_total = 3.21e+06
Step 77 : gram_loss = 3.02e+06, loss_total = 3.02e+06
Step 78 : gram_loss = 2.84e+06, loss_total = 2.84e+06
Step 79 : gram_loss = 2.70e+06, loss_total = 2.70e+06
Step 80 : gram_loss = 2.64e+06, loss_total = 2.64e+06
Step 81 : gram_loss = 2.57e+06, loss_total = 2.57e+06
Step 82 : gram_loss = 2.52e+06, loss_total = 2.52e+06
Step 83 : gram_loss = 2.41e+06, loss_total = 2.41e+06
Step 84 : gram_loss = 2.25e+06, loss_total = 2.25e+06
Step 85 : gram_loss = 2.09e+06, loss_total = 2.09e+06
Step 86 : gram_loss = 1.94e+06, loss_total = 1.94e+06
Step 87 : gram_loss = 1.89e+06, loss_total = 1.89e+06
Step 88 : gram_loss = 1.83e+06, loss_total = 1.83e+06
Step 89 : gram_loss = 1.79e+06, loss_total = 1.79e+06
Step 90 : gram_loss = 1.70e+06, loss_total = 1.70e+06
Step 91 : gram_loss = 1.57e+06, loss_total = 1.57e+06
Step 92 : gram_loss = 1.52e+06, loss_total = 1.52e+06
Step 93 : gram_loss = 1.42e+06, loss_total = 1.42e+06
Step 94 : gram_loss = 1.38e+06, loss_total = 1.38e+06
Step 95 : gram_loss = 1.34e+06, loss_total = 1.34e+06
Step 96 : gram_loss = 1.31e+06, loss_total = 1.31e+06
Step 97 : gram_loss = 1.21e+06, loss_total = 1.21e+06
Step 98 : gram_loss = 1.16e+06, loss_total = 1.16e+06
Step 99 : gram_loss = 1.12e+06, loss_total = 1.12e+06
Step 100 : gram_loss = 1.08e+06, loss_total = 1.08e+06
Step 101 : gram_loss = 1.02e+06, loss_total = 1.02e+06
Step 102 : gram_loss = 9.87e+05, loss_total = 9.87e+05
Step 103 : gram_loss = 9.34e+05, loss_total = 9.34e+05
Step 104 : gram_loss = 9.07e+05, loss_total = 9.07e+05
Step 105 : gram_loss = 8.88e+05, loss_total = 8.88e+05
Step 106 : gram_loss = 8.58e+05, loss_total = 8.58e+05
Step 107 : gram_loss = 8.27e+05, loss_total = 8.27e+05
Step 108 : gram_loss = 7.91e+05, loss_total = 7.91e+05
Step 109 : gram_loss = 7.68e+05, loss_total = 7.68e+05
Step 110 : gram_loss = 7.52e+05, loss_total = 7.52e+05
Step 111 : gram_loss = 7.31e+05, loss_total = 7.31e+05
Step 112 : gram_loss = 7.08e+05, loss_total = 7.08e+05
Step 113 : gram_loss = 6.81e+05, loss_total = 6.81e+05
Step 114 : gram_loss = 6.55e+05, loss_total = 6.55e+05
Step 115 : gram_loss = 6.40e+05, loss_total = 6.40e+05
Step 116 : gram_loss = 6.25e+05, loss_total = 6.25e+05
Step 117 : gram_loss = 6.08e+05, loss_total = 6.08e+05
Step 118 : gram_loss = 5.93e+05, loss_total = 5.93e+05
Step 119 : gram_loss = 5.73e+05, loss_total = 5.73e+05
Step 120 : gram_loss = 5.62e+05, loss_total = 5.62e+05
Step 121 : gram_loss = 5.53e+05, loss_total = 5.53e+05
Step 122 : gram_loss = 5.44e+05, loss_total = 5.44e+05
Step 123 : gram_loss = 5.26e+05, loss_total = 5.26e+05
Step 124 : gram_loss = 5.14e+05, loss_total = 5.14e+05
Step 125 : gram_loss = 5.04e+05, loss_total = 5.04e+05
Step 126 : gram_loss = 4.94e+05, loss_total = 4.94e+05
Step 127 : gram_loss = 4.85e+05, loss_total = 4.85e+05
Step 128 : gram_loss = 4.77e+05, loss_total = 4.77e+05
Step 129 : gram_loss = 4.69e+05, loss_total = 4.69e+05
Step 130 : gram_loss = 4.59e+05, loss_total = 4.59e+05
Step 131 : gram_loss = 4.47e+05, loss_total = 4.47e+05
Step 132 : gram_loss = 4.38e+05, loss_total = 4.38e+05
Step 133 : gram_loss = 4.30e+05, loss_total = 4.30e+05
Step 134 : gram_loss = 4.23e+05, loss_total = 4.23e+05
Step 135 : gram_loss = 4.17e+05, loss_total = 4.17e+05
Step 136 : gram_loss = 4.09e+05, loss_total = 4.09e+05
Step 137 : gram_loss = 4.01e+05, loss_total = 4.01e+05
Step 138 : gram_loss = 3.92e+05, loss_total = 3.92e+05
Step 139 : gram_loss = 3.84e+05, loss_total = 3.84e+05
Step 140 : gram_loss = 3.77e+05, loss_total = 3.77e+05
Step 141 : gram_loss = 3.72e+05, loss_total = 3.72e+05
Step 142 : gram_loss = 3.69e+05, loss_total = 3.69e+05
Step 143 : gram_loss = 3.64e+05, loss_total = 3.64e+05
Step 144 : gram_loss = 3.60e+05, loss_total = 3.60e+05
Step 145 : gram_loss = 3.54e+05, loss_total = 3.54e+05
Step 146 : gram_loss = 3.49e+05, loss_total = 3.49e+05
Step 147 : gram_loss = 3.43e+05, loss_total = 3.43e+05
Step 148 : gram_loss = 3.40e+05, loss_total = 3.40e+05
Step 149 : gram_loss = 3.34e+05, loss_total = 3.34e+05
Step 150 : gram_loss = 3.30e+05, loss_total = 3.30e+05
Step 151 : gram_loss = 3.27e+05, loss_total = 3.27e+05
Step 152 : gram_loss = 3.24e+05, loss_total = 3.24e+05
Step 153 : gram_loss = 3.22e+05, loss_total = 3.22e+05
Step 154 : gram_loss = 3.17e+05, loss_total = 3.17e+05
Step 155 : gram_loss = 3.14e+05, loss_total = 3.14e+05
Step 156 : gram_loss = 3.08e+05, loss_total = 3.08e+05
Step 157 : gram_loss = 3.06e+05, loss_total = 3.06e+05
Step 158 : gram_loss = 3.03e+05, loss_total = 3.03e+05
Step 159 : gram_loss = 3.00e+05, loss_total = 3.00e+05
Step 160 : gram_loss = 2.96e+05, loss_total = 2.96e+05
Step 161 : gram_loss = 2.94e+05, loss_total = 2.94e+05
Step 162 : gram_loss = 2.92e+05, loss_total = 2.92e+05
Step 163 : gram_loss = 2.89e+05, loss_total = 2.89e+05
Step 164 : gram_loss = 2.87e+05, loss_total = 2.87e+05
Step 165 : gram_loss = 2.83e+05, loss_total = 2.83e+05
Step 166 : gram_loss = 2.81e+05, loss_total = 2.81e+05
Step 167 : gram_loss = 2.79e+05, loss_total = 2.79e+05
Step 168 : gram_loss = 2.76e+05, loss_total = 2.76e+05
Step 169 : gram_loss = 2.74e+05, loss_total = 2.74e+05
Step 170 : gram_loss = 2.73e+05, loss_total = 2.73e+05
Step 171 : gram_loss = 2.70e+05, loss_total = 2.70e+05
Step 172 : gram_loss = 2.67e+05, loss_total = 2.67e+05
Step 173 : gram_loss = 2.65e+05, loss_total = 2.65e+05
Step 174 : gram_loss = 2.62e+05, loss_total = 2.62e+05
Step 175 : gram_loss = 2.61e+05, loss_total = 2.61e+05
Step 176 : gram_loss = 2.58e+05, loss_total = 2.58e+05
Step 177 : gram_loss = 2.57e+05, loss_total = 2.57e+05
Step 178 : gram_loss = 2.55e+05, loss_total = 2.55e+05
Step 179 : gram_loss = 2.54e+05, loss_total = 2.54e+05
Step 180 : gram_loss = 2.53e+05, loss_total = 2.53e+05
Step 181 : gram_loss = 2.51e+05, loss_total = 2.51e+05
Step 182 : gram_loss = 2.49e+05, loss_total = 2.49e+05
Step 183 : gram_loss = 2.47e+05, loss_total = 2.47e+05
Step 184 : gram_loss = 2.45e+05, loss_total = 2.45e+05
Step 185 : gram_loss = 2.44e+05, loss_total = 2.44e+05
Step 186 : gram_loss = 2.42e+05, loss_total = 2.42e+05
Step 187 : gram_loss = 2.40e+05, loss_total = 2.40e+05
Step 188 : gram_loss = 2.38e+05, loss_total = 2.38e+05
Step 189 : gram_loss = 2.37e+05, loss_total = 2.37e+05
Step 190 : gram_loss = 2.36e+05, loss_total = 2.36e+05
Step 191 : gram_loss = 2.34e+05, loss_total = 2.34e+05
Step 192 : gram_loss = 2.33e+05, loss_total = 2.33e+05
Step 193 : gram_loss = 2.31e+05, loss_total = 2.31e+05
Step 194 : gram_loss = 2.30e+05, loss_total = 2.30e+05
Step 195 : gram_loss = 2.28e+05, loss_total = 2.28e+05
Step 196 : gram_loss = 2.27e+05, loss_total = 2.27e+05
Step 197 : gram_loss = 2.26e+05, loss_total = 2.26e+05
Step 198 : gram_loss = 2.25e+05, loss_total = 2.25e+05
Step 199 : gram_loss = 2.24e+05, loss_total = 2.24e+05
Step 200 : gram_loss = 2.23e+05, loss_total = 2.23e+05
Close Sess - End of the global optimization.
Computation total for  112.96917486190796  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0017_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0017_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0017_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0017_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0017_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0017_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.464395046234131  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 5.15e+09, loss_total = 5.15e+09
Step 1 : gram_loss = 1.42e+09, loss_total = 1.42e+09
Step 2 : gram_loss = 1.41e+09, loss_total = 1.41e+09
Step 3 : gram_loss = 8.67e+08, loss_total = 8.67e+08
Step 4 : gram_loss = 5.62e+08, loss_total = 5.62e+08
Step 5 : gram_loss = 3.73e+08, loss_total = 3.73e+08
Step 6 : gram_loss = 3.29e+08, loss_total = 3.29e+08
Step 7 : gram_loss = 2.58e+08, loss_total = 2.58e+08
Step 8 : gram_loss = 2.26e+08, loss_total = 2.26e+08
Step 9 : gram_loss = 1.86e+08, loss_total = 1.86e+08
Step 10 : gram_loss = 1.49e+08, loss_total = 1.49e+08
Step 11 : gram_loss = 1.16e+08, loss_total = 1.16e+08
Step 12 : gram_loss = 8.78e+07, loss_total = 8.78e+07
Step 13 : gram_loss = 6.08e+07, loss_total = 6.08e+07
Step 14 : gram_loss = 5.22e+07, loss_total = 5.22e+07
Step 15 : gram_loss = 4.25e+07, loss_total = 4.25e+07
Step 16 : gram_loss = 3.88e+07, loss_total = 3.88e+07
Step 17 : gram_loss = 3.70e+07, loss_total = 3.70e+07
Step 18 : gram_loss = 3.34e+07, loss_total = 3.34e+07
Step 19 : gram_loss = 3.03e+07, loss_total = 3.03e+07
Step 20 : gram_loss = 2.81e+07, loss_total = 2.81e+07
Step 21 : gram_loss = 2.45e+07, loss_total = 2.45e+07
Step 22 : gram_loss = 2.30e+07, loss_total = 2.30e+07
Step 23 : gram_loss = 2.00e+07, loss_total = 2.00e+07
Step 24 : gram_loss = 1.83e+07, loss_total = 1.83e+07
Step 25 : gram_loss = 1.69e+07, loss_total = 1.69e+07
Step 26 : gram_loss = 1.62e+07, loss_total = 1.62e+07
Step 27 : gram_loss = 1.52e+07, loss_total = 1.52e+07
Step 28 : gram_loss = 1.40e+07, loss_total = 1.40e+07
Step 29 : gram_loss = 1.26e+07, loss_total = 1.26e+07
Step 30 : gram_loss = 1.12e+07, loss_total = 1.12e+07
Step 31 : gram_loss = 1.01e+07, loss_total = 1.01e+07
Step 32 : gram_loss = 9.78e+06, loss_total = 9.78e+06
Step 33 : gram_loss = 9.45e+06, loss_total = 9.45e+06
Step 34 : gram_loss = 8.95e+06, loss_total = 8.95e+06
Step 35 : gram_loss = 8.63e+06, loss_total = 8.63e+06
Step 36 : gram_loss = 8.28e+06, loss_total = 8.28e+06
Step 37 : gram_loss = 7.67e+06, loss_total = 7.67e+06
Step 38 : gram_loss = 6.89e+06, loss_total = 6.89e+06
Step 39 : gram_loss = 6.47e+06, loss_total = 6.47e+06
Step 40 : gram_loss = 6.30e+06, loss_total = 6.30e+06
Step 41 : gram_loss = 6.08e+06, loss_total = 6.08e+06
Step 42 : gram_loss = 5.70e+06, loss_total = 5.70e+06
Step 43 : gram_loss = 5.31e+06, loss_total = 5.31e+06
Step 44 : gram_loss = 4.88e+06, loss_total = 4.88e+06
Step 45 : gram_loss = 4.54e+06, loss_total = 4.54e+06
Step 46 : gram_loss = 4.32e+06, loss_total = 4.32e+06
Step 47 : gram_loss = 4.14e+06, loss_total = 4.14e+06
Step 48 : gram_loss = 3.85e+06, loss_total = 3.85e+06
Step 49 : gram_loss = 3.57e+06, loss_total = 3.57e+06
Step 50 : gram_loss = 3.27e+06, loss_total = 3.27e+06
Step 51 : gram_loss = 3.10e+06, loss_total = 3.10e+06
Step 52 : gram_loss = 2.96e+06, loss_total = 2.96e+06
Step 53 : gram_loss = 2.83e+06, loss_total = 2.83e+06
Step 54 : gram_loss = 2.71e+06, loss_total = 2.71e+06
Step 55 : gram_loss = 2.60e+06, loss_total = 2.60e+06
Step 56 : gram_loss = 2.37e+06, loss_total = 2.37e+06
Step 57 : gram_loss = 2.27e+06, loss_total = 2.27e+06
Step 58 : gram_loss = 2.17e+06, loss_total = 2.17e+06
Step 59 : gram_loss = 2.05e+06, loss_total = 2.05e+06
Step 60 : gram_loss = 1.98e+06, loss_total = 1.98e+06
Step 61 : gram_loss = 1.92e+06, loss_total = 1.92e+06
Step 62 : gram_loss = 1.80e+06, loss_total = 1.80e+06
Step 63 : gram_loss = 1.70e+06, loss_total = 1.70e+06
Step 64 : gram_loss = 1.56e+06, loss_total = 1.56e+06
Step 65 : gram_loss = 1.49e+06, loss_total = 1.49e+06
Step 66 : gram_loss = 1.43e+06, loss_total = 1.43e+06
Step 67 : gram_loss = 1.38e+06, loss_total = 1.38e+06
Step 68 : gram_loss = 1.35e+06, loss_total = 1.35e+06
Step 69 : gram_loss = 1.28e+06, loss_total = 1.28e+06
Step 70 : gram_loss = 1.23e+06, loss_total = 1.23e+06
Step 71 : gram_loss = 1.15e+06, loss_total = 1.15e+06
Step 72 : gram_loss = 1.08e+06, loss_total = 1.08e+06
Step 73 : gram_loss = 1.05e+06, loss_total = 1.05e+06
Step 74 : gram_loss = 9.90e+05, loss_total = 9.90e+05
Step 75 : gram_loss = 9.63e+05, loss_total = 9.63e+05
Step 76 : gram_loss = 9.29e+05, loss_total = 9.29e+05
Step 77 : gram_loss = 8.96e+05, loss_total = 8.96e+05
Step 78 : gram_loss = 8.38e+05, loss_total = 8.38e+05
Step 79 : gram_loss = 8.18e+05, loss_total = 8.18e+05
Step 80 : gram_loss = 7.67e+05, loss_total = 7.67e+05
Step 81 : gram_loss = 7.47e+05, loss_total = 7.47e+05
Step 82 : gram_loss = 7.27e+05, loss_total = 7.27e+05
Step 83 : gram_loss = 7.04e+05, loss_total = 7.04e+05
Step 84 : gram_loss = 6.74e+05, loss_total = 6.74e+05
Step 85 : gram_loss = 6.39e+05, loss_total = 6.39e+05
Step 86 : gram_loss = 6.22e+05, loss_total = 6.22e+05
Step 87 : gram_loss = 5.98e+05, loss_total = 5.98e+05
Step 88 : gram_loss = 5.88e+05, loss_total = 5.88e+05
Step 89 : gram_loss = 5.75e+05, loss_total = 5.75e+05
Step 90 : gram_loss = 5.48e+05, loss_total = 5.48e+05
Step 91 : gram_loss = 5.32e+05, loss_total = 5.32e+05
Step 92 : gram_loss = 5.21e+05, loss_total = 5.21e+05
Step 93 : gram_loss = 5.12e+05, loss_total = 5.12e+05
Step 94 : gram_loss = 4.99e+05, loss_total = 4.99e+05
Step 95 : gram_loss = 4.74e+05, loss_total = 4.74e+05
Step 96 : gram_loss = 4.56e+05, loss_total = 4.56e+05
Step 97 : gram_loss = 4.45e+05, loss_total = 4.45e+05
Step 98 : gram_loss = 4.33e+05, loss_total = 4.33e+05
Step 99 : gram_loss = 4.18e+05, loss_total = 4.18e+05
Step 100 : gram_loss = 4.06e+05, loss_total = 4.06e+05
Step 101 : gram_loss = 3.98e+05, loss_total = 3.98e+05
Step 102 : gram_loss = 3.92e+05, loss_total = 3.92e+05
Step 103 : gram_loss = 3.80e+05, loss_total = 3.80e+05
Step 104 : gram_loss = 3.69e+05, loss_total = 3.69e+05
Step 105 : gram_loss = 3.52e+05, loss_total = 3.52e+05
Step 106 : gram_loss = 3.48e+05, loss_total = 3.48e+05
Step 107 : gram_loss = 3.35e+05, loss_total = 3.35e+05
Step 108 : gram_loss = 3.31e+05, loss_total = 3.31e+05
Step 109 : gram_loss = 3.27e+05, loss_total = 3.27e+05
Step 110 : gram_loss = 3.20e+05, loss_total = 3.20e+05
Step 111 : gram_loss = 3.12e+05, loss_total = 3.12e+05
Step 112 : gram_loss = 3.05e+05, loss_total = 3.05e+05
Step 113 : gram_loss = 2.96e+05, loss_total = 2.96e+05
Step 114 : gram_loss = 2.91e+05, loss_total = 2.91e+05
Step 115 : gram_loss = 2.87e+05, loss_total = 2.87e+05
Step 116 : gram_loss = 2.84e+05, loss_total = 2.84e+05
Step 117 : gram_loss = 2.81e+05, loss_total = 2.81e+05
Step 118 : gram_loss = 2.78e+05, loss_total = 2.78e+05
Step 119 : gram_loss = 2.72e+05, loss_total = 2.72e+05
Step 120 : gram_loss = 2.69e+05, loss_total = 2.69e+05
Step 121 : gram_loss = 2.65e+05, loss_total = 2.65e+05
Step 122 : gram_loss = 2.58e+05, loss_total = 2.58e+05
Step 123 : gram_loss = 2.54e+05, loss_total = 2.54e+05
Step 124 : gram_loss = 2.49e+05, loss_total = 2.49e+05
Step 125 : gram_loss = 2.46e+05, loss_total = 2.46e+05
Step 126 : gram_loss = 2.44e+05, loss_total = 2.44e+05
Step 127 : gram_loss = 2.40e+05, loss_total = 2.40e+05
Step 128 : gram_loss = 2.38e+05, loss_total = 2.38e+05
Step 129 : gram_loss = 2.35e+05, loss_total = 2.35e+05
Step 130 : gram_loss = 2.29e+05, loss_total = 2.29e+05
Step 131 : gram_loss = 2.23e+05, loss_total = 2.23e+05
Step 132 : gram_loss = 2.19e+05, loss_total = 2.19e+05
Step 133 : gram_loss = 2.14e+05, loss_total = 2.14e+05
Step 134 : gram_loss = 2.11e+05, loss_total = 2.11e+05
Step 135 : gram_loss = 2.06e+05, loss_total = 2.06e+05
Step 136 : gram_loss = 2.03e+05, loss_total = 2.03e+05
Step 137 : gram_loss = 2.00e+05, loss_total = 2.00e+05
Step 138 : gram_loss = 1.99e+05, loss_total = 1.99e+05
Step 139 : gram_loss = 1.97e+05, loss_total = 1.97e+05
Step 140 : gram_loss = 1.95e+05, loss_total = 1.95e+05
Step 141 : gram_loss = 1.92e+05, loss_total = 1.92e+05
Step 142 : gram_loss = 1.89e+05, loss_total = 1.89e+05
Step 143 : gram_loss = 1.87e+05, loss_total = 1.87e+05
Step 144 : gram_loss = 1.85e+05, loss_total = 1.85e+05
Step 145 : gram_loss = 1.83e+05, loss_total = 1.83e+05
Step 146 : gram_loss = 1.80e+05, loss_total = 1.80e+05
Step 147 : gram_loss = 1.77e+05, loss_total = 1.77e+05
Step 148 : gram_loss = 1.75e+05, loss_total = 1.75e+05
Step 149 : gram_loss = 1.74e+05, loss_total = 1.74e+05
Step 150 : gram_loss = 1.72e+05, loss_total = 1.72e+05
Step 151 : gram_loss = 1.69e+05, loss_total = 1.69e+05
Step 152 : gram_loss = 1.67e+05, loss_total = 1.67e+05
Step 153 : gram_loss = 1.66e+05, loss_total = 1.66e+05
Step 154 : gram_loss = 1.62e+05, loss_total = 1.62e+05
Step 155 : gram_loss = 1.62e+05, loss_total = 1.62e+05
Step 156 : gram_loss = 1.59e+05, loss_total = 1.59e+05
Step 157 : gram_loss = 1.58e+05, loss_total = 1.58e+05
Step 158 : gram_loss = 1.57e+05, loss_total = 1.57e+05
Step 159 : gram_loss = 1.56e+05, loss_total = 1.56e+05
Step 160 : gram_loss = 1.54e+05, loss_total = 1.54e+05
Step 161 : gram_loss = 1.52e+05, loss_total = 1.52e+05
Step 162 : gram_loss = 1.51e+05, loss_total = 1.51e+05
Step 163 : gram_loss = 1.50e+05, loss_total = 1.50e+05
Step 164 : gram_loss = 1.49e+05, loss_total = 1.49e+05
Step 165 : gram_loss = 1.47e+05, loss_total = 1.47e+05
Step 166 : gram_loss = 1.46e+05, loss_total = 1.46e+05
Step 167 : gram_loss = 1.44e+05, loss_total = 1.44e+05
Step 168 : gram_loss = 1.43e+05, loss_total = 1.43e+05
Step 169 : gram_loss = 1.42e+05, loss_total = 1.42e+05
Step 170 : gram_loss = 1.41e+05, loss_total = 1.41e+05
Step 171 : gram_loss = 1.40e+05, loss_total = 1.40e+05
Step 172 : gram_loss = 1.38e+05, loss_total = 1.38e+05
Step 173 : gram_loss = 1.37e+05, loss_total = 1.37e+05
Step 174 : gram_loss = 1.36e+05, loss_total = 1.36e+05
Step 175 : gram_loss = 1.35e+05, loss_total = 1.35e+05
Step 176 : gram_loss = 1.33e+05, loss_total = 1.33e+05
Step 177 : gram_loss = 1.31e+05, loss_total = 1.31e+05
Step 178 : gram_loss = 1.30e+05, loss_total = 1.30e+05
Step 179 : gram_loss = 1.30e+05, loss_total = 1.30e+05
Step 180 : gram_loss = 1.28e+05, loss_total = 1.28e+05
Step 181 : gram_loss = 1.27e+05, loss_total = 1.27e+05
Step 182 : gram_loss = 1.26e+05, loss_total = 1.26e+05
Step 183 : gram_loss = 1.26e+05, loss_total = 1.26e+05
Step 184 : gram_loss = 1.25e+05, loss_total = 1.25e+05
Step 185 : gram_loss = 1.24e+05, loss_total = 1.24e+05
Step 186 : gram_loss = 1.23e+05, loss_total = 1.23e+05
Step 187 : gram_loss = 1.23e+05, loss_total = 1.23e+05
Step 188 : gram_loss = 1.21e+05, loss_total = 1.21e+05
Step 189 : gram_loss = 1.21e+05, loss_total = 1.21e+05
Step 190 : gram_loss = 1.20e+05, loss_total = 1.20e+05
Step 191 : gram_loss = 1.19e+05, loss_total = 1.19e+05
Step 192 : gram_loss = 1.19e+05, loss_total = 1.19e+05
Step 193 : gram_loss = 1.18e+05, loss_total = 1.18e+05
Step 194 : gram_loss = 1.17e+05, loss_total = 1.17e+05
Step 195 : gram_loss = 1.16e+05, loss_total = 1.16e+05
Step 196 : gram_loss = 1.16e+05, loss_total = 1.16e+05
Step 197 : gram_loss = 1.14e+05, loss_total = 1.14e+05
Step 198 : gram_loss = 1.14e+05, loss_total = 1.14e+05
Step 199 : gram_loss = 1.13e+05, loss_total = 1.13e+05
Step 200 : gram_loss = 1.13e+05, loss_total = 1.13e+05
Close Sess - End of the global optimization.
Computation total for  110.97633194923401  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0012_1_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0012_1_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0012_1_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0012_1_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0012_1_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0012_1_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.171465158462524  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 3.76e+09, loss_total = 3.76e+09
Step 1 : gram_loss = 2.59e+09, loss_total = 2.59e+09
Step 2 : gram_loss = 2.10e+09, loss_total = 2.10e+09
Step 3 : gram_loss = 1.27e+09, loss_total = 1.27e+09
Step 4 : gram_loss = 8.02e+08, loss_total = 8.02e+08
Step 5 : gram_loss = 5.93e+08, loss_total = 5.93e+08
Step 6 : gram_loss = 3.70e+08, loss_total = 3.70e+08
Step 7 : gram_loss = 3.05e+08, loss_total = 3.05e+08
Step 8 : gram_loss = 2.21e+08, loss_total = 2.21e+08
Step 9 : gram_loss = 1.77e+08, loss_total = 1.77e+08
Step 10 : gram_loss = 1.31e+08, loss_total = 1.31e+08
Step 11 : gram_loss = 9.93e+07, loss_total = 9.93e+07
Step 12 : gram_loss = 7.95e+07, loss_total = 7.95e+07
Step 13 : gram_loss = 7.38e+07, loss_total = 7.38e+07
Step 14 : gram_loss = 6.08e+07, loss_total = 6.08e+07
Step 15 : gram_loss = 5.00e+07, loss_total = 5.00e+07
Step 16 : gram_loss = 4.33e+07, loss_total = 4.33e+07
Step 17 : gram_loss = 3.11e+07, loss_total = 3.11e+07
Step 18 : gram_loss = 2.86e+07, loss_total = 2.86e+07
Step 19 : gram_loss = 2.54e+07, loss_total = 2.54e+07
Step 20 : gram_loss = 2.35e+07, loss_total = 2.35e+07
Step 21 : gram_loss = 1.88e+07, loss_total = 1.88e+07
Step 22 : gram_loss = 1.71e+07, loss_total = 1.71e+07
Step 23 : gram_loss = 1.50e+07, loss_total = 1.50e+07
Step 24 : gram_loss = 1.35e+07, loss_total = 1.35e+07
Step 25 : gram_loss = 1.21e+07, loss_total = 1.21e+07
Step 26 : gram_loss = 1.07e+07, loss_total = 1.07e+07
Step 27 : gram_loss = 9.57e+06, loss_total = 9.57e+06
Step 28 : gram_loss = 8.50e+06, loss_total = 8.50e+06
Step 29 : gram_loss = 7.85e+06, loss_total = 7.85e+06
Step 30 : gram_loss = 7.37e+06, loss_total = 7.37e+06
Step 31 : gram_loss = 6.84e+06, loss_total = 6.84e+06
Step 32 : gram_loss = 6.34e+06, loss_total = 6.34e+06
Step 33 : gram_loss = 5.95e+06, loss_total = 5.95e+06
Step 34 : gram_loss = 5.54e+06, loss_total = 5.54e+06
Step 35 : gram_loss = 5.28e+06, loss_total = 5.28e+06
Step 36 : gram_loss = 4.90e+06, loss_total = 4.90e+06
Step 37 : gram_loss = 4.54e+06, loss_total = 4.54e+06
Step 38 : gram_loss = 4.27e+06, loss_total = 4.27e+06
Step 39 : gram_loss = 4.03e+06, loss_total = 4.03e+06
Step 40 : gram_loss = 3.74e+06, loss_total = 3.74e+06
Step 41 : gram_loss = 3.48e+06, loss_total = 3.48e+06
Step 42 : gram_loss = 3.14e+06, loss_total = 3.14e+06
Step 43 : gram_loss = 2.99e+06, loss_total = 2.99e+06
Step 44 : gram_loss = 2.75e+06, loss_total = 2.75e+06
Step 45 : gram_loss = 2.64e+06, loss_total = 2.64e+06
Step 46 : gram_loss = 2.47e+06, loss_total = 2.47e+06
Step 47 : gram_loss = 2.30e+06, loss_total = 2.30e+06
Step 48 : gram_loss = 2.15e+06, loss_total = 2.15e+06
Step 49 : gram_loss = 2.05e+06, loss_total = 2.05e+06
Step 50 : gram_loss = 1.97e+06, loss_total = 1.97e+06
Step 51 : gram_loss = 1.89e+06, loss_total = 1.89e+06
Step 52 : gram_loss = 1.82e+06, loss_total = 1.82e+06
Step 53 : gram_loss = 1.72e+06, loss_total = 1.72e+06
Step 54 : gram_loss = 1.70e+06, loss_total = 1.70e+06
Step 55 : gram_loss = 1.56e+06, loss_total = 1.56e+06
Step 56 : gram_loss = 1.52e+06, loss_total = 1.52e+06
Step 57 : gram_loss = 1.47e+06, loss_total = 1.47e+06
Step 58 : gram_loss = 1.38e+06, loss_total = 1.38e+06
Step 59 : gram_loss = 1.31e+06, loss_total = 1.31e+06
Step 60 : gram_loss = 1.27e+06, loss_total = 1.27e+06
Step 61 : gram_loss = 1.22e+06, loss_total = 1.22e+06
Step 62 : gram_loss = 1.17e+06, loss_total = 1.17e+06
Step 63 : gram_loss = 1.13e+06, loss_total = 1.13e+06
Step 64 : gram_loss = 1.11e+06, loss_total = 1.11e+06
Step 65 : gram_loss = 1.08e+06, loss_total = 1.08e+06
Step 66 : gram_loss = 1.04e+06, loss_total = 1.04e+06
Step 67 : gram_loss = 9.73e+05, loss_total = 9.73e+05
Step 68 : gram_loss = 9.18e+05, loss_total = 9.18e+05
Step 69 : gram_loss = 8.84e+05, loss_total = 8.84e+05
Step 70 : gram_loss = 8.60e+05, loss_total = 8.60e+05
Step 71 : gram_loss = 8.38e+05, loss_total = 8.38e+05
Step 72 : gram_loss = 8.21e+05, loss_total = 8.21e+05
Step 73 : gram_loss = 7.90e+05, loss_total = 7.90e+05
Step 74 : gram_loss = 7.62e+05, loss_total = 7.62e+05
Step 75 : gram_loss = 7.39e+05, loss_total = 7.39e+05
Step 76 : gram_loss = 7.24e+05, loss_total = 7.24e+05
Step 77 : gram_loss = 7.16e+05, loss_total = 7.16e+05
Step 78 : gram_loss = 7.03e+05, loss_total = 7.03e+05
Step 79 : gram_loss = 6.84e+05, loss_total = 6.84e+05
Step 80 : gram_loss = 6.57e+05, loss_total = 6.57e+05
Step 81 : gram_loss = 6.42e+05, loss_total = 6.42e+05
Step 82 : gram_loss = 6.30e+05, loss_total = 6.30e+05
Step 83 : gram_loss = 6.19e+05, loss_total = 6.19e+05
Step 84 : gram_loss = 6.14e+05, loss_total = 6.14e+05
Step 85 : gram_loss = 6.05e+05, loss_total = 6.05e+05
Step 86 : gram_loss = 5.94e+05, loss_total = 5.94e+05
Step 87 : gram_loss = 5.85e+05, loss_total = 5.85e+05
Step 88 : gram_loss = 5.65e+05, loss_total = 5.65e+05
Step 89 : gram_loss = 5.54e+05, loss_total = 5.54e+05
Step 90 : gram_loss = 5.36e+05, loss_total = 5.36e+05
Step 91 : gram_loss = 5.26e+05, loss_total = 5.26e+05
Step 92 : gram_loss = 5.14e+05, loss_total = 5.14e+05
Step 93 : gram_loss = 5.04e+05, loss_total = 5.04e+05
Step 94 : gram_loss = 4.95e+05, loss_total = 4.95e+05
Step 95 : gram_loss = 4.88e+05, loss_total = 4.88e+05
Step 96 : gram_loss = 4.82e+05, loss_total = 4.82e+05
Step 97 : gram_loss = 4.76e+05, loss_total = 4.76e+05
Step 98 : gram_loss = 4.66e+05, loss_total = 4.66e+05
Step 99 : gram_loss = 4.56e+05, loss_total = 4.56e+05
Step 100 : gram_loss = 4.47e+05, loss_total = 4.47e+05
Step 101 : gram_loss = 4.39e+05, loss_total = 4.39e+05
Step 102 : gram_loss = 4.30e+05, loss_total = 4.30e+05
Step 103 : gram_loss = 4.22e+05, loss_total = 4.22e+05
Step 104 : gram_loss = 4.18e+05, loss_total = 4.18e+05
Step 105 : gram_loss = 4.15e+05, loss_total = 4.15e+05
Step 106 : gram_loss = 4.10e+05, loss_total = 4.10e+05
Step 107 : gram_loss = 4.05e+05, loss_total = 4.05e+05
Step 108 : gram_loss = 3.99e+05, loss_total = 3.99e+05
Step 109 : gram_loss = 3.95e+05, loss_total = 3.95e+05
Step 110 : gram_loss = 3.89e+05, loss_total = 3.89e+05
Step 111 : gram_loss = 3.83e+05, loss_total = 3.83e+05
Step 112 : gram_loss = 3.77e+05, loss_total = 3.77e+05
Step 113 : gram_loss = 3.71e+05, loss_total = 3.71e+05
Step 114 : gram_loss = 3.66e+05, loss_total = 3.66e+05
Step 115 : gram_loss = 3.59e+05, loss_total = 3.59e+05
Step 116 : gram_loss = 3.53e+05, loss_total = 3.53e+05
Step 117 : gram_loss = 3.49e+05, loss_total = 3.49e+05
Step 118 : gram_loss = 3.44e+05, loss_total = 3.44e+05
Step 119 : gram_loss = 3.41e+05, loss_total = 3.41e+05
Step 120 : gram_loss = 3.37e+05, loss_total = 3.37e+05
Step 121 : gram_loss = 3.31e+05, loss_total = 3.31e+05
Step 122 : gram_loss = 3.28e+05, loss_total = 3.28e+05
Step 123 : gram_loss = 3.26e+05, loss_total = 3.26e+05
Step 124 : gram_loss = 3.22e+05, loss_total = 3.22e+05
Step 125 : gram_loss = 3.20e+05, loss_total = 3.20e+05
Step 126 : gram_loss = 3.13e+05, loss_total = 3.13e+05
Step 127 : gram_loss = 3.11e+05, loss_total = 3.11e+05
Step 128 : gram_loss = 3.09e+05, loss_total = 3.09e+05
Step 129 : gram_loss = 3.05e+05, loss_total = 3.05e+05
Step 130 : gram_loss = 3.05e+05, loss_total = 3.05e+05
Step 131 : gram_loss = 2.98e+05, loss_total = 2.98e+05
Step 132 : gram_loss = 2.97e+05, loss_total = 2.97e+05
Step 133 : gram_loss = 2.96e+05, loss_total = 2.96e+05
Step 134 : gram_loss = 2.94e+05, loss_total = 2.94e+05
Step 135 : gram_loss = 2.92e+05, loss_total = 2.92e+05
Step 136 : gram_loss = 2.89e+05, loss_total = 2.89e+05
Step 137 : gram_loss = 2.84e+05, loss_total = 2.84e+05
Step 138 : gram_loss = 2.80e+05, loss_total = 2.80e+05
Step 139 : gram_loss = 2.77e+05, loss_total = 2.77e+05
Step 140 : gram_loss = 2.75e+05, loss_total = 2.75e+05
Step 141 : gram_loss = 2.73e+05, loss_total = 2.73e+05
Step 142 : gram_loss = 2.70e+05, loss_total = 2.70e+05
Step 143 : gram_loss = 2.68e+05, loss_total = 2.68e+05
Step 144 : gram_loss = 2.65e+05, loss_total = 2.65e+05
Step 145 : gram_loss = 2.64e+05, loss_total = 2.64e+05
Step 146 : gram_loss = 2.62e+05, loss_total = 2.62e+05
Step 147 : gram_loss = 2.58e+05, loss_total = 2.58e+05
Step 148 : gram_loss = 2.58e+05, loss_total = 2.58e+05
Step 149 : gram_loss = 2.54e+05, loss_total = 2.54e+05
Step 150 : gram_loss = 2.53e+05, loss_total = 2.53e+05
Step 151 : gram_loss = 2.52e+05, loss_total = 2.52e+05
Step 152 : gram_loss = 2.50e+05, loss_total = 2.50e+05
Step 153 : gram_loss = 2.47e+05, loss_total = 2.47e+05
Step 154 : gram_loss = 2.44e+05, loss_total = 2.44e+05
Step 155 : gram_loss = 2.43e+05, loss_total = 2.43e+05
Step 156 : gram_loss = 2.41e+05, loss_total = 2.41e+05
Step 157 : gram_loss = 2.40e+05, loss_total = 2.40e+05
Step 158 : gram_loss = 2.39e+05, loss_total = 2.39e+05
Step 159 : gram_loss = 2.37e+05, loss_total = 2.37e+05
Step 160 : gram_loss = 2.35e+05, loss_total = 2.35e+05
Step 161 : gram_loss = 2.32e+05, loss_total = 2.32e+05
Step 162 : gram_loss = 2.32e+05, loss_total = 2.32e+05
Step 163 : gram_loss = 2.29e+05, loss_total = 2.29e+05
Step 164 : gram_loss = 2.29e+05, loss_total = 2.29e+05
Step 165 : gram_loss = 2.27e+05, loss_total = 2.27e+05
Step 166 : gram_loss = 2.27e+05, loss_total = 2.27e+05
Step 167 : gram_loss = 2.25e+05, loss_total = 2.25e+05
Step 168 : gram_loss = 2.23e+05, loss_total = 2.23e+05
Step 169 : gram_loss = 2.22e+05, loss_total = 2.22e+05
Step 170 : gram_loss = 2.20e+05, loss_total = 2.20e+05
Step 171 : gram_loss = 2.17e+05, loss_total = 2.17e+05
Step 172 : gram_loss = 2.16e+05, loss_total = 2.16e+05
Step 173 : gram_loss = 2.15e+05, loss_total = 2.15e+05
Step 174 : gram_loss = 2.14e+05, loss_total = 2.14e+05
Step 175 : gram_loss = 2.13e+05, loss_total = 2.13e+05
Step 176 : gram_loss = 2.12e+05, loss_total = 2.12e+05
Step 177 : gram_loss = 2.10e+05, loss_total = 2.10e+05
Step 178 : gram_loss = 2.09e+05, loss_total = 2.09e+05
Step 179 : gram_loss = 2.08e+05, loss_total = 2.08e+05
Step 180 : gram_loss = 2.07e+05, loss_total = 2.07e+05
Step 181 : gram_loss = 2.06e+05, loss_total = 2.06e+05
Step 182 : gram_loss = 2.05e+05, loss_total = 2.05e+05
Step 183 : gram_loss = 2.04e+05, loss_total = 2.04e+05
Step 184 : gram_loss = 2.03e+05, loss_total = 2.03e+05
Step 185 : gram_loss = 2.02e+05, loss_total = 2.02e+05
Step 186 : gram_loss = 2.01e+05, loss_total = 2.01e+05
Step 187 : gram_loss = 2.00e+05, loss_total = 2.00e+05
Step 188 : gram_loss = 1.99e+05, loss_total = 1.99e+05
Step 189 : gram_loss = 1.98e+05, loss_total = 1.98e+05
Step 190 : gram_loss = 1.97e+05, loss_total = 1.97e+05
Step 191 : gram_loss = 1.96e+05, loss_total = 1.96e+05
Step 192 : gram_loss = 1.95e+05, loss_total = 1.95e+05
Step 193 : gram_loss = 1.93e+05, loss_total = 1.93e+05
Step 194 : gram_loss = 1.93e+05, loss_total = 1.93e+05
Step 195 : gram_loss = 1.92e+05, loss_total = 1.92e+05
Step 196 : gram_loss = 1.91e+05, loss_total = 1.91e+05
Step 197 : gram_loss = 1.90e+05, loss_total = 1.90e+05
Step 198 : gram_loss = 1.89e+05, loss_total = 1.89e+05
Step 199 : gram_loss = 1.88e+05, loss_total = 1.88e+05
Step 200 : gram_loss = 1.87e+05, loss_total = 1.87e+05
Close Sess - End of the global optimization.
Computation total for  108.58389520645142  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0030_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0030_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0030_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0030_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0030_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0030_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.168762922286987  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 3.92e+09, loss_total = 3.92e+09
Step 1 : gram_loss = 3.36e+09, loss_total = 3.36e+09
Step 2 : gram_loss = 2.90e+09, loss_total = 2.90e+09
Step 3 : gram_loss = 2.17e+09, loss_total = 2.17e+09
Step 4 : gram_loss = 1.30e+09, loss_total = 1.30e+09
Step 5 : gram_loss = 3.77e+08, loss_total = 3.77e+08
Step 6 : gram_loss = 3.17e+08, loss_total = 3.17e+08
Step 7 : gram_loss = 2.54e+08, loss_total = 2.54e+08
Step 8 : gram_loss = 1.76e+08, loss_total = 1.76e+08
Step 9 : gram_loss = 1.31e+08, loss_total = 1.31e+08
Step 10 : gram_loss = 1.08e+08, loss_total = 1.08e+08
Step 11 : gram_loss = 9.39e+07, loss_total = 9.39e+07
Step 12 : gram_loss = 7.56e+07, loss_total = 7.56e+07
Step 13 : gram_loss = 5.07e+07, loss_total = 5.07e+07
Step 14 : gram_loss = 3.38e+07, loss_total = 3.38e+07
Step 15 : gram_loss = 2.74e+07, loss_total = 2.74e+07
Step 16 : gram_loss = 2.51e+07, loss_total = 2.51e+07
Step 17 : gram_loss = 2.34e+07, loss_total = 2.34e+07
Step 18 : gram_loss = 2.09e+07, loss_total = 2.09e+07
Step 19 : gram_loss = 1.65e+07, loss_total = 1.65e+07
Step 20 : gram_loss = 1.29e+07, loss_total = 1.29e+07
Step 21 : gram_loss = 1.14e+07, loss_total = 1.14e+07
Step 22 : gram_loss = 1.00e+07, loss_total = 1.00e+07
Step 23 : gram_loss = 9.61e+06, loss_total = 9.61e+06
Step 24 : gram_loss = 9.00e+06, loss_total = 9.00e+06
Step 25 : gram_loss = 8.30e+06, loss_total = 8.30e+06
Step 26 : gram_loss = 7.44e+06, loss_total = 7.44e+06
Step 27 : gram_loss = 6.64e+06, loss_total = 6.64e+06
Step 28 : gram_loss = 6.40e+06, loss_total = 6.40e+06
Step 29 : gram_loss = 5.98e+06, loss_total = 5.98e+06
Step 30 : gram_loss = 5.76e+06, loss_total = 5.76e+06
Step 31 : gram_loss = 5.55e+06, loss_total = 5.55e+06
Step 32 : gram_loss = 5.32e+06, loss_total = 5.32e+06
Step 33 : gram_loss = 5.04e+06, loss_total = 5.04e+06
Step 34 : gram_loss = 4.83e+06, loss_total = 4.83e+06
Step 35 : gram_loss = 4.63e+06, loss_total = 4.63e+06
Step 36 : gram_loss = 4.44e+06, loss_total = 4.44e+06
Step 37 : gram_loss = 4.17e+06, loss_total = 4.17e+06
Step 38 : gram_loss = 4.03e+06, loss_total = 4.03e+06
Step 39 : gram_loss = 3.74e+06, loss_total = 3.74e+06
Step 40 : gram_loss = 3.64e+06, loss_total = 3.64e+06
Step 41 : gram_loss = 3.54e+06, loss_total = 3.54e+06
Step 42 : gram_loss = 3.43e+06, loss_total = 3.43e+06
Step 43 : gram_loss = 3.15e+06, loss_total = 3.15e+06
Step 44 : gram_loss = 3.01e+06, loss_total = 3.01e+06
Step 45 : gram_loss = 2.88e+06, loss_total = 2.88e+06
Step 46 : gram_loss = 2.67e+06, loss_total = 2.67e+06
Step 47 : gram_loss = 2.52e+06, loss_total = 2.52e+06
Step 48 : gram_loss = 2.47e+06, loss_total = 2.47e+06
Step 49 : gram_loss = 2.39e+06, loss_total = 2.39e+06
Step 50 : gram_loss = 2.34e+06, loss_total = 2.34e+06
Step 51 : gram_loss = 2.24e+06, loss_total = 2.24e+06
Step 52 : gram_loss = 2.21e+06, loss_total = 2.21e+06
Step 53 : gram_loss = 2.14e+06, loss_total = 2.14e+06
Step 54 : gram_loss = 2.06e+06, loss_total = 2.06e+06
Step 55 : gram_loss = 1.97e+06, loss_total = 1.97e+06
Step 56 : gram_loss = 1.89e+06, loss_total = 1.89e+06
Step 57 : gram_loss = 1.82e+06, loss_total = 1.82e+06
Step 58 : gram_loss = 1.77e+06, loss_total = 1.77e+06
Step 59 : gram_loss = 1.68e+06, loss_total = 1.68e+06
Step 60 : gram_loss = 1.56e+06, loss_total = 1.56e+06
Step 61 : gram_loss = 1.51e+06, loss_total = 1.51e+06
Step 62 : gram_loss = 1.45e+06, loss_total = 1.45e+06
Step 63 : gram_loss = 1.42e+06, loss_total = 1.42e+06
Step 64 : gram_loss = 1.39e+06, loss_total = 1.39e+06
Step 65 : gram_loss = 1.35e+06, loss_total = 1.35e+06
Step 66 : gram_loss = 1.29e+06, loss_total = 1.29e+06
Step 67 : gram_loss = 1.26e+06, loss_total = 1.26e+06
Step 68 : gram_loss = 1.19e+06, loss_total = 1.19e+06
Step 69 : gram_loss = 1.13e+06, loss_total = 1.13e+06
Step 70 : gram_loss = 1.09e+06, loss_total = 1.09e+06
Step 71 : gram_loss = 1.05e+06, loss_total = 1.05e+06
Step 72 : gram_loss = 1.02e+06, loss_total = 1.02e+06
Step 73 : gram_loss = 1.00e+06, loss_total = 1.00e+06
Step 74 : gram_loss = 9.59e+05, loss_total = 9.59e+05
Step 75 : gram_loss = 9.48e+05, loss_total = 9.48e+05
Step 76 : gram_loss = 9.28e+05, loss_total = 9.28e+05
Step 77 : gram_loss = 9.15e+05, loss_total = 9.15e+05
Step 78 : gram_loss = 8.88e+05, loss_total = 8.88e+05
Step 79 : gram_loss = 8.60e+05, loss_total = 8.60e+05
Step 80 : gram_loss = 8.25e+05, loss_total = 8.25e+05
Step 81 : gram_loss = 8.06e+05, loss_total = 8.06e+05
Step 82 : gram_loss = 7.92e+05, loss_total = 7.92e+05
Step 83 : gram_loss = 7.63e+05, loss_total = 7.63e+05
Step 84 : gram_loss = 7.41e+05, loss_total = 7.41e+05
Step 85 : gram_loss = 7.24e+05, loss_total = 7.24e+05
Step 86 : gram_loss = 7.08e+05, loss_total = 7.08e+05
Step 87 : gram_loss = 6.96e+05, loss_total = 6.96e+05
Step 88 : gram_loss = 6.68e+05, loss_total = 6.68e+05
Step 89 : gram_loss = 6.49e+05, loss_total = 6.49e+05
Step 90 : gram_loss = 6.27e+05, loss_total = 6.27e+05
Step 91 : gram_loss = 6.13e+05, loss_total = 6.13e+05
Step 92 : gram_loss = 5.99e+05, loss_total = 5.99e+05
Step 93 : gram_loss = 5.82e+05, loss_total = 5.82e+05
Step 94 : gram_loss = 5.65e+05, loss_total = 5.65e+05
Step 95 : gram_loss = 5.52e+05, loss_total = 5.52e+05
Step 96 : gram_loss = 5.36e+05, loss_total = 5.36e+05
Step 97 : gram_loss = 5.32e+05, loss_total = 5.32e+05
Step 98 : gram_loss = 5.28e+05, loss_total = 5.28e+05
Step 99 : gram_loss = 5.20e+05, loss_total = 5.20e+05
Step 100 : gram_loss = 5.11e+05, loss_total = 5.11e+05
Step 101 : gram_loss = 4.92e+05, loss_total = 4.92e+05
Step 102 : gram_loss = 4.88e+05, loss_total = 4.88e+05
Step 103 : gram_loss = 4.75e+05, loss_total = 4.75e+05
Step 104 : gram_loss = 4.69e+05, loss_total = 4.69e+05
Step 105 : gram_loss = 4.64e+05, loss_total = 4.64e+05
Step 106 : gram_loss = 4.54e+05, loss_total = 4.54e+05
Step 107 : gram_loss = 4.41e+05, loss_total = 4.41e+05
Step 108 : gram_loss = 4.34e+05, loss_total = 4.34e+05
Step 109 : gram_loss = 4.21e+05, loss_total = 4.21e+05
Step 110 : gram_loss = 4.15e+05, loss_total = 4.15e+05
Step 111 : gram_loss = 4.03e+05, loss_total = 4.03e+05
Step 112 : gram_loss = 3.98e+05, loss_total = 3.98e+05
Step 113 : gram_loss = 3.93e+05, loss_total = 3.93e+05
Step 114 : gram_loss = 3.85e+05, loss_total = 3.85e+05
Step 115 : gram_loss = 3.75e+05, loss_total = 3.75e+05
Step 116 : gram_loss = 3.64e+05, loss_total = 3.64e+05
Step 117 : gram_loss = 3.58e+05, loss_total = 3.58e+05
Step 118 : gram_loss = 3.52e+05, loss_total = 3.52e+05
Step 119 : gram_loss = 3.49e+05, loss_total = 3.49e+05
Step 120 : gram_loss = 3.47e+05, loss_total = 3.47e+05
Step 121 : gram_loss = 3.43e+05, loss_total = 3.43e+05
Step 122 : gram_loss = 3.39e+05, loss_total = 3.39e+05
Step 123 : gram_loss = 3.32e+05, loss_total = 3.32e+05
Step 124 : gram_loss = 3.26e+05, loss_total = 3.26e+05
Step 125 : gram_loss = 3.22e+05, loss_total = 3.22e+05
Step 126 : gram_loss = 3.15e+05, loss_total = 3.15e+05
Step 127 : gram_loss = 3.09e+05, loss_total = 3.09e+05
Step 128 : gram_loss = 3.01e+05, loss_total = 3.01e+05
Step 129 : gram_loss = 2.98e+05, loss_total = 2.98e+05
Step 130 : gram_loss = 2.94e+05, loss_total = 2.94e+05
Step 131 : gram_loss = 2.89e+05, loss_total = 2.89e+05
Step 132 : gram_loss = 2.85e+05, loss_total = 2.85e+05
Step 133 : gram_loss = 2.82e+05, loss_total = 2.82e+05
Step 134 : gram_loss = 2.78e+05, loss_total = 2.78e+05
Step 135 : gram_loss = 2.75e+05, loss_total = 2.75e+05
Step 136 : gram_loss = 2.72e+05, loss_total = 2.72e+05
Step 137 : gram_loss = 2.68e+05, loss_total = 2.68e+05
Step 138 : gram_loss = 2.65e+05, loss_total = 2.65e+05
Step 139 : gram_loss = 2.59e+05, loss_total = 2.59e+05
Step 140 : gram_loss = 2.56e+05, loss_total = 2.56e+05
Step 141 : gram_loss = 2.53e+05, loss_total = 2.53e+05
Step 142 : gram_loss = 2.52e+05, loss_total = 2.52e+05
Step 143 : gram_loss = 2.50e+05, loss_total = 2.50e+05
Step 144 : gram_loss = 2.47e+05, loss_total = 2.47e+05
Step 145 : gram_loss = 2.42e+05, loss_total = 2.42e+05
Step 146 : gram_loss = 2.38e+05, loss_total = 2.38e+05
Step 147 : gram_loss = 2.36e+05, loss_total = 2.36e+05
Step 148 : gram_loss = 2.34e+05, loss_total = 2.34e+05
Step 149 : gram_loss = 2.32e+05, loss_total = 2.32e+05
Step 150 : gram_loss = 2.28e+05, loss_total = 2.28e+05
Step 151 : gram_loss = 2.26e+05, loss_total = 2.26e+05
Step 152 : gram_loss = 2.21e+05, loss_total = 2.21e+05
Step 153 : gram_loss = 2.19e+05, loss_total = 2.19e+05
Step 154 : gram_loss = 2.16e+05, loss_total = 2.16e+05
Step 155 : gram_loss = 2.15e+05, loss_total = 2.15e+05
Step 156 : gram_loss = 2.11e+05, loss_total = 2.11e+05
Step 157 : gram_loss = 2.10e+05, loss_total = 2.10e+05
Step 158 : gram_loss = 2.08e+05, loss_total = 2.08e+05
Step 159 : gram_loss = 2.05e+05, loss_total = 2.05e+05
Step 160 : gram_loss = 2.03e+05, loss_total = 2.03e+05
Step 161 : gram_loss = 2.00e+05, loss_total = 2.00e+05
Step 162 : gram_loss = 1.99e+05, loss_total = 1.99e+05
Step 163 : gram_loss = 1.98e+05, loss_total = 1.98e+05
Step 164 : gram_loss = 1.97e+05, loss_total = 1.97e+05
Step 165 : gram_loss = 1.96e+05, loss_total = 1.96e+05
Step 166 : gram_loss = 1.94e+05, loss_total = 1.94e+05
Step 167 : gram_loss = 1.92e+05, loss_total = 1.92e+05
Step 168 : gram_loss = 1.89e+05, loss_total = 1.89e+05
Step 169 : gram_loss = 1.87e+05, loss_total = 1.87e+05
Step 170 : gram_loss = 1.85e+05, loss_total = 1.85e+05
Step 171 : gram_loss = 1.83e+05, loss_total = 1.83e+05
Step 172 : gram_loss = 1.82e+05, loss_total = 1.82e+05
Step 173 : gram_loss = 1.80e+05, loss_total = 1.80e+05
Step 174 : gram_loss = 1.78e+05, loss_total = 1.78e+05
Step 175 : gram_loss = 1.76e+05, loss_total = 1.76e+05
Step 176 : gram_loss = 1.73e+05, loss_total = 1.73e+05
Step 177 : gram_loss = 1.70e+05, loss_total = 1.70e+05
Step 178 : gram_loss = 1.70e+05, loss_total = 1.70e+05
Step 179 : gram_loss = 1.69e+05, loss_total = 1.69e+05
Step 180 : gram_loss = 1.68e+05, loss_total = 1.68e+05
Step 181 : gram_loss = 1.67e+05, loss_total = 1.67e+05
Step 182 : gram_loss = 1.65e+05, loss_total = 1.65e+05
Step 183 : gram_loss = 1.62e+05, loss_total = 1.62e+05
Step 184 : gram_loss = 1.61e+05, loss_total = 1.61e+05
Step 185 : gram_loss = 1.60e+05, loss_total = 1.60e+05
Step 186 : gram_loss = 1.59e+05, loss_total = 1.59e+05
Step 187 : gram_loss = 1.58e+05, loss_total = 1.58e+05
Step 188 : gram_loss = 1.58e+05, loss_total = 1.58e+05
Step 189 : gram_loss = 1.56e+05, loss_total = 1.56e+05
Step 190 : gram_loss = 1.54e+05, loss_total = 1.54e+05
Step 191 : gram_loss = 1.53e+05, loss_total = 1.53e+05
Step 192 : gram_loss = 1.51e+05, loss_total = 1.51e+05
Step 193 : gram_loss = 1.50e+05, loss_total = 1.50e+05
Step 194 : gram_loss = 1.48e+05, loss_total = 1.48e+05
Step 195 : gram_loss = 1.47e+05, loss_total = 1.47e+05
Step 196 : gram_loss = 1.45e+05, loss_total = 1.45e+05
Step 197 : gram_loss = 1.44e+05, loss_total = 1.44e+05
Step 198 : gram_loss = 1.44e+05, loss_total = 1.44e+05
Step 199 : gram_loss = 1.42e+05, loss_total = 1.42e+05
Step 200 : gram_loss = 1.41e+05, loss_total = 1.41e+05
Close Sess - End of the global optimization.
Computation total for  108.76008701324463  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0045_1_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0045_1_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0045_1_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0045_1_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0045_1_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0045_1_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.195399045944214  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 5.47e+09, loss_total = 5.47e+09
Step 1 : gram_loss = 4.74e+09, loss_total = 4.74e+09
Step 2 : gram_loss = 4.46e+09, loss_total = 4.46e+09
Step 3 : gram_loss = 3.77e+09, loss_total = 3.77e+09
Step 4 : gram_loss = 1.75e+09, loss_total = 1.75e+09
Step 5 : gram_loss = 4.85e+08, loss_total = 4.85e+08
Step 6 : gram_loss = 2.67e+08, loss_total = 2.67e+08
Step 7 : gram_loss = 2.21e+08, loss_total = 2.21e+08
Step 8 : gram_loss = 1.29e+08, loss_total = 1.29e+08
Step 9 : gram_loss = 7.02e+07, loss_total = 7.02e+07
Step 10 : gram_loss = 4.42e+07, loss_total = 4.42e+07
Step 11 : gram_loss = 3.41e+07, loss_total = 3.41e+07
Step 12 : gram_loss = 2.51e+07, loss_total = 2.51e+07
Step 13 : gram_loss = 1.66e+07, loss_total = 1.66e+07
Step 14 : gram_loss = 1.19e+07, loss_total = 1.19e+07
Step 15 : gram_loss = 9.17e+06, loss_total = 9.17e+06
Step 16 : gram_loss = 6.54e+06, loss_total = 6.54e+06
Step 17 : gram_loss = 5.04e+06, loss_total = 5.04e+06
Step 18 : gram_loss = 4.53e+06, loss_total = 4.53e+06
Step 19 : gram_loss = 4.05e+06, loss_total = 4.05e+06
Step 20 : gram_loss = 3.71e+06, loss_total = 3.71e+06
Step 21 : gram_loss = 3.22e+06, loss_total = 3.22e+06
Step 22 : gram_loss = 2.81e+06, loss_total = 2.81e+06
Step 23 : gram_loss = 2.51e+06, loss_total = 2.51e+06
Step 24 : gram_loss = 2.13e+06, loss_total = 2.13e+06
Step 25 : gram_loss = 1.84e+06, loss_total = 1.84e+06
Step 26 : gram_loss = 1.62e+06, loss_total = 1.62e+06
Step 27 : gram_loss = 1.51e+06, loss_total = 1.51e+06
Step 28 : gram_loss = 1.45e+06, loss_total = 1.45e+06
Step 29 : gram_loss = 1.37e+06, loss_total = 1.37e+06
Step 30 : gram_loss = 1.32e+06, loss_total = 1.32e+06
Step 31 : gram_loss = 1.25e+06, loss_total = 1.25e+06
Step 32 : gram_loss = 1.20e+06, loss_total = 1.20e+06
Step 33 : gram_loss = 1.10e+06, loss_total = 1.10e+06
Step 34 : gram_loss = 1.02e+06, loss_total = 1.02e+06
Step 35 : gram_loss = 9.34e+05, loss_total = 9.34e+05
Step 36 : gram_loss = 8.87e+05, loss_total = 8.87e+05
Step 37 : gram_loss = 8.45e+05, loss_total = 8.45e+05
Step 38 : gram_loss = 7.95e+05, loss_total = 7.95e+05
Step 39 : gram_loss = 7.37e+05, loss_total = 7.37e+05
Step 40 : gram_loss = 6.81e+05, loss_total = 6.81e+05
Step 41 : gram_loss = 6.24e+05, loss_total = 6.24e+05
Step 42 : gram_loss = 5.96e+05, loss_total = 5.96e+05
Step 43 : gram_loss = 5.49e+05, loss_total = 5.49e+05
Step 44 : gram_loss = 5.14e+05, loss_total = 5.14e+05
Step 45 : gram_loss = 4.84e+05, loss_total = 4.84e+05
Step 46 : gram_loss = 4.64e+05, loss_total = 4.64e+05
Step 47 : gram_loss = 4.44e+05, loss_total = 4.44e+05
Step 48 : gram_loss = 4.35e+05, loss_total = 4.35e+05
Step 49 : gram_loss = 4.25e+05, loss_total = 4.25e+05
Step 50 : gram_loss = 3.98e+05, loss_total = 3.98e+05
Step 51 : gram_loss = 3.93e+05, loss_total = 3.93e+05
Step 52 : gram_loss = 3.86e+05, loss_total = 3.86e+05
Step 53 : gram_loss = 3.75e+05, loss_total = 3.75e+05
Step 54 : gram_loss = 3.59e+05, loss_total = 3.59e+05
Step 55 : gram_loss = 3.37e+05, loss_total = 3.37e+05
Step 56 : gram_loss = 3.27e+05, loss_total = 3.27e+05
Step 57 : gram_loss = 3.12e+05, loss_total = 3.12e+05
Step 58 : gram_loss = 3.03e+05, loss_total = 3.03e+05
Step 59 : gram_loss = 2.92e+05, loss_total = 2.92e+05
Step 60 : gram_loss = 2.80e+05, loss_total = 2.80e+05
Step 61 : gram_loss = 2.68e+05, loss_total = 2.68e+05
Step 62 : gram_loss = 2.56e+05, loss_total = 2.56e+05
Step 63 : gram_loss = 2.43e+05, loss_total = 2.43e+05
Step 64 : gram_loss = 2.32e+05, loss_total = 2.32e+05
Step 65 : gram_loss = 2.20e+05, loss_total = 2.20e+05
Step 66 : gram_loss = 2.13e+05, loss_total = 2.13e+05
Step 67 : gram_loss = 2.09e+05, loss_total = 2.09e+05
Step 68 : gram_loss = 2.04e+05, loss_total = 2.04e+05
Step 69 : gram_loss = 1.98e+05, loss_total = 1.98e+05
Step 70 : gram_loss = 1.89e+05, loss_total = 1.89e+05
Step 71 : gram_loss = 1.84e+05, loss_total = 1.84e+05
Step 72 : gram_loss = 1.83e+05, loss_total = 1.83e+05
Step 73 : gram_loss = 1.76e+05, loss_total = 1.76e+05
Step 74 : gram_loss = 1.74e+05, loss_total = 1.74e+05
Step 75 : gram_loss = 1.71e+05, loss_total = 1.71e+05
Step 76 : gram_loss = 1.67e+05, loss_total = 1.67e+05
Step 77 : gram_loss = 1.60e+05, loss_total = 1.60e+05
Step 78 : gram_loss = 1.56e+05, loss_total = 1.56e+05
Step 79 : gram_loss = 1.53e+05, loss_total = 1.53e+05
Step 80 : gram_loss = 1.51e+05, loss_total = 1.51e+05
Step 81 : gram_loss = 1.48e+05, loss_total = 1.48e+05
Step 82 : gram_loss = 1.47e+05, loss_total = 1.47e+05
Step 83 : gram_loss = 1.43e+05, loss_total = 1.43e+05
Step 84 : gram_loss = 1.40e+05, loss_total = 1.40e+05
Step 85 : gram_loss = 1.35e+05, loss_total = 1.35e+05
Step 86 : gram_loss = 1.32e+05, loss_total = 1.32e+05
Step 87 : gram_loss = 1.29e+05, loss_total = 1.29e+05
Step 88 : gram_loss = 1.26e+05, loss_total = 1.26e+05
Step 89 : gram_loss = 1.24e+05, loss_total = 1.24e+05
Step 90 : gram_loss = 1.20e+05, loss_total = 1.20e+05
Step 91 : gram_loss = 1.18e+05, loss_total = 1.18e+05
Step 92 : gram_loss = 1.15e+05, loss_total = 1.15e+05
Step 93 : gram_loss = 1.13e+05, loss_total = 1.13e+05
Step 94 : gram_loss = 1.11e+05, loss_total = 1.11e+05
Step 95 : gram_loss = 1.10e+05, loss_total = 1.10e+05
Step 96 : gram_loss = 1.08e+05, loss_total = 1.08e+05
Step 97 : gram_loss = 1.07e+05, loss_total = 1.07e+05
Step 98 : gram_loss = 1.05e+05, loss_total = 1.05e+05
Step 99 : gram_loss = 1.02e+05, loss_total = 1.02e+05
Step 100 : gram_loss = 1.01e+05, loss_total = 1.01e+05
Step 101 : gram_loss = 9.93e+04, loss_total = 9.93e+04
Step 102 : gram_loss = 9.83e+04, loss_total = 9.83e+04
Step 103 : gram_loss = 9.63e+04, loss_total = 9.63e+04
Step 104 : gram_loss = 9.30e+04, loss_total = 9.30e+04
Step 105 : gram_loss = 9.24e+04, loss_total = 9.24e+04
Step 106 : gram_loss = 8.88e+04, loss_total = 8.88e+04
Step 107 : gram_loss = 8.78e+04, loss_total = 8.78e+04
Step 108 : gram_loss = 8.59e+04, loss_total = 8.59e+04
Step 109 : gram_loss = 8.48e+04, loss_total = 8.48e+04
Step 110 : gram_loss = 8.28e+04, loss_total = 8.28e+04
Step 111 : gram_loss = 8.21e+04, loss_total = 8.21e+04
Step 112 : gram_loss = 8.14e+04, loss_total = 8.14e+04
Step 113 : gram_loss = 8.07e+04, loss_total = 8.07e+04
Step 114 : gram_loss = 7.87e+04, loss_total = 7.87e+04
Step 115 : gram_loss = 7.76e+04, loss_total = 7.76e+04
Step 116 : gram_loss = 7.70e+04, loss_total = 7.70e+04
Step 117 : gram_loss = 7.63e+04, loss_total = 7.63e+04
Step 118 : gram_loss = 7.54e+04, loss_total = 7.54e+04
Step 119 : gram_loss = 7.42e+04, loss_total = 7.42e+04
Step 120 : gram_loss = 7.25e+04, loss_total = 7.25e+04
Step 121 : gram_loss = 7.12e+04, loss_total = 7.12e+04
Step 122 : gram_loss = 7.05e+04, loss_total = 7.05e+04
Step 123 : gram_loss = 6.98e+04, loss_total = 6.98e+04
Step 124 : gram_loss = 6.84e+04, loss_total = 6.84e+04
Step 125 : gram_loss = 6.71e+04, loss_total = 6.71e+04
Step 126 : gram_loss = 6.58e+04, loss_total = 6.58e+04
Step 127 : gram_loss = 6.48e+04, loss_total = 6.48e+04
Step 128 : gram_loss = 6.39e+04, loss_total = 6.39e+04
Step 129 : gram_loss = 6.28e+04, loss_total = 6.28e+04
Step 130 : gram_loss = 6.19e+04, loss_total = 6.19e+04
Step 131 : gram_loss = 6.09e+04, loss_total = 6.09e+04
Step 132 : gram_loss = 5.96e+04, loss_total = 5.96e+04
Step 133 : gram_loss = 5.88e+04, loss_total = 5.88e+04
Step 134 : gram_loss = 5.84e+04, loss_total = 5.84e+04
Step 135 : gram_loss = 5.78e+04, loss_total = 5.78e+04
Step 136 : gram_loss = 5.72e+04, loss_total = 5.72e+04
Step 137 : gram_loss = 5.68e+04, loss_total = 5.68e+04
Step 138 : gram_loss = 5.60e+04, loss_total = 5.60e+04
Step 139 : gram_loss = 5.56e+04, loss_total = 5.56e+04
Step 140 : gram_loss = 5.52e+04, loss_total = 5.52e+04
Step 141 : gram_loss = 5.44e+04, loss_total = 5.44e+04
Step 142 : gram_loss = 5.40e+04, loss_total = 5.40e+04
Step 143 : gram_loss = 5.28e+04, loss_total = 5.28e+04
Step 144 : gram_loss = 5.23e+04, loss_total = 5.23e+04
Step 145 : gram_loss = 5.15e+04, loss_total = 5.15e+04
Step 146 : gram_loss = 5.09e+04, loss_total = 5.09e+04
Step 147 : gram_loss = 5.02e+04, loss_total = 5.02e+04
Step 148 : gram_loss = 4.96e+04, loss_total = 4.96e+04
Step 149 : gram_loss = 4.93e+04, loss_total = 4.93e+04
Step 150 : gram_loss = 4.90e+04, loss_total = 4.90e+04
Step 151 : gram_loss = 4.82e+04, loss_total = 4.82e+04
Step 152 : gram_loss = 4.80e+04, loss_total = 4.80e+04
Step 153 : gram_loss = 4.72e+04, loss_total = 4.72e+04
Step 154 : gram_loss = 4.69e+04, loss_total = 4.69e+04
Step 155 : gram_loss = 4.64e+04, loss_total = 4.64e+04
Step 156 : gram_loss = 4.61e+04, loss_total = 4.61e+04
Step 157 : gram_loss = 4.53e+04, loss_total = 4.53e+04
Step 158 : gram_loss = 4.50e+04, loss_total = 4.50e+04
Step 159 : gram_loss = 4.48e+04, loss_total = 4.48e+04
Step 160 : gram_loss = 4.46e+04, loss_total = 4.46e+04
Step 161 : gram_loss = 4.44e+04, loss_total = 4.44e+04
Step 162 : gram_loss = 4.39e+04, loss_total = 4.39e+04
Step 163 : gram_loss = 4.36e+04, loss_total = 4.36e+04
Step 164 : gram_loss = 4.28e+04, loss_total = 4.28e+04
Step 165 : gram_loss = 4.24e+04, loss_total = 4.24e+04
Step 166 : gram_loss = 4.21e+04, loss_total = 4.21e+04
Step 167 : gram_loss = 4.18e+04, loss_total = 4.18e+04
Step 168 : gram_loss = 4.15e+04, loss_total = 4.15e+04
Step 169 : gram_loss = 4.11e+04, loss_total = 4.11e+04
Step 170 : gram_loss = 4.07e+04, loss_total = 4.07e+04
Step 171 : gram_loss = 4.04e+04, loss_total = 4.04e+04
Step 172 : gram_loss = 4.03e+04, loss_total = 4.03e+04
Step 173 : gram_loss = 3.98e+04, loss_total = 3.98e+04
Step 174 : gram_loss = 3.92e+04, loss_total = 3.92e+04
Step 175 : gram_loss = 3.89e+04, loss_total = 3.89e+04
Step 176 : gram_loss = 3.84e+04, loss_total = 3.84e+04
Step 177 : gram_loss = 3.81e+04, loss_total = 3.81e+04
Step 178 : gram_loss = 3.77e+04, loss_total = 3.77e+04
Step 179 : gram_loss = 3.74e+04, loss_total = 3.74e+04
Step 180 : gram_loss = 3.71e+04, loss_total = 3.71e+04
Step 181 : gram_loss = 3.70e+04, loss_total = 3.70e+04
Step 182 : gram_loss = 3.67e+04, loss_total = 3.67e+04
Step 183 : gram_loss = 3.66e+04, loss_total = 3.66e+04
Step 184 : gram_loss = 3.63e+04, loss_total = 3.63e+04
Step 185 : gram_loss = 3.60e+04, loss_total = 3.60e+04
Step 186 : gram_loss = 3.55e+04, loss_total = 3.55e+04
Step 187 : gram_loss = 3.52e+04, loss_total = 3.52e+04
Step 188 : gram_loss = 3.49e+04, loss_total = 3.49e+04
Step 189 : gram_loss = 3.46e+04, loss_total = 3.46e+04
Step 190 : gram_loss = 3.44e+04, loss_total = 3.44e+04
Step 191 : gram_loss = 3.41e+04, loss_total = 3.41e+04
Step 192 : gram_loss = 3.39e+04, loss_total = 3.39e+04
Step 193 : gram_loss = 3.36e+04, loss_total = 3.36e+04
Step 194 : gram_loss = 3.34e+04, loss_total = 3.34e+04
Step 195 : gram_loss = 3.31e+04, loss_total = 3.31e+04
Step 196 : gram_loss = 3.27e+04, loss_total = 3.27e+04
Step 197 : gram_loss = 3.23e+04, loss_total = 3.23e+04
Step 198 : gram_loss = 3.20e+04, loss_total = 3.20e+04
Step 199 : gram_loss = 3.18e+04, loss_total = 3.18e+04
Step 200 : gram_loss = 3.16e+04, loss_total = 3.16e+04
Close Sess - End of the global optimization.
Computation total for  108.5628273487091  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0019_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0019_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0019_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0019_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0019_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0019_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.214624643325806  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 1.29e+09, loss_total = 1.29e+09
Step 1 : gram_loss = 1.18e+09, loss_total = 1.18e+09
Step 2 : gram_loss = 1.11e+09, loss_total = 1.11e+09
Step 3 : gram_loss = 3.95e+08, loss_total = 3.95e+08
Step 4 : gram_loss = 2.45e+08, loss_total = 2.45e+08
Step 5 : gram_loss = 2.22e+08, loss_total = 2.22e+08
Step 6 : gram_loss = 1.68e+08, loss_total = 1.68e+08
Step 7 : gram_loss = 1.50e+08, loss_total = 1.50e+08
Step 8 : gram_loss = 1.28e+08, loss_total = 1.28e+08
Step 9 : gram_loss = 1.13e+08, loss_total = 1.13e+08
Step 10 : gram_loss = 1.01e+08, loss_total = 1.01e+08
Step 11 : gram_loss = 8.85e+07, loss_total = 8.85e+07
Step 12 : gram_loss = 7.96e+07, loss_total = 7.96e+07
Step 13 : gram_loss = 6.83e+07, loss_total = 6.83e+07
Step 14 : gram_loss = 6.05e+07, loss_total = 6.05e+07
Step 15 : gram_loss = 5.15e+07, loss_total = 5.15e+07
Step 16 : gram_loss = 4.40e+07, loss_total = 4.40e+07
Step 17 : gram_loss = 3.92e+07, loss_total = 3.92e+07
Step 18 : gram_loss = 3.55e+07, loss_total = 3.55e+07
Step 19 : gram_loss = 3.24e+07, loss_total = 3.24e+07
Step 20 : gram_loss = 2.98e+07, loss_total = 2.98e+07
Step 21 : gram_loss = 2.82e+07, loss_total = 2.82e+07
Step 22 : gram_loss = 2.72e+07, loss_total = 2.72e+07
Step 23 : gram_loss = 2.58e+07, loss_total = 2.58e+07
Step 24 : gram_loss = 2.49e+07, loss_total = 2.49e+07
Step 25 : gram_loss = 2.32e+07, loss_total = 2.32e+07
Step 26 : gram_loss = 2.11e+07, loss_total = 2.11e+07
Step 27 : gram_loss = 1.92e+07, loss_total = 1.92e+07
Step 28 : gram_loss = 1.78e+07, loss_total = 1.78e+07
Step 29 : gram_loss = 1.73e+07, loss_total = 1.73e+07
Step 30 : gram_loss = 1.62e+07, loss_total = 1.62e+07
Step 31 : gram_loss = 1.59e+07, loss_total = 1.59e+07
Step 32 : gram_loss = 1.50e+07, loss_total = 1.50e+07
Step 33 : gram_loss = 1.43e+07, loss_total = 1.43e+07
Step 34 : gram_loss = 1.34e+07, loss_total = 1.34e+07
Step 35 : gram_loss = 1.28e+07, loss_total = 1.28e+07
Step 36 : gram_loss = 1.20e+07, loss_total = 1.20e+07
Step 37 : gram_loss = 1.16e+07, loss_total = 1.16e+07
Step 38 : gram_loss = 1.11e+07, loss_total = 1.11e+07
Step 39 : gram_loss = 1.07e+07, loss_total = 1.07e+07
Step 40 : gram_loss = 1.03e+07, loss_total = 1.03e+07
Step 41 : gram_loss = 9.66e+06, loss_total = 9.66e+06
Step 42 : gram_loss = 8.94e+06, loss_total = 8.94e+06
Step 43 : gram_loss = 8.36e+06, loss_total = 8.36e+06
Step 44 : gram_loss = 8.09e+06, loss_total = 8.09e+06
Step 45 : gram_loss = 7.74e+06, loss_total = 7.74e+06
Step 46 : gram_loss = 7.47e+06, loss_total = 7.47e+06
Step 47 : gram_loss = 7.01e+06, loss_total = 7.01e+06
Step 48 : gram_loss = 6.72e+06, loss_total = 6.72e+06
Step 49 : gram_loss = 6.53e+06, loss_total = 6.53e+06
Step 50 : gram_loss = 6.32e+06, loss_total = 6.32e+06
Step 51 : gram_loss = 6.05e+06, loss_total = 6.05e+06
Step 52 : gram_loss = 5.69e+06, loss_total = 5.69e+06
Step 53 : gram_loss = 5.38e+06, loss_total = 5.38e+06
Step 54 : gram_loss = 5.21e+06, loss_total = 5.21e+06
Step 55 : gram_loss = 4.91e+06, loss_total = 4.91e+06
Step 56 : gram_loss = 4.74e+06, loss_total = 4.74e+06
Step 57 : gram_loss = 4.48e+06, loss_total = 4.48e+06
Step 58 : gram_loss = 4.21e+06, loss_total = 4.21e+06
Step 59 : gram_loss = 4.01e+06, loss_total = 4.01e+06
Step 60 : gram_loss = 3.90e+06, loss_total = 3.90e+06
Step 61 : gram_loss = 3.74e+06, loss_total = 3.74e+06
Step 62 : gram_loss = 3.58e+06, loss_total = 3.58e+06
Step 63 : gram_loss = 3.49e+06, loss_total = 3.49e+06
Step 64 : gram_loss = 3.35e+06, loss_total = 3.35e+06
Step 65 : gram_loss = 3.27e+06, loss_total = 3.27e+06
Step 66 : gram_loss = 3.09e+06, loss_total = 3.09e+06
Step 67 : gram_loss = 2.93e+06, loss_total = 2.93e+06
Step 68 : gram_loss = 2.83e+06, loss_total = 2.83e+06
Step 69 : gram_loss = 2.78e+06, loss_total = 2.78e+06
Step 70 : gram_loss = 2.66e+06, loss_total = 2.66e+06
Step 71 : gram_loss = 2.56e+06, loss_total = 2.56e+06
Step 72 : gram_loss = 2.44e+06, loss_total = 2.44e+06
Step 73 : gram_loss = 2.36e+06, loss_total = 2.36e+06
Step 74 : gram_loss = 2.30e+06, loss_total = 2.30e+06
Step 75 : gram_loss = 2.18e+06, loss_total = 2.18e+06
Step 76 : gram_loss = 2.10e+06, loss_total = 2.10e+06
Step 77 : gram_loss = 2.04e+06, loss_total = 2.04e+06
Step 78 : gram_loss = 1.99e+06, loss_total = 1.99e+06
Step 79 : gram_loss = 1.93e+06, loss_total = 1.93e+06
Step 80 : gram_loss = 1.85e+06, loss_total = 1.85e+06
Step 81 : gram_loss = 1.78e+06, loss_total = 1.78e+06
Step 82 : gram_loss = 1.73e+06, loss_total = 1.73e+06
Step 83 : gram_loss = 1.67e+06, loss_total = 1.67e+06
Step 84 : gram_loss = 1.62e+06, loss_total = 1.62e+06
Step 85 : gram_loss = 1.57e+06, loss_total = 1.57e+06
Step 86 : gram_loss = 1.53e+06, loss_total = 1.53e+06
Step 87 : gram_loss = 1.48e+06, loss_total = 1.48e+06
Step 88 : gram_loss = 1.43e+06, loss_total = 1.43e+06
Step 89 : gram_loss = 1.40e+06, loss_total = 1.40e+06
Step 90 : gram_loss = 1.36e+06, loss_total = 1.36e+06
Step 91 : gram_loss = 1.34e+06, loss_total = 1.34e+06
Step 92 : gram_loss = 1.30e+06, loss_total = 1.30e+06
Step 93 : gram_loss = 1.26e+06, loss_total = 1.26e+06
Step 94 : gram_loss = 1.22e+06, loss_total = 1.22e+06
Step 95 : gram_loss = 1.18e+06, loss_total = 1.18e+06
Step 96 : gram_loss = 1.16e+06, loss_total = 1.16e+06
Step 97 : gram_loss = 1.14e+06, loss_total = 1.14e+06
Step 98 : gram_loss = 1.11e+06, loss_total = 1.11e+06
Step 99 : gram_loss = 1.09e+06, loss_total = 1.09e+06
Step 100 : gram_loss = 1.07e+06, loss_total = 1.07e+06
Step 101 : gram_loss = 1.03e+06, loss_total = 1.03e+06
Step 102 : gram_loss = 1.01e+06, loss_total = 1.01e+06
Step 103 : gram_loss = 9.87e+05, loss_total = 9.87e+05
Step 104 : gram_loss = 9.73e+05, loss_total = 9.73e+05
Step 105 : gram_loss = 9.58e+05, loss_total = 9.58e+05
Step 106 : gram_loss = 9.35e+05, loss_total = 9.35e+05
Step 107 : gram_loss = 9.17e+05, loss_total = 9.17e+05
Step 108 : gram_loss = 9.07e+05, loss_total = 9.07e+05
Step 109 : gram_loss = 8.88e+05, loss_total = 8.88e+05
Step 110 : gram_loss = 8.71e+05, loss_total = 8.71e+05
Step 111 : gram_loss = 8.56e+05, loss_total = 8.56e+05
Step 112 : gram_loss = 8.45e+05, loss_total = 8.45e+05
Step 113 : gram_loss = 8.35e+05, loss_total = 8.35e+05
Step 114 : gram_loss = 8.25e+05, loss_total = 8.25e+05
Step 115 : gram_loss = 8.12e+05, loss_total = 8.12e+05
Step 116 : gram_loss = 8.04e+05, loss_total = 8.04e+05
Step 117 : gram_loss = 7.94e+05, loss_total = 7.94e+05
Step 118 : gram_loss = 7.87e+05, loss_total = 7.87e+05
Step 119 : gram_loss = 7.77e+05, loss_total = 7.77e+05
Step 120 : gram_loss = 7.70e+05, loss_total = 7.70e+05
Step 121 : gram_loss = 7.63e+05, loss_total = 7.63e+05
Step 122 : gram_loss = 7.51e+05, loss_total = 7.51e+05
Step 123 : gram_loss = 7.45e+05, loss_total = 7.45e+05
Step 124 : gram_loss = 7.29e+05, loss_total = 7.29e+05
Step 125 : gram_loss = 7.24e+05, loss_total = 7.24e+05
Step 126 : gram_loss = 7.17e+05, loss_total = 7.17e+05
Step 127 : gram_loss = 7.09e+05, loss_total = 7.09e+05
Step 128 : gram_loss = 7.00e+05, loss_total = 7.00e+05
Step 129 : gram_loss = 6.95e+05, loss_total = 6.95e+05
Step 130 : gram_loss = 6.85e+05, loss_total = 6.85e+05
Step 131 : gram_loss = 6.77e+05, loss_total = 6.77e+05
Step 132 : gram_loss = 6.71e+05, loss_total = 6.71e+05
Step 133 : gram_loss = 6.66e+05, loss_total = 6.66e+05
Step 134 : gram_loss = 6.60e+05, loss_total = 6.60e+05
Step 135 : gram_loss = 6.51e+05, loss_total = 6.51e+05
Step 136 : gram_loss = 6.44e+05, loss_total = 6.44e+05
Step 137 : gram_loss = 6.40e+05, loss_total = 6.40e+05
Step 138 : gram_loss = 6.34e+05, loss_total = 6.34e+05
Step 139 : gram_loss = 6.30e+05, loss_total = 6.30e+05
Step 140 : gram_loss = 6.24e+05, loss_total = 6.24e+05
Step 141 : gram_loss = 6.20e+05, loss_total = 6.20e+05
Step 142 : gram_loss = 6.16e+05, loss_total = 6.16e+05
Step 143 : gram_loss = 6.09e+05, loss_total = 6.09e+05
Step 144 : gram_loss = 6.03e+05, loss_total = 6.03e+05
Step 145 : gram_loss = 5.98e+05, loss_total = 5.98e+05
Step 146 : gram_loss = 5.94e+05, loss_total = 5.94e+05
Step 147 : gram_loss = 5.90e+05, loss_total = 5.90e+05
Step 148 : gram_loss = 5.85e+05, loss_total = 5.85e+05
Step 149 : gram_loss = 5.78e+05, loss_total = 5.78e+05
Step 150 : gram_loss = 5.73e+05, loss_total = 5.73e+05
Step 151 : gram_loss = 5.70e+05, loss_total = 5.70e+05
Step 152 : gram_loss = 5.67e+05, loss_total = 5.67e+05
Step 153 : gram_loss = 5.62e+05, loss_total = 5.62e+05
Step 154 : gram_loss = 5.57e+05, loss_total = 5.57e+05
Step 155 : gram_loss = 5.52e+05, loss_total = 5.52e+05
Step 156 : gram_loss = 5.49e+05, loss_total = 5.49e+05
Step 157 : gram_loss = 5.46e+05, loss_total = 5.46e+05
Step 158 : gram_loss = 5.42e+05, loss_total = 5.42e+05
Step 159 : gram_loss = 5.38e+05, loss_total = 5.38e+05
Step 160 : gram_loss = 5.35e+05, loss_total = 5.35e+05
Step 161 : gram_loss = 5.33e+05, loss_total = 5.33e+05
Step 162 : gram_loss = 5.30e+05, loss_total = 5.30e+05
Step 163 : gram_loss = 5.27e+05, loss_total = 5.27e+05
Step 164 : gram_loss = 5.25e+05, loss_total = 5.25e+05
Step 165 : gram_loss = 5.22e+05, loss_total = 5.22e+05
Step 166 : gram_loss = 5.18e+05, loss_total = 5.18e+05
Step 167 : gram_loss = 5.15e+05, loss_total = 5.15e+05
Step 168 : gram_loss = 5.12e+05, loss_total = 5.12e+05
Step 169 : gram_loss = 5.10e+05, loss_total = 5.10e+05
Step 170 : gram_loss = 5.07e+05, loss_total = 5.07e+05
Step 171 : gram_loss = 5.05e+05, loss_total = 5.05e+05
Step 172 : gram_loss = 5.03e+05, loss_total = 5.03e+05
Step 173 : gram_loss = 5.00e+05, loss_total = 5.00e+05
Step 174 : gram_loss = 4.97e+05, loss_total = 4.97e+05
Step 175 : gram_loss = 4.94e+05, loss_total = 4.94e+05
Step 176 : gram_loss = 4.92e+05, loss_total = 4.92e+05
Step 177 : gram_loss = 4.88e+05, loss_total = 4.88e+05
Step 178 : gram_loss = 4.86e+05, loss_total = 4.86e+05
Step 179 : gram_loss = 4.83e+05, loss_total = 4.83e+05
Step 180 : gram_loss = 4.82e+05, loss_total = 4.82e+05
Step 181 : gram_loss = 4.79e+05, loss_total = 4.79e+05
Step 182 : gram_loss = 4.77e+05, loss_total = 4.77e+05
Step 183 : gram_loss = 4.75e+05, loss_total = 4.75e+05
Step 184 : gram_loss = 4.73e+05, loss_total = 4.73e+05
Step 185 : gram_loss = 4.71e+05, loss_total = 4.71e+05
Step 186 : gram_loss = 4.70e+05, loss_total = 4.70e+05
Step 187 : gram_loss = 4.68e+05, loss_total = 4.68e+05
Step 188 : gram_loss = 4.66e+05, loss_total = 4.66e+05
Step 189 : gram_loss = 4.65e+05, loss_total = 4.65e+05
Step 190 : gram_loss = 4.62e+05, loss_total = 4.62e+05
Step 191 : gram_loss = 4.59e+05, loss_total = 4.59e+05
Step 192 : gram_loss = 4.57e+05, loss_total = 4.57e+05
Step 193 : gram_loss = 4.55e+05, loss_total = 4.55e+05
Step 194 : gram_loss = 4.53e+05, loss_total = 4.53e+05
Step 195 : gram_loss = 4.51e+05, loss_total = 4.51e+05
Step 196 : gram_loss = 4.49e+05, loss_total = 4.49e+05
Step 197 : gram_loss = 4.48e+05, loss_total = 4.48e+05
Step 198 : gram_loss = 4.46e+05, loss_total = 4.46e+05
Step 199 : gram_loss = 4.44e+05, loss_total = 4.44e+05
Step 200 : gram_loss = 4.42e+05, loss_total = 4.42e+05
Close Sess - End of the global optimization.
Computation total for  109.5109851360321  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0041_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0041_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0041_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0041_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0041_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0041_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.310428857803345  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 1.82e+09, loss_total = 1.82e+09
Step 1 : gram_loss = 1.21e+09, loss_total = 1.21e+09
Step 2 : gram_loss = 1.16e+09, loss_total = 1.16e+09
Step 3 : gram_loss = 7.37e+08, loss_total = 7.37e+08
Step 4 : gram_loss = 6.81e+08, loss_total = 6.81e+08
Step 5 : gram_loss = 3.82e+08, loss_total = 3.82e+08
Step 6 : gram_loss = 1.82e+08, loss_total = 1.82e+08
Step 7 : gram_loss = 1.50e+08, loss_total = 1.50e+08
Step 8 : gram_loss = 1.21e+08, loss_total = 1.21e+08
Step 9 : gram_loss = 9.33e+07, loss_total = 9.33e+07
Step 10 : gram_loss = 7.21e+07, loss_total = 7.21e+07
Step 11 : gram_loss = 4.86e+07, loss_total = 4.86e+07
Step 12 : gram_loss = 4.44e+07, loss_total = 4.44e+07
Step 13 : gram_loss = 3.65e+07, loss_total = 3.65e+07
Step 14 : gram_loss = 2.99e+07, loss_total = 2.99e+07
Step 15 : gram_loss = 2.72e+07, loss_total = 2.72e+07
Step 16 : gram_loss = 2.52e+07, loss_total = 2.52e+07
Step 17 : gram_loss = 2.17e+07, loss_total = 2.17e+07
Step 18 : gram_loss = 2.01e+07, loss_total = 2.01e+07
Step 19 : gram_loss = 1.85e+07, loss_total = 1.85e+07
Step 20 : gram_loss = 1.73e+07, loss_total = 1.73e+07
Step 21 : gram_loss = 1.55e+07, loss_total = 1.55e+07
Step 22 : gram_loss = 1.45e+07, loss_total = 1.45e+07
Step 23 : gram_loss = 1.30e+07, loss_total = 1.30e+07
Step 24 : gram_loss = 1.21e+07, loss_total = 1.21e+07
Step 25 : gram_loss = 1.18e+07, loss_total = 1.18e+07
Step 26 : gram_loss = 1.10e+07, loss_total = 1.10e+07
Step 27 : gram_loss = 1.02e+07, loss_total = 1.02e+07
Step 28 : gram_loss = 9.23e+06, loss_total = 9.23e+06
Step 29 : gram_loss = 8.68e+06, loss_total = 8.68e+06
Step 30 : gram_loss = 8.33e+06, loss_total = 8.33e+06
Step 31 : gram_loss = 7.92e+06, loss_total = 7.92e+06
Step 32 : gram_loss = 7.64e+06, loss_total = 7.64e+06
Step 33 : gram_loss = 6.95e+06, loss_total = 6.95e+06
Step 34 : gram_loss = 6.81e+06, loss_total = 6.81e+06
Step 35 : gram_loss = 6.36e+06, loss_total = 6.36e+06
Step 36 : gram_loss = 5.91e+06, loss_total = 5.91e+06
Step 37 : gram_loss = 5.39e+06, loss_total = 5.39e+06
Step 38 : gram_loss = 4.85e+06, loss_total = 4.85e+06
Step 39 : gram_loss = 4.67e+06, loss_total = 4.67e+06
Step 40 : gram_loss = 4.40e+06, loss_total = 4.40e+06
Step 41 : gram_loss = 4.14e+06, loss_total = 4.14e+06
Step 42 : gram_loss = 3.89e+06, loss_total = 3.89e+06
Step 43 : gram_loss = 3.70e+06, loss_total = 3.70e+06
Step 44 : gram_loss = 3.49e+06, loss_total = 3.49e+06
Step 45 : gram_loss = 3.28e+06, loss_total = 3.28e+06
Step 46 : gram_loss = 3.02e+06, loss_total = 3.02e+06
Step 47 : gram_loss = 2.87e+06, loss_total = 2.87e+06
Step 48 : gram_loss = 2.73e+06, loss_total = 2.73e+06
Step 49 : gram_loss = 2.66e+06, loss_total = 2.66e+06
Step 50 : gram_loss = 2.56e+06, loss_total = 2.56e+06
Step 51 : gram_loss = 2.39e+06, loss_total = 2.39e+06
Step 52 : gram_loss = 2.24e+06, loss_total = 2.24e+06
Step 53 : gram_loss = 2.12e+06, loss_total = 2.12e+06
Step 54 : gram_loss = 2.04e+06, loss_total = 2.04e+06
Step 55 : gram_loss = 1.96e+06, loss_total = 1.96e+06
Step 56 : gram_loss = 1.81e+06, loss_total = 1.81e+06
Step 57 : gram_loss = 1.76e+06, loss_total = 1.76e+06
Step 58 : gram_loss = 1.68e+06, loss_total = 1.68e+06
Step 59 : gram_loss = 1.63e+06, loss_total = 1.63e+06
Step 60 : gram_loss = 1.58e+06, loss_total = 1.58e+06
Step 61 : gram_loss = 1.51e+06, loss_total = 1.51e+06
Step 62 : gram_loss = 1.45e+06, loss_total = 1.45e+06
Step 63 : gram_loss = 1.37e+06, loss_total = 1.37e+06
Step 64 : gram_loss = 1.34e+06, loss_total = 1.34e+06
Step 65 : gram_loss = 1.29e+06, loss_total = 1.29e+06
Step 66 : gram_loss = 1.23e+06, loss_total = 1.23e+06
Step 67 : gram_loss = 1.19e+06, loss_total = 1.19e+06
Step 68 : gram_loss = 1.16e+06, loss_total = 1.16e+06
Step 69 : gram_loss = 1.12e+06, loss_total = 1.12e+06
Step 70 : gram_loss = 1.08e+06, loss_total = 1.08e+06
Step 71 : gram_loss = 1.05e+06, loss_total = 1.05e+06
Step 72 : gram_loss = 1.01e+06, loss_total = 1.01e+06
Step 73 : gram_loss = 9.87e+05, loss_total = 9.87e+05
Step 74 : gram_loss = 9.61e+05, loss_total = 9.61e+05
Step 75 : gram_loss = 9.32e+05, loss_total = 9.32e+05
Step 76 : gram_loss = 9.08e+05, loss_total = 9.08e+05
Step 77 : gram_loss = 8.78e+05, loss_total = 8.78e+05
Step 78 : gram_loss = 8.46e+05, loss_total = 8.46e+05
Step 79 : gram_loss = 8.21e+05, loss_total = 8.21e+05
Step 80 : gram_loss = 7.97e+05, loss_total = 7.97e+05
Step 81 : gram_loss = 7.76e+05, loss_total = 7.76e+05
Step 82 : gram_loss = 7.63e+05, loss_total = 7.63e+05
Step 83 : gram_loss = 7.45e+05, loss_total = 7.45e+05
Step 84 : gram_loss = 7.30e+05, loss_total = 7.30e+05
Step 85 : gram_loss = 7.11e+05, loss_total = 7.11e+05
Step 86 : gram_loss = 6.99e+05, loss_total = 6.99e+05
Step 87 : gram_loss = 6.75e+05, loss_total = 6.75e+05
Step 88 : gram_loss = 6.54e+05, loss_total = 6.54e+05
Step 89 : gram_loss = 6.39e+05, loss_total = 6.39e+05
Step 90 : gram_loss = 6.29e+05, loss_total = 6.29e+05
Step 91 : gram_loss = 6.17e+05, loss_total = 6.17e+05
Step 92 : gram_loss = 6.00e+05, loss_total = 6.00e+05
Step 93 : gram_loss = 5.89e+05, loss_total = 5.89e+05
Step 94 : gram_loss = 5.76e+05, loss_total = 5.76e+05
Step 95 : gram_loss = 5.69e+05, loss_total = 5.69e+05
Step 96 : gram_loss = 5.57e+05, loss_total = 5.57e+05
Step 97 : gram_loss = 5.49e+05, loss_total = 5.49e+05
Step 98 : gram_loss = 5.44e+05, loss_total = 5.44e+05
Step 99 : gram_loss = 5.35e+05, loss_total = 5.35e+05
Step 100 : gram_loss = 5.29e+05, loss_total = 5.29e+05
Step 101 : gram_loss = 5.21e+05, loss_total = 5.21e+05
Step 102 : gram_loss = 5.10e+05, loss_total = 5.10e+05
Step 103 : gram_loss = 4.99e+05, loss_total = 4.99e+05
Step 104 : gram_loss = 4.91e+05, loss_total = 4.91e+05
Step 105 : gram_loss = 4.86e+05, loss_total = 4.86e+05
Step 106 : gram_loss = 4.80e+05, loss_total = 4.80e+05
Step 107 : gram_loss = 4.75e+05, loss_total = 4.75e+05
Step 108 : gram_loss = 4.67e+05, loss_total = 4.67e+05
Step 109 : gram_loss = 4.62e+05, loss_total = 4.62e+05
Step 110 : gram_loss = 4.56e+05, loss_total = 4.56e+05
Step 111 : gram_loss = 4.50e+05, loss_total = 4.50e+05
Step 112 : gram_loss = 4.40e+05, loss_total = 4.40e+05
Step 113 : gram_loss = 4.34e+05, loss_total = 4.34e+05
Step 114 : gram_loss = 4.27e+05, loss_total = 4.27e+05
Step 115 : gram_loss = 4.23e+05, loss_total = 4.23e+05
Step 116 : gram_loss = 4.20e+05, loss_total = 4.20e+05
Step 117 : gram_loss = 4.15e+05, loss_total = 4.15e+05
Step 118 : gram_loss = 4.08e+05, loss_total = 4.08e+05
Step 119 : gram_loss = 4.00e+05, loss_total = 4.00e+05
Step 120 : gram_loss = 3.95e+05, loss_total = 3.95e+05
Step 121 : gram_loss = 3.92e+05, loss_total = 3.92e+05
Step 122 : gram_loss = 3.89e+05, loss_total = 3.89e+05
Step 123 : gram_loss = 3.86e+05, loss_total = 3.86e+05
Step 124 : gram_loss = 3.82e+05, loss_total = 3.82e+05
Step 125 : gram_loss = 3.76e+05, loss_total = 3.76e+05
Step 126 : gram_loss = 3.71e+05, loss_total = 3.71e+05
Step 127 : gram_loss = 3.67e+05, loss_total = 3.67e+05
Step 128 : gram_loss = 3.64e+05, loss_total = 3.64e+05
Step 129 : gram_loss = 3.62e+05, loss_total = 3.62e+05
Step 130 : gram_loss = 3.58e+05, loss_total = 3.58e+05
Step 131 : gram_loss = 3.52e+05, loss_total = 3.52e+05
Step 132 : gram_loss = 3.47e+05, loss_total = 3.47e+05
Step 133 : gram_loss = 3.44e+05, loss_total = 3.44e+05
Step 134 : gram_loss = 3.41e+05, loss_total = 3.41e+05
Step 135 : gram_loss = 3.39e+05, loss_total = 3.39e+05
Step 136 : gram_loss = 3.36e+05, loss_total = 3.36e+05
Step 137 : gram_loss = 3.33e+05, loss_total = 3.33e+05
Step 138 : gram_loss = 3.31e+05, loss_total = 3.31e+05
Step 139 : gram_loss = 3.26e+05, loss_total = 3.26e+05
Step 140 : gram_loss = 3.24e+05, loss_total = 3.24e+05
Step 141 : gram_loss = 3.22e+05, loss_total = 3.22e+05
Step 142 : gram_loss = 3.20e+05, loss_total = 3.20e+05
Step 143 : gram_loss = 3.17e+05, loss_total = 3.17e+05
Step 144 : gram_loss = 3.15e+05, loss_total = 3.15e+05
Step 145 : gram_loss = 3.12e+05, loss_total = 3.12e+05
Step 146 : gram_loss = 3.10e+05, loss_total = 3.10e+05
Step 147 : gram_loss = 3.07e+05, loss_total = 3.07e+05
Step 148 : gram_loss = 3.06e+05, loss_total = 3.06e+05
Step 149 : gram_loss = 3.04e+05, loss_total = 3.04e+05
Step 150 : gram_loss = 3.02e+05, loss_total = 3.02e+05
Step 151 : gram_loss = 3.00e+05, loss_total = 3.00e+05
Step 152 : gram_loss = 2.99e+05, loss_total = 2.99e+05
Step 153 : gram_loss = 2.97e+05, loss_total = 2.97e+05
Step 154 : gram_loss = 2.95e+05, loss_total = 2.95e+05
Step 155 : gram_loss = 2.93e+05, loss_total = 2.93e+05
Step 156 : gram_loss = 2.91e+05, loss_total = 2.91e+05
Step 157 : gram_loss = 2.87e+05, loss_total = 2.87e+05
Step 158 : gram_loss = 2.85e+05, loss_total = 2.85e+05
Step 159 : gram_loss = 2.84e+05, loss_total = 2.84e+05
Step 160 : gram_loss = 2.82e+05, loss_total = 2.82e+05
Step 161 : gram_loss = 2.80e+05, loss_total = 2.80e+05
Step 162 : gram_loss = 2.78e+05, loss_total = 2.78e+05
Step 163 : gram_loss = 2.77e+05, loss_total = 2.77e+05
Step 164 : gram_loss = 2.76e+05, loss_total = 2.76e+05
Step 165 : gram_loss = 2.75e+05, loss_total = 2.75e+05
Step 166 : gram_loss = 2.73e+05, loss_total = 2.73e+05
Step 167 : gram_loss = 2.71e+05, loss_total = 2.71e+05
Step 168 : gram_loss = 2.69e+05, loss_total = 2.69e+05
Step 169 : gram_loss = 2.68e+05, loss_total = 2.68e+05
Step 170 : gram_loss = 2.67e+05, loss_total = 2.67e+05
Step 171 : gram_loss = 2.66e+05, loss_total = 2.66e+05
Step 172 : gram_loss = 2.64e+05, loss_total = 2.64e+05
Step 173 : gram_loss = 2.63e+05, loss_total = 2.63e+05
Step 174 : gram_loss = 2.62e+05, loss_total = 2.62e+05
Step 175 : gram_loss = 2.61e+05, loss_total = 2.61e+05
Step 176 : gram_loss = 2.60e+05, loss_total = 2.60e+05
Step 177 : gram_loss = 2.58e+05, loss_total = 2.58e+05
Step 178 : gram_loss = 2.56e+05, loss_total = 2.56e+05
Step 179 : gram_loss = 2.55e+05, loss_total = 2.55e+05
Step 180 : gram_loss = 2.54e+05, loss_total = 2.54e+05
Step 181 : gram_loss = 2.53e+05, loss_total = 2.53e+05
Step 182 : gram_loss = 2.52e+05, loss_total = 2.52e+05
Step 183 : gram_loss = 2.50e+05, loss_total = 2.50e+05
Step 184 : gram_loss = 2.50e+05, loss_total = 2.50e+05
Step 185 : gram_loss = 2.48e+05, loss_total = 2.48e+05
Step 186 : gram_loss = 2.48e+05, loss_total = 2.48e+05
Step 187 : gram_loss = 2.47e+05, loss_total = 2.47e+05
Step 188 : gram_loss = 2.45e+05, loss_total = 2.45e+05
Step 189 : gram_loss = 2.44e+05, loss_total = 2.44e+05
Step 190 : gram_loss = 2.42e+05, loss_total = 2.42e+05
Step 191 : gram_loss = 2.42e+05, loss_total = 2.42e+05
Step 192 : gram_loss = 2.41e+05, loss_total = 2.41e+05
Step 193 : gram_loss = 2.40e+05, loss_total = 2.40e+05
Step 194 : gram_loss = 2.39e+05, loss_total = 2.39e+05
Step 195 : gram_loss = 2.37e+05, loss_total = 2.37e+05
Step 196 : gram_loss = 2.37e+05, loss_total = 2.37e+05
Step 197 : gram_loss = 2.36e+05, loss_total = 2.36e+05
Step 198 : gram_loss = 2.35e+05, loss_total = 2.35e+05
Step 199 : gram_loss = 2.34e+05, loss_total = 2.34e+05
Step 200 : gram_loss = 2.33e+05, loss_total = 2.33e+05
Close Sess - End of the global optimization.
Computation total for  108.10304617881775  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0025_1_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0025_1_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0025_1_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0025_1_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0025_1_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0025_1_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.21656346321106  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 4.26e+09, loss_total = 4.26e+09
Step 1 : gram_loss = 1.03e+09, loss_total = 1.03e+09
Step 2 : gram_loss = 9.97e+08, loss_total = 9.97e+08
Step 3 : gram_loss = 4.09e+08, loss_total = 4.09e+08
Step 4 : gram_loss = 2.57e+08, loss_total = 2.57e+08
Step 5 : gram_loss = 2.23e+08, loss_total = 2.23e+08
Step 6 : gram_loss = 1.62e+08, loss_total = 1.62e+08
Step 7 : gram_loss = 1.38e+08, loss_total = 1.38e+08
Step 8 : gram_loss = 1.27e+08, loss_total = 1.27e+08
Step 9 : gram_loss = 1.13e+08, loss_total = 1.13e+08
Step 10 : gram_loss = 1.02e+08, loss_total = 1.02e+08
Step 11 : gram_loss = 8.09e+07, loss_total = 8.09e+07
Step 12 : gram_loss = 5.97e+07, loss_total = 5.97e+07
Step 13 : gram_loss = 4.95e+07, loss_total = 4.95e+07
Step 14 : gram_loss = 4.18e+07, loss_total = 4.18e+07
Step 15 : gram_loss = 3.89e+07, loss_total = 3.89e+07
Step 16 : gram_loss = 3.69e+07, loss_total = 3.69e+07
Step 17 : gram_loss = 3.45e+07, loss_total = 3.45e+07
Step 18 : gram_loss = 2.87e+07, loss_total = 2.87e+07
Step 19 : gram_loss = 2.48e+07, loss_total = 2.48e+07
Step 20 : gram_loss = 2.27e+07, loss_total = 2.27e+07
Step 21 : gram_loss = 2.03e+07, loss_total = 2.03e+07
Step 22 : gram_loss = 1.92e+07, loss_total = 1.92e+07
Step 23 : gram_loss = 1.72e+07, loss_total = 1.72e+07
Step 24 : gram_loss = 1.61e+07, loss_total = 1.61e+07
Step 25 : gram_loss = 1.38e+07, loss_total = 1.38e+07
Step 26 : gram_loss = 1.17e+07, loss_total = 1.17e+07
Step 27 : gram_loss = 1.02e+07, loss_total = 1.02e+07
Step 28 : gram_loss = 1.01e+07, loss_total = 1.01e+07
Step 29 : gram_loss = 8.89e+06, loss_total = 8.89e+06
Step 30 : gram_loss = 8.66e+06, loss_total = 8.66e+06
Step 31 : gram_loss = 8.18e+06, loss_total = 8.18e+06
Step 32 : gram_loss = 7.61e+06, loss_total = 7.61e+06
Step 33 : gram_loss = 6.67e+06, loss_total = 6.67e+06
Step 34 : gram_loss = 6.23e+06, loss_total = 6.23e+06
Step 35 : gram_loss = 5.87e+06, loss_total = 5.87e+06
Step 36 : gram_loss = 5.52e+06, loss_total = 5.52e+06
Step 37 : gram_loss = 5.25e+06, loss_total = 5.25e+06
Step 38 : gram_loss = 4.82e+06, loss_total = 4.82e+06
Step 39 : gram_loss = 4.57e+06, loss_total = 4.57e+06
Step 40 : gram_loss = 4.24e+06, loss_total = 4.24e+06
Step 41 : gram_loss = 3.93e+06, loss_total = 3.93e+06
Step 42 : gram_loss = 3.82e+06, loss_total = 3.82e+06
Step 43 : gram_loss = 3.58e+06, loss_total = 3.58e+06
Step 44 : gram_loss = 3.39e+06, loss_total = 3.39e+06
Step 45 : gram_loss = 3.15e+06, loss_total = 3.15e+06
Step 46 : gram_loss = 2.95e+06, loss_total = 2.95e+06
Step 47 : gram_loss = 2.68e+06, loss_total = 2.68e+06
Step 48 : gram_loss = 2.55e+06, loss_total = 2.55e+06
Step 49 : gram_loss = 2.39e+06, loss_total = 2.39e+06
Step 50 : gram_loss = 2.36e+06, loss_total = 2.36e+06
Step 51 : gram_loss = 2.14e+06, loss_total = 2.14e+06
Step 52 : gram_loss = 2.06e+06, loss_total = 2.06e+06
Step 53 : gram_loss = 1.93e+06, loss_total = 1.93e+06
Step 54 : gram_loss = 1.74e+06, loss_total = 1.74e+06
Step 55 : gram_loss = 1.61e+06, loss_total = 1.61e+06
Step 56 : gram_loss = 1.50e+06, loss_total = 1.50e+06
Step 57 : gram_loss = 1.42e+06, loss_total = 1.42e+06
Step 58 : gram_loss = 1.34e+06, loss_total = 1.34e+06
Step 59 : gram_loss = 1.26e+06, loss_total = 1.26e+06
Step 60 : gram_loss = 1.16e+06, loss_total = 1.16e+06
Step 61 : gram_loss = 1.11e+06, loss_total = 1.11e+06
Step 62 : gram_loss = 1.04e+06, loss_total = 1.04e+06
Step 63 : gram_loss = 9.64e+05, loss_total = 9.64e+05
Step 64 : gram_loss = 8.92e+05, loss_total = 8.92e+05
Step 65 : gram_loss = 8.32e+05, loss_total = 8.32e+05
Step 66 : gram_loss = 7.95e+05, loss_total = 7.95e+05
Step 67 : gram_loss = 7.58e+05, loss_total = 7.58e+05
Step 68 : gram_loss = 7.40e+05, loss_total = 7.40e+05
Step 69 : gram_loss = 7.07e+05, loss_total = 7.07e+05
Step 70 : gram_loss = 6.66e+05, loss_total = 6.66e+05
Step 71 : gram_loss = 6.29e+05, loss_total = 6.29e+05
Step 72 : gram_loss = 5.73e+05, loss_total = 5.73e+05
Step 73 : gram_loss = 5.56e+05, loss_total = 5.56e+05
Step 74 : gram_loss = 5.37e+05, loss_total = 5.37e+05
Step 75 : gram_loss = 5.26e+05, loss_total = 5.26e+05
Step 76 : gram_loss = 4.91e+05, loss_total = 4.91e+05
Step 77 : gram_loss = 4.79e+05, loss_total = 4.79e+05
Step 78 : gram_loss = 4.45e+05, loss_total = 4.45e+05
Step 79 : gram_loss = 4.26e+05, loss_total = 4.26e+05
Step 80 : gram_loss = 4.05e+05, loss_total = 4.05e+05
Step 81 : gram_loss = 3.87e+05, loss_total = 3.87e+05
Step 82 : gram_loss = 3.70e+05, loss_total = 3.70e+05
Step 83 : gram_loss = 3.55e+05, loss_total = 3.55e+05
Step 84 : gram_loss = 3.41e+05, loss_total = 3.41e+05
Step 85 : gram_loss = 3.33e+05, loss_total = 3.33e+05
Step 86 : gram_loss = 3.22e+05, loss_total = 3.22e+05
Step 87 : gram_loss = 3.00e+05, loss_total = 3.00e+05
Step 88 : gram_loss = 2.95e+05, loss_total = 2.95e+05
Step 89 : gram_loss = 2.79e+05, loss_total = 2.79e+05
Step 90 : gram_loss = 2.72e+05, loss_total = 2.72e+05
Step 91 : gram_loss = 2.66e+05, loss_total = 2.66e+05
Step 92 : gram_loss = 2.59e+05, loss_total = 2.59e+05
Step 93 : gram_loss = 2.51e+05, loss_total = 2.51e+05
Step 94 : gram_loss = 2.42e+05, loss_total = 2.42e+05
Step 95 : gram_loss = 2.36e+05, loss_total = 2.36e+05
Step 96 : gram_loss = 2.27e+05, loss_total = 2.27e+05
Step 97 : gram_loss = 2.24e+05, loss_total = 2.24e+05
Step 98 : gram_loss = 2.16e+05, loss_total = 2.16e+05
Step 99 : gram_loss = 2.10e+05, loss_total = 2.10e+05
Step 100 : gram_loss = 2.03e+05, loss_total = 2.03e+05
Step 101 : gram_loss = 1.99e+05, loss_total = 1.99e+05
Step 102 : gram_loss = 1.94e+05, loss_total = 1.94e+05
Step 103 : gram_loss = 1.89e+05, loss_total = 1.89e+05
Step 104 : gram_loss = 1.84e+05, loss_total = 1.84e+05
Step 105 : gram_loss = 1.79e+05, loss_total = 1.79e+05
Step 106 : gram_loss = 1.76e+05, loss_total = 1.76e+05
Step 107 : gram_loss = 1.74e+05, loss_total = 1.74e+05
Step 108 : gram_loss = 1.71e+05, loss_total = 1.71e+05
Step 109 : gram_loss = 1.68e+05, loss_total = 1.68e+05
Step 110 : gram_loss = 1.61e+05, loss_total = 1.61e+05
Step 111 : gram_loss = 1.60e+05, loss_total = 1.60e+05
Step 112 : gram_loss = 1.54e+05, loss_total = 1.54e+05
Step 113 : gram_loss = 1.53e+05, loss_total = 1.53e+05
Step 114 : gram_loss = 1.51e+05, loss_total = 1.51e+05
Step 115 : gram_loss = 1.45e+05, loss_total = 1.45e+05
Step 116 : gram_loss = 1.43e+05, loss_total = 1.43e+05
Step 117 : gram_loss = 1.40e+05, loss_total = 1.40e+05
Step 118 : gram_loss = 1.38e+05, loss_total = 1.38e+05
Step 119 : gram_loss = 1.36e+05, loss_total = 1.36e+05
Step 120 : gram_loss = 1.34e+05, loss_total = 1.34e+05
Step 121 : gram_loss = 1.32e+05, loss_total = 1.32e+05
Step 122 : gram_loss = 1.30e+05, loss_total = 1.30e+05
Step 123 : gram_loss = 1.27e+05, loss_total = 1.27e+05
Step 124 : gram_loss = 1.25e+05, loss_total = 1.25e+05
Step 125 : gram_loss = 1.23e+05, loss_total = 1.23e+05
Step 126 : gram_loss = 1.21e+05, loss_total = 1.21e+05
Step 127 : gram_loss = 1.20e+05, loss_total = 1.20e+05
Step 128 : gram_loss = 1.17e+05, loss_total = 1.17e+05
Step 129 : gram_loss = 1.14e+05, loss_total = 1.14e+05
Step 130 : gram_loss = 1.12e+05, loss_total = 1.12e+05
Step 131 : gram_loss = 1.10e+05, loss_total = 1.10e+05
Step 132 : gram_loss = 1.09e+05, loss_total = 1.09e+05
Step 133 : gram_loss = 1.08e+05, loss_total = 1.08e+05
Step 134 : gram_loss = 1.05e+05, loss_total = 1.05e+05
Step 135 : gram_loss = 1.04e+05, loss_total = 1.04e+05
Step 136 : gram_loss = 1.02e+05, loss_total = 1.02e+05
Step 137 : gram_loss = 1.01e+05, loss_total = 1.01e+05
Step 138 : gram_loss = 1.00e+05, loss_total = 1.00e+05
Step 139 : gram_loss = 9.86e+04, loss_total = 9.86e+04
Step 140 : gram_loss = 9.80e+04, loss_total = 9.80e+04
Step 141 : gram_loss = 9.61e+04, loss_total = 9.61e+04
Step 142 : gram_loss = 9.55e+04, loss_total = 9.55e+04
Step 143 : gram_loss = 9.46e+04, loss_total = 9.46e+04
Step 144 : gram_loss = 9.33e+04, loss_total = 9.33e+04
Step 145 : gram_loss = 9.21e+04, loss_total = 9.21e+04
Step 146 : gram_loss = 9.09e+04, loss_total = 9.09e+04
Step 147 : gram_loss = 8.97e+04, loss_total = 8.97e+04
Step 148 : gram_loss = 8.88e+04, loss_total = 8.88e+04
Step 149 : gram_loss = 8.71e+04, loss_total = 8.71e+04
Step 150 : gram_loss = 8.58e+04, loss_total = 8.58e+04
Step 151 : gram_loss = 8.47e+04, loss_total = 8.47e+04
Step 152 : gram_loss = 8.34e+04, loss_total = 8.34e+04
Step 153 : gram_loss = 8.28e+04, loss_total = 8.28e+04
Step 154 : gram_loss = 8.15e+04, loss_total = 8.15e+04
Step 155 : gram_loss = 8.09e+04, loss_total = 8.09e+04
Step 156 : gram_loss = 8.01e+04, loss_total = 8.01e+04
Step 157 : gram_loss = 7.90e+04, loss_total = 7.90e+04
Step 158 : gram_loss = 7.79e+04, loss_total = 7.79e+04
Step 159 : gram_loss = 7.74e+04, loss_total = 7.74e+04
Step 160 : gram_loss = 7.69e+04, loss_total = 7.69e+04
Step 161 : gram_loss = 7.58e+04, loss_total = 7.58e+04
Step 162 : gram_loss = 7.49e+04, loss_total = 7.49e+04
Step 163 : gram_loss = 7.41e+04, loss_total = 7.41e+04
Step 164 : gram_loss = 7.35e+04, loss_total = 7.35e+04
Step 165 : gram_loss = 7.29e+04, loss_total = 7.29e+04
Step 166 : gram_loss = 7.20e+04, loss_total = 7.20e+04
Step 167 : gram_loss = 7.12e+04, loss_total = 7.12e+04
Step 168 : gram_loss = 7.05e+04, loss_total = 7.05e+04
Step 169 : gram_loss = 7.00e+04, loss_total = 7.00e+04
Step 170 : gram_loss = 6.95e+04, loss_total = 6.95e+04
Step 171 : gram_loss = 6.87e+04, loss_total = 6.87e+04
Step 172 : gram_loss = 6.82e+04, loss_total = 6.82e+04
Step 173 : gram_loss = 6.75e+04, loss_total = 6.75e+04
Step 174 : gram_loss = 6.67e+04, loss_total = 6.67e+04
Step 175 : gram_loss = 6.60e+04, loss_total = 6.60e+04
Step 176 : gram_loss = 6.55e+04, loss_total = 6.55e+04
Step 177 : gram_loss = 6.49e+04, loss_total = 6.49e+04
Step 178 : gram_loss = 6.43e+04, loss_total = 6.43e+04
Step 179 : gram_loss = 6.38e+04, loss_total = 6.38e+04
Step 180 : gram_loss = 6.32e+04, loss_total = 6.32e+04
Step 181 : gram_loss = 6.26e+04, loss_total = 6.26e+04
Step 182 : gram_loss = 6.19e+04, loss_total = 6.19e+04
Step 183 : gram_loss = 6.13e+04, loss_total = 6.13e+04
Step 184 : gram_loss = 6.07e+04, loss_total = 6.07e+04
Step 185 : gram_loss = 6.02e+04, loss_total = 6.02e+04
Step 186 : gram_loss = 5.97e+04, loss_total = 5.97e+04
Step 187 : gram_loss = 5.93e+04, loss_total = 5.93e+04
Step 188 : gram_loss = 5.90e+04, loss_total = 5.90e+04
Step 189 : gram_loss = 5.83e+04, loss_total = 5.83e+04
Step 190 : gram_loss = 5.80e+04, loss_total = 5.80e+04
Step 191 : gram_loss = 5.73e+04, loss_total = 5.73e+04
Step 192 : gram_loss = 5.71e+04, loss_total = 5.71e+04
Step 193 : gram_loss = 5.67e+04, loss_total = 5.67e+04
Step 194 : gram_loss = 5.65e+04, loss_total = 5.65e+04
Step 195 : gram_loss = 5.60e+04, loss_total = 5.60e+04
Step 196 : gram_loss = 5.58e+04, loss_total = 5.58e+04
Step 197 : gram_loss = 5.56e+04, loss_total = 5.56e+04
Step 198 : gram_loss = 5.53e+04, loss_total = 5.53e+04
Step 199 : gram_loss = 5.48e+04, loss_total = 5.48e+04
Step 200 : gram_loss = 5.42e+04, loss_total = 5.42e+04
Close Sess - End of the global optimization.
Computation total for  108.36901760101318  s
End of the texture test with Gram Matrices
############################################################################################
########  /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0013_1_256.jpg  #########
############################################################################################
verbosity turned on
Namespace(GramLightComput=False, K=2, MS_Strat='', MS_minscale=256, WLowResConstr=1.0, beta_spectrum=100000, clip_var=1, clipping_type='ImageStyleBGR', config_layers='Custom', data_folder='data/', debug=False, eps=1e-16, gamma_autocorr=1.0, gpu_frac=0.0, img_ext='png', img_folder='/home/thomas/Downloads/CompImg/flower_beds_256/', img_output_folder='images_output/', init='Gaussian', init_noise_ratio=1.0, init_range=127.5, iprint=0, learning_rate=10.0, loss=['Gram'], max_iter=200, maxcor=20, non_linearity_type='relu', optimizer='lbfgs', output_img_name='FlowerBeds0013_1_256.jpg_Gram', padding='SAME', pooling_type='avg', print_iter=1, recomputePrepocess=False, saveMS=False, savedIntermediateIm=False, start_from_noise=1, texture_layer_weights=[1.0, 1.0, 1.0, 1.0, 1.0], texture_ref_name='FlowerBeds0013_1_256.jpg', used_layers=['relu1_1', 'pool1', 'pool2', 'pool3', 'pool4'], verbose=True, vgg_name='normalizedvgg.mat')
image_path /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0013_1_256.jpg.png
Exception when we try to open the image, try with a different extension format png
image_path2 /home/thomas/Downloads/CompImg/flower_beds_256/FlowerBeds0013_1_256.jpg.jpg
The image have been sucessfully loaded without extension
Load Data  data/gram_FlowerBeds0013_1_256.jpg_256_256_avg_SAME_n.pkl
The Gram Matrices doesn't exist, we will generate them.
Pickle dumped
Net loaded and Gram computation (if needed) done after  4.182280778884888  s
Memory Growth
Noisy image generation with a Gaussian white noise
Texture layers [('relu1_1', 1.0), ('pool1', 1.0), ('pool2', 1.0), ('pool3', 1.0), ('pool4', 1.0)]
Initial total loss:
Start LBFGS optimization with a print each  1  iterations
Loss values before optimization:
gram_loss = 3.54e+09, loss_total = 3.54e+09
Step 1 : gram_loss = 2.75e+09, loss_total = 2.75e+09
Step 2 : gram_loss = 2.66e+09, loss_total = 2.66e+09
Step 3 : gram_loss = 1.99e+09, loss_total = 1.99e+09
Step 4 : gram_loss = 1.49e+09, loss_total = 1.49e+09
Step 5 : gram_loss = 8.06e+08, loss_total = 8.06e+08
Step 6 : gram_loss = 5.09e+08, loss_total = 5.09e+08
Step 7 : gram_loss = 3.99e+08, loss_total = 3.99e+08
Step 8 : gram_loss = 3.52e+08, loss_total = 3.52e+08
Step 9 : gram_loss = 2.86e+08, loss_total = 2.86e+08
Step 10 : gram_loss = 2.15e+08, loss_total = 2.15e+08
Step 11 : gram_loss = 1.70e+08, loss_total = 1.70e+08
Step 12 : gram_loss = 1.29e+08, loss_total = 1.29e+08
Step 13 : gram_loss = 9.77e+07, loss_total = 9.77e+07
Step 14 : gram_loss = 8.48e+07, loss_total = 8.48e+07
Step 15 : gram_loss = 7.74e+07, loss_total = 7.74e+07
Step 16 : gram_loss = 6.92e+07, loss_total = 6.92e+07
Step 17 : gram_loss = 5.55e+07, loss_total = 5.55e+07
Step 18 : gram_loss = 4.39e+07, loss_total = 4.39e+07
Step 19 : gram_loss = 3.48e+07, loss_total = 3.48e+07
Step 20 : gram_loss = 2.83e+07, loss_total = 2.83e+07
Step 21 : gram_loss = 2.55e+07, loss_total = 2.55e+07
Step 22 : gram_loss = 2.40e+07, loss_total = 2.40e+07
Step 23 : gram_loss = 2.15e+07, loss_total = 2.15e+07
Step 24 : gram_loss = 1.93e+07, loss_total = 1.93e+07
Step 25 : gram_loss = 1.63e+07, loss_total = 1.63e+07
Step 26 : gram_loss = 1.40e+07, loss_total = 1.40e+07
Step 27 : gram_loss = 1.23e+07, loss_total = 1.23e+07
Step 28 : gram_loss = 1.13e+07, loss_total = 1.13e+07
Step 29 : gram_loss = 1.06e+07, loss_total = 1.06e+07
Step 30 : gram_loss = 1.01e+07, loss_total = 1.01e+07
Step 31 : gram_loss = 8.84e+06, loss_total = 8.84e+06
Step 32 : gram_loss = 8.08e+06, loss_total = 8.08e+06
Step 33 : gram_loss = 6.96e+06, loss_total = 6.96e+06
Step 34 : gram_loss = 6.65e+06, loss_total = 6.65e+06
Step 35 : gram_loss = 6.34e+06, loss_total = 6.34e+06
Step 36 : gram_loss = 5.92e+06, loss_total = 5.92e+06
Step 37 : gram_loss = 5.41e+06, loss_total = 5.41e+06
Step 38 : gram_loss = 5.14e+06, loss_total = 5.14e+06
Step 39 : gram_loss = 4.80e+06, loss_total = 4.80e+06
Step 40 : gram_loss = 4.66e+06, loss_total = 4.66e+06
Step 41 : gram_loss = 4.28e+06, loss_total = 4.28e+06
Step 42 : gram_loss = 4.14e+06, loss_total = 4.14e+06
Step 43 : gram_loss = 3.97e+06, loss_total = 3.97e+06
Step 44 : gram_loss = 3.65e+06, loss_total = 3.65e+06
Step 45 : gram_loss = 3.25e+06, loss_total = 3.25e+06
Step 46 : gram_loss = 3.04e+06, loss_total = 3.04e+06
Step 47 : gram_loss = 2.92e+06, loss_total = 2.92e+06
Step 48 : gram_loss = 2.69e+06, loss_total = 2.69e+06
Step 49 : gram_loss = 2.63e+06, loss_total = 2.63e+06
Step 50 : gram_loss = 2.52e+06, loss_total = 2.52e+06
Step 51 : gram_loss = 2.37e+06, loss_total = 2.37e+06
Step 52 : gram_loss = 2.09e+06, loss_total = 2.09e+06
Step 53 : gram_loss = 1.89e+06, loss_total = 1.89e+06
Step 54 : gram_loss = 1.65e+06, loss_total = 1.65e+06
Step 55 : gram_loss = 1.59e+06, loss_total = 1.59e+06
Step 56 : gram_loss = 1.51e+06, loss_total = 1.51e+06
Step 57 : gram_loss = 1.46e+06, loss_total = 1.46e+06
Step 58 : gram_loss = 1.36e+06, loss_total = 1.36e+06
Step 59 : gram_loss = 1.23e+06, loss_total = 1.23e+06
Step 60 : gram_loss = 1.17e+06, loss_total = 1.17e+06
Step 61 : gram_loss = 1.08e+06, loss_total = 1.08e+06
Step 62 : gram_loss = 1.03e+06, loss_total = 1.03e+06
Step 63 : gram_loss = 9.67e+05, loss_total = 9.67e+05
Step 64 : gram_loss = 9.07e+05, loss_total = 9.07e+05
Step 65 : gram_loss = 8.48e+05, loss_total = 8.48e+05
Step 66 : gram_loss = 8.29e+05, loss_total = 8.29e+05
Step 67 : gram_loss = 7.91e+05, loss_total = 7.91e+05
Step 68 : gram_loss = 7.63e+05, loss_total = 7.63e+05
Step 69 : gram_loss = 7.23e+05, loss_total = 7.23e+05
Step 70 : gram_loss = 6.76e+05, loss_total = 6.76e+05
Step 71 : gram_loss = 6.33e+05, loss_total = 6.33e+05
Step 72 : gram_loss = 5.98e+05, loss_total = 5.98e+05
Step 73 : gram_loss = 5.75e+05, loss_total = 5.75e+05
Step 74 : gram_loss = 5.47e+05, loss_total = 5.47e+05
Step 75 : gram_loss = 5.20e+05, loss_total = 5.20e+05
Step 76 : gram_loss = 4.92e+05, loss_total = 4.92e+05
Step 77 : gram_loss = 4.75e+05, loss_total = 4.75e+05
Step 78 : gram_loss = 4.65e+05, loss_total = 4.65e+05
Step 79 : gram_loss = 4.38e+05, loss_total = 4.38e+05
Step 80 : gram_loss = 4.22e+05, loss_total = 4.22e+05
Step 81 : gram_loss = 4.00e+05, loss_total = 4.00e+05
Step 82 : gram_loss = 3.89e+05, loss_total = 3.89e+05
Step 83 : gram_loss = 3.81e+05, loss_total = 3.81e+05
Step 84 : gram_loss = 3.71e+05, loss_total = 3.71e+05
Step 85 : gram_loss = 3.60e+05, loss_total = 3.60e+05
Step 86 : gram_loss = 3.51e+05, loss_total = 3.51e+05
Step 87 : gram_loss = 3.43e+05, loss_total = 3.43e+05
Step 88 : gram_loss = 3.36e+05, loss_total = 3.36e+05
Step 89 : gram_loss = 3.25e+05, loss_total = 3.25e+05
Step 90 : gram_loss = 3.13e+05, loss_total = 3.13e+05
Step 91 : gram_loss = 3.02e+05, loss_total = 3.02e+05
Step 92 : gram_loss = 2.95e+05, loss_total = 2.95e+05
Step 93 : gram_loss = 2.89e+05, loss_total = 2.89e+05
Step 94 : gram_loss = 2.82e+05, loss_total = 2.82e+05
Step 95 : gram_loss = 2.75e+05, loss_total = 2.75e+05
Step 96 : gram_loss = 2.67e+05, loss_total = 2.67e+05
Step 97 : gram_loss = 2.59e+05, loss_total = 2.59e+05
Step 98 : gram_loss = 2.50e+05, loss_total = 2.50e+05
Step 99 : gram_loss = 2.45e+05, loss_total = 2.45e+05
Step 100 : gram_loss = 2.40e+05, loss_total = 2.40e+05
Step 101 : gram_loss = 2.37e+05, loss_total = 2.37e+05
Step 102 : gram_loss = 2.33e+05, loss_total = 2.33e+05
Step 103 : gram_loss = 2.26e+05, loss_total = 2.26e+05
Step 104 : gram_loss = 2.19e+05, loss_total = 2.19e+05
Step 105 : gram_loss = 2.15e+05, loss_total = 2.15e+05
Step 106 : gram_loss = 2.11e+05, loss_total = 2.11e+05
Step 107 : gram_loss = 2.06e+05, loss_total = 2.06e+05
Step 108 : gram_loss = 2.03e+05, loss_total = 2.03e+05
Step 109 : gram_loss = 1.98e+05, loss_total = 1.98e+05
Step 110 : gram_loss = 1.97e+05, loss_total = 1.97e+05
Step 111 : gram_loss = 1.94e+05, loss_total = 1.94e+05
Step 112 : gram_loss = 1.91e+05, loss_total = 1.91e+05
Step 113 : gram_loss = 1.89e+05, loss_total = 1.89e+05
Step 114 : gram_loss = 1.85e+05, loss_total = 1.85e+05
Step 115 : gram_loss = 1.81e+05, loss_total = 1.81e+05
Step 116 : gram_loss = 1.75e+05, loss_total = 1.75e+05
Step 117 : gram_loss = 1.72e+05, loss_total = 1.72e+05
Step 118 : gram_loss = 1.69e+05, loss_total = 1.69e+05
Step 119 : gram_loss = 1.68e+05, loss_total = 1.68e+05
Step 120 : gram_loss = 1.66e+05, loss_total = 1.66e+05
Step 121 : gram_loss = 1.64e+05, loss_total = 1.64e+05
Step 122 : gram_loss = 1.60e+05, loss_total = 1.60e+05
Step 123 : gram_loss = 1.57e+05, loss_total = 1.57e+05
Step 124 : gram_loss = 1.54e+05, loss_total = 1.54e+05
Step 125 : gram_loss = 1.52e+05, loss_total = 1.52e+05
Step 126 : gram_loss = 1.50e+05, loss_total = 1.50e+05
Step 127 : gram_loss = 1.48e+05, loss_total = 1.48e+05
Step 128 : gram_loss = 1.46e+05, loss_total = 1.46e+05
Step 129 : gram_loss = 1.45e+05, loss_total = 1.45e+05
Step 130 : gram_loss = 1.43e+05, loss_total = 1.43e+05
Step 131 : gram_loss = 1.41e+05, loss_total = 1.41e+05
Step 132 : gram_loss = 1.39e+05, loss_total = 1.39e+05
Step 133 : gram_loss = 1.37e+05, loss_total = 1.37e+05
Step 134 : gram_loss = 1.36e+05, loss_total = 1.36e+05
Step 135 : gram_loss = 1.34e+05, loss_total = 1.34e+05
Step 136 : gram_loss = 1.31e+05, loss_total = 1.31e+05
Step 137 : gram_loss = 1.29e+05, loss_total = 1.29e+05
Step 138 : gram_loss = 1.28e+05, loss_total = 1.28e+05
Step 139 : gram_loss = 1.25e+05, loss_total = 1.25e+05
Step 140 : gram_loss = 1.24e+05, loss_total = 1.24e+05
Step 141 : gram_loss = 1.23e+05, loss_total = 1.23e+05
Step 142 : gram_loss = 1.21e+05, loss_total = 1.21e+05
Step 143 : gram_loss = 1.20e+05, loss_total = 1.20e+05
Step 144 : gram_loss = 1.19e+05, loss_total = 1.19e+05
Step 145 : gram_loss = 1.18e+05, loss_total = 1.18e+05
Step 146 : gram_loss = 1.16e+05, loss_total = 1.16e+05
Step 147 : gram_loss = 1.15e+05, loss_total = 1.15e+05
Step 148 : gram_loss = 1.13e+05, loss_total = 1.13e+05
Step 149 : gram_loss = 1.12e+05, loss_total = 1.12e+05
Step 150 : gram_loss = 1.11e+05, loss_total = 1.11e+05
Step 151 : gram_loss = 1.10e+05, loss_total = 1.10e+05
Step 152 : gram_loss = 1.09e+05, loss_total = 1.09e+05
Step 153 : gram_loss = 1.08e+05, loss_total = 1.08e+05
Step 154 : gram_loss = 1.07e+05, loss_total = 1.07e+05
Step 155 : gram_loss = 1.06e+05, loss_total = 1.06e+05
Step 156 : gram_loss = 1.05e+05, loss_total = 1.05e+05
Step 157 : gram_loss = 1.04e+05, loss_total = 1.04e+05
Step 158 : gram_loss = 1.04e+05, loss_total = 1.04e+05
Step 159 : gram_loss = 1.03e+05, loss_total = 1.03e+05
Step 160 : gram_loss = 1.02e+05, loss_total = 1.02e+05
Step 161 : gram_loss = 1.01e+05, loss_total = 1.01e+05
Step 162 : gram_loss = 1.00e+05, loss_total = 1.00e+05
Step 163 : gram_loss = 9.88e+04, loss_total = 9.88e+04
Step 164 : gram_loss = 9.82e+04, loss_total = 9.82e+04
Step 165 : gram_loss = 9.76e+04, loss_total = 9.76e+04
Step 166 : gram_loss = 9.69e+04, loss_total = 9.69e+04
Step 167 : gram_loss = 9.63e+04, loss_total = 9.63e+04
Step 168 : gram_loss = 9.56e+04, loss_total = 9.56e+04
Step 169 : gram_loss = 9.52e+04, loss_total = 9.52e+04
Step 170 : gram_loss = 9.38e+04, loss_total = 9.38e+04
Step 171 : gram_loss = 9.35e+04, loss_total = 9.35e+04
Step 172 : gram_loss = 9.22e+04, loss_total = 9.22e+04
Step 173 : gram_loss = 9.17e+04, loss_total = 9.17e+04
Step 174 : gram_loss = 9.12e+04, loss_total = 9.12e+04
Step 175 : gram_loss = 9.07e+04, loss_total = 9.07e+04
Step 176 : gram_loss = 8.99e+04, loss_total = 8.99e+04
Step 177 : gram_loss = 8.93e+04, loss_total = 8.93e+04
Step 178 : gram_loss = 8.87e+04, loss_total = 8.87e+04
Step 179 : gram_loss = 8.81e+04, loss_total = 8.81e+04
Step 180 : gram_loss = 8.76e+04, loss_total = 8.76e+04
Step 181 : gram_loss = 8.72e+04, loss_total = 8.72e+04
Step 182 : gram_loss = 8.63e+04, loss_total = 8.63e+04
Step 183 : gram_loss = 8.57e+04, loss_total = 8.57e+04
Step 184 : gram_loss = 8.51e+04, loss_total = 8.51e+04
Step 185 : gram_loss = 8.46e+04, loss_total = 8.46e+04
Step 186 : gram_loss = 8.40e+04, loss_total = 8.40e+04
Step 187 : gram_loss = 8.33e+04, loss_total = 8.33e+04
Step 188 : gram_loss = 8.27e+04, loss_total = 8.27e+04
Step 189 : gram_loss = 8.22e+04, loss_total = 8.22e+04
Step 190 : gram_loss = 8.17e+04, loss_total = 8.17e+04
Step 191 : gram_loss = 8.09e+04, loss_total = 8.09e+04
Step 192 : gram_loss = 8.04e+04, loss_total = 8.04e+04
Step 193 : gram_loss = 7.97e+04, loss_total = 7.97e+04
Step 194 : gram_loss = 7.92e+04, loss_total = 7.92e+04
Step 195 : gram_loss = 7.91e+04, loss_total = 7.91e+04
Step 196 : gram_loss = 7.85e+04, loss_total = 7.85e+04
Step 197 : gram_loss = 7.83e+04, loss_total = 7.83e+04
Step 198 : gram_loss = 7.79e+04, loss_total = 7.79e+04
Step 199 : gram_loss = 7.74e+04, loss_total = 7.74e+04
Step 200 : gram_loss = 7.67e+04, loss_total = 7.67e+04
Close Sess - End of the global optimization.
Computation total for  108.1599748134613  s
End of the texture test with Gram Matrices
